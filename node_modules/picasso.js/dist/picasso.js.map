{"version":3,"file":"picasso.js","sources":["../../../node_modules/path2d-polyfill/src/parse-path.js","../../../node_modules/path2d-polyfill/src/path2d-polyfill.js","../../../node_modules/path2d-polyfill/src/index.js","../../../node_modules/extend/index.js","../src/about.js","../src/core/charts/chart-mixins.js","../src/core/dock-layout/dock-config.js","../src/core/dock-layout/dock-settings-resolver.js","../src/core/utils/is-number.js","../src/core/geometry/util.js","../src/core/dock-layout/dock-layout.js","../src/core/utils/event-type.js","../src/core/data/data.js","../../../node_modules/d3-path/src/path.js","../../../node_modules/d3-shape/src/constant.js","../../../node_modules/d3-shape/src/math.js","../../../node_modules/d3-shape/src/arc.js","../../../node_modules/d3-shape/src/curve/linear.js","../../../node_modules/d3-shape/src/point.js","../../../node_modules/d3-shape/src/line.js","../../../node_modules/d3-shape/src/area.js","../../../node_modules/d3-shape/src/descending.js","../../../node_modules/d3-shape/src/identity.js","../../../node_modules/d3-shape/src/pie.js","../../../node_modules/d3-shape/src/array.js","../../../node_modules/d3-shape/src/curve/basis.js","../../../node_modules/d3-shape/src/curve/cardinal.js","../../../node_modules/d3-shape/src/curve/catmullRom.js","../../../node_modules/d3-shape/src/curve/monotone.js","../../../node_modules/d3-shape/src/curve/natural.js","../../../node_modules/d3-shape/src/curve/step.js","../../../node_modules/d3-shape/src/offset/none.js","../../../node_modules/d3-shape/src/order/none.js","../../../node_modules/d3-shape/src/stack.js","../../../node_modules/d3-shape/src/offset/expand.js","../../../node_modules/d3-shape/src/offset/diverging.js","../../../node_modules/d3-shape/src/offset/silhouette.js","../../../node_modules/d3-shape/src/offset/wiggle.js","../../../node_modules/d3-shape/src/order/ascending.js","../../../node_modules/d3-shape/src/order/insideOut.js","../../../node_modules/d3-shape/src/order/reverse.js","../src/core/utils/registry.js","../../../node_modules/d3-format/src/formatDecimal.js","../../../node_modules/d3-format/src/exponent.js","../../../node_modules/d3-format/src/formatGroup.js","../../../node_modules/d3-format/src/formatNumerals.js","../../../node_modules/d3-format/src/formatSpecifier.js","../../../node_modules/d3-format/src/formatTrim.js","../../../node_modules/d3-format/src/formatPrefixAuto.js","../../../node_modules/d3-format/src/formatRounded.js","../../../node_modules/d3-format/src/formatTypes.js","../../../node_modules/d3-format/src/identity.js","../../../node_modules/d3-format/src/locale.js","../../../node_modules/d3-format/src/defaultLocale.js","../../../node_modules/d3-format/src/precisionFixed.js","../../../node_modules/d3-format/src/precisionPrefix.js","../../../node_modules/d3-format/src/precisionRound.js","../src/core/formatter/d3/numberFormat.js","../../../node_modules/d3-time/src/interval.js","../../../node_modules/d3-time/src/millisecond.js","../../../node_modules/d3-time/src/duration.js","../../../node_modules/d3-time/src/second.js","../../../node_modules/d3-time/src/minute.js","../../../node_modules/d3-time/src/hour.js","../../../node_modules/d3-time/src/day.js","../../../node_modules/d3-time/src/week.js","../../../node_modules/d3-time/src/month.js","../../../node_modules/d3-time/src/year.js","../../../node_modules/d3-time/src/utcMinute.js","../../../node_modules/d3-time/src/utcHour.js","../../../node_modules/d3-time/src/utcDay.js","../../../node_modules/d3-time/src/utcWeek.js","../../../node_modules/d3-time/src/utcMonth.js","../../../node_modules/d3-time/src/utcYear.js","../../../node_modules/d3-time-format/src/locale.js","../../../node_modules/d3-time-format/src/defaultLocale.js","../../../node_modules/d3-time-format/src/isoFormat.js","../../../node_modules/d3-time-format/src/isoParse.js","../src/core/formatter/d3/timeFormat.js","../src/core/formatter/index.js","../src/core/data/field.js","../src/core/data/stack.js","../src/core/data/extractor.js","../src/core/data/collections.js","../src/core/charts/formatter/index.js","../../../node_modules/d3-array/src/ascending.js","../../../node_modules/d3-array/src/bisector.js","../../../node_modules/d3-array/src/bisect.js","../../../node_modules/d3-array/src/range.js","../../../node_modules/d3-array/src/ticks.js","../../../node_modules/d3-collection/src/map.js","../../../node_modules/d3-collection/src/set.js","../../../node_modules/d3-scale/src/array.js","../../../node_modules/d3-scale/src/ordinal.js","../../../node_modules/d3-scale/src/band.js","../../../node_modules/d3-color/src/define.js","../../../node_modules/d3-color/src/color.js","../../../node_modules/d3-color/src/math.js","../../../node_modules/d3-color/src/lab.js","../../../node_modules/d3-color/src/cubehelix.js","../../../node_modules/d3-interpolate/src/constant.js","../../../node_modules/d3-interpolate/src/color.js","../../../node_modules/d3-interpolate/src/rgb.js","../../../node_modules/d3-interpolate/src/array.js","../../../node_modules/d3-interpolate/src/date.js","../../../node_modules/d3-interpolate/src/number.js","../../../node_modules/d3-interpolate/src/object.js","../../../node_modules/d3-interpolate/src/string.js","../../../node_modules/d3-interpolate/src/value.js","../../../node_modules/d3-interpolate/src/round.js","../../../node_modules/d3-interpolate/src/transform/decompose.js","../../../node_modules/d3-interpolate/src/zoom.js","../../../node_modules/d3-scale/src/constant.js","../../../node_modules/d3-scale/src/number.js","../../../node_modules/d3-scale/src/continuous.js","../../../node_modules/d3-scale/src/tickFormat.js","../../../node_modules/d3-scale/src/linear.js","../../../node_modules/d3-scale/src/threshold.js","../src/core/scales/ticks/tick-generators.js","../src/core/scales/settings-resolver.js","../src/core/scales/linear.js","../src/core/scales/band.js","../src/core/scales/h-band.js","../src/core/utils/min-max.js","../src/core/scales/color/sequential.js","../src/core/scales/color/threshold.js","../src/core/scales/ordinal.js","../src/core/scales/color/categorical.js","../src/core/charts/scales/index.js","../../../node_modules/node-event-emitter/index.js","../src/core/utils/event-emitter.js","../src/core/scroll-api/index.js","../src/core/charts/scroll-api/index.js","../src/core/brush/range-collection.js","../src/core/brush/value-collection.js","../src/core/brush/brush.js","../src/core/brush/index.js","../src/core/component/component-mixins.js","../../../node_modules/d3-ease/src/cubic.js","../../../node_modules/d3-ease/src/sin.js","../../../node_modules/d3-ease/src/elastic.js","../src/core/component/tween.js","../src/core/chart-components/property-resolver.js","../src/core/scales/index.js","../src/core/component/settings-resolver.js","../src/core/component/brushing.js","../src/core/component/component-factory.js","../src/core/mediator/index.js","../src/core/math/vector.js","../src/core/math/intersection.js","../src/core/math/narrow-phase-collision.js","../src/core/style/resolver.js","../src/core/theme/index.js","../src/core/charts/chart.js","../src/core/renderer/index.js","../src/core/component/index.js","../src/core/data/util.js","../src/core/data/extractor-matrix.js","../src/core/data/dataset.js","../src/core/data/index.js","../src/web/interactions/native/index.js","../src/core/interaction/index.js","../src/core/chart-components/box/box-math.js","../src/core/chart-components/box/box-shapes.js","../src/core/chart-components/box/box-resolver.js","../src/core/chart-components/box/box.js","../src/core/chart-components/box/index.js","../src/core/scene-graph/attributes.js","../src/core/symbols/circle.js","../src/core/utils/points-to-path.js","../src/core/symbols/diamond.js","../src/core/symbols/cross.js","../src/core/math/angles.js","../src/core/symbols/saltire.js","../src/core/symbols/square.js","../src/core/symbols/triangle.js","../src/core/symbols/line.js","../src/core/symbols/star.js","../src/core/symbols/n-polygon.js","../src/core/symbols/bar.js","../src/core/symbols/index.js","../src/core/chart-components/point/point.js","../src/core/chart-components/point/index.js","../src/core/chart-components/pie/pie.js","../src/core/chart-components/pie/index.js","../src/core/transposer/crispifier.js","../src/core/transposer/transposer.js","../src/core/chart-components/grid/line.js","../src/core/chart-components/grid/index.js","../src/core/chart-components/ref-line/oob.js","../src/core/chart-components/ref-line/lines-and-labels.js","../src/core/chart-components/ref-line/refline.js","../src/core/chart-components/ref-line/index.js","../src/core/chart-components/axis/axis-line-node.js","../src/core/chart-components/axis/axis-label-node.js","../src/core/chart-components/axis/axis-tick-node.js","../src/core/chart-components/axis/axis-label-size.js","../src/core/chart-components/axis/axis-node-builder.js","../src/core/chart-components/axis/axis-default-settings.js","../src/core/chart-components/axis/axis-size-calculator.js","../src/core/chart-components/axis/axis.js","../src/core/chart-components/axis/index.js","../src/core/chart-components/text/text.js","../src/core/chart-components/text/index.js","../src/core/chart-components/scrollbar.js","../src/web/components/brush-range/brush-range-const.js","../src/web/components/brush-range/brush-range-node-builder.js","../src/web/components/brush-range/brush-range-interaction.js","../src/web/components/brush-range/brush-range.js","../src/web/components/brush-range/brush-area-dir.js","../src/web/components/brush-range/index.js","../src/core/chart-components/range/range.js","../src/core/chart-components/range/index.js","../src/core/chart-components/brush-lasso/brush-lasso.js","../src/core/chart-components/brush-lasso/index.js","../src/core/chart-components/labels/strategies/bars.js","../src/core/chart-components/labels/strategies/slices.js","../src/core/chart-components/labels/strategies/rows.js","../src/core/chart-components/labels/strategies/index.js","../src/core/chart-components/labels/labels.js","../src/core/chart-components/labels/index.js","../src/core/chart-components/legend-cat/legend-resolver.js","../src/core/chart-components/legend-cat/item-renderer.js","../src/core/chart-components/legend-cat/navigation-renderer.js","../src/core/chart-components/legend-cat/title-renderer.js","../src/core/chart-components/legend-cat/legend-layout.js","../src/core/chart-components/legend-cat/legend-cat.js","../src/core/chart-components/legend-cat/index.js","../src/core/chart-components/legend-seq/node-builder.js","../src/core/chart-components/legend-seq/legend-seq.js","../src/core/chart-components/legend-seq/index.js","../src/core/chart-components/line/line.js","../src/core/chart-components/line/index.js","../src/web/components/brush-area/brush-area.js","../src/web/components/brush-area/index.js","../src/api/components.js","../src/core/scene-graph/node.js","../src/core/geometry/rect.js","../src/core/geometry/circle.js","../src/core/geometry/line.js","../src/core/geometry/polygon.js","../src/core/geometry/polyline.js","../src/core/geometry/index.js","../src/core/geometry/geometry-collection.js","../src/core/math/matrix.js","../src/core/scene-graph/transform-resolver.js","../src/core/scene-graph/node-selector.js","../src/core/scene-graph/scene-node.js","../src/core/scene-graph/collision.js","../src/core/scene-graph/collision-resolver.js","../src/core/scene-graph/display-objects/display-object.js","../src/core/scene-graph/node-container.js","../src/core/scene-graph/display-objects/container.js","../src/core/scene-graph/display-objects/stage.js","../src/core/scene-graph/display-objects/gradient-item.js","../src/core/scene-graph/display-objects/rect.js","../src/core/scene-graph/display-objects/circle.js","../src/core/scene-graph/display-objects/line.js","../src/core/math/arc-to-center.js","../src/core/math/curve-flattness.js","../src/core/math/cubic-bezier-curve-interpolation.js","../src/core/math/quad-bezier-curve-interpolation.js","../src/core/scene-graph/parse-path-d.js","../src/core/utils/flatten-array.js","../src/core/scene-graph/display-objects/path.js","../src/core/scene-graph/display-objects/text.js","../src/core/scene-graph/display-objects/index.js","../src/core/scene-graph/context.js","../src/core/scene-graph/scene.js","../src/web/text-manipulation/string-tokenizer.js","../src/web/text-manipulation/text-const.js","../src/web/text-manipulation/word-break.js","../src/web/text-manipulation/line-break-resolver.js","../src/web/text-manipulation/text-ellipsis.js","../src/web/text-manipulation/baseline-heuristic.js","../src/web/text-manipulation/text-metrics.js","../src/web/renderer/canvas-renderer/canvas-gradient.js","../src/web/renderer/renderer-box.js","../src/web/renderer/index.js","../src/web/renderer/canvas-renderer/canvas-renderer.js","../src/web/renderer/canvas-renderer/shapes/rect.js","../src/web/renderer/canvas-renderer/shapes/circle.js","../src/web/renderer/canvas-renderer/shapes/line.js","../src/core/utils/rtl-util.js","../src/web/renderer/canvas-renderer/shapes/text.js","../src/web/renderer/canvas-renderer/shapes/path.js","../src/web/renderer/canvas-renderer/index.js","../src/web/renderer/node-tree.js","../src/web/renderer/svg-renderer/svg-nodes.js","../src/web/renderer/svg-renderer/svg-tree.js","../src/core/utils/crypto.js","../src/web/renderer/svg-renderer/svg-gradient.js","../src/web/renderer/svg-renderer/svg-renderer.js","../../../node_modules/snabbdom/es/vnode.js","../../../node_modules/snabbdom/es/is.js","../../../node_modules/snabbdom/es/htmldomapi.js","../../../node_modules/snabbdom/es/snabbdom.js","../../../node_modules/snabbdom/modules/attributes.js","../../../node_modules/snabbdom/modules/class.js","../../../node_modules/snabbdom/modules/style.js","../../../node_modules/snabbdom/modules/eventlisteners.js","../../../node_modules/snabbdom/vnode.js","../../../node_modules/snabbdom/is.js","../../../node_modules/snabbdom/h.js","../src/web/renderer/dom-renderer/vdom.js","../src/web/renderer/dom-renderer/dom-renderer.js","../src/web/renderer/dom-renderer/index.js","../src/api/renderers.js","../src/api/scales.js","../src/core/utils/logger.js","../src/core/theme/light/index.js","../src/index.js"],"sourcesContent":["const ARG_LENGTH = {\n  a: 7,\n  c: 6,\n  h: 1,\n  l: 2,\n  m: 2,\n  q: 4,\n  s: 4,\n  t: 2,\n  v: 1,\n  z: 0,\n};\n\nconst SEGMENT_PATTERN = /([astvzqmhlc])([^astvzqmhlc]*)/ig;\n\nconst NUMBER = /-?[0-9]*\\.?[0-9]+(?:e[-+]?\\d+)?/ig;\n\nfunction parseValues(args) {\n  const numbers = args.match(NUMBER);\n  return numbers ? numbers.map(Number) : [];\n}\n\n/**\n * parse an svg path data string. Generates an Array\n * of commands where each command is an Array of the\n * form `[command, arg1, arg2, ...]`\n *\n * https://www.w3.org/TR/SVG/paths.html#PathDataGeneralInformation\n * @ignore\n *\n * @param {string} path\n * @returns {array}\n */\nexport default function parse(path) {\n  const data = [];\n  const p = `${path}`.trim();\n\n  // A path data segment (if there is one) must begin with a \"moveto\" command\n  if (p[0] !== 'M' && p[0] !== 'm') {\n    return data;\n  }\n\n  p.replace(SEGMENT_PATTERN, (_, command, args) => {\n    let type = command.toLowerCase();\n    args = parseValues(args);\n\n    // overloaded moveTo\n    if (type === 'm' && args.length > 2) {\n      data.push([command].concat(args.splice(0, 2)));\n      type = 'l';\n      command = command === 'm' ? 'l' : 'L';\n    }\n\n    // Ignore invalid commands\n    if (args.length < ARG_LENGTH[type]) {\n      return '';\n    }\n\n    data.push([command].concat(args.splice(0, ARG_LENGTH[type])));\n\n    // The command letter can be eliminated on subsequent commands if the\n    // same command is used multiple times in a row (e.g., you can drop the\n    // second \"L\" in \"M 100 200 L 200 100 L -100 -200\" and use\n    // \"M 100 200 L 200 100 -100 -200\" instead).\n    while (args.length >= ARG_LENGTH[type] && args.length && ARG_LENGTH[type]) {\n      data.push([command].concat(args.splice(0, ARG_LENGTH[type])));\n    }\n\n    return '';\n  });\n  return data;\n}\n","import parsePath from './parse-path';\n\n/**\n * Work around for https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/8438884/\n * @ignore\n */\nfunction supportsSvgPathArgument(window) {\n  const canvas = window.document.createElement('canvas');\n  const g = canvas.getContext('2d');\n  const p = new window.Path2D('M0 0 L1 1');\n  g.strokeStyle = 'red';\n  g.lineWidth = 1;\n  g.stroke(p);\n  const imgData = g.getImageData(0, 0, 1, 1);\n  return imgData.data[0] === 255; // Check if pixel is red\n}\n\nfunction rotatePoint(point, angle) {\n  const nx = (point.x * Math.cos(angle)) - (point.y * Math.sin(angle));\n  const ny = (point.y * Math.cos(angle)) + (point.x * Math.sin(angle));\n  point.x = nx;\n  point.y = ny;\n}\n\nfunction translatePoint(point, dx, dy) {\n  point.x += dx;\n  point.y += dy;\n}\n\nfunction polyFillPath2D(window) {\n  if (!window) {\n    return;\n  }\n  if (window.Path2D && supportsSvgPathArgument(window)) {\n    return;\n  }\n\n  /**\n     * Crates a Path2D polyfill object\n     * @constructor\n     * @ignore\n     * @param {String} path\n     */\n  class Path2D {\n    constructor(path) {\n      this.segments = [];\n      if (path && path instanceof Path2D) {\n        this.segments.push(...path.segments);\n      } else if (path) {\n        this.segments = parsePath(path);\n      }\n    }\n    addPath(path) {\n      if (path && path instanceof Path2D) {\n        this.segments.push(...path.segments);\n      }\n    }\n    moveTo(x, y) {\n      this.segments.push(['M', x, y]);\n    }\n    lineTo(x, y) {\n      this.segments.push(['L', x, y]);\n    }\n    arc(x, y, r, start, end, ccw) {\n      this.segments.push(['AC', x, y, r, start, end, !!ccw]);\n    }\n    arcTo(x1, y1, x2, y2, r) {\n      this.segments.push(['AT', x1, y1, x2, y2, r]);\n    }\n    closePath() {\n      this.segments.push(['Z']);\n    }\n    bezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y) {\n      this.segments.push(['C', cp1x, cp1y, cp2x, cp2y, x, y]);\n    }\n    quadraticCurveTo(cpx, cpy, x, y) {\n      this.segments.push(['Q', cpx, cpy, x, y]);\n    }\n    rect(x, y, width, height) {\n      this.segments.push(['R', x, y, width, height]);\n    }\n  }\n\n  const cFill = window.CanvasRenderingContext2D.prototype.fill;\n  const cStroke = window.CanvasRenderingContext2D.prototype.stroke;\n\n  function buildPath(canvas, segments) {\n    let endAngle;\n    let startAngle;\n    let largeArcFlag;\n    let sweepFlag;\n    let endPoint;\n    let angle;\n    let x;\n    let x1;\n    let y;\n    let y1;\n    let r;\n    let b;\n    let w;\n    let h;\n    let pathType;\n    let centerPoint;\n    let cpx;\n    let cpy;\n    let qcpx;\n    let qcpy;\n    let ccw;\n    const currentPoint = { x: 0, y: 0 };\n\n    // Reset control point if command is not cubic\n    if (pathType !== 'S' && pathType !== 's' && pathType !== 'C' && pathType !== 'c') {\n      cpx = null;\n      cpy = null;\n    }\n\n    if (pathType !== 'T' && pathType !== 't' && pathType !== 'Q' && pathType !== 'q') {\n      qcpx = null;\n      qcpy = null;\n    }\n\n    canvas.beginPath();\n    for (let i = 0; i < segments.length; ++i) {\n      const s = segments[i];\n      pathType = s[0];\n      switch (pathType) {\n        case 'm':\n          x += s[1];\n          y += s[2];\n          canvas.moveTo(x, y);\n          break;\n        case 'M':\n          x = s[1];\n          y = s[2];\n          canvas.moveTo(x, y);\n          break;\n        case 'l':\n          x += s[1];\n          y += s[2];\n          canvas.lineTo(x, y);\n          break;\n        case 'L':\n          x = s[1];\n          y = s[2];\n          canvas.lineTo(x, y);\n          break;\n        case 'H':\n          x = s[1];\n          canvas.lineTo(x, y);\n          break;\n        case 'h':\n          x += s[1];\n          canvas.lineTo(x, y);\n          break;\n        case 'V':\n          y = s[1];\n          canvas.lineTo(x, y);\n          break;\n        case 'v':\n          y += s[1];\n          canvas.lineTo(x, y);\n          break;\n        case 'a':\n        case 'A':\n          if (pathType === 'a') {\n            x += s[6];\n            y += s[7];\n          } else {\n            x = s[6];\n            y = s[7];\n          }\n\n          r = s[1];\n          // s[2] = 2nd radius in ellipse, ignore\n          // s[3] = rotation of ellipse, ignore\n          largeArcFlag = s[4];\n          sweepFlag = s[5];\n          endPoint = { x, y };\n          // translate all points so that currentPoint is origin\n          translatePoint(endPoint, -currentPoint.x, -currentPoint.y);\n\n          // angle to destination\n          angle = Math.atan2(endPoint.y, endPoint.x);\n\n          // rotate points so that angle is 0\n          rotatePoint(endPoint, -angle);\n\n          b = endPoint.x / 2;\n          // var sweepAngle = Math.asin(b / r);\n\n          centerPoint = { x: 0, y: 0 };\n          centerPoint.x = endPoint.x / 2;\n          if ((sweepFlag && !largeArcFlag) || (!sweepFlag && largeArcFlag)) {\n            centerPoint.y = Math.sqrt((r * r) - (b * b));\n          } else {\n            centerPoint.y = -Math.sqrt((r * r) - (b * b));\n          }\n          startAngle = Math.atan2(-centerPoint.y, -centerPoint.x);\n          endAngle = Math.atan2(endPoint.y - centerPoint.y, endPoint.x - centerPoint.x);\n\n          // rotate back\n          startAngle += angle;\n          endAngle += angle;\n          rotatePoint(endPoint, angle);\n          rotatePoint(centerPoint, angle);\n\n          // translate points\n          translatePoint(endPoint, currentPoint.x, currentPoint.y);\n          translatePoint(centerPoint, currentPoint.x, currentPoint.y);\n\n          canvas.arc(centerPoint.x, centerPoint.y, r, startAngle, endAngle, !sweepFlag);\n          break;\n        case 'C':\n          cpx = s[3]; // Last control point\n          cpy = s[4];\n          x = s[5];\n          y = s[6];\n          canvas.bezierCurveTo(s[1], s[2], cpx, cpy, x, y);\n          break;\n        case 'c':\n          canvas.bezierCurveTo(\n            s[1] + x,\n            s[2] + y,\n            s[3] + x,\n            s[4] + y,\n            s[5] + x,\n            s[6] + y,\n          );\n          cpx = s[3] + x; // Last control point\n          cpy = s[4] + y;\n          x += s[5];\n          y += s[6];\n          break;\n        case 'S':\n          if (cpx === null || cpx === null) {\n            cpx = x;\n            cpy = y;\n          }\n\n          canvas.bezierCurveTo(\n            (2 * x) - cpx,\n            (2 * y) - cpy,\n            s[1],\n            s[2],\n            s[3],\n            s[4],\n          );\n          cpx = s[1]; // last control point\n          cpy = s[2];\n          x = s[3];\n          y = s[4];\n          break;\n        case 's':\n          if (cpx === null || cpx === null) {\n            cpx = x;\n            cpy = y;\n          }\n\n          canvas.bezierCurveTo(\n            (2 * x) - cpx,\n            (2 * y) - cpy,\n            s[1] + x,\n            s[2] + y,\n            s[3] + x,\n            s[4] + y,\n          );\n          cpx = s[1] + x; // last control point\n          cpy = s[2] + y;\n          x += s[3];\n          y += s[4];\n          break;\n        case 'Q':\n          qcpx = s[1]; // last control point\n          qcpy = s[2];\n          x = s[3];\n          y = s[4];\n          canvas.quadraticCurveTo(qcpx, qcpy, x, y);\n          break;\n        case 'q':\n          qcpx = s[1] + x; // last control point\n          qcpy = s[2] + y;\n          x += s[3];\n          y += s[4];\n          canvas.quadraticCurveTo(qcpx, qcpy, x, y);\n          break;\n        case 'T':\n          if (qcpx === null || qcpx === null) {\n            qcpx = x;\n            qcpy = y;\n          }\n          qcpx = (2 * x) - qcpx; // last control point\n          qcpy = (2 * y) - qcpy;\n          x = s[1];\n          y = s[2];\n          canvas.quadraticCurveTo(qcpx, qcpy, x, y);\n          break;\n        case 't':\n          if (qcpx === null || qcpx === null) {\n            qcpx = x;\n            qcpy = y;\n          }\n          qcpx = (2 * x) - qcpx; // last control point\n          qcpy = (2 * y) - qcpy;\n          x += s[1];\n          y += s[2];\n          canvas.quadraticCurveTo(qcpx, qcpy, x, y);\n          break;\n        case 'z':\n        case 'Z':\n          canvas.closePath();\n          break;\n        case 'AC': // arc\n          x = s[1];\n          y = s[2];\n          r = s[3];\n          startAngle = s[4];\n          endAngle = s[5];\n          ccw = s[6];\n          canvas.arc(x, y, r, startAngle, endAngle, ccw);\n          break;\n        case 'AT': // arcTo\n          x1 = s[1];\n          y1 = s[2];\n          x = s[3];\n          y = s[4];\n          r = s[5];\n          canvas.arcTo(x1, y1, x, y, r);\n          break;\n        case 'R': // rect\n          x = s[1];\n          y = s[2];\n          w = s[3];\n          h = s[4];\n          canvas.rect(x, y, w, h);\n          break;\n        default:\n          // throw new Error(`${pathType} is not implemented`); ?\n      }\n\n      currentPoint.x = x;\n      currentPoint.y = y;\n    }\n  }\n\n  window.CanvasRenderingContext2D.prototype.fill = function fill(...args) {\n    let fillRule = 'nonzero';\n    if (args.length === 0 || (args.length === 1 && typeof args[0] === 'string')) {\n      cFill.apply(this, args);\n      return;\n    }\n    if (arguments.length === 2) {\n      fillRule = args[1];\n    }\n    const path = args[0];\n    buildPath(this, path.segments);\n    cFill.call(this, fillRule);\n  };\n\n  window.CanvasRenderingContext2D.prototype.stroke = function stroke(path) {\n    if (!path) {\n      cStroke.call(this);\n      return;\n    }\n    buildPath(this, path.segments);\n    cStroke.call(this);\n  };\n\n  window.Path2D = Path2D;\n}\n\nexport default polyFillPath2D;\n","import parsePath from './parse-path';\nimport path2dPolyfill from './path2d-polyfill';\n\nif (typeof window !== 'undefined') {\n  path2dPolyfill(window);\n}\n\nexport {\n  path2dPolyfill,\n  parsePath,\n};\n","'use strict';\n\nvar hasOwn = Object.prototype.hasOwnProperty;\nvar toStr = Object.prototype.toString;\n\nvar isArray = function isArray(arr) {\n\tif (typeof Array.isArray === 'function') {\n\t\treturn Array.isArray(arr);\n\t}\n\n\treturn toStr.call(arr) === '[object Array]';\n};\n\nvar isPlainObject = function isPlainObject(obj) {\n\tif (!obj || toStr.call(obj) !== '[object Object]') {\n\t\treturn false;\n\t}\n\n\tvar hasOwnConstructor = hasOwn.call(obj, 'constructor');\n\tvar hasIsPrototypeOf = obj.constructor && obj.constructor.prototype && hasOwn.call(obj.constructor.prototype, 'isPrototypeOf');\n\t// Not own constructor property must be Object\n\tif (obj.constructor && !hasOwnConstructor && !hasIsPrototypeOf) {\n\t\treturn false;\n\t}\n\n\t// Own properties are enumerated firstly, so to speed up,\n\t// if last one is own, then all properties are own.\n\tvar key;\n\tfor (key in obj) { /**/ }\n\n\treturn typeof key === 'undefined' || hasOwn.call(obj, key);\n};\n\nmodule.exports = function extend() {\n\tvar options, name, src, copy, copyIsArray, clone;\n\tvar target = arguments[0];\n\tvar i = 1;\n\tvar length = arguments.length;\n\tvar deep = false;\n\n\t// Handle a deep copy situation\n\tif (typeof target === 'boolean') {\n\t\tdeep = target;\n\t\ttarget = arguments[1] || {};\n\t\t// skip the boolean and the target\n\t\ti = 2;\n\t}\n\tif (target == null || (typeof target !== 'object' && typeof target !== 'function')) {\n\t\ttarget = {};\n\t}\n\n\tfor (; i < length; ++i) {\n\t\toptions = arguments[i];\n\t\t// Only deal with non-null/undefined values\n\t\tif (options != null) {\n\t\t\t// Extend the base object\n\t\t\tfor (name in options) {\n\t\t\t\tsrc = target[name];\n\t\t\t\tcopy = options[name];\n\n\t\t\t\t// Prevent never-ending loop\n\t\t\t\tif (target !== copy) {\n\t\t\t\t\t// Recurse if we're merging plain objects or arrays\n\t\t\t\t\tif (deep && copy && (isPlainObject(copy) || (copyIsArray = isArray(copy)))) {\n\t\t\t\t\t\tif (copyIsArray) {\n\t\t\t\t\t\t\tcopyIsArray = false;\n\t\t\t\t\t\t\tclone = src && isArray(src) ? src : [];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tclone = src && isPlainObject(src) ? src : {};\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Never move original objects, clone them\n\t\t\t\t\t\ttarget[name] = extend(deep, clone, copy);\n\n\t\t\t\t\t// Don't bring in undefined values\n\t\t\t\t\t} else if (typeof copy !== 'undefined') {\n\t\t\t\t\t\ttarget[name] = copy;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Return the modified object\n\treturn target;\n};\n","export default { version: '0.9.0' };\n","const mixins = [];\n\nexport function add(mixin) {\n  mixins.push(mixin);\n}\n\nexport function list() {\n  return mixins;\n}\n","/**\n * Initilize a new dock configuration\n * @private\n * @param {object} [settings] - Settings object\n * @returns {object} A dock configuration instance\n * @example\n * let instance = dockConfig({\n *  dock: 'left',\n *  displayOrder: 2,\n *  prioOrder: 1,\n *  requiredSize: () => 33,\n *  minimumLayoutMode: 'L',\n *  show: true\n * });\n */\nfunction dockConfig(settings = {}) {\n  let {\n    dock = '',\n    displayOrder = 0,\n    prioOrder = 0,\n    requiredSize = () => 0,\n    minimumLayoutMode,\n    show = true\n  } = settings;\n\n  /**\n   * @private\n   */\n  const fn = function fn() {};\n\n  /**\n   * Takes a function that returns the required size of a component.\n   * The return value of the function can either be a number representing the required size in the dock direction\n   * or an object with a `size` and `edgeBleed` property.\n   * @param {function} [calcFn] - Function to calculate the required size of a component\n   * @returns {function|this} If no parameter is passed, the current requiredSize function is return. Else the current context is returns to allow chaining.\n   * @example\n   * dockConfig.requireSize(() => 150); // Require a size of 150 in the dock direction\n   *\n   * dockConfig.requireSize(() => ({\n   *  size: 150,\n   *  edgeBleed: {\n   *    left: 50,\n   *    right: 50\n   *  }\n   * })); // Require a size of 150 in the dock direction and a bleed size of 50 to the left and right dock direction\n   */\n  fn.requiredSize = function requiredSizeFn(calcFn) {\n    if (typeof calcFn === 'function') {\n      requiredSize = calcFn;\n      return this;\n    }\n    return requiredSize;\n  };\n\n  /**\n   * Set the dock direction, supported values are left | right | top | bottom. Any other value will be interpreted as center dock.\n   * @param {string} [d=''] - Dock direction\n   * @returns {this} The current context\n   * @example\n   * dockConfig.dock('left');\n   */\n  fn.dock = function dockFn(d) {\n    if (typeof d === 'undefined') {\n      return dock;\n    }\n    dock = d;\n    return this;\n  };\n\n  /**\n   * The `displayOrder` property is used by the layout engine to lay out components.\n   * Components are interpreted in the ascending order of the `displayOrder` value. The layout engine apply the value in two ways,\n   * the first is the order in which components are rendererd. The second is the area components are laid out in\n   * when they have a direction, i.e. docked to either top, bottom, left or right.\n   *\n   * If docked at the same area, the component with a higher `displayOrder` will be rendered\n   * on top of the component with a lower `displayOrder`. It can be seen as defining a z-index.\n   * A lower `displayOrder` also means that a component will be laid out first in a given direction,\n   * i.e. laid out closer to the central area (non-directional area) then a component with a higher `displayOrder`.\n   * It can in this case be seen as the x-index or y-index.\n   * @param {number} [order=0] - The display order\n   * @returns {this} The current context\n   * @example\n   * dockConfig.displayOrder(99);\n   */\n  fn.displayOrder = function displayOrderFn(order) {\n    if (typeof order === 'undefined') {\n      return displayOrder;\n    }\n    displayOrder = order;\n    return this;\n  };\n\n  /**\n   * The `prioOrder` property is used to define the order in which components are added to the layout engine,\n   * this is done before any components are laid out. When there is not enough space to add any more components\n   * to a given area, all components not all ready added, are then discarded. The `prioOrder` is interpreted\n   * in the ascending order. Such that a lower value is added to the layout engine first.\n   * @param {number} [order=0] - The prio order\n   * @returns {this} The current context\n   * @example\n   * dockConfig.prioOrder(-1);\n   */\n  fn.prioOrder = function prioOrderFn(order) {\n    if (typeof order === 'undefined') {\n      return prioOrder;\n    }\n    prioOrder = order;\n    return this;\n  };\n\n  /**\n   * Ger or set the minimumLayoutMode\n   * @param {string|object} [s] - The minimum layout mode\n   * @returns {string|object|this} If no parameter is passed the current context is returned, else the current layout mode.\n   * @example\n   * dockConfig.minimumLayoutMode('L');\n   * dockConfig.minimumLayoutMode({ width: 'S', height: 'L' });\n   */\n  fn.minimumLayoutMode = function minimumLayoutModeFn(s) {\n    if (typeof s === 'undefined') {\n      return minimumLayoutMode;\n    }\n    minimumLayoutMode = s;\n    return this;\n  };\n\n  /**\n   * Set the component visibility. If false the component is not added to the layout engine.\n   * @param {boolean} [s=true] - Toggle visibility\n   * @returns {this} The current context\n   */\n  fn.show = function showFn(s) {\n    if (typeof s === 'undefined') {\n      return show;\n    }\n    show = !!s;\n    return this;\n  };\n\n  return fn;\n}\n\nexport { dockConfig as default };\n","import extend from 'extend';\n\nfunction roundRect(rect) {\n  rect.x = Math.ceil(rect.x);\n  rect.y = Math.ceil(rect.y);\n  rect.width = Math.ceil(rect.width);\n  rect.height = Math.ceil(rect.height);\n}\n\nfunction getRect(container, settings) {\n  const containerRect = {\n    x: 0, y: 0, width: 0, height: 0\n  };\n  const logicalContainerRect = {\n    x: 0, y: 0, width: 0, height: 0\n  };\n\n  // Check input object for size\n  if (typeof container.getBoundingClientRect === 'function') {\n    const boundingRect = container.getBoundingClientRect();\n    containerRect.width = boundingRect.width;\n    containerRect.height = boundingRect.height;\n  } else {\n    containerRect.width = container.width || 0;\n    containerRect.height = container.height || 0;\n  }\n\n  // Check settings defintion for size\n  if (typeof settings.size !== 'undefined') {\n    containerRect.width = isNaN(settings.size.width) ? containerRect.width : settings.size.width;\n    containerRect.height = isNaN(settings.size.height) ? containerRect.height : settings.size.height;\n  }\n\n  if (typeof settings.logicalSize !== 'undefined') {\n    logicalContainerRect.width = isNaN(settings.logicalSize.width) ? containerRect.width : settings.logicalSize.width;\n    logicalContainerRect.height = isNaN(settings.logicalSize.height) ? containerRect.height : settings.logicalSize.height;\n    logicalContainerRect.align = isNaN(settings.logicalSize.align) ? 0.5 : Math.min(Math.max(settings.logicalSize.align, 0), 1);\n    logicalContainerRect.preserveAspectRatio = settings.logicalSize.preserveAspectRatio;\n  } else {\n    logicalContainerRect.width = containerRect.width;\n    logicalContainerRect.height = containerRect.height;\n    logicalContainerRect.preserveAspectRatio = false;\n  }\n\n  roundRect(logicalContainerRect);\n  roundRect(containerRect);\n\n  return [logicalContainerRect, containerRect];\n}\n\nexport default function resolveLayout(container, settings) {\n  return getRect(container, settings);\n}\n\nexport function resolveSettings(s) {\n  const settings = {\n    logicalSize: {\n      preserveAspectRatio: false\n    },\n    center: {\n      minWidthRatio: 0.5,\n      minHeightRatio: 0.5,\n      minWidth: 0,\n      minHeight: 0\n    }\n  };\n\n  extend(true, settings, s);\n\n  settings.center.minWidthRatio = Math.min(Math.max(settings.center.minWidthRatio, 0), 1); // Only accept value between 0-1\n  settings.center.minHeightRatio = Math.min(Math.max(settings.center.minHeightRatio, 0), 1); // Only accept value between 0-1\n  settings.center.minWidth = Math.max(settings.center.minWidth, 0); // Consider <= 0 to be falsy and fallback to ratio\n  settings.center.minHeight = Math.max(settings.center.minHeight, 0); // Consider <= 0 to be falsy and fallback to ratio\n\n  return settings;\n}\n","export function isNumber(v) {\n  return typeof v === 'number' && !isNaN(v);\n}\n\nexport function notNumber(value) {\n  return typeof value !== 'number' || isNaN(value);\n}\n","import { isNumber } from '../utils/is-number';\n\nexport function getMinMax(points) {\n  const num = points.length;\n  let xMin = NaN;\n  let xMax = NaN;\n  let yMin = NaN;\n  let yMax = NaN;\n\n  for (let i = 0; i < num; i++) {\n    xMin = isNaN(xMin) ? points[i].x : Math.min(xMin, points[i].x);\n    xMax = isNaN(xMax) ? points[i].x : Math.max(xMax, points[i].x);\n    yMin = isNaN(yMin) ? points[i].y : Math.min(yMin, points[i].y);\n    yMax = isNaN(yMax) ? points[i].y : Math.max(yMax, points[i].y);\n  }\n  return [xMin, yMin, xMax, yMax];\n}\n\n/**\n * @ignore\n * @param {oject} line\n * @returns {point[]} Array of points\n */\nexport function lineToPoints(line) {\n  const x1 = line.x1 || 0;\n  const y1 = line.y1 || 0;\n  const x2 = line.x2 || 0;\n  const y2 = line.y2 || 0;\n  return [{ x: x1, y: y1 }, { x: x2, y: y2 }];\n}\n\n/**\n * @ignore\n * @param {oject} rect\n * @returns {point[]} Array of points\n */\nexport function rectToPoints(rect) {\n  return [\n    { x: rect.x, y: rect.y },\n    { x: rect.x + rect.width, y: rect.y },\n    { x: rect.x + rect.width, y: rect.y + rect.height },\n    { x: rect.x, y: rect.y + rect.height }\n  ];\n}\n\nexport function pointsToRect(points) {\n  const [xMin, yMin, xMax, yMax] = getMinMax(points);\n\n  return {\n    x: xMin,\n    y: yMin,\n    width: xMax - xMin,\n    height: yMax - yMin\n  };\n}\n\nexport function pointsToCircle(points, r) {\n  return {\n    cx: points[0].x,\n    cy: points[0].y,\n    r\n  };\n}\n\nexport function pointsToLine(points) {\n  return {\n    x1: points[0].x,\n    y1: points[0].y,\n    x2: points[1].x,\n    y2: points[1].y\n  };\n}\n\nexport function pointToArray(p) {\n  return [p.x, p.y];\n}\n\nexport function arrayToPoint(ary) {\n  return { x: ary[0], y: ary[1] };\n}\n\n/**\n * @ignore\n * @param {oject}\n * @returns {string} Type of geometry\n */\nexport function getShapeType(shape) {\n  const {\n    x, y, // Point\n    width, height, // Rect\n    x1, x2, y1, y2, // Line\n    cx, cy, r, // Circle\n    vertices // Polygon\n  } = shape || {};\n\n  if (isNumber(cx) && isNumber(cy) && isNumber(r)) {\n    return 'circle';\n  } else if (isNumber(x1) && isNumber(x2) && isNumber(y1) && isNumber(y2)) {\n    return 'line';\n  } else if (isNumber(x) && isNumber(y) && isNumber(width) && isNumber(height)) {\n    return 'rect';\n  } else if (isNumber(x) && isNumber(y)) {\n    return 'point';\n  } else if (Array.isArray(vertices)) {\n    return 'polygon';\n  }\n  return null;\n}\n","import extend from 'extend';\nimport dockConfig from './dock-config';\nimport resolveLayout, { resolveSettings } from './dock-settings-resolver';\nimport { rectToPoints, pointsToRect } from '../geometry/util';\n\nfunction validateComponent(component) {\n  const expectedProperties = ['resize'];\n\n  expectedProperties.forEach((p) => {\n    if (typeof component[p] !== 'function') {\n      throw new Error(`Component is missing required function \"${p}\"`);\n    }\n  });\n}\n\nfunction cacheSize(c, reducedRect, containerRect) {\n  if (typeof c.cachedSize === 'undefined') {\n    const size = c.config.requiredSize()(reducedRect, containerRect);\n    if (typeof size === 'object') {\n      c.cachedSize = Math.ceil(size.size);\n      c.edgeBleed = size.edgeBleed;\n    } else {\n      c.cachedSize = Math.ceil(size);\n    }\n  }\n  return c.cachedSize;\n}\n\nfunction validateReduceRect(logicalContainerRect, reducedRect, settings) {\n  // Absolute value for width/height should have predence over relative value\n  const minReduceWidth = Math.min(settings.center.minWidth, logicalContainerRect.width) || Math.max(logicalContainerRect.width * settings.center.minWidthRatio, 1);\n  const minReduceHeight = Math.min(settings.center.minHeight, logicalContainerRect.height) || Math.max(logicalContainerRect.height * settings.center.minHeightRatio, 1);\n  return reducedRect.width >= minReduceWidth && reducedRect.height >= minReduceHeight;\n}\n\nfunction reduceDocRect(reducedRect, c) {\n  switch (c.config.dock()) {\n    case 'top':\n      reducedRect.y += c.cachedSize;\n      reducedRect.height -= c.cachedSize;\n      break;\n    case 'bottom':\n      reducedRect.height -= c.cachedSize;\n      break;\n    case 'left':\n      reducedRect.x += c.cachedSize;\n      reducedRect.width -= c.cachedSize;\n      break;\n    case 'right':\n      reducedRect.width -= c.cachedSize;\n      break;\n    default:\n  }\n}\nfunction addEdgeBleed(currentEdgeBleed, c) {\n  const edgeBleed = c.edgeBleed;\n  if (!edgeBleed) { return; }\n  currentEdgeBleed.left = Math.max(currentEdgeBleed.left, edgeBleed.left || 0);\n  currentEdgeBleed.right = Math.max(currentEdgeBleed.right, edgeBleed.right || 0);\n  currentEdgeBleed.top = Math.max(currentEdgeBleed.top, edgeBleed.top || 0);\n  currentEdgeBleed.bottom = Math.max(currentEdgeBleed.bottom, edgeBleed.bottom || 0);\n}\nfunction reduceEdgeBleed(logicalContainerRect, reducedRect, edgeBleed) {\n  if (reducedRect.x < edgeBleed.left) {\n    reducedRect.width -= edgeBleed.left - reducedRect.x;\n    reducedRect.x = edgeBleed.left;\n  }\n  const reducedRectRightBoundary = logicalContainerRect.width - (reducedRect.x + reducedRect.width);\n  if (reducedRectRightBoundary < edgeBleed.right) {\n    reducedRect.width -= edgeBleed.right - reducedRectRightBoundary;\n  }\n  if (reducedRect.y < edgeBleed.top) {\n    reducedRect.height -= edgeBleed.top - reducedRect.y;\n    reducedRect.y = edgeBleed.top;\n  }\n  const reducedRectBottomBoundary = logicalContainerRect.height - (reducedRect.y + reducedRect.height);\n  if (reducedRectBottomBoundary < edgeBleed.bottom) {\n    reducedRect.height -= edgeBleed.bottom - reducedRectBottomBoundary;\n  }\n}\n\nfunction reduceSingleLayoutRect(logicalContainerRect, reducedRect, edgeBleed, c, settings) {\n  const newReduceRect = extend({}, reducedRect);\n  const newEdgeBeed = extend({}, edgeBleed);\n  reduceDocRect(newReduceRect, c);\n  addEdgeBleed(newEdgeBeed, c);\n  reduceEdgeBleed(logicalContainerRect, newReduceRect, newEdgeBeed);\n\n  const isValid = validateReduceRect(logicalContainerRect, newReduceRect, settings);\n  if (!isValid) {\n    return false;\n  }\n\n  reduceDocRect(reducedRect, c);\n  addEdgeBleed(edgeBleed, c);\n  return true;\n}\n\nfunction reduceLayoutRect(logicalContainerRect, components, hiddenComponents, settings) {\n  const reducedRect = {\n    x: logicalContainerRect.x,\n    y: logicalContainerRect.y,\n    width: logicalContainerRect.width,\n    height: logicalContainerRect.height\n  };\n  const edgeBleed = {\n    left: 0, right: 0, top: 0, bottom: 0\n  };\n\n  const sortedComponents = components.slice();\n  sortedComponents.sort((a, b) => a.config.prioOrder() - b.config.prioOrder()); // lower prioOrder will have higher prio\n\n  for (let i = 0; i < sortedComponents.length; ++i) {\n    const c = sortedComponents[i];\n    cacheSize(c, reducedRect, logicalContainerRect);\n\n    if (!reduceSingleLayoutRect(logicalContainerRect, reducedRect, edgeBleed, c, settings)) {\n      sortedComponents.splice(i, 1);\n      hiddenComponents.push(c.instance);\n      --i;\n    }\n  }\n\n  const filteredUnsortedComps = components.filter(c => sortedComponents.indexOf(c) !== -1);\n  components.length = 0;\n  components.push(...filteredUnsortedComps);\n  reduceEdgeBleed(logicalContainerRect, reducedRect, edgeBleed);\n  return reducedRect;\n}\n\nfunction appendScaleRatio(rect, outerRect, logicalContainerRect, containerRect) {\n  const scaleRatio = {\n    x: containerRect.width / logicalContainerRect.width,\n    y: containerRect.height / logicalContainerRect.height\n  };\n  const margin = {\n    left: 0,\n    top: 0\n  };\n\n  if (logicalContainerRect.preserveAspectRatio) {\n    const xLessThenY = scaleRatio.x < scaleRatio.y;\n    // To preserve the aspect ratio, take the smallest ratio and apply in both directions to \"meet\" the size of the container\n    const minRatio = Math.min(scaleRatio.x, scaleRatio.y);\n    scaleRatio.x = minRatio;\n    scaleRatio.y = minRatio;\n    const area = xLessThenY ? 'height' : 'width';\n    const spread = (containerRect[area] - (logicalContainerRect[area] * scaleRatio.x)) * logicalContainerRect.align;\n    margin.left = xLessThenY ? 0 : spread;\n    margin.top = xLessThenY ? spread : 0;\n  }\n\n  rect.scaleRatio = scaleRatio;\n  rect.margin = margin;\n  outerRect.scaleRatio = scaleRatio;\n  outerRect.margin = margin;\n  logicalContainerRect.scaleRatio = scaleRatio;\n  logicalContainerRect.margin = margin;\n}\n\nfunction boundingBox(rects) {\n  const points = [].concat(...rects.map(rectToPoints));\n  return pointsToRect(points);\n}\n\nfunction positionComponents(components, logicalContainerRect, reducedRect, containerRect) {\n  const vRect = {\n    x: reducedRect.x, y: reducedRect.y, width: reducedRect.width, height: reducedRect.height\n  };\n  const hRect = {\n    x: reducedRect.x, y: reducedRect.y, width: reducedRect.width, height: reducedRect.height\n  };\n\n  const referencedComponents = {};\n\n  components.sort((a, b) => {\n    if (/^@/.test(b.config.dock())) {\n      return -1;\n    } else if (/^@/.test(a.config.dock())) {\n      return 1;\n    }\n    return a.config.displayOrder() - b.config.displayOrder();\n  }).forEach((c) => {\n    let outerRect = {};\n    let rect = {};\n    const d = c.config.dock();\n    switch (d) {\n      case 'top':\n        outerRect.height = rect.height = c.cachedSize;\n        outerRect.width = logicalContainerRect.width;\n        rect.width = vRect.width;\n        outerRect.x = logicalContainerRect.x;\n        rect.x = vRect.x;\n        outerRect.y = rect.y = vRect.y - c.cachedSize;\n\n        vRect.y -= c.cachedSize;\n        vRect.height += c.cachedSize;\n        break;\n      case 'bottom':\n        outerRect.x = logicalContainerRect.x;\n        rect.x = vRect.x;\n        outerRect.y = rect.y = vRect.y + vRect.height;\n        outerRect.width = logicalContainerRect.width;\n        rect.width = vRect.width;\n        outerRect.height = rect.height = c.cachedSize;\n\n        vRect.height += c.cachedSize;\n        break;\n      case 'left':\n        outerRect.x = rect.x = hRect.x - c.cachedSize;\n        outerRect.y = logicalContainerRect.y;\n        rect.y = hRect.y;\n        outerRect.width = rect.width = c.cachedSize;\n        outerRect.height = logicalContainerRect.height;\n        rect.height = hRect.height;\n\n        hRect.x -= c.cachedSize;\n        hRect.width += c.cachedSize;\n        break;\n      case 'right':\n        outerRect.x = rect.x = hRect.x + hRect.width;\n        outerRect.y = logicalContainerRect.y;\n        rect.y = hRect.y;\n        outerRect.width = rect.width = c.cachedSize;\n        outerRect.height = logicalContainerRect.height;\n        rect.height = hRect.height;\n\n        hRect.width += c.cachedSize;\n        break;\n      default:\n        outerRect.x = rect.x = reducedRect.x;\n        outerRect.y = rect.y = reducedRect.y;\n        outerRect.width = rect.width = reducedRect.width;\n        outerRect.height = rect.height = reducedRect.height;\n    }\n    if (/^@/.test(d)) {\n      const refs = d.split(',').map(r => referencedComponents[r.replace('@', '')]).filter(r => !!r);\n      if (refs.length > 0) {\n        outerRect = boundingBox(refs.map(r => r.outerRect));\n        rect = boundingBox(refs.map(r => r.rect));\n      }\n    } else if (c.key) {\n      referencedComponents[c.key] = { // store the size of this component\n        rect,\n        outerRect\n      };\n    }\n    appendScaleRatio(rect, outerRect, logicalContainerRect, containerRect);\n    c.instance.resize(rect, outerRect, logicalContainerRect);\n    c.cachedSize = undefined;\n  });\n}\n\nfunction checkShowSettings(components, hiddenComponents, settings, logicalContainerRect) {\n  const layoutModes = settings.layoutModes || {};\n  for (let i = 0; i < components.length; ++i) {\n    const c = components[i];\n    const minimumLayoutMode = c.config.minimumLayoutMode();\n    let show = c.config.show();\n    if (show && typeof minimumLayoutMode === 'object') {\n      show = layoutModes[minimumLayoutMode.width] &&\n        layoutModes[minimumLayoutMode.height] &&\n        logicalContainerRect.width >= layoutModes[minimumLayoutMode.width].width &&\n        logicalContainerRect.height >= layoutModes[minimumLayoutMode.height].height;\n    } else if (show && minimumLayoutMode !== undefined) {\n      show = layoutModes[minimumLayoutMode] &&\n        logicalContainerRect.width >= layoutModes[minimumLayoutMode].width &&\n        logicalContainerRect.height >= layoutModes[minimumLayoutMode].height;\n    }\n    if (!show) {\n      components.splice(i, 1);\n      hiddenComponents.push(c.instance);\n      --i;\n    }\n  }\n}\n\n/**\n * @typedef {object} dock-layout-settings\n * @property {object} [size] - Physical size. Defaults to the container element.\n * @property {number} [size.width] - Width in pixels\n * @property {number} [size.height]- Height in pixels\n * @property {object} [logicalSize] - Logical size\n * @property {number} [logicalSize.width] - Width in pixels\n * @property {number} [logicalSize.height] - Height in pixels\n * @property {boolean} [logicalSize.preserveAspectRatio=false] - If true, takes the smallest ratio of width/height between logical and physical size ( physical / logical )\n * @property {number} [logicalSize.align=0.5] - Normalized value between 0-1. Defines how the space around the scaled axis is spread in the container, with 0.5 meaning the spread is equal on both sides. Only applicable if preserveAspectRatio is set to true\n * @property {object} [center] - Define how much space the center dock area requires\n * @property {number} [center.minWidthRatio=0.5] - Value between 0 and 1\n * @property {number} [center.minHeightRatio=0.5] - Value between 0 and 1\n * @property {number} [center.minWidth] - Width in pixels\n * @property {number} [center.minHeight] - Height in pixels\n * @property {object<string, {width: number, height: number}>} [layoutModes] Dictionary with named sizes\n */\n\nexport default function dockLayout(initialSettings) {\n  const components = [];\n  const hiddenComponents = [];\n  let settings = resolveSettings(initialSettings);\n\n  const docker = function docker() {};\n\n  docker.addComponent = function addComponent(component, key) {\n    validateComponent(component);\n    docker.removeComponent(component);\n\n    // component.dockConfig can be undefined, a function or an object:\n    // if undefined: use default values from dockConfig()\n    // if function: use the function\n    // if object: wrap in dockConfig() function\n    components.push({\n      instance: component,\n      key,\n      config: typeof component.dockConfig === 'function' ? component.dockConfig : dockConfig(component.dockConfig)\n    });\n  };\n\n  docker.removeComponent = function removeComponent(component) {\n    const idx = components.map(c => c.instance).indexOf(component);\n    if (idx > -1) {\n      components.splice(idx, 1);\n    }\n  };\n\n  docker.layout = function layout(container) {\n    const [logicalContainerRect, containerRect] = resolveLayout(container, settings);\n    checkShowSettings(components, hiddenComponents, settings, logicalContainerRect);\n    const reduced = reduceLayoutRect(logicalContainerRect, components, hiddenComponents, settings);\n    positionComponents(components, logicalContainerRect, reduced, containerRect);\n    return {\n      visible: components.map(c => c.instance),\n      hidden: hiddenComponents\n    };\n  };\n\n  docker.settings = function settingsFn(s) {\n    settings = resolveSettings(s);\n  };\n\n  return docker;\n}\n","export function detectPointerSupport(e) {\n  if ('onpointerdown' in e && 'onpointerup' in e) {\n    return true;\n  }\n  return false;\n}\n\nexport function detectTouchSupport(e) {\n  if ('ontouchstart' in e && 'ontouchend' in e) {\n    return true;\n  }\n  return false;\n}\n\nexport function isTouchEvent(e) {\n  return !!e.changedTouches;\n}\n\nexport function isValidTapEvent(e, eventInfo) {\n  const isTouch = isTouchEvent(e);\n  const ee = isTouch ? e.changedTouches[0] : e;\n  const dt = Date.now() - eventInfo.time;\n  const dx = isNaN(eventInfo.x) ? 0 : Math.abs(ee.clientX - eventInfo.x);\n  const dy = isNaN(eventInfo.y) ? 0 : Math.abs(ee.clientY - eventInfo.y);\n\n  return (e.button === 0 || isTouch) &&\n    !eventInfo.multiTouch &&\n    dx <= 12 &&\n    dy <= 12 &&\n    dt <= 300;\n}\n","// import types from './types';\n\n/**\n * @ignore\n * @param {Array<data-source>} dataSources\n * @param {any} { logger }\n * @returns {function}\n */\nexport default function datasets(dataSources, { types, logger }) {\n  const data = {};\n\n  const sets = [];\n  if (!Array.isArray(dataSources)) {\n    logger.warn('Deprecated: \"data-source\" configuration\"');\n    sets.push(dataSources);\n  } else {\n    sets.push(...dataSources);\n  }\n\n  sets.forEach((d, i) => {\n    let datasetFactory = types(d.type);\n    if (datasetFactory) {\n      let key = d.key || i;\n      let dataset = datasetFactory({\n        key,\n        data: d.data,\n        config: d.config\n      });\n      data[d.key || i] = dataset;\n    }\n  });\n\n  /**\n   * Returns the `dataset` which has `key` as identifier\n   * @ignore\n   * @param {string} key - The dataset identifier\n   * @returns {dataset}\n   */\n  const fn = (key) => {\n    if (key) {\n      return data[key];\n    }\n    return data[Object.keys(data)[0]];\n  };\n  return fn;\n}\n\n/**\n * @typedef {object} data-source\n * @property {string} key - Unique identifier for this data source\n * @property {string} type - The dataset type\n * @property {any} data\n */\n","var pi = Math.PI,\n    tau = 2 * pi,\n    epsilon = 1e-6,\n    tauEpsilon = tau - epsilon;\n\nfunction Path() {\n  this._x0 = this._y0 = // start of current subpath\n  this._x1 = this._y1 = null; // end of current subpath\n  this._ = \"\";\n}\n\nfunction path() {\n  return new Path;\n}\n\nPath.prototype = path.prototype = {\n  constructor: Path,\n  moveTo: function(x, y) {\n    this._ += \"M\" + (this._x0 = this._x1 = +x) + \",\" + (this._y0 = this._y1 = +y);\n  },\n  closePath: function() {\n    if (this._x1 !== null) {\n      this._x1 = this._x0, this._y1 = this._y0;\n      this._ += \"Z\";\n    }\n  },\n  lineTo: function(x, y) {\n    this._ += \"L\" + (this._x1 = +x) + \",\" + (this._y1 = +y);\n  },\n  quadraticCurveTo: function(x1, y1, x, y) {\n    this._ += \"Q\" + (+x1) + \",\" + (+y1) + \",\" + (this._x1 = +x) + \",\" + (this._y1 = +y);\n  },\n  bezierCurveTo: function(x1, y1, x2, y2, x, y) {\n    this._ += \"C\" + (+x1) + \",\" + (+y1) + \",\" + (+x2) + \",\" + (+y2) + \",\" + (this._x1 = +x) + \",\" + (this._y1 = +y);\n  },\n  arcTo: function(x1, y1, x2, y2, r) {\n    x1 = +x1, y1 = +y1, x2 = +x2, y2 = +y2, r = +r;\n    var x0 = this._x1,\n        y0 = this._y1,\n        x21 = x2 - x1,\n        y21 = y2 - y1,\n        x01 = x0 - x1,\n        y01 = y0 - y1,\n        l01_2 = x01 * x01 + y01 * y01;\n\n    // Is the radius negative? Error.\n    if (r < 0) throw new Error(\"negative radius: \" + r);\n\n    // Is this path empty? Move to (x1,y1).\n    if (this._x1 === null) {\n      this._ += \"M\" + (this._x1 = x1) + \",\" + (this._y1 = y1);\n    }\n\n    // Or, is (x1,y1) coincident with (x0,y0)? Do nothing.\n    else if (!(l01_2 > epsilon)) {}\n\n    // Or, are (x0,y0), (x1,y1) and (x2,y2) collinear?\n    // Equivalently, is (x1,y1) coincident with (x2,y2)?\n    // Or, is the radius zero? Line to (x1,y1).\n    else if (!(Math.abs(y01 * x21 - y21 * x01) > epsilon) || !r) {\n      this._ += \"L\" + (this._x1 = x1) + \",\" + (this._y1 = y1);\n    }\n\n    // Otherwise, draw an arc!\n    else {\n      var x20 = x2 - x0,\n          y20 = y2 - y0,\n          l21_2 = x21 * x21 + y21 * y21,\n          l20_2 = x20 * x20 + y20 * y20,\n          l21 = Math.sqrt(l21_2),\n          l01 = Math.sqrt(l01_2),\n          l = r * Math.tan((pi - Math.acos((l21_2 + l01_2 - l20_2) / (2 * l21 * l01))) / 2),\n          t01 = l / l01,\n          t21 = l / l21;\n\n      // If the start tangent is not coincident with (x0,y0), line to.\n      if (Math.abs(t01 - 1) > epsilon) {\n        this._ += \"L\" + (x1 + t01 * x01) + \",\" + (y1 + t01 * y01);\n      }\n\n      this._ += \"A\" + r + \",\" + r + \",0,0,\" + (+(y01 * x20 > x01 * y20)) + \",\" + (this._x1 = x1 + t21 * x21) + \",\" + (this._y1 = y1 + t21 * y21);\n    }\n  },\n  arc: function(x, y, r, a0, a1, ccw) {\n    x = +x, y = +y, r = +r;\n    var dx = r * Math.cos(a0),\n        dy = r * Math.sin(a0),\n        x0 = x + dx,\n        y0 = y + dy,\n        cw = 1 ^ ccw,\n        da = ccw ? a0 - a1 : a1 - a0;\n\n    // Is the radius negative? Error.\n    if (r < 0) throw new Error(\"negative radius: \" + r);\n\n    // Is this path empty? Move to (x0,y0).\n    if (this._x1 === null) {\n      this._ += \"M\" + x0 + \",\" + y0;\n    }\n\n    // Or, is (x0,y0) not coincident with the previous point? Line to (x0,y0).\n    else if (Math.abs(this._x1 - x0) > epsilon || Math.abs(this._y1 - y0) > epsilon) {\n      this._ += \"L\" + x0 + \",\" + y0;\n    }\n\n    // Is this arc empty? Were done.\n    if (!r) return;\n\n    // Does the angle go the wrong way? Flip the direction.\n    if (da < 0) da = da % tau + tau;\n\n    // Is this a complete circle? Draw two arcs to complete the circle.\n    if (da > tauEpsilon) {\n      this._ += \"A\" + r + \",\" + r + \",0,1,\" + cw + \",\" + (x - dx) + \",\" + (y - dy) + \"A\" + r + \",\" + r + \",0,1,\" + cw + \",\" + (this._x1 = x0) + \",\" + (this._y1 = y0);\n    }\n\n    // Is this arc non-empty? Draw an arc!\n    else if (da > epsilon) {\n      this._ += \"A\" + r + \",\" + r + \",0,\" + (+(da >= pi)) + \",\" + cw + \",\" + (this._x1 = x + r * Math.cos(a1)) + \",\" + (this._y1 = y + r * Math.sin(a1));\n    }\n  },\n  rect: function(x, y, w, h) {\n    this._ += \"M\" + (this._x0 = this._x1 = +x) + \",\" + (this._y0 = this._y1 = +y) + \"h\" + (+w) + \"v\" + (+h) + \"h\" + (-w) + \"Z\";\n  },\n  toString: function() {\n    return this._;\n  }\n};\n\nexport default path;\n","export default function(x) {\n  return function constant() {\n    return x;\n  };\n}\n","export var abs = Math.abs;\nexport var atan2 = Math.atan2;\nexport var cos = Math.cos;\nexport var max = Math.max;\nexport var min = Math.min;\nexport var sin = Math.sin;\nexport var sqrt = Math.sqrt;\n\nexport var epsilon = 1e-12;\nexport var pi = Math.PI;\nexport var halfPi = pi / 2;\nexport var tau = 2 * pi;\n\nexport function acos(x) {\n  return x > 1 ? 0 : x < -1 ? pi : Math.acos(x);\n}\n\nexport function asin(x) {\n  return x >= 1 ? halfPi : x <= -1 ? -halfPi : Math.asin(x);\n}\n","import {path} from \"d3-path\";\nimport constant from \"./constant\";\nimport {abs, acos, asin, atan2, cos, epsilon, halfPi, max, min, pi, sin, sqrt, tau} from \"./math\";\n\nfunction arcInnerRadius(d) {\n  return d.innerRadius;\n}\n\nfunction arcOuterRadius(d) {\n  return d.outerRadius;\n}\n\nfunction arcStartAngle(d) {\n  return d.startAngle;\n}\n\nfunction arcEndAngle(d) {\n  return d.endAngle;\n}\n\nfunction arcPadAngle(d) {\n  return d && d.padAngle; // Note: optional!\n}\n\nfunction intersect(x0, y0, x1, y1, x2, y2, x3, y3) {\n  var x10 = x1 - x0, y10 = y1 - y0,\n      x32 = x3 - x2, y32 = y3 - y2,\n      t = (x32 * (y0 - y2) - y32 * (x0 - x2)) / (y32 * x10 - x32 * y10);\n  return [x0 + t * x10, y0 + t * y10];\n}\n\n// Compute perpendicular offset line of length rc.\n// http://mathworld.wolfram.com/Circle-LineIntersection.html\nfunction cornerTangents(x0, y0, x1, y1, r1, rc, cw) {\n  var x01 = x0 - x1,\n      y01 = y0 - y1,\n      lo = (cw ? rc : -rc) / sqrt(x01 * x01 + y01 * y01),\n      ox = lo * y01,\n      oy = -lo * x01,\n      x11 = x0 + ox,\n      y11 = y0 + oy,\n      x10 = x1 + ox,\n      y10 = y1 + oy,\n      x00 = (x11 + x10) / 2,\n      y00 = (y11 + y10) / 2,\n      dx = x10 - x11,\n      dy = y10 - y11,\n      d2 = dx * dx + dy * dy,\n      r = r1 - rc,\n      D = x11 * y10 - x10 * y11,\n      d = (dy < 0 ? -1 : 1) * sqrt(max(0, r * r * d2 - D * D)),\n      cx0 = (D * dy - dx * d) / d2,\n      cy0 = (-D * dx - dy * d) / d2,\n      cx1 = (D * dy + dx * d) / d2,\n      cy1 = (-D * dx + dy * d) / d2,\n      dx0 = cx0 - x00,\n      dy0 = cy0 - y00,\n      dx1 = cx1 - x00,\n      dy1 = cy1 - y00;\n\n  // Pick the closer of the two intersection points.\n  // TODO Is there a faster way to determine which intersection to use?\n  if (dx0 * dx0 + dy0 * dy0 > dx1 * dx1 + dy1 * dy1) cx0 = cx1, cy0 = cy1;\n\n  return {\n    cx: cx0,\n    cy: cy0,\n    x01: -ox,\n    y01: -oy,\n    x11: cx0 * (r1 / r - 1),\n    y11: cy0 * (r1 / r - 1)\n  };\n}\n\nexport default function() {\n  var innerRadius = arcInnerRadius,\n      outerRadius = arcOuterRadius,\n      cornerRadius = constant(0),\n      padRadius = null,\n      startAngle = arcStartAngle,\n      endAngle = arcEndAngle,\n      padAngle = arcPadAngle,\n      context = null;\n\n  function arc() {\n    var buffer,\n        r,\n        r0 = +innerRadius.apply(this, arguments),\n        r1 = +outerRadius.apply(this, arguments),\n        a0 = startAngle.apply(this, arguments) - halfPi,\n        a1 = endAngle.apply(this, arguments) - halfPi,\n        da = abs(a1 - a0),\n        cw = a1 > a0;\n\n    if (!context) context = buffer = path();\n\n    // Ensure that the outer radius is always larger than the inner radius.\n    if (r1 < r0) r = r1, r1 = r0, r0 = r;\n\n    // Is it a point?\n    if (!(r1 > epsilon)) context.moveTo(0, 0);\n\n    // Or is it a circle or annulus?\n    else if (da > tau - epsilon) {\n      context.moveTo(r1 * cos(a0), r1 * sin(a0));\n      context.arc(0, 0, r1, a0, a1, !cw);\n      if (r0 > epsilon) {\n        context.moveTo(r0 * cos(a1), r0 * sin(a1));\n        context.arc(0, 0, r0, a1, a0, cw);\n      }\n    }\n\n    // Or is it a circular or annular sector?\n    else {\n      var a01 = a0,\n          a11 = a1,\n          a00 = a0,\n          a10 = a1,\n          da0 = da,\n          da1 = da,\n          ap = padAngle.apply(this, arguments) / 2,\n          rp = (ap > epsilon) && (padRadius ? +padRadius.apply(this, arguments) : sqrt(r0 * r0 + r1 * r1)),\n          rc = min(abs(r1 - r0) / 2, +cornerRadius.apply(this, arguments)),\n          rc0 = rc,\n          rc1 = rc,\n          t0,\n          t1;\n\n      // Apply padding? Note that since r1  r0, da1  da0.\n      if (rp > epsilon) {\n        var p0 = asin(rp / r0 * sin(ap)),\n            p1 = asin(rp / r1 * sin(ap));\n        if ((da0 -= p0 * 2) > epsilon) p0 *= (cw ? 1 : -1), a00 += p0, a10 -= p0;\n        else da0 = 0, a00 = a10 = (a0 + a1) / 2;\n        if ((da1 -= p1 * 2) > epsilon) p1 *= (cw ? 1 : -1), a01 += p1, a11 -= p1;\n        else da1 = 0, a01 = a11 = (a0 + a1) / 2;\n      }\n\n      var x01 = r1 * cos(a01),\n          y01 = r1 * sin(a01),\n          x10 = r0 * cos(a10),\n          y10 = r0 * sin(a10);\n\n      // Apply rounded corners?\n      if (rc > epsilon) {\n        var x11 = r1 * cos(a11),\n            y11 = r1 * sin(a11),\n            x00 = r0 * cos(a00),\n            y00 = r0 * sin(a00);\n\n        // Restrict the corner radius according to the sector angle.\n        if (da < pi) {\n          var oc = da0 > epsilon ? intersect(x01, y01, x00, y00, x11, y11, x10, y10) : [x10, y10],\n              ax = x01 - oc[0],\n              ay = y01 - oc[1],\n              bx = x11 - oc[0],\n              by = y11 - oc[1],\n              kc = 1 / sin(acos((ax * bx + ay * by) / (sqrt(ax * ax + ay * ay) * sqrt(bx * bx + by * by))) / 2),\n              lc = sqrt(oc[0] * oc[0] + oc[1] * oc[1]);\n          rc0 = min(rc, (r0 - lc) / (kc - 1));\n          rc1 = min(rc, (r1 - lc) / (kc + 1));\n        }\n      }\n\n      // Is the sector collapsed to a line?\n      if (!(da1 > epsilon)) context.moveTo(x01, y01);\n\n      // Does the sectors outer ring have rounded corners?\n      else if (rc1 > epsilon) {\n        t0 = cornerTangents(x00, y00, x01, y01, r1, rc1, cw);\n        t1 = cornerTangents(x11, y11, x10, y10, r1, rc1, cw);\n\n        context.moveTo(t0.cx + t0.x01, t0.cy + t0.y01);\n\n        // Have the corners merged?\n        if (rc1 < rc) context.arc(t0.cx, t0.cy, rc1, atan2(t0.y01, t0.x01), atan2(t1.y01, t1.x01), !cw);\n\n        // Otherwise, draw the two corners and the ring.\n        else {\n          context.arc(t0.cx, t0.cy, rc1, atan2(t0.y01, t0.x01), atan2(t0.y11, t0.x11), !cw);\n          context.arc(0, 0, r1, atan2(t0.cy + t0.y11, t0.cx + t0.x11), atan2(t1.cy + t1.y11, t1.cx + t1.x11), !cw);\n          context.arc(t1.cx, t1.cy, rc1, atan2(t1.y11, t1.x11), atan2(t1.y01, t1.x01), !cw);\n        }\n      }\n\n      // Or is the outer ring just a circular arc?\n      else context.moveTo(x01, y01), context.arc(0, 0, r1, a01, a11, !cw);\n\n      // Is there no inner ring, and its a circular sector?\n      // Or perhaps its an annular sector collapsed due to padding?\n      if (!(r0 > epsilon) || !(da0 > epsilon)) context.lineTo(x10, y10);\n\n      // Does the sectors inner ring (or point) have rounded corners?\n      else if (rc0 > epsilon) {\n        t0 = cornerTangents(x10, y10, x11, y11, r0, -rc0, cw);\n        t1 = cornerTangents(x01, y01, x00, y00, r0, -rc0, cw);\n\n        context.lineTo(t0.cx + t0.x01, t0.cy + t0.y01);\n\n        // Have the corners merged?\n        if (rc0 < rc) context.arc(t0.cx, t0.cy, rc0, atan2(t0.y01, t0.x01), atan2(t1.y01, t1.x01), !cw);\n\n        // Otherwise, draw the two corners and the ring.\n        else {\n          context.arc(t0.cx, t0.cy, rc0, atan2(t0.y01, t0.x01), atan2(t0.y11, t0.x11), !cw);\n          context.arc(0, 0, r0, atan2(t0.cy + t0.y11, t0.cx + t0.x11), atan2(t1.cy + t1.y11, t1.cx + t1.x11), cw);\n          context.arc(t1.cx, t1.cy, rc0, atan2(t1.y11, t1.x11), atan2(t1.y01, t1.x01), !cw);\n        }\n      }\n\n      // Or is the inner ring just a circular arc?\n      else context.arc(0, 0, r0, a10, a00, cw);\n    }\n\n    context.closePath();\n\n    if (buffer) return context = null, buffer + \"\" || null;\n  }\n\n  arc.centroid = function() {\n    var r = (+innerRadius.apply(this, arguments) + +outerRadius.apply(this, arguments)) / 2,\n        a = (+startAngle.apply(this, arguments) + +endAngle.apply(this, arguments)) / 2 - pi / 2;\n    return [cos(a) * r, sin(a) * r];\n  };\n\n  arc.innerRadius = function(_) {\n    return arguments.length ? (innerRadius = typeof _ === \"function\" ? _ : constant(+_), arc) : innerRadius;\n  };\n\n  arc.outerRadius = function(_) {\n    return arguments.length ? (outerRadius = typeof _ === \"function\" ? _ : constant(+_), arc) : outerRadius;\n  };\n\n  arc.cornerRadius = function(_) {\n    return arguments.length ? (cornerRadius = typeof _ === \"function\" ? _ : constant(+_), arc) : cornerRadius;\n  };\n\n  arc.padRadius = function(_) {\n    return arguments.length ? (padRadius = _ == null ? null : typeof _ === \"function\" ? _ : constant(+_), arc) : padRadius;\n  };\n\n  arc.startAngle = function(_) {\n    return arguments.length ? (startAngle = typeof _ === \"function\" ? _ : constant(+_), arc) : startAngle;\n  };\n\n  arc.endAngle = function(_) {\n    return arguments.length ? (endAngle = typeof _ === \"function\" ? _ : constant(+_), arc) : endAngle;\n  };\n\n  arc.padAngle = function(_) {\n    return arguments.length ? (padAngle = typeof _ === \"function\" ? _ : constant(+_), arc) : padAngle;\n  };\n\n  arc.context = function(_) {\n    return arguments.length ? ((context = _ == null ? null : _), arc) : context;\n  };\n\n  return arc;\n}\n","function Linear(context) {\n  this._context = context;\n}\n\nLinear.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._point = 0;\n  },\n  lineEnd: function() {\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; // proceed\n      default: this._context.lineTo(x, y); break;\n    }\n  }\n};\n\nexport default function(context) {\n  return new Linear(context);\n}\n","export function x(p) {\n  return p[0];\n}\n\nexport function y(p) {\n  return p[1];\n}\n","import {path} from \"d3-path\";\nimport constant from \"./constant\";\nimport curveLinear from \"./curve/linear\";\nimport {x as pointX, y as pointY} from \"./point\";\n\nexport default function() {\n  var x = pointX,\n      y = pointY,\n      defined = constant(true),\n      context = null,\n      curve = curveLinear,\n      output = null;\n\n  function line(data) {\n    var i,\n        n = data.length,\n        d,\n        defined0 = false,\n        buffer;\n\n    if (context == null) output = curve(buffer = path());\n\n    for (i = 0; i <= n; ++i) {\n      if (!(i < n && defined(d = data[i], i, data)) === defined0) {\n        if (defined0 = !defined0) output.lineStart();\n        else output.lineEnd();\n      }\n      if (defined0) output.point(+x(d, i, data), +y(d, i, data));\n    }\n\n    if (buffer) return output = null, buffer + \"\" || null;\n  }\n\n  line.x = function(_) {\n    return arguments.length ? (x = typeof _ === \"function\" ? _ : constant(+_), line) : x;\n  };\n\n  line.y = function(_) {\n    return arguments.length ? (y = typeof _ === \"function\" ? _ : constant(+_), line) : y;\n  };\n\n  line.defined = function(_) {\n    return arguments.length ? (defined = typeof _ === \"function\" ? _ : constant(!!_), line) : defined;\n  };\n\n  line.curve = function(_) {\n    return arguments.length ? (curve = _, context != null && (output = curve(context)), line) : curve;\n  };\n\n  line.context = function(_) {\n    return arguments.length ? (_ == null ? context = output = null : output = curve(context = _), line) : context;\n  };\n\n  return line;\n}\n","import {path} from \"d3-path\";\nimport constant from \"./constant\";\nimport curveLinear from \"./curve/linear\";\nimport line from \"./line\";\nimport {x as pointX, y as pointY} from \"./point\";\n\nexport default function() {\n  var x0 = pointX,\n      x1 = null,\n      y0 = constant(0),\n      y1 = pointY,\n      defined = constant(true),\n      context = null,\n      curve = curveLinear,\n      output = null;\n\n  function area(data) {\n    var i,\n        j,\n        k,\n        n = data.length,\n        d,\n        defined0 = false,\n        buffer,\n        x0z = new Array(n),\n        y0z = new Array(n);\n\n    if (context == null) output = curve(buffer = path());\n\n    for (i = 0; i <= n; ++i) {\n      if (!(i < n && defined(d = data[i], i, data)) === defined0) {\n        if (defined0 = !defined0) {\n          j = i;\n          output.areaStart();\n          output.lineStart();\n        } else {\n          output.lineEnd();\n          output.lineStart();\n          for (k = i - 1; k >= j; --k) {\n            output.point(x0z[k], y0z[k]);\n          }\n          output.lineEnd();\n          output.areaEnd();\n        }\n      }\n      if (defined0) {\n        x0z[i] = +x0(d, i, data), y0z[i] = +y0(d, i, data);\n        output.point(x1 ? +x1(d, i, data) : x0z[i], y1 ? +y1(d, i, data) : y0z[i]);\n      }\n    }\n\n    if (buffer) return output = null, buffer + \"\" || null;\n  }\n\n  function arealine() {\n    return line().defined(defined).curve(curve).context(context);\n  }\n\n  area.x = function(_) {\n    return arguments.length ? (x0 = typeof _ === \"function\" ? _ : constant(+_), x1 = null, area) : x0;\n  };\n\n  area.x0 = function(_) {\n    return arguments.length ? (x0 = typeof _ === \"function\" ? _ : constant(+_), area) : x0;\n  };\n\n  area.x1 = function(_) {\n    return arguments.length ? (x1 = _ == null ? null : typeof _ === \"function\" ? _ : constant(+_), area) : x1;\n  };\n\n  area.y = function(_) {\n    return arguments.length ? (y0 = typeof _ === \"function\" ? _ : constant(+_), y1 = null, area) : y0;\n  };\n\n  area.y0 = function(_) {\n    return arguments.length ? (y0 = typeof _ === \"function\" ? _ : constant(+_), area) : y0;\n  };\n\n  area.y1 = function(_) {\n    return arguments.length ? (y1 = _ == null ? null : typeof _ === \"function\" ? _ : constant(+_), area) : y1;\n  };\n\n  area.lineX0 =\n  area.lineY0 = function() {\n    return arealine().x(x0).y(y0);\n  };\n\n  area.lineY1 = function() {\n    return arealine().x(x0).y(y1);\n  };\n\n  area.lineX1 = function() {\n    return arealine().x(x1).y(y0);\n  };\n\n  area.defined = function(_) {\n    return arguments.length ? (defined = typeof _ === \"function\" ? _ : constant(!!_), area) : defined;\n  };\n\n  area.curve = function(_) {\n    return arguments.length ? (curve = _, context != null && (output = curve(context)), area) : curve;\n  };\n\n  area.context = function(_) {\n    return arguments.length ? (_ == null ? context = output = null : output = curve(context = _), area) : context;\n  };\n\n  return area;\n}\n","export default function(a, b) {\n  return b < a ? -1 : b > a ? 1 : b >= a ? 0 : NaN;\n}\n","export default function(d) {\n  return d;\n}\n","import constant from \"./constant\";\nimport descending from \"./descending\";\nimport identity from \"./identity\";\nimport {tau} from \"./math\";\n\nexport default function() {\n  var value = identity,\n      sortValues = descending,\n      sort = null,\n      startAngle = constant(0),\n      endAngle = constant(tau),\n      padAngle = constant(0);\n\n  function pie(data) {\n    var i,\n        n = data.length,\n        j,\n        k,\n        sum = 0,\n        index = new Array(n),\n        arcs = new Array(n),\n        a0 = +startAngle.apply(this, arguments),\n        da = Math.min(tau, Math.max(-tau, endAngle.apply(this, arguments) - a0)),\n        a1,\n        p = Math.min(Math.abs(da) / n, padAngle.apply(this, arguments)),\n        pa = p * (da < 0 ? -1 : 1),\n        v;\n\n    for (i = 0; i < n; ++i) {\n      if ((v = arcs[index[i] = i] = +value(data[i], i, data)) > 0) {\n        sum += v;\n      }\n    }\n\n    // Optionally sort the arcs by previously-computed values or by data.\n    if (sortValues != null) index.sort(function(i, j) { return sortValues(arcs[i], arcs[j]); });\n    else if (sort != null) index.sort(function(i, j) { return sort(data[i], data[j]); });\n\n    // Compute the arcs! They are stored in the original data's order.\n    for (i = 0, k = sum ? (da - n * pa) / sum : 0; i < n; ++i, a0 = a1) {\n      j = index[i], v = arcs[j], a1 = a0 + (v > 0 ? v * k : 0) + pa, arcs[j] = {\n        data: data[j],\n        index: i,\n        value: v,\n        startAngle: a0,\n        endAngle: a1,\n        padAngle: p\n      };\n    }\n\n    return arcs;\n  }\n\n  pie.value = function(_) {\n    return arguments.length ? (value = typeof _ === \"function\" ? _ : constant(+_), pie) : value;\n  };\n\n  pie.sortValues = function(_) {\n    return arguments.length ? (sortValues = _, sort = null, pie) : sortValues;\n  };\n\n  pie.sort = function(_) {\n    return arguments.length ? (sort = _, sortValues = null, pie) : sort;\n  };\n\n  pie.startAngle = function(_) {\n    return arguments.length ? (startAngle = typeof _ === \"function\" ? _ : constant(+_), pie) : startAngle;\n  };\n\n  pie.endAngle = function(_) {\n    return arguments.length ? (endAngle = typeof _ === \"function\" ? _ : constant(+_), pie) : endAngle;\n  };\n\n  pie.padAngle = function(_) {\n    return arguments.length ? (padAngle = typeof _ === \"function\" ? _ : constant(+_), pie) : padAngle;\n  };\n\n  return pie;\n}\n","export var slice = Array.prototype.slice;\n","export function point(that, x, y) {\n  that._context.bezierCurveTo(\n    (2 * that._x0 + that._x1) / 3,\n    (2 * that._y0 + that._y1) / 3,\n    (that._x0 + 2 * that._x1) / 3,\n    (that._y0 + 2 * that._y1) / 3,\n    (that._x0 + 4 * that._x1 + x) / 6,\n    (that._y0 + 4 * that._y1 + y) / 6\n  );\n}\n\nexport function Basis(context) {\n  this._context = context;\n}\n\nBasis.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 =\n    this._y0 = this._y1 = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 3: point(this, this._x1, this._y1); // proceed\n      case 2: this._context.lineTo(this._x1, this._y1); break;\n    }\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; break;\n      case 2: this._point = 3; this._context.lineTo((5 * this._x0 + this._x1) / 6, (5 * this._y0 + this._y1) / 6); // proceed\n      default: point(this, x, y); break;\n    }\n    this._x0 = this._x1, this._x1 = x;\n    this._y0 = this._y1, this._y1 = y;\n  }\n};\n\nexport default function(context) {\n  return new Basis(context);\n}\n","export function point(that, x, y) {\n  that._context.bezierCurveTo(\n    that._x1 + that._k * (that._x2 - that._x0),\n    that._y1 + that._k * (that._y2 - that._y0),\n    that._x2 + that._k * (that._x1 - x),\n    that._y2 + that._k * (that._y1 - y),\n    that._x2,\n    that._y2\n  );\n}\n\nexport function Cardinal(context, tension) {\n  this._context = context;\n  this._k = (1 - tension) / 6;\n}\n\nCardinal.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 = this._x2 =\n    this._y0 = this._y1 = this._y2 = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 2: this._context.lineTo(this._x2, this._y2); break;\n      case 3: point(this, this._x1, this._y1); break;\n    }\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; this._x1 = x, this._y1 = y; break;\n      case 2: this._point = 3; // proceed\n      default: point(this, x, y); break;\n    }\n    this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;\n    this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;\n  }\n};\n\nexport default (function custom(tension) {\n\n  function cardinal(context) {\n    return new Cardinal(context, tension);\n  }\n\n  cardinal.tension = function(tension) {\n    return custom(+tension);\n  };\n\n  return cardinal;\n})(0);\n","import {epsilon} from \"../math\";\nimport {Cardinal} from \"./cardinal\";\n\nexport function point(that, x, y) {\n  var x1 = that._x1,\n      y1 = that._y1,\n      x2 = that._x2,\n      y2 = that._y2;\n\n  if (that._l01_a > epsilon) {\n    var a = 2 * that._l01_2a + 3 * that._l01_a * that._l12_a + that._l12_2a,\n        n = 3 * that._l01_a * (that._l01_a + that._l12_a);\n    x1 = (x1 * a - that._x0 * that._l12_2a + that._x2 * that._l01_2a) / n;\n    y1 = (y1 * a - that._y0 * that._l12_2a + that._y2 * that._l01_2a) / n;\n  }\n\n  if (that._l23_a > epsilon) {\n    var b = 2 * that._l23_2a + 3 * that._l23_a * that._l12_a + that._l12_2a,\n        m = 3 * that._l23_a * (that._l23_a + that._l12_a);\n    x2 = (x2 * b + that._x1 * that._l23_2a - x * that._l12_2a) / m;\n    y2 = (y2 * b + that._y1 * that._l23_2a - y * that._l12_2a) / m;\n  }\n\n  that._context.bezierCurveTo(x1, y1, x2, y2, that._x2, that._y2);\n}\n\nfunction CatmullRom(context, alpha) {\n  this._context = context;\n  this._alpha = alpha;\n}\n\nCatmullRom.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 = this._x2 =\n    this._y0 = this._y1 = this._y2 = NaN;\n    this._l01_a = this._l12_a = this._l23_a =\n    this._l01_2a = this._l12_2a = this._l23_2a =\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 2: this._context.lineTo(this._x2, this._y2); break;\n      case 3: this.point(this._x2, this._y2); break;\n    }\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n\n    if (this._point) {\n      var x23 = this._x2 - x,\n          y23 = this._y2 - y;\n      this._l23_a = Math.sqrt(this._l23_2a = Math.pow(x23 * x23 + y23 * y23, this._alpha));\n    }\n\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; break;\n      case 2: this._point = 3; // proceed\n      default: point(this, x, y); break;\n    }\n\n    this._l01_a = this._l12_a, this._l12_a = this._l23_a;\n    this._l01_2a = this._l12_2a, this._l12_2a = this._l23_2a;\n    this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;\n    this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;\n  }\n};\n\nexport default (function custom(alpha) {\n\n  function catmullRom(context) {\n    return alpha ? new CatmullRom(context, alpha) : new Cardinal(context, 0);\n  }\n\n  catmullRom.alpha = function(alpha) {\n    return custom(+alpha);\n  };\n\n  return catmullRom;\n})(0.5);\n","function sign(x) {\n  return x < 0 ? -1 : 1;\n}\n\n// Calculate the slopes of the tangents (Hermite-type interpolation) based on\n// the following paper: Steffen, M. 1990. A Simple Method for Monotonic\n// Interpolation in One Dimension. Astronomy and Astrophysics, Vol. 239, NO.\n// NOV(II), P. 443, 1990.\nfunction slope3(that, x2, y2) {\n  var h0 = that._x1 - that._x0,\n      h1 = x2 - that._x1,\n      s0 = (that._y1 - that._y0) / (h0 || h1 < 0 && -0),\n      s1 = (y2 - that._y1) / (h1 || h0 < 0 && -0),\n      p = (s0 * h1 + s1 * h0) / (h0 + h1);\n  return (sign(s0) + sign(s1)) * Math.min(Math.abs(s0), Math.abs(s1), 0.5 * Math.abs(p)) || 0;\n}\n\n// Calculate a one-sided slope.\nfunction slope2(that, t) {\n  var h = that._x1 - that._x0;\n  return h ? (3 * (that._y1 - that._y0) / h - t) / 2 : t;\n}\n\n// According to https://en.wikipedia.org/wiki/Cubic_Hermite_spline#Representations\n// \"you can express cubic Hermite interpolation in terms of cubic Bzier curves\n// with respect to the four values p0, p0 + m0 / 3, p1 - m1 / 3, p1\".\nfunction point(that, t0, t1) {\n  var x0 = that._x0,\n      y0 = that._y0,\n      x1 = that._x1,\n      y1 = that._y1,\n      dx = (x1 - x0) / 3;\n  that._context.bezierCurveTo(x0 + dx, y0 + dx * t0, x1 - dx, y1 - dx * t1, x1, y1);\n}\n\nfunction MonotoneX(context) {\n  this._context = context;\n}\n\nMonotoneX.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 =\n    this._y0 = this._y1 =\n    this._t0 = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 2: this._context.lineTo(this._x1, this._y1); break;\n      case 3: point(this, this._t0, slope2(this, this._t0)); break;\n    }\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    var t1 = NaN;\n\n    x = +x, y = +y;\n    if (x === this._x1 && y === this._y1) return; // Ignore coincident points.\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; break;\n      case 2: this._point = 3; point(this, slope2(this, t1 = slope3(this, x, y)), t1); break;\n      default: point(this, this._t0, t1 = slope3(this, x, y)); break;\n    }\n\n    this._x0 = this._x1, this._x1 = x;\n    this._y0 = this._y1, this._y1 = y;\n    this._t0 = t1;\n  }\n}\n\nfunction MonotoneY(context) {\n  this._context = new ReflectContext(context);\n}\n\n(MonotoneY.prototype = Object.create(MonotoneX.prototype)).point = function(x, y) {\n  MonotoneX.prototype.point.call(this, y, x);\n};\n\nfunction ReflectContext(context) {\n  this._context = context;\n}\n\nReflectContext.prototype = {\n  moveTo: function(x, y) { this._context.moveTo(y, x); },\n  closePath: function() { this._context.closePath(); },\n  lineTo: function(x, y) { this._context.lineTo(y, x); },\n  bezierCurveTo: function(x1, y1, x2, y2, x, y) { this._context.bezierCurveTo(y1, x1, y2, x2, y, x); }\n};\n\nexport function monotoneX(context) {\n  return new MonotoneX(context);\n}\n\nexport function monotoneY(context) {\n  return new MonotoneY(context);\n}\n","function Natural(context) {\n  this._context = context;\n}\n\nNatural.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x = [];\n    this._y = [];\n  },\n  lineEnd: function() {\n    var x = this._x,\n        y = this._y,\n        n = x.length;\n\n    if (n) {\n      this._line ? this._context.lineTo(x[0], y[0]) : this._context.moveTo(x[0], y[0]);\n      if (n === 2) {\n        this._context.lineTo(x[1], y[1]);\n      } else {\n        var px = controlPoints(x),\n            py = controlPoints(y);\n        for (var i0 = 0, i1 = 1; i1 < n; ++i0, ++i1) {\n          this._context.bezierCurveTo(px[0][i0], py[0][i0], px[1][i0], py[1][i0], x[i1], y[i1]);\n        }\n      }\n    }\n\n    if (this._line || (this._line !== 0 && n === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n    this._x = this._y = null;\n  },\n  point: function(x, y) {\n    this._x.push(+x);\n    this._y.push(+y);\n  }\n};\n\n// See https://www.particleincell.com/2012/bezier-splines/ for derivation.\nfunction controlPoints(x) {\n  var i,\n      n = x.length - 1,\n      m,\n      a = new Array(n),\n      b = new Array(n),\n      r = new Array(n);\n  a[0] = 0, b[0] = 2, r[0] = x[0] + 2 * x[1];\n  for (i = 1; i < n - 1; ++i) a[i] = 1, b[i] = 4, r[i] = 4 * x[i] + 2 * x[i + 1];\n  a[n - 1] = 2, b[n - 1] = 7, r[n - 1] = 8 * x[n - 1] + x[n];\n  for (i = 1; i < n; ++i) m = a[i] / b[i - 1], b[i] -= m, r[i] -= m * r[i - 1];\n  a[n - 1] = r[n - 1] / b[n - 1];\n  for (i = n - 2; i >= 0; --i) a[i] = (r[i] - a[i + 1]) / b[i];\n  b[n - 1] = (x[n] + a[n - 1]) / 2;\n  for (i = 0; i < n - 1; ++i) b[i] = 2 * x[i + 1] - a[i + 1];\n  return [a, b];\n}\n\nexport default function(context) {\n  return new Natural(context);\n}\n","function Step(context, t) {\n  this._context = context;\n  this._t = t;\n}\n\nStep.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x = this._y = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    if (0 < this._t && this._t < 1 && this._point === 2) this._context.lineTo(this._x, this._y);\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    if (this._line >= 0) this._t = 1 - this._t, this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; // proceed\n      default: {\n        if (this._t <= 0) {\n          this._context.lineTo(this._x, y);\n          this._context.lineTo(x, y);\n        } else {\n          var x1 = this._x * (1 - this._t) + x * this._t;\n          this._context.lineTo(x1, this._y);\n          this._context.lineTo(x1, y);\n        }\n        break;\n      }\n    }\n    this._x = x, this._y = y;\n  }\n};\n\nexport default function(context) {\n  return new Step(context, 0.5);\n}\n\nexport function stepBefore(context) {\n  return new Step(context, 0);\n}\n\nexport function stepAfter(context) {\n  return new Step(context, 1);\n}\n","export default function(series, order) {\n  if (!((n = series.length) > 1)) return;\n  for (var i = 1, j, s0, s1 = series[order[0]], n, m = s1.length; i < n; ++i) {\n    s0 = s1, s1 = series[order[i]];\n    for (j = 0; j < m; ++j) {\n      s1[j][1] += s1[j][0] = isNaN(s0[j][1]) ? s0[j][0] : s0[j][1];\n    }\n  }\n}\n","export default function(series) {\n  var n = series.length, o = new Array(n);\n  while (--n >= 0) o[n] = n;\n  return o;\n}\n","import {slice} from \"./array\";\nimport constant from \"./constant\";\nimport offsetNone from \"./offset/none\";\nimport orderNone from \"./order/none\";\n\nfunction stackValue(d, key) {\n  return d[key];\n}\n\nexport default function() {\n  var keys = constant([]),\n      order = orderNone,\n      offset = offsetNone,\n      value = stackValue;\n\n  function stack(data) {\n    var kz = keys.apply(this, arguments),\n        i,\n        m = data.length,\n        n = kz.length,\n        sz = new Array(n),\n        oz;\n\n    for (i = 0; i < n; ++i) {\n      for (var ki = kz[i], si = sz[i] = new Array(m), j = 0, sij; j < m; ++j) {\n        si[j] = sij = [0, +value(data[j], ki, j, data)];\n        sij.data = data[j];\n      }\n      si.key = ki;\n    }\n\n    for (i = 0, oz = order(sz); i < n; ++i) {\n      sz[oz[i]].index = i;\n    }\n\n    offset(sz, oz);\n    return sz;\n  }\n\n  stack.keys = function(_) {\n    return arguments.length ? (keys = typeof _ === \"function\" ? _ : constant(slice.call(_)), stack) : keys;\n  };\n\n  stack.value = function(_) {\n    return arguments.length ? (value = typeof _ === \"function\" ? _ : constant(+_), stack) : value;\n  };\n\n  stack.order = function(_) {\n    return arguments.length ? (order = _ == null ? orderNone : typeof _ === \"function\" ? _ : constant(slice.call(_)), stack) : order;\n  };\n\n  stack.offset = function(_) {\n    return arguments.length ? (offset = _ == null ? offsetNone : _, stack) : offset;\n  };\n\n  return stack;\n}\n","import none from \"./none\";\n\nexport default function(series, order) {\n  if (!((n = series.length) > 0)) return;\n  for (var i, n, j = 0, m = series[0].length, y; j < m; ++j) {\n    for (y = i = 0; i < n; ++i) y += series[i][j][1] || 0;\n    if (y) for (i = 0; i < n; ++i) series[i][j][1] /= y;\n  }\n  none(series, order);\n}\n","export default function(series, order) {\n  if (!((n = series.length) > 1)) return;\n  for (var i, j = 0, d, dy, yp, yn, n, m = series[order[0]].length; j < m; ++j) {\n    for (yp = yn = 0, i = 0; i < n; ++i) {\n      if ((dy = (d = series[order[i]][j])[1] - d[0]) >= 0) {\n        d[0] = yp, d[1] = yp += dy;\n      } else if (dy < 0) {\n        d[1] = yn, d[0] = yn += dy;\n      } else {\n        d[0] = yp;\n      }\n    }\n  }\n}\n","import none from \"./none\";\n\nexport default function(series, order) {\n  if (!((n = series.length) > 0)) return;\n  for (var j = 0, s0 = series[order[0]], n, m = s0.length; j < m; ++j) {\n    for (var i = 0, y = 0; i < n; ++i) y += series[i][j][1] || 0;\n    s0[j][1] += s0[j][0] = -y / 2;\n  }\n  none(series, order);\n}\n","import none from \"./none\";\n\nexport default function(series, order) {\n  if (!((n = series.length) > 0) || !((m = (s0 = series[order[0]]).length) > 0)) return;\n  for (var y = 0, j = 1, s0, m, n; j < m; ++j) {\n    for (var i = 0, s1 = 0, s2 = 0; i < n; ++i) {\n      var si = series[order[i]],\n          sij0 = si[j][1] || 0,\n          sij1 = si[j - 1][1] || 0,\n          s3 = (sij0 - sij1) / 2;\n      for (var k = 0; k < i; ++k) {\n        var sk = series[order[k]],\n            skj0 = sk[j][1] || 0,\n            skj1 = sk[j - 1][1] || 0;\n        s3 += skj0 - skj1;\n      }\n      s1 += sij0, s2 += s3 * sij0;\n    }\n    s0[j - 1][1] += s0[j - 1][0] = y;\n    if (s1) y -= s2 / s1;\n  }\n  s0[j - 1][1] += s0[j - 1][0] = y;\n  none(series, order);\n}\n","import none from \"./none\";\n\nexport default function(series) {\n  var sums = series.map(sum);\n  return none(series).sort(function(a, b) { return sums[a] - sums[b]; });\n}\n\nexport function sum(series) {\n  var s = 0, i = -1, n = series.length, v;\n  while (++i < n) if (v = +series[i][1]) s += v;\n  return s;\n}\n","import none from \"./none\";\nimport {sum} from \"./ascending\";\n\nexport default function(series) {\n  var n = series.length,\n      i,\n      j,\n      sums = series.map(sum),\n      order = none(series).sort(function(a, b) { return sums[b] - sums[a]; }),\n      top = 0,\n      bottom = 0,\n      tops = [],\n      bottoms = [];\n\n  for (i = 0; i < n; ++i) {\n    j = order[i];\n    if (top < bottom) {\n      top += sums[j];\n      tops.push(j);\n    } else {\n      bottom += sums[j];\n      bottoms.push(j);\n    }\n  }\n\n  return bottoms.reverse().concat(tops);\n}\n","import none from \"./none\";\n\nexport default function(series) {\n  return none(series).reverse();\n}\n","export default function registryFactory(parentRegistry) {\n  let defaultValue;\n  const reg = {};\n  const parent = parentRegistry || {\n    get: () => undefined,\n    has: () => false,\n    default: () => undefined\n  };\n\n  defaultValue = parent.default();\n\n  /**\n   * @private\n   * @param {string} key\n   * @param {any} value\n   * @throws {TypeError} Key must be a non-empty string\n   * @returns {boolean} False if the given key already exists, true otherwise\n   * @example\n   * var r = registry();\n   * r.add( \"marker\", function(args) {\n   *   return new markers[args.type](args);\n   * });\n   *\n   */\n  function add(key, value) {\n    if (!key || typeof key !== 'string') {\n      throw new TypeError('Invalid argument: key must be a non-empty string');\n    }\n    if (key in reg) {\n      return false;\n    }\n    reg[key] = value;\n    return true;\n  }\n\n  function get(key) {\n    return reg[key] || parent.get(key);\n  }\n\n  function has(key) {\n    return !!reg[key] || parent.has(key);\n  }\n\n  function remove(key) {\n    const d = reg[key];\n    delete reg[key];\n    return d;\n  }\n\n  function getKeys() {\n    return Object.keys(reg);\n  }\n\n  function getValues() {\n    return Object.keys(reg).map(key => reg[key]);\n  }\n\n  function deflt(d) {\n    if (typeof d !== 'undefined') {\n      defaultValue = d;\n    }\n    return defaultValue;\n  }\n\n  /**\n   * @alias registry\n   * @interface\n   * @param {string} key\n   * @param {any} value\n   */\n  function registry(key, value) {\n    if (typeof value !== 'undefined') {\n      return add(key, value);\n    }\n    return get(key || defaultValue);\n  }\n\n  registry.add = add;\n  registry.get = get;\n  registry.has = has;\n  registry.remove = remove;\n  registry.getKeys = getKeys;\n  registry.getValues = getValues;\n  registry.default = deflt;\n  registry.register = add; // deprecated\n\n  return registry;\n}\n","// Computes the decimal coefficient and exponent of the specified number x with\n// significant digits p, where x is positive and p is in [1, 21] or undefined.\n// For example, formatDecimal(1.23) returns [\"123\", 0].\nexport default function(x, p) {\n  if ((i = (x = p ? x.toExponential(p - 1) : x.toExponential()).indexOf(\"e\")) < 0) return null; // NaN, Infinity\n  var i, coefficient = x.slice(0, i);\n\n  // The string returned by toExponential either has the form \\d\\.\\d+e[-+]\\d+\n  // (e.g., 1.2e+3) or the form \\de[-+]\\d+ (e.g., 1e+3).\n  return [\n    coefficient.length > 1 ? coefficient[0] + coefficient.slice(2) : coefficient,\n    +x.slice(i + 1)\n  ];\n}\n","import formatDecimal from \"./formatDecimal\";\n\nexport default function(x) {\n  return x = formatDecimal(Math.abs(x)), x ? x[1] : NaN;\n}\n","export default function(grouping, thousands) {\n  return function(value, width) {\n    var i = value.length,\n        t = [],\n        j = 0,\n        g = grouping[0],\n        length = 0;\n\n    while (i > 0 && g > 0) {\n      if (length + g + 1 > width) g = Math.max(1, width - length);\n      t.push(value.substring(i -= g, i + g));\n      if ((length += g + 1) > width) break;\n      g = grouping[j = (j + 1) % grouping.length];\n    }\n\n    return t.reverse().join(thousands);\n  };\n}\n","export default function(numerals) {\n  return function(value) {\n    return value.replace(/[0-9]/g, function(i) {\n      return numerals[+i];\n    });\n  };\n}\n","// [[fill]align][sign][symbol][0][width][,][.precision][~][type]\nvar re = /^(?:(.)?([<>=^]))?([+\\-\\( ])?([$#])?(0)?(\\d+)?(,)?(\\.\\d+)?(~)?([a-z%])?$/i;\n\nexport default function formatSpecifier(specifier) {\n  return new FormatSpecifier(specifier);\n}\n\nformatSpecifier.prototype = FormatSpecifier.prototype; // instanceof\n\nfunction FormatSpecifier(specifier) {\n  if (!(match = re.exec(specifier))) throw new Error(\"invalid format: \" + specifier);\n  var match;\n  this.fill = match[1] || \" \";\n  this.align = match[2] || \">\";\n  this.sign = match[3] || \"-\";\n  this.symbol = match[4] || \"\";\n  this.zero = !!match[5];\n  this.width = match[6] && +match[6];\n  this.comma = !!match[7];\n  this.precision = match[8] && +match[8].slice(1);\n  this.trim = !!match[9];\n  this.type = match[10] || \"\";\n}\n\nFormatSpecifier.prototype.toString = function() {\n  return this.fill\n      + this.align\n      + this.sign\n      + this.symbol\n      + (this.zero ? \"0\" : \"\")\n      + (this.width == null ? \"\" : Math.max(1, this.width | 0))\n      + (this.comma ? \",\" : \"\")\n      + (this.precision == null ? \"\" : \".\" + Math.max(0, this.precision | 0))\n      + (this.trim ? \"~\" : \"\")\n      + this.type;\n};\n","// Trims insignificant zeros, e.g., replaces 1.2000k with 1.2k.\nexport default function(s) {\n  out: for (var n = s.length, i = 1, i0 = -1, i1; i < n; ++i) {\n    switch (s[i]) {\n      case \".\": i0 = i1 = i; break;\n      case \"0\": if (i0 === 0) i0 = i; i1 = i; break;\n      default: if (i0 > 0) { if (!+s[i]) break out; i0 = 0; } break;\n    }\n  }\n  return i0 > 0 ? s.slice(0, i0) + s.slice(i1 + 1) : s;\n}\n","import formatDecimal from \"./formatDecimal\";\n\nexport var prefixExponent;\n\nexport default function(x, p) {\n  var d = formatDecimal(x, p);\n  if (!d) return x + \"\";\n  var coefficient = d[0],\n      exponent = d[1],\n      i = exponent - (prefixExponent = Math.max(-8, Math.min(8, Math.floor(exponent / 3))) * 3) + 1,\n      n = coefficient.length;\n  return i === n ? coefficient\n      : i > n ? coefficient + new Array(i - n + 1).join(\"0\")\n      : i > 0 ? coefficient.slice(0, i) + \".\" + coefficient.slice(i)\n      : \"0.\" + new Array(1 - i).join(\"0\") + formatDecimal(x, Math.max(0, p + i - 1))[0]; // less than 1y!\n}\n","import formatDecimal from \"./formatDecimal\";\n\nexport default function(x, p) {\n  var d = formatDecimal(x, p);\n  if (!d) return x + \"\";\n  var coefficient = d[0],\n      exponent = d[1];\n  return exponent < 0 ? \"0.\" + new Array(-exponent).join(\"0\") + coefficient\n      : coefficient.length > exponent + 1 ? coefficient.slice(0, exponent + 1) + \".\" + coefficient.slice(exponent + 1)\n      : coefficient + new Array(exponent - coefficient.length + 2).join(\"0\");\n}\n","import formatPrefixAuto from \"./formatPrefixAuto\";\nimport formatRounded from \"./formatRounded\";\n\nexport default {\n  \"%\": function(x, p) { return (x * 100).toFixed(p); },\n  \"b\": function(x) { return Math.round(x).toString(2); },\n  \"c\": function(x) { return x + \"\"; },\n  \"d\": function(x) { return Math.round(x).toString(10); },\n  \"e\": function(x, p) { return x.toExponential(p); },\n  \"f\": function(x, p) { return x.toFixed(p); },\n  \"g\": function(x, p) { return x.toPrecision(p); },\n  \"o\": function(x) { return Math.round(x).toString(8); },\n  \"p\": function(x, p) { return formatRounded(x * 100, p); },\n  \"r\": formatRounded,\n  \"s\": formatPrefixAuto,\n  \"X\": function(x) { return Math.round(x).toString(16).toUpperCase(); },\n  \"x\": function(x) { return Math.round(x).toString(16); }\n};\n","export default function(x) {\n  return x;\n}\n","import exponent from \"./exponent\";\nimport formatGroup from \"./formatGroup\";\nimport formatNumerals from \"./formatNumerals\";\nimport formatSpecifier from \"./formatSpecifier\";\nimport formatTrim from \"./formatTrim\";\nimport formatTypes from \"./formatTypes\";\nimport {prefixExponent} from \"./formatPrefixAuto\";\nimport identity from \"./identity\";\n\nvar prefixes = [\"y\",\"z\",\"a\",\"f\",\"p\",\"n\",\"\",\"m\",\"\",\"k\",\"M\",\"G\",\"T\",\"P\",\"E\",\"Z\",\"Y\"];\n\nexport default function(locale) {\n  var group = locale.grouping && locale.thousands ? formatGroup(locale.grouping, locale.thousands) : identity,\n      currency = locale.currency,\n      decimal = locale.decimal,\n      numerals = locale.numerals ? formatNumerals(locale.numerals) : identity,\n      percent = locale.percent || \"%\";\n\n  function newFormat(specifier) {\n    specifier = formatSpecifier(specifier);\n\n    var fill = specifier.fill,\n        align = specifier.align,\n        sign = specifier.sign,\n        symbol = specifier.symbol,\n        zero = specifier.zero,\n        width = specifier.width,\n        comma = specifier.comma,\n        precision = specifier.precision,\n        trim = specifier.trim,\n        type = specifier.type;\n\n    // The \"n\" type is an alias for \",g\".\n    if (type === \"n\") comma = true, type = \"g\";\n\n    // The \"\" type, and any invalid type, is an alias for \".12~g\".\n    else if (!formatTypes[type]) precision == null && (precision = 12), trim = true, type = \"g\";\n\n    // If zero fill is specified, padding goes after sign and before digits.\n    if (zero || (fill === \"0\" && align === \"=\")) zero = true, fill = \"0\", align = \"=\";\n\n    // Compute the prefix and suffix.\n    // For SI-prefix, the suffix is lazily computed.\n    var prefix = symbol === \"$\" ? currency[0] : symbol === \"#\" && /[boxX]/.test(type) ? \"0\" + type.toLowerCase() : \"\",\n        suffix = symbol === \"$\" ? currency[1] : /[%p]/.test(type) ? percent : \"\";\n\n    // What format function should we use?\n    // Is this an integer type?\n    // Can this type generate exponential notation?\n    var formatType = formatTypes[type],\n        maybeSuffix = /[defgprs%]/.test(type);\n\n    // Set the default precision if not specified,\n    // or clamp the specified precision to the supported range.\n    // For significant precision, it must be in [1, 21].\n    // For fixed precision, it must be in [0, 20].\n    precision = precision == null ? 6\n        : /[gprs]/.test(type) ? Math.max(1, Math.min(21, precision))\n        : Math.max(0, Math.min(20, precision));\n\n    function format(value) {\n      var valuePrefix = prefix,\n          valueSuffix = suffix,\n          i, n, c;\n\n      if (type === \"c\") {\n        valueSuffix = formatType(value) + valueSuffix;\n        value = \"\";\n      } else {\n        value = +value;\n\n        // Perform the initial formatting.\n        var valueNegative = value < 0;\n        value = formatType(Math.abs(value), precision);\n\n        // Trim insignificant zeros.\n        if (trim) value = formatTrim(value);\n\n        // If a negative value rounds to zero during formatting, treat as positive.\n        if (valueNegative && +value === 0) valueNegative = false;\n\n        // Compute the prefix and suffix.\n        valuePrefix = (valueNegative ? (sign === \"(\" ? sign : \"-\") : sign === \"-\" || sign === \"(\" ? \"\" : sign) + valuePrefix;\n        valueSuffix = (type === \"s\" ? prefixes[8 + prefixExponent / 3] : \"\") + valueSuffix + (valueNegative && sign === \"(\" ? \")\" : \"\");\n\n        // Break the formatted value into the integer value part that can be\n        // grouped, and fractional or exponential suffix part that is not.\n        if (maybeSuffix) {\n          i = -1, n = value.length;\n          while (++i < n) {\n            if (c = value.charCodeAt(i), 48 > c || c > 57) {\n              valueSuffix = (c === 46 ? decimal + value.slice(i + 1) : value.slice(i)) + valueSuffix;\n              value = value.slice(0, i);\n              break;\n            }\n          }\n        }\n      }\n\n      // If the fill character is not \"0\", grouping is applied before padding.\n      if (comma && !zero) value = group(value, Infinity);\n\n      // Compute the padding.\n      var length = valuePrefix.length + value.length + valueSuffix.length,\n          padding = length < width ? new Array(width - length + 1).join(fill) : \"\";\n\n      // If the fill character is \"0\", grouping is applied after padding.\n      if (comma && zero) value = group(padding + value, padding.length ? width - valueSuffix.length : Infinity), padding = \"\";\n\n      // Reconstruct the final output based on the desired alignment.\n      switch (align) {\n        case \"<\": value = valuePrefix + value + valueSuffix + padding; break;\n        case \"=\": value = valuePrefix + padding + value + valueSuffix; break;\n        case \"^\": value = padding.slice(0, length = padding.length >> 1) + valuePrefix + value + valueSuffix + padding.slice(length); break;\n        default: value = padding + valuePrefix + value + valueSuffix; break;\n      }\n\n      return numerals(value);\n    }\n\n    format.toString = function() {\n      return specifier + \"\";\n    };\n\n    return format;\n  }\n\n  function formatPrefix(specifier, value) {\n    var f = newFormat((specifier = formatSpecifier(specifier), specifier.type = \"f\", specifier)),\n        e = Math.max(-8, Math.min(8, Math.floor(exponent(value) / 3))) * 3,\n        k = Math.pow(10, -e),\n        prefix = prefixes[8 + e / 3];\n    return function(value) {\n      return f(k * value) + prefix;\n    };\n  }\n\n  return {\n    format: newFormat,\n    formatPrefix: formatPrefix\n  };\n}\n","import formatLocale from \"./locale\";\n\nvar locale;\nexport var format;\nexport var formatPrefix;\n\ndefaultLocale({\n  decimal: \".\",\n  thousands: \",\",\n  grouping: [3],\n  currency: [\"$\", \"\"]\n});\n\nexport default function defaultLocale(definition) {\n  locale = formatLocale(definition);\n  format = locale.format;\n  formatPrefix = locale.formatPrefix;\n  return locale;\n}\n","import exponent from \"./exponent\";\n\nexport default function(step) {\n  return Math.max(0, -exponent(Math.abs(step)));\n}\n","import exponent from \"./exponent\";\n\nexport default function(step, value) {\n  return Math.max(0, Math.max(-8, Math.min(8, Math.floor(exponent(value) / 3))) * 3 - exponent(Math.abs(step)));\n}\n","import exponent from \"./exponent\";\n\nexport default function(step, max) {\n  step = Math.abs(step), max = Math.abs(max) - step;\n  return Math.max(0, exponent(max) - exponent(step)) + 1;\n}\n","import { formatLocale } from 'd3-format';\n\nexport default function formatter(pattern, thousand, decimal) {\n  let locale,\n    d3format;\n\n  /**\n   * Format a value according to the specified pattern created at construct\n   * @private\n   *\n   * @param  {Number} value   The number to be formatted\n   * @return {String}         [description]\n   */\n  function format(value) {\n    return d3format(value);\n  }\n\n  /**\n    * Set the locale for the formatter\n    *\n    * @param  {Object} args   Locale object for formatting\n    * @return {Undefined}      Returns nothing\n    */\n  format.locale = function localeFn(settings) {\n    locale = formatLocale(settings);\n    d3format = locale.format(pattern);\n\n    return this;\n  };\n\n  /**\n   * Resets the formatter using format.locale\n   * @ignore\n   */\n  function reset() {\n    format.locale({\n      decimal: decimal || '.',\n      thousands: thousand || ',',\n      grouping: [3],\n      currency: ['$', '']\n    });\n  }\n  reset();\n\n  /**\n    * Format a value according to a specific pattern\n    * that is not the one specified in the constructor\n    *\n    * @param  {String} p   Pattern\n    * @param  {Number} v   Value\n    * @param  {String} t   Thousand\n    * @param  {String} d   Decimal\n    * @return {String}     Formatted value\n    */\n  format.format = function formatFn(p, v, t, d) {\n    if (t || d) {\n      thousand = t;\n      decimal = d;\n      reset();\n    }\n    return locale.format(p)(v);\n  };\n\n  /**\n   * Change the pattern on existing formatter\n   *\n   * @param  {String} p     Pattern (optional)\n   * @return {String}       Returns the pattern\n   */\n  format.pattern = function patternFn(p) {\n    if (p) {\n      pattern = p;\n      d3format = locale.format(p);\n    }\n    return pattern;\n  };\n\n  return format;\n}\n","var t0 = new Date,\n    t1 = new Date;\n\nexport default function newInterval(floori, offseti, count, field) {\n\n  function interval(date) {\n    return floori(date = new Date(+date)), date;\n  }\n\n  interval.floor = interval;\n\n  interval.ceil = function(date) {\n    return floori(date = new Date(date - 1)), offseti(date, 1), floori(date), date;\n  };\n\n  interval.round = function(date) {\n    var d0 = interval(date),\n        d1 = interval.ceil(date);\n    return date - d0 < d1 - date ? d0 : d1;\n  };\n\n  interval.offset = function(date, step) {\n    return offseti(date = new Date(+date), step == null ? 1 : Math.floor(step)), date;\n  };\n\n  interval.range = function(start, stop, step) {\n    var range = [], previous;\n    start = interval.ceil(start);\n    step = step == null ? 1 : Math.floor(step);\n    if (!(start < stop) || !(step > 0)) return range; // also handles Invalid Date\n    do range.push(previous = new Date(+start)), offseti(start, step), floori(start);\n    while (previous < start && start < stop);\n    return range;\n  };\n\n  interval.filter = function(test) {\n    return newInterval(function(date) {\n      if (date >= date) while (floori(date), !test(date)) date.setTime(date - 1);\n    }, function(date, step) {\n      if (date >= date) {\n        if (step < 0) while (++step <= 0) {\n          while (offseti(date, -1), !test(date)) {} // eslint-disable-line no-empty\n        } else while (--step >= 0) {\n          while (offseti(date, +1), !test(date)) {} // eslint-disable-line no-empty\n        }\n      }\n    });\n  };\n\n  if (count) {\n    interval.count = function(start, end) {\n      t0.setTime(+start), t1.setTime(+end);\n      floori(t0), floori(t1);\n      return Math.floor(count(t0, t1));\n    };\n\n    interval.every = function(step) {\n      step = Math.floor(step);\n      return !isFinite(step) || !(step > 0) ? null\n          : !(step > 1) ? interval\n          : interval.filter(field\n              ? function(d) { return field(d) % step === 0; }\n              : function(d) { return interval.count(0, d) % step === 0; });\n    };\n  }\n\n  return interval;\n}\n","import interval from \"./interval\";\n\nvar millisecond = interval(function() {\n  // noop\n}, function(date, step) {\n  date.setTime(+date + step);\n}, function(start, end) {\n  return end - start;\n});\n\n// An optimized implementation for this simple case.\nmillisecond.every = function(k) {\n  k = Math.floor(k);\n  if (!isFinite(k) || !(k > 0)) return null;\n  if (!(k > 1)) return millisecond;\n  return interval(function(date) {\n    date.setTime(Math.floor(date / k) * k);\n  }, function(date, step) {\n    date.setTime(+date + step * k);\n  }, function(start, end) {\n    return (end - start) / k;\n  });\n};\n\nexport default millisecond;\nexport var milliseconds = millisecond.range;\n","export var durationSecond = 1e3;\nexport var durationMinute = 6e4;\nexport var durationHour = 36e5;\nexport var durationDay = 864e5;\nexport var durationWeek = 6048e5;\n","import interval from \"./interval\";\nimport {durationSecond} from \"./duration\";\n\nvar second = interval(function(date) {\n  date.setTime(Math.floor(date / durationSecond) * durationSecond);\n}, function(date, step) {\n  date.setTime(+date + step * durationSecond);\n}, function(start, end) {\n  return (end - start) / durationSecond;\n}, function(date) {\n  return date.getUTCSeconds();\n});\n\nexport default second;\nexport var seconds = second.range;\n","import interval from \"./interval\";\nimport {durationMinute} from \"./duration\";\n\nvar minute = interval(function(date) {\n  date.setTime(Math.floor(date / durationMinute) * durationMinute);\n}, function(date, step) {\n  date.setTime(+date + step * durationMinute);\n}, function(start, end) {\n  return (end - start) / durationMinute;\n}, function(date) {\n  return date.getMinutes();\n});\n\nexport default minute;\nexport var minutes = minute.range;\n","import interval from \"./interval\";\nimport {durationHour, durationMinute} from \"./duration\";\n\nvar hour = interval(function(date) {\n  var offset = date.getTimezoneOffset() * durationMinute % durationHour;\n  if (offset < 0) offset += durationHour;\n  date.setTime(Math.floor((+date - offset) / durationHour) * durationHour + offset);\n}, function(date, step) {\n  date.setTime(+date + step * durationHour);\n}, function(start, end) {\n  return (end - start) / durationHour;\n}, function(date) {\n  return date.getHours();\n});\n\nexport default hour;\nexport var hours = hour.range;\n","import interval from \"./interval\";\nimport {durationDay, durationMinute} from \"./duration\";\n\nvar day = interval(function(date) {\n  date.setHours(0, 0, 0, 0);\n}, function(date, step) {\n  date.setDate(date.getDate() + step);\n}, function(start, end) {\n  return (end - start - (end.getTimezoneOffset() - start.getTimezoneOffset()) * durationMinute) / durationDay;\n}, function(date) {\n  return date.getDate() - 1;\n});\n\nexport default day;\nexport var days = day.range;\n","import interval from \"./interval\";\nimport {durationMinute, durationWeek} from \"./duration\";\n\nfunction weekday(i) {\n  return interval(function(date) {\n    date.setDate(date.getDate() - (date.getDay() + 7 - i) % 7);\n    date.setHours(0, 0, 0, 0);\n  }, function(date, step) {\n    date.setDate(date.getDate() + step * 7);\n  }, function(start, end) {\n    return (end - start - (end.getTimezoneOffset() - start.getTimezoneOffset()) * durationMinute) / durationWeek;\n  });\n}\n\nexport var sunday = weekday(0);\nexport var monday = weekday(1);\nexport var tuesday = weekday(2);\nexport var wednesday = weekday(3);\nexport var thursday = weekday(4);\nexport var friday = weekday(5);\nexport var saturday = weekday(6);\n\nexport var sundays = sunday.range;\nexport var mondays = monday.range;\nexport var tuesdays = tuesday.range;\nexport var wednesdays = wednesday.range;\nexport var thursdays = thursday.range;\nexport var fridays = friday.range;\nexport var saturdays = saturday.range;\n","import interval from \"./interval\";\n\nvar month = interval(function(date) {\n  date.setDate(1);\n  date.setHours(0, 0, 0, 0);\n}, function(date, step) {\n  date.setMonth(date.getMonth() + step);\n}, function(start, end) {\n  return end.getMonth() - start.getMonth() + (end.getFullYear() - start.getFullYear()) * 12;\n}, function(date) {\n  return date.getMonth();\n});\n\nexport default month;\nexport var months = month.range;\n","import interval from \"./interval\";\n\nvar year = interval(function(date) {\n  date.setMonth(0, 1);\n  date.setHours(0, 0, 0, 0);\n}, function(date, step) {\n  date.setFullYear(date.getFullYear() + step);\n}, function(start, end) {\n  return end.getFullYear() - start.getFullYear();\n}, function(date) {\n  return date.getFullYear();\n});\n\n// An optimized implementation for this simple case.\nyear.every = function(k) {\n  return !isFinite(k = Math.floor(k)) || !(k > 0) ? null : interval(function(date) {\n    date.setFullYear(Math.floor(date.getFullYear() / k) * k);\n    date.setMonth(0, 1);\n    date.setHours(0, 0, 0, 0);\n  }, function(date, step) {\n    date.setFullYear(date.getFullYear() + step * k);\n  });\n};\n\nexport default year;\nexport var years = year.range;\n","import interval from \"./interval\";\nimport {durationMinute} from \"./duration\";\n\nvar utcMinute = interval(function(date) {\n  date.setUTCSeconds(0, 0);\n}, function(date, step) {\n  date.setTime(+date + step * durationMinute);\n}, function(start, end) {\n  return (end - start) / durationMinute;\n}, function(date) {\n  return date.getUTCMinutes();\n});\n\nexport default utcMinute;\nexport var utcMinutes = utcMinute.range;\n","import interval from \"./interval\";\nimport {durationHour} from \"./duration\";\n\nvar utcHour = interval(function(date) {\n  date.setUTCMinutes(0, 0, 0);\n}, function(date, step) {\n  date.setTime(+date + step * durationHour);\n}, function(start, end) {\n  return (end - start) / durationHour;\n}, function(date) {\n  return date.getUTCHours();\n});\n\nexport default utcHour;\nexport var utcHours = utcHour.range;\n","import interval from \"./interval\";\nimport {durationDay} from \"./duration\";\n\nvar utcDay = interval(function(date) {\n  date.setUTCHours(0, 0, 0, 0);\n}, function(date, step) {\n  date.setUTCDate(date.getUTCDate() + step);\n}, function(start, end) {\n  return (end - start) / durationDay;\n}, function(date) {\n  return date.getUTCDate() - 1;\n});\n\nexport default utcDay;\nexport var utcDays = utcDay.range;\n","import interval from \"./interval\";\nimport {durationWeek} from \"./duration\";\n\nfunction utcWeekday(i) {\n  return interval(function(date) {\n    date.setUTCDate(date.getUTCDate() - (date.getUTCDay() + 7 - i) % 7);\n    date.setUTCHours(0, 0, 0, 0);\n  }, function(date, step) {\n    date.setUTCDate(date.getUTCDate() + step * 7);\n  }, function(start, end) {\n    return (end - start) / durationWeek;\n  });\n}\n\nexport var utcSunday = utcWeekday(0);\nexport var utcMonday = utcWeekday(1);\nexport var utcTuesday = utcWeekday(2);\nexport var utcWednesday = utcWeekday(3);\nexport var utcThursday = utcWeekday(4);\nexport var utcFriday = utcWeekday(5);\nexport var utcSaturday = utcWeekday(6);\n\nexport var utcSundays = utcSunday.range;\nexport var utcMondays = utcMonday.range;\nexport var utcTuesdays = utcTuesday.range;\nexport var utcWednesdays = utcWednesday.range;\nexport var utcThursdays = utcThursday.range;\nexport var utcFridays = utcFriday.range;\nexport var utcSaturdays = utcSaturday.range;\n","import interval from \"./interval\";\n\nvar utcMonth = interval(function(date) {\n  date.setUTCDate(1);\n  date.setUTCHours(0, 0, 0, 0);\n}, function(date, step) {\n  date.setUTCMonth(date.getUTCMonth() + step);\n}, function(start, end) {\n  return end.getUTCMonth() - start.getUTCMonth() + (end.getUTCFullYear() - start.getUTCFullYear()) * 12;\n}, function(date) {\n  return date.getUTCMonth();\n});\n\nexport default utcMonth;\nexport var utcMonths = utcMonth.range;\n","import interval from \"./interval\";\n\nvar utcYear = interval(function(date) {\n  date.setUTCMonth(0, 1);\n  date.setUTCHours(0, 0, 0, 0);\n}, function(date, step) {\n  date.setUTCFullYear(date.getUTCFullYear() + step);\n}, function(start, end) {\n  return end.getUTCFullYear() - start.getUTCFullYear();\n}, function(date) {\n  return date.getUTCFullYear();\n});\n\n// An optimized implementation for this simple case.\nutcYear.every = function(k) {\n  return !isFinite(k = Math.floor(k)) || !(k > 0) ? null : interval(function(date) {\n    date.setUTCFullYear(Math.floor(date.getUTCFullYear() / k) * k);\n    date.setUTCMonth(0, 1);\n    date.setUTCHours(0, 0, 0, 0);\n  }, function(date, step) {\n    date.setUTCFullYear(date.getUTCFullYear() + step * k);\n  });\n};\n\nexport default utcYear;\nexport var utcYears = utcYear.range;\n","import {\n  timeDay,\n  timeSunday,\n  timeMonday,\n  timeThursday,\n  timeYear,\n  utcDay,\n  utcSunday,\n  utcMonday,\n  utcThursday,\n  utcYear\n} from \"d3-time\";\n\nfunction localDate(d) {\n  if (0 <= d.y && d.y < 100) {\n    var date = new Date(-1, d.m, d.d, d.H, d.M, d.S, d.L);\n    date.setFullYear(d.y);\n    return date;\n  }\n  return new Date(d.y, d.m, d.d, d.H, d.M, d.S, d.L);\n}\n\nfunction utcDate(d) {\n  if (0 <= d.y && d.y < 100) {\n    var date = new Date(Date.UTC(-1, d.m, d.d, d.H, d.M, d.S, d.L));\n    date.setUTCFullYear(d.y);\n    return date;\n  }\n  return new Date(Date.UTC(d.y, d.m, d.d, d.H, d.M, d.S, d.L));\n}\n\nfunction newYear(y) {\n  return {y: y, m: 0, d: 1, H: 0, M: 0, S: 0, L: 0};\n}\n\nexport default function formatLocale(locale) {\n  var locale_dateTime = locale.dateTime,\n      locale_date = locale.date,\n      locale_time = locale.time,\n      locale_periods = locale.periods,\n      locale_weekdays = locale.days,\n      locale_shortWeekdays = locale.shortDays,\n      locale_months = locale.months,\n      locale_shortMonths = locale.shortMonths;\n\n  var periodRe = formatRe(locale_periods),\n      periodLookup = formatLookup(locale_periods),\n      weekdayRe = formatRe(locale_weekdays),\n      weekdayLookup = formatLookup(locale_weekdays),\n      shortWeekdayRe = formatRe(locale_shortWeekdays),\n      shortWeekdayLookup = formatLookup(locale_shortWeekdays),\n      monthRe = formatRe(locale_months),\n      monthLookup = formatLookup(locale_months),\n      shortMonthRe = formatRe(locale_shortMonths),\n      shortMonthLookup = formatLookup(locale_shortMonths);\n\n  var formats = {\n    \"a\": formatShortWeekday,\n    \"A\": formatWeekday,\n    \"b\": formatShortMonth,\n    \"B\": formatMonth,\n    \"c\": null,\n    \"d\": formatDayOfMonth,\n    \"e\": formatDayOfMonth,\n    \"f\": formatMicroseconds,\n    \"H\": formatHour24,\n    \"I\": formatHour12,\n    \"j\": formatDayOfYear,\n    \"L\": formatMilliseconds,\n    \"m\": formatMonthNumber,\n    \"M\": formatMinutes,\n    \"p\": formatPeriod,\n    \"Q\": formatUnixTimestamp,\n    \"s\": formatUnixTimestampSeconds,\n    \"S\": formatSeconds,\n    \"u\": formatWeekdayNumberMonday,\n    \"U\": formatWeekNumberSunday,\n    \"V\": formatWeekNumberISO,\n    \"w\": formatWeekdayNumberSunday,\n    \"W\": formatWeekNumberMonday,\n    \"x\": null,\n    \"X\": null,\n    \"y\": formatYear,\n    \"Y\": formatFullYear,\n    \"Z\": formatZone,\n    \"%\": formatLiteralPercent\n  };\n\n  var utcFormats = {\n    \"a\": formatUTCShortWeekday,\n    \"A\": formatUTCWeekday,\n    \"b\": formatUTCShortMonth,\n    \"B\": formatUTCMonth,\n    \"c\": null,\n    \"d\": formatUTCDayOfMonth,\n    \"e\": formatUTCDayOfMonth,\n    \"f\": formatUTCMicroseconds,\n    \"H\": formatUTCHour24,\n    \"I\": formatUTCHour12,\n    \"j\": formatUTCDayOfYear,\n    \"L\": formatUTCMilliseconds,\n    \"m\": formatUTCMonthNumber,\n    \"M\": formatUTCMinutes,\n    \"p\": formatUTCPeriod,\n    \"Q\": formatUnixTimestamp,\n    \"s\": formatUnixTimestampSeconds,\n    \"S\": formatUTCSeconds,\n    \"u\": formatUTCWeekdayNumberMonday,\n    \"U\": formatUTCWeekNumberSunday,\n    \"V\": formatUTCWeekNumberISO,\n    \"w\": formatUTCWeekdayNumberSunday,\n    \"W\": formatUTCWeekNumberMonday,\n    \"x\": null,\n    \"X\": null,\n    \"y\": formatUTCYear,\n    \"Y\": formatUTCFullYear,\n    \"Z\": formatUTCZone,\n    \"%\": formatLiteralPercent\n  };\n\n  var parses = {\n    \"a\": parseShortWeekday,\n    \"A\": parseWeekday,\n    \"b\": parseShortMonth,\n    \"B\": parseMonth,\n    \"c\": parseLocaleDateTime,\n    \"d\": parseDayOfMonth,\n    \"e\": parseDayOfMonth,\n    \"f\": parseMicroseconds,\n    \"H\": parseHour24,\n    \"I\": parseHour24,\n    \"j\": parseDayOfYear,\n    \"L\": parseMilliseconds,\n    \"m\": parseMonthNumber,\n    \"M\": parseMinutes,\n    \"p\": parsePeriod,\n    \"Q\": parseUnixTimestamp,\n    \"s\": parseUnixTimestampSeconds,\n    \"S\": parseSeconds,\n    \"u\": parseWeekdayNumberMonday,\n    \"U\": parseWeekNumberSunday,\n    \"V\": parseWeekNumberISO,\n    \"w\": parseWeekdayNumberSunday,\n    \"W\": parseWeekNumberMonday,\n    \"x\": parseLocaleDate,\n    \"X\": parseLocaleTime,\n    \"y\": parseYear,\n    \"Y\": parseFullYear,\n    \"Z\": parseZone,\n    \"%\": parseLiteralPercent\n  };\n\n  // These recursive directive definitions must be deferred.\n  formats.x = newFormat(locale_date, formats);\n  formats.X = newFormat(locale_time, formats);\n  formats.c = newFormat(locale_dateTime, formats);\n  utcFormats.x = newFormat(locale_date, utcFormats);\n  utcFormats.X = newFormat(locale_time, utcFormats);\n  utcFormats.c = newFormat(locale_dateTime, utcFormats);\n\n  function newFormat(specifier, formats) {\n    return function(date) {\n      var string = [],\n          i = -1,\n          j = 0,\n          n = specifier.length,\n          c,\n          pad,\n          format;\n\n      if (!(date instanceof Date)) date = new Date(+date);\n\n      while (++i < n) {\n        if (specifier.charCodeAt(i) === 37) {\n          string.push(specifier.slice(j, i));\n          if ((pad = pads[c = specifier.charAt(++i)]) != null) c = specifier.charAt(++i);\n          else pad = c === \"e\" ? \" \" : \"0\";\n          if (format = formats[c]) c = format(date, pad);\n          string.push(c);\n          j = i + 1;\n        }\n      }\n\n      string.push(specifier.slice(j, i));\n      return string.join(\"\");\n    };\n  }\n\n  function newParse(specifier, newDate) {\n    return function(string) {\n      var d = newYear(1900),\n          i = parseSpecifier(d, specifier, string += \"\", 0),\n          week, day;\n      if (i != string.length) return null;\n\n      // If a UNIX timestamp is specified, return it.\n      if (\"Q\" in d) return new Date(d.Q);\n\n      // The am-pm flag is 0 for AM, and 1 for PM.\n      if (\"p\" in d) d.H = d.H % 12 + d.p * 12;\n\n      // Convert day-of-week and week-of-year to day-of-year.\n      if (\"V\" in d) {\n        if (d.V < 1 || d.V > 53) return null;\n        if (!(\"w\" in d)) d.w = 1;\n        if (\"Z\" in d) {\n          week = utcDate(newYear(d.y)), day = week.getUTCDay();\n          week = day > 4 || day === 0 ? utcMonday.ceil(week) : utcMonday(week);\n          week = utcDay.offset(week, (d.V - 1) * 7);\n          d.y = week.getUTCFullYear();\n          d.m = week.getUTCMonth();\n          d.d = week.getUTCDate() + (d.w + 6) % 7;\n        } else {\n          week = newDate(newYear(d.y)), day = week.getDay();\n          week = day > 4 || day === 0 ? timeMonday.ceil(week) : timeMonday(week);\n          week = timeDay.offset(week, (d.V - 1) * 7);\n          d.y = week.getFullYear();\n          d.m = week.getMonth();\n          d.d = week.getDate() + (d.w + 6) % 7;\n        }\n      } else if (\"W\" in d || \"U\" in d) {\n        if (!(\"w\" in d)) d.w = \"u\" in d ? d.u % 7 : \"W\" in d ? 1 : 0;\n        day = \"Z\" in d ? utcDate(newYear(d.y)).getUTCDay() : newDate(newYear(d.y)).getDay();\n        d.m = 0;\n        d.d = \"W\" in d ? (d.w + 6) % 7 + d.W * 7 - (day + 5) % 7 : d.w + d.U * 7 - (day + 6) % 7;\n      }\n\n      // If a time zone is specified, all fields are interpreted as UTC and then\n      // offset according to the specified time zone.\n      if (\"Z\" in d) {\n        d.H += d.Z / 100 | 0;\n        d.M += d.Z % 100;\n        return utcDate(d);\n      }\n\n      // Otherwise, all fields are in local time.\n      return newDate(d);\n    };\n  }\n\n  function parseSpecifier(d, specifier, string, j) {\n    var i = 0,\n        n = specifier.length,\n        m = string.length,\n        c,\n        parse;\n\n    while (i < n) {\n      if (j >= m) return -1;\n      c = specifier.charCodeAt(i++);\n      if (c === 37) {\n        c = specifier.charAt(i++);\n        parse = parses[c in pads ? specifier.charAt(i++) : c];\n        if (!parse || ((j = parse(d, string, j)) < 0)) return -1;\n      } else if (c != string.charCodeAt(j++)) {\n        return -1;\n      }\n    }\n\n    return j;\n  }\n\n  function parsePeriod(d, string, i) {\n    var n = periodRe.exec(string.slice(i));\n    return n ? (d.p = periodLookup[n[0].toLowerCase()], i + n[0].length) : -1;\n  }\n\n  function parseShortWeekday(d, string, i) {\n    var n = shortWeekdayRe.exec(string.slice(i));\n    return n ? (d.w = shortWeekdayLookup[n[0].toLowerCase()], i + n[0].length) : -1;\n  }\n\n  function parseWeekday(d, string, i) {\n    var n = weekdayRe.exec(string.slice(i));\n    return n ? (d.w = weekdayLookup[n[0].toLowerCase()], i + n[0].length) : -1;\n  }\n\n  function parseShortMonth(d, string, i) {\n    var n = shortMonthRe.exec(string.slice(i));\n    return n ? (d.m = shortMonthLookup[n[0].toLowerCase()], i + n[0].length) : -1;\n  }\n\n  function parseMonth(d, string, i) {\n    var n = monthRe.exec(string.slice(i));\n    return n ? (d.m = monthLookup[n[0].toLowerCase()], i + n[0].length) : -1;\n  }\n\n  function parseLocaleDateTime(d, string, i) {\n    return parseSpecifier(d, locale_dateTime, string, i);\n  }\n\n  function parseLocaleDate(d, string, i) {\n    return parseSpecifier(d, locale_date, string, i);\n  }\n\n  function parseLocaleTime(d, string, i) {\n    return parseSpecifier(d, locale_time, string, i);\n  }\n\n  function formatShortWeekday(d) {\n    return locale_shortWeekdays[d.getDay()];\n  }\n\n  function formatWeekday(d) {\n    return locale_weekdays[d.getDay()];\n  }\n\n  function formatShortMonth(d) {\n    return locale_shortMonths[d.getMonth()];\n  }\n\n  function formatMonth(d) {\n    return locale_months[d.getMonth()];\n  }\n\n  function formatPeriod(d) {\n    return locale_periods[+(d.getHours() >= 12)];\n  }\n\n  function formatUTCShortWeekday(d) {\n    return locale_shortWeekdays[d.getUTCDay()];\n  }\n\n  function formatUTCWeekday(d) {\n    return locale_weekdays[d.getUTCDay()];\n  }\n\n  function formatUTCShortMonth(d) {\n    return locale_shortMonths[d.getUTCMonth()];\n  }\n\n  function formatUTCMonth(d) {\n    return locale_months[d.getUTCMonth()];\n  }\n\n  function formatUTCPeriod(d) {\n    return locale_periods[+(d.getUTCHours() >= 12)];\n  }\n\n  return {\n    format: function(specifier) {\n      var f = newFormat(specifier += \"\", formats);\n      f.toString = function() { return specifier; };\n      return f;\n    },\n    parse: function(specifier) {\n      var p = newParse(specifier += \"\", localDate);\n      p.toString = function() { return specifier; };\n      return p;\n    },\n    utcFormat: function(specifier) {\n      var f = newFormat(specifier += \"\", utcFormats);\n      f.toString = function() { return specifier; };\n      return f;\n    },\n    utcParse: function(specifier) {\n      var p = newParse(specifier, utcDate);\n      p.toString = function() { return specifier; };\n      return p;\n    }\n  };\n}\n\nvar pads = {\"-\": \"\", \"_\": \" \", \"0\": \"0\"},\n    numberRe = /^\\s*\\d+/, // note: ignores next directive\n    percentRe = /^%/,\n    requoteRe = /[\\\\^$*+?|[\\]().{}]/g;\n\nfunction pad(value, fill, width) {\n  var sign = value < 0 ? \"-\" : \"\",\n      string = (sign ? -value : value) + \"\",\n      length = string.length;\n  return sign + (length < width ? new Array(width - length + 1).join(fill) + string : string);\n}\n\nfunction requote(s) {\n  return s.replace(requoteRe, \"\\\\$&\");\n}\n\nfunction formatRe(names) {\n  return new RegExp(\"^(?:\" + names.map(requote).join(\"|\") + \")\", \"i\");\n}\n\nfunction formatLookup(names) {\n  var map = {}, i = -1, n = names.length;\n  while (++i < n) map[names[i].toLowerCase()] = i;\n  return map;\n}\n\nfunction parseWeekdayNumberSunday(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 1));\n  return n ? (d.w = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseWeekdayNumberMonday(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 1));\n  return n ? (d.u = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseWeekNumberSunday(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.U = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseWeekNumberISO(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.V = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseWeekNumberMonday(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.W = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseFullYear(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 4));\n  return n ? (d.y = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseYear(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.y = +n[0] + (+n[0] > 68 ? 1900 : 2000), i + n[0].length) : -1;\n}\n\nfunction parseZone(d, string, i) {\n  var n = /^(Z)|([+-]\\d\\d)(?::?(\\d\\d))?/.exec(string.slice(i, i + 6));\n  return n ? (d.Z = n[1] ? 0 : -(n[2] + (n[3] || \"00\")), i + n[0].length) : -1;\n}\n\nfunction parseMonthNumber(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.m = n[0] - 1, i + n[0].length) : -1;\n}\n\nfunction parseDayOfMonth(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.d = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseDayOfYear(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 3));\n  return n ? (d.m = 0, d.d = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseHour24(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.H = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseMinutes(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.M = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseSeconds(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.S = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseMilliseconds(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 3));\n  return n ? (d.L = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseMicroseconds(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 6));\n  return n ? (d.L = Math.floor(n[0] / 1000), i + n[0].length) : -1;\n}\n\nfunction parseLiteralPercent(d, string, i) {\n  var n = percentRe.exec(string.slice(i, i + 1));\n  return n ? i + n[0].length : -1;\n}\n\nfunction parseUnixTimestamp(d, string, i) {\n  var n = numberRe.exec(string.slice(i));\n  return n ? (d.Q = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseUnixTimestampSeconds(d, string, i) {\n  var n = numberRe.exec(string.slice(i));\n  return n ? (d.Q = (+n[0]) * 1000, i + n[0].length) : -1;\n}\n\nfunction formatDayOfMonth(d, p) {\n  return pad(d.getDate(), p, 2);\n}\n\nfunction formatHour24(d, p) {\n  return pad(d.getHours(), p, 2);\n}\n\nfunction formatHour12(d, p) {\n  return pad(d.getHours() % 12 || 12, p, 2);\n}\n\nfunction formatDayOfYear(d, p) {\n  return pad(1 + timeDay.count(timeYear(d), d), p, 3);\n}\n\nfunction formatMilliseconds(d, p) {\n  return pad(d.getMilliseconds(), p, 3);\n}\n\nfunction formatMicroseconds(d, p) {\n  return formatMilliseconds(d, p) + \"000\";\n}\n\nfunction formatMonthNumber(d, p) {\n  return pad(d.getMonth() + 1, p, 2);\n}\n\nfunction formatMinutes(d, p) {\n  return pad(d.getMinutes(), p, 2);\n}\n\nfunction formatSeconds(d, p) {\n  return pad(d.getSeconds(), p, 2);\n}\n\nfunction formatWeekdayNumberMonday(d) {\n  var day = d.getDay();\n  return day === 0 ? 7 : day;\n}\n\nfunction formatWeekNumberSunday(d, p) {\n  return pad(timeSunday.count(timeYear(d), d), p, 2);\n}\n\nfunction formatWeekNumberISO(d, p) {\n  var day = d.getDay();\n  d = (day >= 4 || day === 0) ? timeThursday(d) : timeThursday.ceil(d);\n  return pad(timeThursday.count(timeYear(d), d) + (timeYear(d).getDay() === 4), p, 2);\n}\n\nfunction formatWeekdayNumberSunday(d) {\n  return d.getDay();\n}\n\nfunction formatWeekNumberMonday(d, p) {\n  return pad(timeMonday.count(timeYear(d), d), p, 2);\n}\n\nfunction formatYear(d, p) {\n  return pad(d.getFullYear() % 100, p, 2);\n}\n\nfunction formatFullYear(d, p) {\n  return pad(d.getFullYear() % 10000, p, 4);\n}\n\nfunction formatZone(d) {\n  var z = d.getTimezoneOffset();\n  return (z > 0 ? \"-\" : (z *= -1, \"+\"))\n      + pad(z / 60 | 0, \"0\", 2)\n      + pad(z % 60, \"0\", 2);\n}\n\nfunction formatUTCDayOfMonth(d, p) {\n  return pad(d.getUTCDate(), p, 2);\n}\n\nfunction formatUTCHour24(d, p) {\n  return pad(d.getUTCHours(), p, 2);\n}\n\nfunction formatUTCHour12(d, p) {\n  return pad(d.getUTCHours() % 12 || 12, p, 2);\n}\n\nfunction formatUTCDayOfYear(d, p) {\n  return pad(1 + utcDay.count(utcYear(d), d), p, 3);\n}\n\nfunction formatUTCMilliseconds(d, p) {\n  return pad(d.getUTCMilliseconds(), p, 3);\n}\n\nfunction formatUTCMicroseconds(d, p) {\n  return formatUTCMilliseconds(d, p) + \"000\";\n}\n\nfunction formatUTCMonthNumber(d, p) {\n  return pad(d.getUTCMonth() + 1, p, 2);\n}\n\nfunction formatUTCMinutes(d, p) {\n  return pad(d.getUTCMinutes(), p, 2);\n}\n\nfunction formatUTCSeconds(d, p) {\n  return pad(d.getUTCSeconds(), p, 2);\n}\n\nfunction formatUTCWeekdayNumberMonday(d) {\n  var dow = d.getUTCDay();\n  return dow === 0 ? 7 : dow;\n}\n\nfunction formatUTCWeekNumberSunday(d, p) {\n  return pad(utcSunday.count(utcYear(d), d), p, 2);\n}\n\nfunction formatUTCWeekNumberISO(d, p) {\n  var day = d.getUTCDay();\n  d = (day >= 4 || day === 0) ? utcThursday(d) : utcThursday.ceil(d);\n  return pad(utcThursday.count(utcYear(d), d) + (utcYear(d).getUTCDay() === 4), p, 2);\n}\n\nfunction formatUTCWeekdayNumberSunday(d) {\n  return d.getUTCDay();\n}\n\nfunction formatUTCWeekNumberMonday(d, p) {\n  return pad(utcMonday.count(utcYear(d), d), p, 2);\n}\n\nfunction formatUTCYear(d, p) {\n  return pad(d.getUTCFullYear() % 100, p, 2);\n}\n\nfunction formatUTCFullYear(d, p) {\n  return pad(d.getUTCFullYear() % 10000, p, 4);\n}\n\nfunction formatUTCZone() {\n  return \"+0000\";\n}\n\nfunction formatLiteralPercent() {\n  return \"%\";\n}\n\nfunction formatUnixTimestamp(d) {\n  return +d;\n}\n\nfunction formatUnixTimestampSeconds(d) {\n  return Math.floor(+d / 1000);\n}\n","import formatLocale from \"./locale\";\n\nvar locale;\nexport var timeFormat;\nexport var timeParse;\nexport var utcFormat;\nexport var utcParse;\n\ndefaultLocale({\n  dateTime: \"%x, %X\",\n  date: \"%-m/%-d/%Y\",\n  time: \"%-I:%M:%S %p\",\n  periods: [\"AM\", \"PM\"],\n  days: [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"],\n  shortDays: [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"],\n  months: [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"],\n  shortMonths: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"]\n});\n\nexport default function defaultLocale(definition) {\n  locale = formatLocale(definition);\n  timeFormat = locale.format;\n  timeParse = locale.parse;\n  utcFormat = locale.utcFormat;\n  utcParse = locale.utcParse;\n  return locale;\n}\n","import {utcFormat} from \"./defaultLocale\";\n\nexport var isoSpecifier = \"%Y-%m-%dT%H:%M:%S.%LZ\";\n\nfunction formatIsoNative(date) {\n  return date.toISOString();\n}\n\nvar formatIso = Date.prototype.toISOString\n    ? formatIsoNative\n    : utcFormat(isoSpecifier);\n\nexport default formatIso;\n","import {isoSpecifier} from \"./isoFormat\";\nimport {utcParse} from \"./defaultLocale\";\n\nfunction parseIsoNative(string) {\n  var date = new Date(string);\n  return isNaN(date) ? null : date;\n}\n\nvar parseIso = +new Date(\"2000-01-01T00:00:00.000Z\")\n    ? parseIsoNative\n    : utcParse(isoSpecifier);\n\nexport default parseIso;\n","import { timeFormatLocale } from 'd3-time-format';\n\nexport default function formatter(pattern) { // eslint-disable-line import/prefer-default-export\n  let locale = timeFormatLocale({\n    dateTime: '%x, %X',\n    date: '%-m/%-d/%Y',\n    time: '%-I:%M:%S %p',\n    periods: ['AM', 'PM'],\n    days: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],\n    shortDays: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\n    months: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],\n    shortMonths: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']\n  });\n\n  let d3format = locale.format(pattern);\n\n  /**\n   * Format a value according to the specified pattern created at construct\n   *\n   * @param  {Date} value   The number to be formatted\n   * @return {String}         [description]\n   * @private\n   */\n  function format(value) {\n    return d3format(value);\n  }\n\n  /**\n    * Format a value according to a specific pattern\n    * that is not the one specified in the constructor\n    *\n    * @param  {String} p   Pattern\n    * @param  {Date} v   Value\n    * @return {String}     Formatted value\n    */\n  format.format = function formatFn(p, v) {\n    return locale.format(p)(v);\n  };\n\n  /**\n   * Set the locale for the formatter\n   *\n   * @param  {Object} args   Locale object for formatting\n   * @return {Undefined}      Returns nothing\n   */\n  format.locale = function localeFn(...args) {\n    locale = timeFormatLocale(...args);\n    d3format = locale.format(pattern);\n\n    return this;\n  };\n\n  /**\n   * Parse a string to a date according to a pattern\n   *\n   * @param  {String} p   Pattern\n   * @param  {String} v   Value\n   * @return {Date}     Date\n   */\n  format.parse = function parse(p, v) {\n    return locale.parse(p)(v);\n  };\n\n  /**\n   * Returns a parser that parses strings to date according to the pattern\n   *\n   * @param  {String} p   Pattern\n   * @return {Function}   Parser\n   */\n  format.parsePattern = function parsePattern(p) {\n    return locale.parse(p);\n  };\n\n  return format;\n}\n","import registry from '../utils/registry';\n\nimport { numberFormat as d3NumberFormatter, timeFormat as d3TimeFormatter } from './d3';\n\nconst formatterRegistry = registry();\n\nformatterRegistry('d3-number', d3NumberFormatter);\nformatterRegistry('d3-time', d3TimeFormatter);\n\nexport { formatterRegistry as default };\n","/* eslint no-return-assign: 0 */\nimport formatterFn from '../formatter';\n\n// TODO - decide whether usage of .call() is appropriate when invoking accessors, if yes then arrow functions are not allowed!\n\nconst getFormatter = (data) => {\n  if (typeof data.formatter === 'function') {\n    return data.formatter();\n  }\n  const f = data.formatter || {};\n  return formatterFn(f.type || 'd3-number')(f.format || '');\n};\n\nconst accessors = {\n  id: data => `${data.source}/${data.key || data.title}`,\n  key: data => String(data.key || data.title),\n  tags: data => data.tags,\n  min: data => data.min,\n  max: data => data.max,\n  type: data => data.type,\n  title: data => String(data.title),\n  values: data => data.values,\n  value: v => v,\n  label: v => v,\n  formatter: data => getFormatter(data)\n};\n\n/**\n * Create a new field with default settings\n * @ignore\n * @return {field} Data field\n */\nexport default function field(data, {\n  id = accessors.id,\n  key = accessors.key,\n  min = accessors.min,\n  max = accessors.max,\n  type = accessors.type,\n  tags = accessors.tags,\n  title = accessors.title,\n  values = accessors.values,\n  value = accessors.value,\n  label = accessors.label,\n  formatter = accessors.formatter\n} = {}) {\n  /**\n   * @alias field\n   */\n  const f = {\n\n    /**\n     * Returns this field's id\n     * @returns {string}\n     */\n    id: () => id(data),\n\n    /**\n     * Returns this field's key\n     * @returns {string}\n     */\n    key: () => key(data),\n\n    /**\n     * Returns the input data\n     * @returns {any}\n     */\n    raw: () => data,\n    /**\n     * Returns the tags.\n     * @return {Array<string>}\n     */\n    tags: () => tags(data),\n\n    /**\n     * Returns this field's type: 'dimension' or 'measure'.\n     * @return {string}\n     */\n    type: () => type(data),\n\n    /**\n     * Returns the min value of this field.\n     * @return {number}\n     */\n    min: () => min(data),\n\n    /**\n     * Returns the max value of this field.\n     * @return {number}\n     */\n    max: () => max(data),\n\n    /**\n     * Returns this field's title.\n     * @return {string}\n     */\n    title: () => title(data),\n\n    /**\n     * Returns the values of this field.\n     * @return {Array<datum-extract>}\n     */\n    items: () => values(data),\n\n    /**\n     * Returns a formatter adapted to the content of this field.\n     */\n    formatter: () => formatter(data),\n\n    value,\n    label\n  };\n\n  return f;\n}\n","import {\n  stack,\n  stackOrderAscending,\n  stackOrderInsideOut,\n  stackOrderNone,\n  stackOrderReverse,\n  stackOffsetDiverging,\n  stackOffsetNone,\n  stackOffsetSilhouette,\n  stackOffsetExpand,\n  stackOffsetWiggle\n} from 'd3-shape';\nimport fieldFn from './field';\n\nconst OFFSETS = {\n  diverging: stackOffsetDiverging,\n  none: stackOffsetNone,\n  silhouette: stackOffsetSilhouette,\n  expand: stackOffsetExpand,\n  wiggle: stackOffsetWiggle\n};\n\nconst ORDERS = {\n  ascending: stackOrderAscending,\n  insideout: stackOrderInsideOut,\n  none: stackOrderNone,\n  reverse: stackOrderReverse\n};\n\nfunction stacked(data, config, ds) {\n  const stackIds = {};\n  const stackFn = config.stackKey;\n  const valueFn = config.value;\n  const startProp = config.startProp || 'start';\n  const endProp = config.endProp || 'end';\n  const offset = config.offset || 'none';\n  const order = config.order || 'none';\n  const valueRef = config.valueRef || '';\n\n  let maxStackCount = 0;\n\n  let valueFields = {};\n\n  for (let i = 0; i < data.items.length; i++) {\n    let p = data.items[i];\n    let sourceField = valueRef ? p[valueRef] : null;\n    if (sourceField && sourceField.source) {\n      let ff = `${sourceField.source.key || ''}/${sourceField.source.field}`;\n      if (!valueFields[ff]) {\n        valueFields[ff] = sourceField.source;\n      }\n    }\n    let sid = stackFn(p);\n    stackIds[sid] = stackIds[sid] || { items: [] };\n    stackIds[sid].items.push(p);\n\n    maxStackCount = Math.max(maxStackCount, stackIds[sid].items.length);\n  }\n\n  const keys = Array.apply(null, { length: maxStackCount }).map(Number.call, Number); // eslint-disable-line\n  const matrix = Object.keys(stackIds).map(sid => stackIds[sid].items);\n\n  const d3Stack = stack()\n    .keys(keys)\n    .value((s, key) => (s[key] ? valueFn(s[key]) : 0))\n    .order(ORDERS[order])\n    .offset(OFFSETS[offset]);\n\n  let series = d3Stack(matrix);\n  let values = [];\n\n  for (let i = 0; i < series.length; i++) {\n    let serie = series[i];\n    for (let s = 0; s < serie.length; s++) {\n      let range = serie[s];\n      let item = serie[s].data[serie.key];\n      if (!item) {\n        continue;\n      }\n      item[startProp] = { value: range[0] };\n      item[endProp] = { value: range[1] };\n      values.push(range[0], range[1]);\n    }\n  }\n\n  let stackedFields = Object.keys(valueFields).map((f) => {\n    let dSource = ds(valueFields[f].key);\n    return dSource ? dSource.field(valueFields[f].field) : null;\n  }).filter(f => !!f);\n\n  const field = fieldFn({\n    title: stackedFields.map(f => f.title()).join(', '),\n    min: Math.min(...values),\n    max: Math.max(...values),\n    type: 'measure',\n    formatter: stackedFields[0] ? stackedFields[0].formatter : undefined\n  });\n  data.fields.push(field);\n}\n\nexport { stacked as default };\n","import stack from './stack';\n\nexport default function extract(dataConfig, data = {}, opts = {}) {\n  const extracted = {\n    // items: [],\n    // fields: [],\n    // source: null,\n    // value: null,\n    // label: null,\n    // children: null,\n    // root: null,\n    // graph: null\n  };\n\n  const logger = opts.logger;\n\n  if (Array.isArray(dataConfig)) { // if data is an array, assume it's manual data input -> normalize\n    extracted.items = dataConfig.map(v => ({ value: v, label: String(v) }));\n  } else if (dataConfig) {\n    if ('collection' in dataConfig) {\n      return data.collection(dataConfig.collection);\n    }\n    const source = data.dataset ? data.dataset(dataConfig.source) : null;\n    let valueFn = dataConfig.value || (d => d);\n    let labelFn = dataConfig.label || (d => d);\n    if (dataConfig.groupBy || dataConfig.mapTo) { // DEPRECATION\n      logger.warn('Deprecated \"data\" configuration', dataConfig);\n      extracted.items = [];\n    } else if (dataConfig.hierarchy) {\n      extracted.root = source.hierarchy ? source.hierarchy(dataConfig.hierarchy) : null;\n    } else if (dataConfig.items) {\n      extracted.items = dataConfig.items.map(v => ({ value: valueFn(v), label: String(labelFn(v)) }));\n    } else if (dataConfig.extract) {\n      const extractionsConfigs = Array.isArray(dataConfig.extract) ? dataConfig.extract : [dataConfig.extract];\n      extracted.items = [];\n      const sourceFields = [];\n      extractionsConfigs.forEach((cfg) => {\n        const s = cfg.source ? data.dataset(cfg.source) : source;\n        if (!s) {\n          return;\n        }\n        extracted.items.push(...s.extract(cfg));\n        if (typeof cfg.field !== 'undefined') {\n          sourceFields.push(s.field(cfg.field));\n        }\n      });\n      if (sourceFields.length) {\n        extracted.fields = sourceFields;\n      }\n      if (dataConfig.amend && Array.isArray(dataConfig.amend)) {\n        extracted.items.push(...dataConfig.amend);\n      }\n    } else if (typeof dataConfig.field !== 'undefined' && source) {\n      const f = source.field(dataConfig.field);\n      if (f) {\n        if (!extracted.fields) {\n          extracted.fields = [];\n        }\n        extracted.fields.push(f);\n        if (!('value' in dataConfig)) {\n          valueFn = f.value || (v => v);\n          labelFn = f.label || (v => v);\n          extracted.value = valueFn;\n        }\n        extracted.items = f.items().map(v => ({ value: valueFn(v), label: String(labelFn(v)), source: { field: dataConfig.field } }));\n        // TODO - add source: { key: dataConfig.source, field: dataConfig.field, data: v }\n      }\n    } else if (dataConfig.fields) {\n      dataConfig.fields.forEach((obj) => {\n        const s = typeof obj === 'object' && obj.source ? data.dataset(obj.source) : source;\n        if (!s) {\n          return;\n        }\n        let f;\n        if (typeof obj === 'object' && typeof obj.field !== 'undefined') {\n          f = s.field(obj.field);\n        } else {\n          f = s.field(obj);\n        }\n        if (f) {\n          if (!extracted.fields) {\n            extracted.fields = [];\n          }\n          extracted.fields.push(f);\n        }\n      });\n    }\n\n    if (extracted.items && dataConfig.map) {\n      extracted.items = extracted.items.map(dataConfig.map);\n    }\n  }\n\n  if (dataConfig && dataConfig.stack) {\n    stack(extracted, dataConfig.stack, data.dataset);\n  }\n  if (dataConfig && !Array.isArray(dataConfig) && typeof dataConfig.sort === 'function' && extracted.items) {\n    extracted.items = extracted.items.sort(dataConfig.sort);\n  }\n  return extracted;\n}\n","import extend from 'extend';\nimport extract from './extractor';\n\nfunction create(config, d, opts, extractor = extract) {\n  const collections = {};\n\n  (config || []).forEach((cfg) => {\n    if (!cfg.key) {\n      throw new Error('Data collection is missing \"key\" property');\n    }\n    if (typeof cfg.data === 'object' && 'collection' in cfg.data) {\n      throw new Error('Data config for collections may not reference other collections');\n    }\n    collections[cfg.key] = extractor(cfg.data, d, opts);\n  });\n\n  const fn = (key) => {\n    let k;\n    let cfg;\n    if (typeof key === 'string') {\n      k = key;\n    } else if (typeof key === 'object') {\n      k = key.key;\n      cfg = key;\n    }\n    if (!(k in collections)) {\n      throw new Error(`Unknown data collection: ${k}`);\n    }\n    let coll = collections[k];\n    if (cfg) {\n      if (cfg.fields && cfg.fields.filter) {\n        let filtered = coll.fields.filter(cfg.fields.filter);\n        if (coll.fields.length !== filtered.length) {\n          coll = extend(coll, { fields: filtered });\n        }\n      }\n    }\n\n    return coll;\n  };\n\n  return fn;\n}\n\nexport { create as default };\n","import extractData from '../../data/extractor';\n\nexport function create(options, data, deps, extractor = extractData) {\n  if (options.data) {\n    const d = extractor(options.data, data, deps);\n    if (d && d.fields && d.fields[0]) {\n      // TODO Have some magic to handle and merge formatters from multiple sources\n      return d.fields[0].formatter();\n    }\n  }\n\n  let formatterType;\n  if (options.formatter) {\n    formatterType = `${options.formatter}-${options.type || 'number'}`;\n  } else {\n    formatterType = options.type || 'd3-number';\n  }\n\n  if (deps.formatter.has(formatterType)) {\n    const f = deps.formatter.get(formatterType)(options.format || '');\n    return f;\n  }\n\n  throw new Error(`Formatter of type '${formatterType}' was not found`);\n}\n\nexport default function builder(obj, data, deps) {\n  const formatters = {};\n  for (const f in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, f)) {\n      formatters[f] = create(obj[f], data, deps);\n    }\n  }\n  return formatters;\n}\n\nexport function getOrCreateFormatter(v, formatters, data, deps) {\n  let f;\n  if (typeof v === 'string' && formatters[v]) { // return by name\n    f = formatters[v];\n  } else if (typeof v === 'object' && 'formatter' in v && formatters[v.formatter]) { // return by { formatter: \"name\" }\n    f = formatters[v.formatter];\n  } else if (typeof v === 'object' && 'type' in v && formatters[v.type]) { // return by { formatter: \"name\" }\n    f = formatters[v.type];\n  }\n\n  return f || create(v, data, deps);\n}\n","export default function(a, b) {\n  return a < b ? -1 : a > b ? 1 : a >= b ? 0 : NaN;\n}\n","import ascending from \"./ascending\";\n\nexport default function(compare) {\n  if (compare.length === 1) compare = ascendingComparator(compare);\n  return {\n    left: function(a, x, lo, hi) {\n      if (lo == null) lo = 0;\n      if (hi == null) hi = a.length;\n      while (lo < hi) {\n        var mid = lo + hi >>> 1;\n        if (compare(a[mid], x) < 0) lo = mid + 1;\n        else hi = mid;\n      }\n      return lo;\n    },\n    right: function(a, x, lo, hi) {\n      if (lo == null) lo = 0;\n      if (hi == null) hi = a.length;\n      while (lo < hi) {\n        var mid = lo + hi >>> 1;\n        if (compare(a[mid], x) > 0) hi = mid;\n        else lo = mid + 1;\n      }\n      return lo;\n    }\n  };\n}\n\nfunction ascendingComparator(f) {\n  return function(d, x) {\n    return ascending(f(d), x);\n  };\n}\n","import ascending from \"./ascending\";\nimport bisector from \"./bisector\";\n\nvar ascendingBisect = bisector(ascending);\nexport var bisectRight = ascendingBisect.right;\nexport var bisectLeft = ascendingBisect.left;\nexport default bisectRight;\n","export default function(start, stop, step) {\n  start = +start, stop = +stop, step = (n = arguments.length) < 2 ? (stop = start, start = 0, 1) : n < 3 ? 1 : +step;\n\n  var i = -1,\n      n = Math.max(0, Math.ceil((stop - start) / step)) | 0,\n      range = new Array(n);\n\n  while (++i < n) {\n    range[i] = start + i * step;\n  }\n\n  return range;\n}\n","var e10 = Math.sqrt(50),\n    e5 = Math.sqrt(10),\n    e2 = Math.sqrt(2);\n\nexport default function(start, stop, count) {\n  var reverse,\n      i = -1,\n      n,\n      ticks,\n      step;\n\n  stop = +stop, start = +start, count = +count;\n  if (start === stop && count > 0) return [start];\n  if (reverse = stop < start) n = start, start = stop, stop = n;\n  if ((step = tickIncrement(start, stop, count)) === 0 || !isFinite(step)) return [];\n\n  if (step > 0) {\n    start = Math.ceil(start / step);\n    stop = Math.floor(stop / step);\n    ticks = new Array(n = Math.ceil(stop - start + 1));\n    while (++i < n) ticks[i] = (start + i) * step;\n  } else {\n    start = Math.floor(start * step);\n    stop = Math.ceil(stop * step);\n    ticks = new Array(n = Math.ceil(start - stop + 1));\n    while (++i < n) ticks[i] = (start - i) / step;\n  }\n\n  if (reverse) ticks.reverse();\n\n  return ticks;\n}\n\nexport function tickIncrement(start, stop, count) {\n  var step = (stop - start) / Math.max(0, count),\n      power = Math.floor(Math.log(step) / Math.LN10),\n      error = step / Math.pow(10, power);\n  return power >= 0\n      ? (error >= e10 ? 10 : error >= e5 ? 5 : error >= e2 ? 2 : 1) * Math.pow(10, power)\n      : -Math.pow(10, -power) / (error >= e10 ? 10 : error >= e5 ? 5 : error >= e2 ? 2 : 1);\n}\n\nexport function tickStep(start, stop, count) {\n  var step0 = Math.abs(stop - start) / Math.max(0, count),\n      step1 = Math.pow(10, Math.floor(Math.log(step0) / Math.LN10)),\n      error = step0 / step1;\n  if (error >= e10) step1 *= 10;\n  else if (error >= e5) step1 *= 5;\n  else if (error >= e2) step1 *= 2;\n  return stop < start ? -step1 : step1;\n}\n","export var prefix = \"$\";\n\nfunction Map() {}\n\nMap.prototype = map.prototype = {\n  constructor: Map,\n  has: function(key) {\n    return (prefix + key) in this;\n  },\n  get: function(key) {\n    return this[prefix + key];\n  },\n  set: function(key, value) {\n    this[prefix + key] = value;\n    return this;\n  },\n  remove: function(key) {\n    var property = prefix + key;\n    return property in this && delete this[property];\n  },\n  clear: function() {\n    for (var property in this) if (property[0] === prefix) delete this[property];\n  },\n  keys: function() {\n    var keys = [];\n    for (var property in this) if (property[0] === prefix) keys.push(property.slice(1));\n    return keys;\n  },\n  values: function() {\n    var values = [];\n    for (var property in this) if (property[0] === prefix) values.push(this[property]);\n    return values;\n  },\n  entries: function() {\n    var entries = [];\n    for (var property in this) if (property[0] === prefix) entries.push({key: property.slice(1), value: this[property]});\n    return entries;\n  },\n  size: function() {\n    var size = 0;\n    for (var property in this) if (property[0] === prefix) ++size;\n    return size;\n  },\n  empty: function() {\n    for (var property in this) if (property[0] === prefix) return false;\n    return true;\n  },\n  each: function(f) {\n    for (var property in this) if (property[0] === prefix) f(this[property], property.slice(1), this);\n  }\n};\n\nfunction map(object, f) {\n  var map = new Map;\n\n  // Copy constructor.\n  if (object instanceof Map) object.each(function(value, key) { map.set(key, value); });\n\n  // Index array by numeric index or specified key function.\n  else if (Array.isArray(object)) {\n    var i = -1,\n        n = object.length,\n        o;\n\n    if (f == null) while (++i < n) map.set(i, object[i]);\n    else while (++i < n) map.set(f(o = object[i], i, object), o);\n  }\n\n  // Convert object to map.\n  else if (object) for (var key in object) map.set(key, object[key]);\n\n  return map;\n}\n\nexport default map;\n","import {default as map, prefix} from \"./map\";\n\nfunction Set() {}\n\nvar proto = map.prototype;\n\nSet.prototype = set.prototype = {\n  constructor: Set,\n  has: proto.has,\n  add: function(value) {\n    value += \"\";\n    this[prefix + value] = value;\n    return this;\n  },\n  remove: proto.remove,\n  clear: proto.clear,\n  values: proto.keys,\n  size: proto.size,\n  empty: proto.empty,\n  each: proto.each\n};\n\nfunction set(object, f) {\n  var set = new Set;\n\n  // Copy constructor.\n  if (object instanceof Set) object.each(function(value) { set.add(value); });\n\n  // Otherwise, assume its an array.\n  else if (object) {\n    var i = -1, n = object.length;\n    if (f == null) while (++i < n) set.add(object[i]);\n    else while (++i < n) set.add(f(object[i], i, object));\n  }\n\n  return set;\n}\n\nexport default set;\n","var array = Array.prototype;\n\nexport var map = array.map;\nexport var slice = array.slice;\n","import {map} from \"d3-collection\";\nimport {slice} from \"./array\";\n\nexport var implicit = {name: \"implicit\"};\n\nexport default function ordinal(range) {\n  var index = map(),\n      domain = [],\n      unknown = implicit;\n\n  range = range == null ? [] : slice.call(range);\n\n  function scale(d) {\n    var key = d + \"\", i = index.get(key);\n    if (!i) {\n      if (unknown !== implicit) return unknown;\n      index.set(key, i = domain.push(d));\n    }\n    return range[(i - 1) % range.length];\n  }\n\n  scale.domain = function(_) {\n    if (!arguments.length) return domain.slice();\n    domain = [], index = map();\n    var i = -1, n = _.length, d, key;\n    while (++i < n) if (!index.has(key = (d = _[i]) + \"\")) index.set(key, domain.push(d));\n    return scale;\n  };\n\n  scale.range = function(_) {\n    return arguments.length ? (range = slice.call(_), scale) : range.slice();\n  };\n\n  scale.unknown = function(_) {\n    return arguments.length ? (unknown = _, scale) : unknown;\n  };\n\n  scale.copy = function() {\n    return ordinal()\n        .domain(domain)\n        .range(range)\n        .unknown(unknown);\n  };\n\n  return scale;\n}\n","import {range as sequence} from \"d3-array\";\nimport ordinal from \"./ordinal\";\n\nexport default function band() {\n  var scale = ordinal().unknown(undefined),\n      domain = scale.domain,\n      ordinalRange = scale.range,\n      range = [0, 1],\n      step,\n      bandwidth,\n      round = false,\n      paddingInner = 0,\n      paddingOuter = 0,\n      align = 0.5;\n\n  delete scale.unknown;\n\n  function rescale() {\n    var n = domain().length,\n        reverse = range[1] < range[0],\n        start = range[reverse - 0],\n        stop = range[1 - reverse];\n    step = (stop - start) / Math.max(1, n - paddingInner + paddingOuter * 2);\n    if (round) step = Math.floor(step);\n    start += (stop - start - step * (n - paddingInner)) * align;\n    bandwidth = step * (1 - paddingInner);\n    if (round) start = Math.round(start), bandwidth = Math.round(bandwidth);\n    var values = sequence(n).map(function(i) { return start + step * i; });\n    return ordinalRange(reverse ? values.reverse() : values);\n  }\n\n  scale.domain = function(_) {\n    return arguments.length ? (domain(_), rescale()) : domain();\n  };\n\n  scale.range = function(_) {\n    return arguments.length ? (range = [+_[0], +_[1]], rescale()) : range.slice();\n  };\n\n  scale.rangeRound = function(_) {\n    return range = [+_[0], +_[1]], round = true, rescale();\n  };\n\n  scale.bandwidth = function() {\n    return bandwidth;\n  };\n\n  scale.step = function() {\n    return step;\n  };\n\n  scale.round = function(_) {\n    return arguments.length ? (round = !!_, rescale()) : round;\n  };\n\n  scale.padding = function(_) {\n    return arguments.length ? (paddingInner = paddingOuter = Math.max(0, Math.min(1, _)), rescale()) : paddingInner;\n  };\n\n  scale.paddingInner = function(_) {\n    return arguments.length ? (paddingInner = Math.max(0, Math.min(1, _)), rescale()) : paddingInner;\n  };\n\n  scale.paddingOuter = function(_) {\n    return arguments.length ? (paddingOuter = Math.max(0, Math.min(1, _)), rescale()) : paddingOuter;\n  };\n\n  scale.align = function(_) {\n    return arguments.length ? (align = Math.max(0, Math.min(1, _)), rescale()) : align;\n  };\n\n  scale.copy = function() {\n    return band()\n        .domain(domain())\n        .range(range)\n        .round(round)\n        .paddingInner(paddingInner)\n        .paddingOuter(paddingOuter)\n        .align(align);\n  };\n\n  return rescale();\n}\n\nfunction pointish(scale) {\n  var copy = scale.copy;\n\n  scale.padding = scale.paddingOuter;\n  delete scale.paddingInner;\n  delete scale.paddingOuter;\n\n  scale.copy = function() {\n    return pointish(copy());\n  };\n\n  return scale;\n}\n\nexport function point() {\n  return pointish(band().paddingInner(1));\n}\n","export default function(constructor, factory, prototype) {\n  constructor.prototype = factory.prototype = prototype;\n  prototype.constructor = constructor;\n}\n\nexport function extend(parent, definition) {\n  var prototype = Object.create(parent.prototype);\n  for (var key in definition) prototype[key] = definition[key];\n  return prototype;\n}\n","import define, {extend} from \"./define\";\n\nexport function Color() {}\n\nexport var darker = 0.7;\nexport var brighter = 1 / darker;\n\nvar reI = \"\\\\s*([+-]?\\\\d+)\\\\s*\",\n    reN = \"\\\\s*([+-]?\\\\d*\\\\.?\\\\d+(?:[eE][+-]?\\\\d+)?)\\\\s*\",\n    reP = \"\\\\s*([+-]?\\\\d*\\\\.?\\\\d+(?:[eE][+-]?\\\\d+)?)%\\\\s*\",\n    reHex3 = /^#([0-9a-f]{3})$/,\n    reHex6 = /^#([0-9a-f]{6})$/,\n    reRgbInteger = new RegExp(\"^rgb\\\\(\" + [reI, reI, reI] + \"\\\\)$\"),\n    reRgbPercent = new RegExp(\"^rgb\\\\(\" + [reP, reP, reP] + \"\\\\)$\"),\n    reRgbaInteger = new RegExp(\"^rgba\\\\(\" + [reI, reI, reI, reN] + \"\\\\)$\"),\n    reRgbaPercent = new RegExp(\"^rgba\\\\(\" + [reP, reP, reP, reN] + \"\\\\)$\"),\n    reHslPercent = new RegExp(\"^hsl\\\\(\" + [reN, reP, reP] + \"\\\\)$\"),\n    reHslaPercent = new RegExp(\"^hsla\\\\(\" + [reN, reP, reP, reN] + \"\\\\)$\");\n\nvar named = {\n  aliceblue: 0xf0f8ff,\n  antiquewhite: 0xfaebd7,\n  aqua: 0x00ffff,\n  aquamarine: 0x7fffd4,\n  azure: 0xf0ffff,\n  beige: 0xf5f5dc,\n  bisque: 0xffe4c4,\n  black: 0x000000,\n  blanchedalmond: 0xffebcd,\n  blue: 0x0000ff,\n  blueviolet: 0x8a2be2,\n  brown: 0xa52a2a,\n  burlywood: 0xdeb887,\n  cadetblue: 0x5f9ea0,\n  chartreuse: 0x7fff00,\n  chocolate: 0xd2691e,\n  coral: 0xff7f50,\n  cornflowerblue: 0x6495ed,\n  cornsilk: 0xfff8dc,\n  crimson: 0xdc143c,\n  cyan: 0x00ffff,\n  darkblue: 0x00008b,\n  darkcyan: 0x008b8b,\n  darkgoldenrod: 0xb8860b,\n  darkgray: 0xa9a9a9,\n  darkgreen: 0x006400,\n  darkgrey: 0xa9a9a9,\n  darkkhaki: 0xbdb76b,\n  darkmagenta: 0x8b008b,\n  darkolivegreen: 0x556b2f,\n  darkorange: 0xff8c00,\n  darkorchid: 0x9932cc,\n  darkred: 0x8b0000,\n  darksalmon: 0xe9967a,\n  darkseagreen: 0x8fbc8f,\n  darkslateblue: 0x483d8b,\n  darkslategray: 0x2f4f4f,\n  darkslategrey: 0x2f4f4f,\n  darkturquoise: 0x00ced1,\n  darkviolet: 0x9400d3,\n  deeppink: 0xff1493,\n  deepskyblue: 0x00bfff,\n  dimgray: 0x696969,\n  dimgrey: 0x696969,\n  dodgerblue: 0x1e90ff,\n  firebrick: 0xb22222,\n  floralwhite: 0xfffaf0,\n  forestgreen: 0x228b22,\n  fuchsia: 0xff00ff,\n  gainsboro: 0xdcdcdc,\n  ghostwhite: 0xf8f8ff,\n  gold: 0xffd700,\n  goldenrod: 0xdaa520,\n  gray: 0x808080,\n  green: 0x008000,\n  greenyellow: 0xadff2f,\n  grey: 0x808080,\n  honeydew: 0xf0fff0,\n  hotpink: 0xff69b4,\n  indianred: 0xcd5c5c,\n  indigo: 0x4b0082,\n  ivory: 0xfffff0,\n  khaki: 0xf0e68c,\n  lavender: 0xe6e6fa,\n  lavenderblush: 0xfff0f5,\n  lawngreen: 0x7cfc00,\n  lemonchiffon: 0xfffacd,\n  lightblue: 0xadd8e6,\n  lightcoral: 0xf08080,\n  lightcyan: 0xe0ffff,\n  lightgoldenrodyellow: 0xfafad2,\n  lightgray: 0xd3d3d3,\n  lightgreen: 0x90ee90,\n  lightgrey: 0xd3d3d3,\n  lightpink: 0xffb6c1,\n  lightsalmon: 0xffa07a,\n  lightseagreen: 0x20b2aa,\n  lightskyblue: 0x87cefa,\n  lightslategray: 0x778899,\n  lightslategrey: 0x778899,\n  lightsteelblue: 0xb0c4de,\n  lightyellow: 0xffffe0,\n  lime: 0x00ff00,\n  limegreen: 0x32cd32,\n  linen: 0xfaf0e6,\n  magenta: 0xff00ff,\n  maroon: 0x800000,\n  mediumaquamarine: 0x66cdaa,\n  mediumblue: 0x0000cd,\n  mediumorchid: 0xba55d3,\n  mediumpurple: 0x9370db,\n  mediumseagreen: 0x3cb371,\n  mediumslateblue: 0x7b68ee,\n  mediumspringgreen: 0x00fa9a,\n  mediumturquoise: 0x48d1cc,\n  mediumvioletred: 0xc71585,\n  midnightblue: 0x191970,\n  mintcream: 0xf5fffa,\n  mistyrose: 0xffe4e1,\n  moccasin: 0xffe4b5,\n  navajowhite: 0xffdead,\n  navy: 0x000080,\n  oldlace: 0xfdf5e6,\n  olive: 0x808000,\n  olivedrab: 0x6b8e23,\n  orange: 0xffa500,\n  orangered: 0xff4500,\n  orchid: 0xda70d6,\n  palegoldenrod: 0xeee8aa,\n  palegreen: 0x98fb98,\n  paleturquoise: 0xafeeee,\n  palevioletred: 0xdb7093,\n  papayawhip: 0xffefd5,\n  peachpuff: 0xffdab9,\n  peru: 0xcd853f,\n  pink: 0xffc0cb,\n  plum: 0xdda0dd,\n  powderblue: 0xb0e0e6,\n  purple: 0x800080,\n  rebeccapurple: 0x663399,\n  red: 0xff0000,\n  rosybrown: 0xbc8f8f,\n  royalblue: 0x4169e1,\n  saddlebrown: 0x8b4513,\n  salmon: 0xfa8072,\n  sandybrown: 0xf4a460,\n  seagreen: 0x2e8b57,\n  seashell: 0xfff5ee,\n  sienna: 0xa0522d,\n  silver: 0xc0c0c0,\n  skyblue: 0x87ceeb,\n  slateblue: 0x6a5acd,\n  slategray: 0x708090,\n  slategrey: 0x708090,\n  snow: 0xfffafa,\n  springgreen: 0x00ff7f,\n  steelblue: 0x4682b4,\n  tan: 0xd2b48c,\n  teal: 0x008080,\n  thistle: 0xd8bfd8,\n  tomato: 0xff6347,\n  turquoise: 0x40e0d0,\n  violet: 0xee82ee,\n  wheat: 0xf5deb3,\n  white: 0xffffff,\n  whitesmoke: 0xf5f5f5,\n  yellow: 0xffff00,\n  yellowgreen: 0x9acd32\n};\n\ndefine(Color, color, {\n  displayable: function() {\n    return this.rgb().displayable();\n  },\n  hex: function() {\n    return this.rgb().hex();\n  },\n  toString: function() {\n    return this.rgb() + \"\";\n  }\n});\n\nexport default function color(format) {\n  var m;\n  format = (format + \"\").trim().toLowerCase();\n  return (m = reHex3.exec(format)) ? (m = parseInt(m[1], 16), new Rgb((m >> 8 & 0xf) | (m >> 4 & 0x0f0), (m >> 4 & 0xf) | (m & 0xf0), ((m & 0xf) << 4) | (m & 0xf), 1)) // #f00\n      : (m = reHex6.exec(format)) ? rgbn(parseInt(m[1], 16)) // #ff0000\n      : (m = reRgbInteger.exec(format)) ? new Rgb(m[1], m[2], m[3], 1) // rgb(255, 0, 0)\n      : (m = reRgbPercent.exec(format)) ? new Rgb(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, 1) // rgb(100%, 0%, 0%)\n      : (m = reRgbaInteger.exec(format)) ? rgba(m[1], m[2], m[3], m[4]) // rgba(255, 0, 0, 1)\n      : (m = reRgbaPercent.exec(format)) ? rgba(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, m[4]) // rgb(100%, 0%, 0%, 1)\n      : (m = reHslPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, 1) // hsl(120, 50%, 50%)\n      : (m = reHslaPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, m[4]) // hsla(120, 50%, 50%, 1)\n      : named.hasOwnProperty(format) ? rgbn(named[format])\n      : format === \"transparent\" ? new Rgb(NaN, NaN, NaN, 0)\n      : null;\n}\n\nfunction rgbn(n) {\n  return new Rgb(n >> 16 & 0xff, n >> 8 & 0xff, n & 0xff, 1);\n}\n\nfunction rgba(r, g, b, a) {\n  if (a <= 0) r = g = b = NaN;\n  return new Rgb(r, g, b, a);\n}\n\nexport function rgbConvert(o) {\n  if (!(o instanceof Color)) o = color(o);\n  if (!o) return new Rgb;\n  o = o.rgb();\n  return new Rgb(o.r, o.g, o.b, o.opacity);\n}\n\nexport function rgb(r, g, b, opacity) {\n  return arguments.length === 1 ? rgbConvert(r) : new Rgb(r, g, b, opacity == null ? 1 : opacity);\n}\n\nexport function Rgb(r, g, b, opacity) {\n  this.r = +r;\n  this.g = +g;\n  this.b = +b;\n  this.opacity = +opacity;\n}\n\ndefine(Rgb, rgb, extend(Color, {\n  brighter: function(k) {\n    k = k == null ? brighter : Math.pow(brighter, k);\n    return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);\n  },\n  darker: function(k) {\n    k = k == null ? darker : Math.pow(darker, k);\n    return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);\n  },\n  rgb: function() {\n    return this;\n  },\n  displayable: function() {\n    return (0 <= this.r && this.r <= 255)\n        && (0 <= this.g && this.g <= 255)\n        && (0 <= this.b && this.b <= 255)\n        && (0 <= this.opacity && this.opacity <= 1);\n  },\n  hex: function() {\n    return \"#\" + hex(this.r) + hex(this.g) + hex(this.b);\n  },\n  toString: function() {\n    var a = this.opacity; a = isNaN(a) ? 1 : Math.max(0, Math.min(1, a));\n    return (a === 1 ? \"rgb(\" : \"rgba(\")\n        + Math.max(0, Math.min(255, Math.round(this.r) || 0)) + \", \"\n        + Math.max(0, Math.min(255, Math.round(this.g) || 0)) + \", \"\n        + Math.max(0, Math.min(255, Math.round(this.b) || 0))\n        + (a === 1 ? \")\" : \", \" + a + \")\");\n  }\n}));\n\nfunction hex(value) {\n  value = Math.max(0, Math.min(255, Math.round(value) || 0));\n  return (value < 16 ? \"0\" : \"\") + value.toString(16);\n}\n\nfunction hsla(h, s, l, a) {\n  if (a <= 0) h = s = l = NaN;\n  else if (l <= 0 || l >= 1) h = s = NaN;\n  else if (s <= 0) h = NaN;\n  return new Hsl(h, s, l, a);\n}\n\nexport function hslConvert(o) {\n  if (o instanceof Hsl) return new Hsl(o.h, o.s, o.l, o.opacity);\n  if (!(o instanceof Color)) o = color(o);\n  if (!o) return new Hsl;\n  if (o instanceof Hsl) return o;\n  o = o.rgb();\n  var r = o.r / 255,\n      g = o.g / 255,\n      b = o.b / 255,\n      min = Math.min(r, g, b),\n      max = Math.max(r, g, b),\n      h = NaN,\n      s = max - min,\n      l = (max + min) / 2;\n  if (s) {\n    if (r === max) h = (g - b) / s + (g < b) * 6;\n    else if (g === max) h = (b - r) / s + 2;\n    else h = (r - g) / s + 4;\n    s /= l < 0.5 ? max + min : 2 - max - min;\n    h *= 60;\n  } else {\n    s = l > 0 && l < 1 ? 0 : h;\n  }\n  return new Hsl(h, s, l, o.opacity);\n}\n\nexport function hsl(h, s, l, opacity) {\n  return arguments.length === 1 ? hslConvert(h) : new Hsl(h, s, l, opacity == null ? 1 : opacity);\n}\n\nfunction Hsl(h, s, l, opacity) {\n  this.h = +h;\n  this.s = +s;\n  this.l = +l;\n  this.opacity = +opacity;\n}\n\ndefine(Hsl, hsl, extend(Color, {\n  brighter: function(k) {\n    k = k == null ? brighter : Math.pow(brighter, k);\n    return new Hsl(this.h, this.s, this.l * k, this.opacity);\n  },\n  darker: function(k) {\n    k = k == null ? darker : Math.pow(darker, k);\n    return new Hsl(this.h, this.s, this.l * k, this.opacity);\n  },\n  rgb: function() {\n    var h = this.h % 360 + (this.h < 0) * 360,\n        s = isNaN(h) || isNaN(this.s) ? 0 : this.s,\n        l = this.l,\n        m2 = l + (l < 0.5 ? l : 1 - l) * s,\n        m1 = 2 * l - m2;\n    return new Rgb(\n      hsl2rgb(h >= 240 ? h - 240 : h + 120, m1, m2),\n      hsl2rgb(h, m1, m2),\n      hsl2rgb(h < 120 ? h + 240 : h - 120, m1, m2),\n      this.opacity\n    );\n  },\n  displayable: function() {\n    return (0 <= this.s && this.s <= 1 || isNaN(this.s))\n        && (0 <= this.l && this.l <= 1)\n        && (0 <= this.opacity && this.opacity <= 1);\n  }\n}));\n\n/* From FvD 13.37, CSS Color Module Level 3 */\nfunction hsl2rgb(h, m1, m2) {\n  return (h < 60 ? m1 + (m2 - m1) * h / 60\n      : h < 180 ? m2\n      : h < 240 ? m1 + (m2 - m1) * (240 - h) / 60\n      : m1) * 255;\n}\n","export var deg2rad = Math.PI / 180;\nexport var rad2deg = 180 / Math.PI;\n","import define, {extend} from \"./define\";\nimport {Color, rgbConvert, Rgb} from \"./color\";\nimport {deg2rad, rad2deg} from \"./math\";\n\n// https://beta.observablehq.com/@mbostock/lab-and-rgb\nvar K = 18,\n    Xn = 0.96422,\n    Yn = 1,\n    Zn = 0.82521,\n    t0 = 4 / 29,\n    t1 = 6 / 29,\n    t2 = 3 * t1 * t1,\n    t3 = t1 * t1 * t1;\n\nfunction labConvert(o) {\n  if (o instanceof Lab) return new Lab(o.l, o.a, o.b, o.opacity);\n  if (o instanceof Hcl) {\n    if (isNaN(o.h)) return new Lab(o.l, 0, 0, o.opacity);\n    var h = o.h * deg2rad;\n    return new Lab(o.l, Math.cos(h) * o.c, Math.sin(h) * o.c, o.opacity);\n  }\n  if (!(o instanceof Rgb)) o = rgbConvert(o);\n  var r = rgb2lrgb(o.r),\n      g = rgb2lrgb(o.g),\n      b = rgb2lrgb(o.b),\n      y = xyz2lab((0.2225045 * r + 0.7168786 * g + 0.0606169 * b) / Yn), x, z;\n  if (r === g && g === b) x = z = y; else {\n    x = xyz2lab((0.4360747 * r + 0.3850649 * g + 0.1430804 * b) / Xn);\n    z = xyz2lab((0.0139322 * r + 0.0971045 * g + 0.7141733 * b) / Zn);\n  }\n  return new Lab(116 * y - 16, 500 * (x - y), 200 * (y - z), o.opacity);\n}\n\nexport function gray(l, opacity) {\n  return new Lab(l, 0, 0, opacity == null ? 1 : opacity);\n}\n\nexport default function lab(l, a, b, opacity) {\n  return arguments.length === 1 ? labConvert(l) : new Lab(l, a, b, opacity == null ? 1 : opacity);\n}\n\nexport function Lab(l, a, b, opacity) {\n  this.l = +l;\n  this.a = +a;\n  this.b = +b;\n  this.opacity = +opacity;\n}\n\ndefine(Lab, lab, extend(Color, {\n  brighter: function(k) {\n    return new Lab(this.l + K * (k == null ? 1 : k), this.a, this.b, this.opacity);\n  },\n  darker: function(k) {\n    return new Lab(this.l - K * (k == null ? 1 : k), this.a, this.b, this.opacity);\n  },\n  rgb: function() {\n    var y = (this.l + 16) / 116,\n        x = isNaN(this.a) ? y : y + this.a / 500,\n        z = isNaN(this.b) ? y : y - this.b / 200;\n    x = Xn * lab2xyz(x);\n    y = Yn * lab2xyz(y);\n    z = Zn * lab2xyz(z);\n    return new Rgb(\n      lrgb2rgb( 3.1338561 * x - 1.6168667 * y - 0.4906146 * z),\n      lrgb2rgb(-0.9787684 * x + 1.9161415 * y + 0.0334540 * z),\n      lrgb2rgb( 0.0719453 * x - 0.2289914 * y + 1.4052427 * z),\n      this.opacity\n    );\n  }\n}));\n\nfunction xyz2lab(t) {\n  return t > t3 ? Math.pow(t, 1 / 3) : t / t2 + t0;\n}\n\nfunction lab2xyz(t) {\n  return t > t1 ? t * t * t : t2 * (t - t0);\n}\n\nfunction lrgb2rgb(x) {\n  return 255 * (x <= 0.0031308 ? 12.92 * x : 1.055 * Math.pow(x, 1 / 2.4) - 0.055);\n}\n\nfunction rgb2lrgb(x) {\n  return (x /= 255) <= 0.04045 ? x / 12.92 : Math.pow((x + 0.055) / 1.055, 2.4);\n}\n\nfunction hclConvert(o) {\n  if (o instanceof Hcl) return new Hcl(o.h, o.c, o.l, o.opacity);\n  if (!(o instanceof Lab)) o = labConvert(o);\n  if (o.a === 0 && o.b === 0) return new Hcl(NaN, 0, o.l, o.opacity);\n  var h = Math.atan2(o.b, o.a) * rad2deg;\n  return new Hcl(h < 0 ? h + 360 : h, Math.sqrt(o.a * o.a + o.b * o.b), o.l, o.opacity);\n}\n\nexport function lch(l, c, h, opacity) {\n  return arguments.length === 1 ? hclConvert(l) : new Hcl(h, c, l, opacity == null ? 1 : opacity);\n}\n\nexport function hcl(h, c, l, opacity) {\n  return arguments.length === 1 ? hclConvert(h) : new Hcl(h, c, l, opacity == null ? 1 : opacity);\n}\n\nexport function Hcl(h, c, l, opacity) {\n  this.h = +h;\n  this.c = +c;\n  this.l = +l;\n  this.opacity = +opacity;\n}\n\ndefine(Hcl, hcl, extend(Color, {\n  brighter: function(k) {\n    return new Hcl(this.h, this.c, this.l + K * (k == null ? 1 : k), this.opacity);\n  },\n  darker: function(k) {\n    return new Hcl(this.h, this.c, this.l - K * (k == null ? 1 : k), this.opacity);\n  },\n  rgb: function() {\n    return labConvert(this).rgb();\n  }\n}));\n","import define, {extend} from \"./define\";\nimport {Color, rgbConvert, Rgb, darker, brighter} from \"./color\";\nimport {deg2rad, rad2deg} from \"./math\";\n\nvar A = -0.14861,\n    B = +1.78277,\n    C = -0.29227,\n    D = -0.90649,\n    E = +1.97294,\n    ED = E * D,\n    EB = E * B,\n    BC_DA = B * C - D * A;\n\nfunction cubehelixConvert(o) {\n  if (o instanceof Cubehelix) return new Cubehelix(o.h, o.s, o.l, o.opacity);\n  if (!(o instanceof Rgb)) o = rgbConvert(o);\n  var r = o.r / 255,\n      g = o.g / 255,\n      b = o.b / 255,\n      l = (BC_DA * b + ED * r - EB * g) / (BC_DA + ED - EB),\n      bl = b - l,\n      k = (E * (g - l) - C * bl) / D,\n      s = Math.sqrt(k * k + bl * bl) / (E * l * (1 - l)), // NaN if l=0 or l=1\n      h = s ? Math.atan2(k, bl) * rad2deg - 120 : NaN;\n  return new Cubehelix(h < 0 ? h + 360 : h, s, l, o.opacity);\n}\n\nexport default function cubehelix(h, s, l, opacity) {\n  return arguments.length === 1 ? cubehelixConvert(h) : new Cubehelix(h, s, l, opacity == null ? 1 : opacity);\n}\n\nexport function Cubehelix(h, s, l, opacity) {\n  this.h = +h;\n  this.s = +s;\n  this.l = +l;\n  this.opacity = +opacity;\n}\n\ndefine(Cubehelix, cubehelix, extend(Color, {\n  brighter: function(k) {\n    k = k == null ? brighter : Math.pow(brighter, k);\n    return new Cubehelix(this.h, this.s, this.l * k, this.opacity);\n  },\n  darker: function(k) {\n    k = k == null ? darker : Math.pow(darker, k);\n    return new Cubehelix(this.h, this.s, this.l * k, this.opacity);\n  },\n  rgb: function() {\n    var h = isNaN(this.h) ? 0 : (this.h + 120) * deg2rad,\n        l = +this.l,\n        a = isNaN(this.s) ? 0 : this.s * l * (1 - l),\n        cosh = Math.cos(h),\n        sinh = Math.sin(h);\n    return new Rgb(\n      255 * (l + a * (A * cosh + B * sinh)),\n      255 * (l + a * (C * cosh + D * sinh)),\n      255 * (l + a * (E * cosh)),\n      this.opacity\n    );\n  }\n}));\n","export default function(x) {\n  return function() {\n    return x;\n  };\n}\n","import constant from \"./constant\";\n\nfunction linear(a, d) {\n  return function(t) {\n    return a + t * d;\n  };\n}\n\nfunction exponential(a, b, y) {\n  return a = Math.pow(a, y), b = Math.pow(b, y) - a, y = 1 / y, function(t) {\n    return Math.pow(a + t * b, y);\n  };\n}\n\nexport function hue(a, b) {\n  var d = b - a;\n  return d ? linear(a, d > 180 || d < -180 ? d - 360 * Math.round(d / 360) : d) : constant(isNaN(a) ? b : a);\n}\n\nexport function gamma(y) {\n  return (y = +y) === 1 ? nogamma : function(a, b) {\n    return b - a ? exponential(a, b, y) : constant(isNaN(a) ? b : a);\n  };\n}\n\nexport default function nogamma(a, b) {\n  var d = b - a;\n  return d ? linear(a, d) : constant(isNaN(a) ? b : a);\n}\n","import {rgb as colorRgb} from \"d3-color\";\nimport basis from \"./basis\";\nimport basisClosed from \"./basisClosed\";\nimport nogamma, {gamma} from \"./color\";\n\nexport default (function rgbGamma(y) {\n  var color = gamma(y);\n\n  function rgb(start, end) {\n    var r = color((start = colorRgb(start)).r, (end = colorRgb(end)).r),\n        g = color(start.g, end.g),\n        b = color(start.b, end.b),\n        opacity = nogamma(start.opacity, end.opacity);\n    return function(t) {\n      start.r = r(t);\n      start.g = g(t);\n      start.b = b(t);\n      start.opacity = opacity(t);\n      return start + \"\";\n    };\n  }\n\n  rgb.gamma = rgbGamma;\n\n  return rgb;\n})(1);\n\nfunction rgbSpline(spline) {\n  return function(colors) {\n    var n = colors.length,\n        r = new Array(n),\n        g = new Array(n),\n        b = new Array(n),\n        i, color;\n    for (i = 0; i < n; ++i) {\n      color = colorRgb(colors[i]);\n      r[i] = color.r || 0;\n      g[i] = color.g || 0;\n      b[i] = color.b || 0;\n    }\n    r = spline(r);\n    g = spline(g);\n    b = spline(b);\n    color.opacity = 1;\n    return function(t) {\n      color.r = r(t);\n      color.g = g(t);\n      color.b = b(t);\n      return color + \"\";\n    };\n  };\n}\n\nexport var rgbBasis = rgbSpline(basis);\nexport var rgbBasisClosed = rgbSpline(basisClosed);\n","import value from \"./value\";\n\nexport default function(a, b) {\n  var nb = b ? b.length : 0,\n      na = a ? Math.min(nb, a.length) : 0,\n      x = new Array(na),\n      c = new Array(nb),\n      i;\n\n  for (i = 0; i < na; ++i) x[i] = value(a[i], b[i]);\n  for (; i < nb; ++i) c[i] = b[i];\n\n  return function(t) {\n    for (i = 0; i < na; ++i) c[i] = x[i](t);\n    return c;\n  };\n}\n","export default function(a, b) {\n  var d = new Date;\n  return a = +a, b -= a, function(t) {\n    return d.setTime(a + b * t), d;\n  };\n}\n","export default function(a, b) {\n  return a = +a, b -= a, function(t) {\n    return a + b * t;\n  };\n}\n","import value from \"./value\";\n\nexport default function(a, b) {\n  var i = {},\n      c = {},\n      k;\n\n  if (a === null || typeof a !== \"object\") a = {};\n  if (b === null || typeof b !== \"object\") b = {};\n\n  for (k in b) {\n    if (k in a) {\n      i[k] = value(a[k], b[k]);\n    } else {\n      c[k] = b[k];\n    }\n  }\n\n  return function(t) {\n    for (k in i) c[k] = i[k](t);\n    return c;\n  };\n}\n","import number from \"./number\";\n\nvar reA = /[-+]?(?:\\d+\\.?\\d*|\\.?\\d+)(?:[eE][-+]?\\d+)?/g,\n    reB = new RegExp(reA.source, \"g\");\n\nfunction zero(b) {\n  return function() {\n    return b;\n  };\n}\n\nfunction one(b) {\n  return function(t) {\n    return b(t) + \"\";\n  };\n}\n\nexport default function(a, b) {\n  var bi = reA.lastIndex = reB.lastIndex = 0, // scan index for next number in b\n      am, // current match in a\n      bm, // current match in b\n      bs, // string preceding current number in b, if any\n      i = -1, // index in s\n      s = [], // string constants and placeholders\n      q = []; // number interpolators\n\n  // Coerce inputs to strings.\n  a = a + \"\", b = b + \"\";\n\n  // Interpolate pairs of numbers in a & b.\n  while ((am = reA.exec(a))\n      && (bm = reB.exec(b))) {\n    if ((bs = bm.index) > bi) { // a string precedes the next number in b\n      bs = b.slice(bi, bs);\n      if (s[i]) s[i] += bs; // coalesce with previous string\n      else s[++i] = bs;\n    }\n    if ((am = am[0]) === (bm = bm[0])) { // numbers in a & b match\n      if (s[i]) s[i] += bm; // coalesce with previous string\n      else s[++i] = bm;\n    } else { // interpolate non-matching numbers\n      s[++i] = null;\n      q.push({i: i, x: number(am, bm)});\n    }\n    bi = reB.lastIndex;\n  }\n\n  // Add remains of b.\n  if (bi < b.length) {\n    bs = b.slice(bi);\n    if (s[i]) s[i] += bs; // coalesce with previous string\n    else s[++i] = bs;\n  }\n\n  // Special optimization for only a single match.\n  // Otherwise, interpolate each of the numbers and rejoin the string.\n  return s.length < 2 ? (q[0]\n      ? one(q[0].x)\n      : zero(b))\n      : (b = q.length, function(t) {\n          for (var i = 0, o; i < b; ++i) s[(o = q[i]).i] = o.x(t);\n          return s.join(\"\");\n        });\n}\n","import {color} from \"d3-color\";\nimport rgb from \"./rgb\";\nimport array from \"./array\";\nimport date from \"./date\";\nimport number from \"./number\";\nimport object from \"./object\";\nimport string from \"./string\";\nimport constant from \"./constant\";\n\nexport default function(a, b) {\n  var t = typeof b, c;\n  return b == null || t === \"boolean\" ? constant(b)\n      : (t === \"number\" ? number\n      : t === \"string\" ? ((c = color(b)) ? (b = c, rgb) : string)\n      : b instanceof color ? rgb\n      : b instanceof Date ? date\n      : Array.isArray(b) ? array\n      : typeof b.valueOf !== \"function\" && typeof b.toString !== \"function\" || isNaN(b) ? object\n      : number)(a, b);\n}\n","export default function(a, b) {\n  return a = +a, b -= a, function(t) {\n    return Math.round(a + b * t);\n  };\n}\n","var degrees = 180 / Math.PI;\n\nexport var identity = {\n  translateX: 0,\n  translateY: 0,\n  rotate: 0,\n  skewX: 0,\n  scaleX: 1,\n  scaleY: 1\n};\n\nexport default function(a, b, c, d, e, f) {\n  var scaleX, scaleY, skewX;\n  if (scaleX = Math.sqrt(a * a + b * b)) a /= scaleX, b /= scaleX;\n  if (skewX = a * c + b * d) c -= a * skewX, d -= b * skewX;\n  if (scaleY = Math.sqrt(c * c + d * d)) c /= scaleY, d /= scaleY, skewX /= scaleY;\n  if (a * d < b * c) a = -a, b = -b, skewX = -skewX, scaleX = -scaleX;\n  return {\n    translateX: e,\n    translateY: f,\n    rotate: Math.atan2(b, a) * degrees,\n    skewX: Math.atan(skewX) * degrees,\n    scaleX: scaleX,\n    scaleY: scaleY\n  };\n}\n","var rho = Math.SQRT2,\n    rho2 = 2,\n    rho4 = 4,\n    epsilon2 = 1e-12;\n\nfunction cosh(x) {\n  return ((x = Math.exp(x)) + 1 / x) / 2;\n}\n\nfunction sinh(x) {\n  return ((x = Math.exp(x)) - 1 / x) / 2;\n}\n\nfunction tanh(x) {\n  return ((x = Math.exp(2 * x)) - 1) / (x + 1);\n}\n\n// p0 = [ux0, uy0, w0]\n// p1 = [ux1, uy1, w1]\nexport default function(p0, p1) {\n  var ux0 = p0[0], uy0 = p0[1], w0 = p0[2],\n      ux1 = p1[0], uy1 = p1[1], w1 = p1[2],\n      dx = ux1 - ux0,\n      dy = uy1 - uy0,\n      d2 = dx * dx + dy * dy,\n      i,\n      S;\n\n  // Special case for u0  u1.\n  if (d2 < epsilon2) {\n    S = Math.log(w1 / w0) / rho;\n    i = function(t) {\n      return [\n        ux0 + t * dx,\n        uy0 + t * dy,\n        w0 * Math.exp(rho * t * S)\n      ];\n    }\n  }\n\n  // General case.\n  else {\n    var d1 = Math.sqrt(d2),\n        b0 = (w1 * w1 - w0 * w0 + rho4 * d2) / (2 * w0 * rho2 * d1),\n        b1 = (w1 * w1 - w0 * w0 - rho4 * d2) / (2 * w1 * rho2 * d1),\n        r0 = Math.log(Math.sqrt(b0 * b0 + 1) - b0),\n        r1 = Math.log(Math.sqrt(b1 * b1 + 1) - b1);\n    S = (r1 - r0) / rho;\n    i = function(t) {\n      var s = t * S,\n          coshr0 = cosh(r0),\n          u = w0 / (rho2 * d1) * (coshr0 * tanh(rho * s + r0) - sinh(r0));\n      return [\n        ux0 + u * dx,\n        uy0 + u * dy,\n        w0 * coshr0 / cosh(rho * s + r0)\n      ];\n    }\n  }\n\n  i.duration = S * 1000;\n\n  return i;\n}\n","export default function(x) {\n  return function() {\n    return x;\n  };\n}\n","export default function(x) {\n  return +x;\n}\n","import {bisect} from \"d3-array\";\nimport {interpolate as interpolateValue, interpolateRound} from \"d3-interpolate\";\nimport {map, slice} from \"./array\";\nimport constant from \"./constant\";\nimport number from \"./number\";\n\nvar unit = [0, 1];\n\nexport function deinterpolateLinear(a, b) {\n  return (b -= (a = +a))\n      ? function(x) { return (x - a) / b; }\n      : constant(b);\n}\n\nfunction deinterpolateClamp(deinterpolate) {\n  return function(a, b) {\n    var d = deinterpolate(a = +a, b = +b);\n    return function(x) { return x <= a ? 0 : x >= b ? 1 : d(x); };\n  };\n}\n\nfunction reinterpolateClamp(reinterpolate) {\n  return function(a, b) {\n    var r = reinterpolate(a = +a, b = +b);\n    return function(t) { return t <= 0 ? a : t >= 1 ? b : r(t); };\n  };\n}\n\nfunction bimap(domain, range, deinterpolate, reinterpolate) {\n  var d0 = domain[0], d1 = domain[1], r0 = range[0], r1 = range[1];\n  if (d1 < d0) d0 = deinterpolate(d1, d0), r0 = reinterpolate(r1, r0);\n  else d0 = deinterpolate(d0, d1), r0 = reinterpolate(r0, r1);\n  return function(x) { return r0(d0(x)); };\n}\n\nfunction polymap(domain, range, deinterpolate, reinterpolate) {\n  var j = Math.min(domain.length, range.length) - 1,\n      d = new Array(j),\n      r = new Array(j),\n      i = -1;\n\n  // Reverse descending domains.\n  if (domain[j] < domain[0]) {\n    domain = domain.slice().reverse();\n    range = range.slice().reverse();\n  }\n\n  while (++i < j) {\n    d[i] = deinterpolate(domain[i], domain[i + 1]);\n    r[i] = reinterpolate(range[i], range[i + 1]);\n  }\n\n  return function(x) {\n    var i = bisect(domain, x, 1, j) - 1;\n    return r[i](d[i](x));\n  };\n}\n\nexport function copy(source, target) {\n  return target\n      .domain(source.domain())\n      .range(source.range())\n      .interpolate(source.interpolate())\n      .clamp(source.clamp());\n}\n\n// deinterpolate(a, b)(x) takes a domain value x in [a,b] and returns the corresponding parameter t in [0,1].\n// reinterpolate(a, b)(t) takes a parameter t in [0,1] and returns the corresponding domain value x in [a,b].\nexport default function continuous(deinterpolate, reinterpolate) {\n  var domain = unit,\n      range = unit,\n      interpolate = interpolateValue,\n      clamp = false,\n      piecewise,\n      output,\n      input;\n\n  function rescale() {\n    piecewise = Math.min(domain.length, range.length) > 2 ? polymap : bimap;\n    output = input = null;\n    return scale;\n  }\n\n  function scale(x) {\n    return (output || (output = piecewise(domain, range, clamp ? deinterpolateClamp(deinterpolate) : deinterpolate, interpolate)))(+x);\n  }\n\n  scale.invert = function(y) {\n    return (input || (input = piecewise(range, domain, deinterpolateLinear, clamp ? reinterpolateClamp(reinterpolate) : reinterpolate)))(+y);\n  };\n\n  scale.domain = function(_) {\n    return arguments.length ? (domain = map.call(_, number), rescale()) : domain.slice();\n  };\n\n  scale.range = function(_) {\n    return arguments.length ? (range = slice.call(_), rescale()) : range.slice();\n  };\n\n  scale.rangeRound = function(_) {\n    return range = slice.call(_), interpolate = interpolateRound, rescale();\n  };\n\n  scale.clamp = function(_) {\n    return arguments.length ? (clamp = !!_, rescale()) : clamp;\n  };\n\n  scale.interpolate = function(_) {\n    return arguments.length ? (interpolate = _, rescale()) : interpolate;\n  };\n\n  return rescale();\n}\n","import {tickStep} from \"d3-array\";\nimport {format, formatPrefix, formatSpecifier, precisionFixed, precisionPrefix, precisionRound} from \"d3-format\";\n\nexport default function(domain, count, specifier) {\n  var start = domain[0],\n      stop = domain[domain.length - 1],\n      step = tickStep(start, stop, count == null ? 10 : count),\n      precision;\n  specifier = formatSpecifier(specifier == null ? \",f\" : specifier);\n  switch (specifier.type) {\n    case \"s\": {\n      var value = Math.max(Math.abs(start), Math.abs(stop));\n      if (specifier.precision == null && !isNaN(precision = precisionPrefix(step, value))) specifier.precision = precision;\n      return formatPrefix(specifier, value);\n    }\n    case \"\":\n    case \"e\":\n    case \"g\":\n    case \"p\":\n    case \"r\": {\n      if (specifier.precision == null && !isNaN(precision = precisionRound(step, Math.max(Math.abs(start), Math.abs(stop))))) specifier.precision = precision - (specifier.type === \"e\");\n      break;\n    }\n    case \"f\":\n    case \"%\": {\n      if (specifier.precision == null && !isNaN(precision = precisionFixed(step))) specifier.precision = precision - (specifier.type === \"%\") * 2;\n      break;\n    }\n  }\n  return format(specifier);\n}\n","import {ticks, tickIncrement} from \"d3-array\";\nimport {interpolateNumber as reinterpolate} from \"d3-interpolate\";\nimport {default as continuous, copy, deinterpolateLinear as deinterpolate} from \"./continuous\";\nimport tickFormat from \"./tickFormat\";\n\nexport function linearish(scale) {\n  var domain = scale.domain;\n\n  scale.ticks = function(count) {\n    var d = domain();\n    return ticks(d[0], d[d.length - 1], count == null ? 10 : count);\n  };\n\n  scale.tickFormat = function(count, specifier) {\n    return tickFormat(domain(), count, specifier);\n  };\n\n  scale.nice = function(count) {\n    if (count == null) count = 10;\n\n    var d = domain(),\n        i0 = 0,\n        i1 = d.length - 1,\n        start = d[i0],\n        stop = d[i1],\n        step;\n\n    if (stop < start) {\n      step = start, start = stop, stop = step;\n      step = i0, i0 = i1, i1 = step;\n    }\n\n    step = tickIncrement(start, stop, count);\n\n    if (step > 0) {\n      start = Math.floor(start / step) * step;\n      stop = Math.ceil(stop / step) * step;\n      step = tickIncrement(start, stop, count);\n    } else if (step < 0) {\n      start = Math.ceil(start * step) / step;\n      stop = Math.floor(stop * step) / step;\n      step = tickIncrement(start, stop, count);\n    }\n\n    if (step > 0) {\n      d[i0] = Math.floor(start / step) * step;\n      d[i1] = Math.ceil(stop / step) * step;\n      domain(d);\n    } else if (step < 0) {\n      d[i0] = Math.ceil(start * step) / step;\n      d[i1] = Math.floor(stop * step) / step;\n      domain(d);\n    }\n\n    return scale;\n  };\n\n  return scale;\n}\n\nexport default function linear() {\n  var scale = continuous(deinterpolate, reinterpolate);\n\n  scale.copy = function() {\n    return copy(scale, linear());\n  };\n\n  return linearish(scale);\n}\n","import {bisect} from \"d3-array\";\nimport {slice} from \"./array\";\n\nexport default function threshold() {\n  var domain = [0.5],\n      range = [0, 1],\n      n = 1;\n\n  function scale(x) {\n    if (x <= x) return range[bisect(domain, x, 0, n)];\n  }\n\n  scale.domain = function(_) {\n    return arguments.length ? (domain = slice.call(_), n = Math.min(domain.length, range.length - 1), scale) : domain.slice();\n  };\n\n  scale.range = function(_) {\n    return arguments.length ? (range = slice.call(_), n = Math.min(domain.length, range.length - 1), scale) : range.slice();\n  };\n\n  scale.invertExtent = function(y) {\n    var i = range.indexOf(y);\n    return [domain[i - 1], domain[i]];\n  };\n\n  scale.copy = function() {\n    return threshold()\n        .domain(domain)\n        .range(range);\n  };\n\n  return scale;\n}\n","import { notNumber } from '../../utils/is-number';\n\nfunction applyFormat(formatter) {\n  return typeof formatter === 'undefined' ? t => t : t => formatter(t);\n}\n\nfunction clamp(val) {\n  return Math.max(0, Math.min(1, val));\n}\n\nfunction isObject(obj) {\n  return typeof obj === 'object';\n}\n\nfunction minorTicksGenerator(count, start, end) {\n  const r = Math.abs(start - end);\n  const interval = r / (count + 1);\n  const ticks = [];\n  for (let i = 1; i <= count; i++) {\n    const v = i * interval;\n    ticks.push(start < end ? start + v : start - v);\n  }\n  return ticks;\n}\n\nfunction appendMinorTicks(majorTicks, minorCount, scale) {\n  if (majorTicks.length === 1) { return majorTicks; }\n\n  const ticks = majorTicks.concat([]);\n\n  for (let i = 0; i < majorTicks.length; i++) {\n    let start = majorTicks[i];\n    let end = majorTicks[i + 1];\n\n    if (i === 0 && start !== scale.start()) { // Before and after first major tick\n      ticks.push(...minorTicksGenerator(minorCount, start, end));\n      start -= end - start;\n      end = majorTicks[i];\n      ticks.push(...minorTicksGenerator(minorCount, start, end));\n    } else if (i === majorTicks.length - 1 && end !== scale.end()) { // After last major tick\n      end = start + (start - majorTicks[i - 1]);\n      ticks.push(...minorTicksGenerator(minorCount, start, end));\n    } else {\n      ticks.push(...minorTicksGenerator(minorCount, start, end));\n    }\n  }\n\n  return ticks.filter(t => t >= scale.min() && t <= scale.max());\n}\n\n/**\n* Generate ticks based on a distance, for each 100th unit, one additional tick may be added\n* @private\n* @param  {Number} distance       Distance between each tick\n* @param  {Number} scale         The scale instance\n* @param  {Number} [minorCount=0]     Number of tick added between each distance\n* @param  {Number} [unitDivider=100]   Number to divide distance with\n* @return {Array}               Array of ticks\n*/\nexport function looseDistanceBasedGenerator({\n  distance, scale, minorCount = 0, unitDivider = 100, formatter = undefined\n}) {\n  const step = !notNumber(unitDivider) && !notNumber(distance) ? Math.max(distance / unitDivider, 2) : 2;\n  const count = Math.min(1000, Math.round(step)); // safe guard against huge numbers\n  let majorTicks = scale.ticks(count);\n  if (majorTicks.length <= 1) {\n    majorTicks = scale.ticks(count + 1);\n  }\n\n  const ticks = minorCount > 0 ? appendMinorTicks(majorTicks, minorCount, scale) : majorTicks;\n  ticks.sort((a, b) => a - b);\n\n  const ticksFormatted = ticks.map(applyFormat(formatter));\n\n  return ticks.map((tick, i) => {\n    const position = scale(tick);\n    return {\n      position,\n      start: position,\n      end: position,\n      label: ticksFormatted[i],\n      value: tick,\n      isMinor: majorTicks.indexOf(tick) === -1\n    };\n  });\n}\n\n/**\n* Generate ticks based on a distance, for each 100th unit, one additional tick may be added.\n* Will attempt to round the bounds of domain to even values and generate ticks hitting the domain bounds.\n* @private\n* @param  {Number} distance       Distance between each tick\n* @param  {Number} scale         The scale instance\n* @param  {Number} [minorCount=0]     Number of tick added between each distance\n* @param  {Number} [unitDivider=100]   Number to divide distance with\n* @return {Array}               Array of ticks\n*/\nexport function tightDistanceBasedGenerator({\n  distance, scale, minorCount = 0, unitDivider = 100, formatter = undefined\n}) {\n  const step = !notNumber(unitDivider) && !notNumber(distance) ? Math.max(distance / unitDivider, 2) : 2;\n  const count = Math.min(1000, Math.round(step)); // safe guard against huge numbers\n  const n = count > 10 ? 10 : count;\n  scale.nice(n);\n\n  const majorTicks = scale.ticks(count);\n  const ticks = minorCount > 0 ? appendMinorTicks(majorTicks, minorCount, scale) : majorTicks;\n  ticks.sort((a, b) => a - b);\n\n  const ticksFormatted = ticks.map(applyFormat(formatter));\n\n  return ticks.map((tick, i) => {\n    const position = scale(tick);\n    return {\n      position,\n      start: position,\n      end: position,\n      label: ticksFormatted[i],\n      value: tick,\n      isMinor: majorTicks.indexOf(tick) === -1\n    };\n  });\n}\n\nfunction ticksByCount({\n  count, minorCount, scale, formatter\n}) {\n  return scale\n    .ticks(((count - 1) * minorCount) + count)\n    .map((tick, i) => {\n      const position = scale(tick);\n      return {\n        position,\n        start: position,\n        end: position,\n        label: formatter(tick),\n        isMinor: i % (minorCount + 1) !== 0,\n        value: tick\n      };\n    });\n}\n\nfunction ticksByValue({ values, scale, formatter = v => v }) {\n  return values\n    .sort((a, b) => (isObject(a) ? a.value : a) - (isObject(b) ? b.value : b))\n    .filter((v, i, ary) => {\n      const val = isObject(v) ? v.value : v;\n      return val <= scale.max() && val >= scale.min() && ary.indexOf(v) === i;\n    })\n    .map((v) => {\n      const value = isObject(v) ? v.value : v;\n      const position = scale(value);\n      return {\n        position,\n        value,\n        label: isObject(v) && typeof v.label !== 'undefined' ? v.label : formatter(value),\n        isMinor: false,\n        start: isObject(v) && !isNaN(v.start) ? clamp(scale(v.start)) : position, // TODOHandle end < start?\n        end: isObject(v) && !isNaN(v.end) ? clamp(scale(v.end)) : position // TODO Handle start > end?\n      };\n    });\n}\n\nfunction forceTicksAtBounds(ticks, scale, formatter) {\n  const ticksP = ticks.map(t => t.position);\n  const range = scale.range();\n\n  if (ticksP.indexOf(range[0]) === -1) {\n    ticks.splice(0, 0, {\n      position: range[0],\n      start: range[0],\n      end: range[0],\n      label: formatter(scale.start()),\n      isMinor: false,\n      value: scale.start()\n    });\n  } else if (ticks[0] && ticks[0].isMinor) {\n    ticks[0].isMinor = false; // Convert to major tick\n  }\n\n  const lastTick = ticks[ticks.length - 1];\n  if (ticksP.indexOf(range[1]) === -1) {\n    ticks.push({\n      position: range[1],\n      start: range[1],\n      end: range[1],\n      label: formatter(scale.end()),\n      isMinor: false,\n      value: scale.end()\n    });\n  } else if (lastTick && lastTick.isMinor) {\n    lastTick.isMinor = false; // Convert to major tick\n  }\n}\n\nexport function generateContinuousTicks({\n  settings, scale, distance, formatter\n}) {\n  let ticks;\n  const minorCount = settings.minorTicks && !notNumber(settings.minorTicks.count) ? Math.min(100, settings.minorTicks.count) : 0;\n\n  if (Array.isArray(settings.ticks.values)) {\n    const values = settings.ticks.values.filter(v => (typeof v === 'object' ? !notNumber(v.value) : !notNumber(v)));\n    ticks = ticksByValue({ values, scale: scale.copy(), formatter });\n  } else if (!notNumber(settings.ticks.count)) {\n    const count = Math.min(1000, settings.ticks.count);\n    ticks = ticksByCount({\n      count, minorCount, scale: scale.copy(), formatter\n    });\n  } else {\n    const tickGen = settings.ticks.tight ? tightDistanceBasedGenerator : looseDistanceBasedGenerator;\n    ticks = tickGen({\n      distance,\n      minorCount,\n      unitDivider: settings.ticks.distance,\n      scale,\n      formatter\n    });\n\n    if (settings.ticks.forceBounds) {\n      forceTicksAtBounds(ticks, scale, formatter);\n    }\n  }\n\n  return ticks;\n}\n\nexport function generateDiscreteTicks({ scale }) {\n  const domain = scale.domain();\n  const values = domain;\n  const dataItems = scale.data().items;\n  const labels = scale.labels ? scale.labels() : values;\n  const bandwidth = scale.bandwidth();\n\n  return values.map((d, i) => {\n    const start = scale(d);\n    return {\n      position: start + (bandwidth / 2),\n      label: `${labels[i]}`,\n      data: dataItems ? dataItems[i] : undefined,\n      start,\n      end: start + bandwidth\n    };\n  });\n}\n","export default function resolveSettings(settings = {}, defaultSettings = {}, context = {}) {\n  const stngs = {};\n\n  Object.keys(defaultSettings).forEach((key) => {\n    const type = typeof settings[key];\n\n    if (type === 'function') {\n      stngs[key] = settings[key](context);\n    } else if (type === 'undefined') {\n      stngs[key] = defaultSettings[key];\n    } else {\n      stngs[key] = settings[key];\n    }\n  });\n\n  return stngs;\n}\n","import { scaleLinear as d3ScaleLinear } from 'd3-scale';\nimport extend from 'extend';\n\nimport { notNumber } from '../utils/is-number';\nimport { generateContinuousTicks } from './ticks/tick-generators';\nimport resolveSettings from './settings-resolver';\n\nexport const DEFAULT_SETTINGS = {\n  min: NaN,\n  max: NaN,\n  expand: NaN,\n  include: [],\n  invert: false\n};\n\nexport const DEFAULT_TICKS_SETTINGS = {\n  tight: false,\n  forceBounds: false,\n  values: undefined,\n  count: NaN,\n  distance: 100\n};\n\nexport const DEFAULT_MINORTICKS_SETTINGS = {\n  count: NaN\n};\n\n/**\n * @typedef {object} scale--linear\n * @property {string} [type='linear']\n * @property {number} [expand] - Expand the output range\n * @property {boolean} [invert=false] - Invert the output range\n * @property {number[]} [include] - Include specified numbers in the output range\n * @property {object} [ticks]\n * @property {boolean} [ticks.tight = false]\n * @property {boolean} [ticks.forceBounds = false]\n * @property {number} [ticks.distance = 100]  - Approximate distance between each tick\n * @property {number[]|object[]} [ticks.values] - If set, ticks are no longer generated but instead equal to this set\n * @property {number} [ticks.count]\n * @property {object} [minorTicks]\n * @property {number} [minorTicks.count = 3]\n * @property {number} [min] - Set an explicit minimum value\n * @property {number} [max] - Set an explicit maximum value\n */\n\nfunction getMinMax(settings, fields) {\n  const min = +settings.min;\n  const max = +settings.max;\n  let fieldMin = 0;\n  let fieldMax = 1;\n  if (fields && fields[0]) {\n    const minValues = fields.map(m => m.min()).filter(v => !isNaN(v));\n    const maxValues = fields.map(m => m.max()).filter(v => !isNaN(v));\n    fieldMin = minValues.length ? Math.min(...minValues) : Number.NaN;\n    fieldMax = maxValues.length ? Math.max(...maxValues) : Number.NaN;\n\n    if (isNaN(fieldMin) || isNaN(fieldMax)) {\n      fieldMin = -1;\n      fieldMax = 1;\n    } else if (fieldMin === fieldMax && fieldMin === 0) {\n      fieldMin = -1;\n      fieldMax = 1;\n    } else if (fieldMin === fieldMax && fieldMin) {\n      fieldMin -= Math.abs(fieldMin * 0.1);\n      fieldMax += Math.abs(fieldMax * 0.1);\n    } else if (!isNaN(settings.expand)) {\n      const range = fieldMax - fieldMin;\n      fieldMin -= range * settings.expand;\n      fieldMax += range * settings.expand;\n    }\n\n    if (Array.isArray(settings.include)) {\n      const i = settings.include.filter(n => !isNaN(n));\n      fieldMin = Math.min(...i, fieldMin);\n      fieldMax = Math.max(...i, fieldMax);\n    }\n  }\n\n  return {\n    mini: !isNaN(min) ? min : fieldMin,\n    maxi: !isNaN(max) ? max : fieldMax\n  };\n}\n\nfunction initNormScale(normScale, scale) {\n  if (normScale.instance) {\n    return;\n  }\n  normScale.instance = scale.copy();\n  normScale.instance.domain([scale.start(), scale.end()]);\n  normScale.instance.clamp(true);\n  normScale.instance.range(normScale.invert ? [1, 0] : [0, 1]);\n}\n/**\n * @alias scaleLinear\n * @private\n * @param { object } settings\n * @param { field[] } [fields]\n * @return { linear }\n */\n\nexport default function scaleLinear(settings = {}, data = {}, resources = {}) {\n  const d3Scale = d3ScaleLinear();\n  const normScale = { instance: null, invert: false };\n  const ctx = { data, resources };\n  const stgns = resolveSettings(settings, DEFAULT_SETTINGS, ctx);\n  stgns.ticks = resolveSettings(settings.ticks, DEFAULT_TICKS_SETTINGS, ctx);\n  stgns.minorTicks = resolveSettings(settings.minorTicks, DEFAULT_MINORTICKS_SETTINGS, ctx);\n  let tickCache;\n\n  /**\n   * @alias linear\n   * @private\n   * @param { Object } value\n   * @return { number }\n   */\n  function fn(v) {\n    if (notNumber(v)) {\n      return NaN;\n    }\n    return d3Scale(v);\n  }\n\n  fn.data = () => data;\n\n  /**\n   * {@link https://github.com/d3/d3-scale#continuous_invert }\n   * @param { number } value The inverted value\n   * @return { number } The inverted scaled value\n   */\n  fn.invert = function invert(value) {\n    return d3Scale.invert(value);\n  };\n\n  /**\n   * {@link https://github.com/d3/d3-scale#continuous_rangeRound }\n   * @param { number[] } values Range values\n   * @return { linear } The instance this method was called on\n   */\n  fn.rangeRound = function rangeRound(values) {\n    d3Scale.rangeRound(values);\n    return fn;\n  };\n\n  /**\n   * {@link https://github.com/d3/d3-scale#continuous_clamp }\n   * @param { boolean } [ value=true ] TRUE if clamping should be enabled\n   * @return { linear } The instance this method was called on\n   */\n  fn.clamp = function clamp(value = true) {\n    d3Scale.clamp(value);\n    return fn;\n  };\n\n  /**\n   * Get cached ticks (if any)\n   * @return { number | undefined }\n   */\n  fn.cachedTicks = function fnCachedTicks() {\n    return tickCache;\n  };\n\n  /**\n   * Clear the tick cache\n   * @return {number | undefined}\n   */\n  fn.clearTicksCache = function fnClearTicks() {\n    tickCache = undefined;\n    return this;\n  };\n\n  /**\n   * {@link https://github.com/d3/d3-scale#continuous_ticks }\n   * @param { Object } input Number of ticks to generate or an object passed to tick generator\n   * @return { number[] | Object } Array of ticks or any type the custom tick generator returns\n   */\n  fn.ticks = function ticks(input) {\n    if (input !== null && typeof input === 'object') {\n      input.settings = input.settings || {};\n      // TODO Discontinue support for custom ticks settings as argument\n      input.settings = extend(true, {}, stgns, input.settings);\n      input.scale = fn;\n      tickCache = generateContinuousTicks(input);\n      return tickCache;\n    }\n\n    tickCache = d3Scale.ticks(input);\n    return tickCache;\n  };\n\n  /**\n   * {@link https://github.com/d3/d3-scale#continuous_nice }\n   * @param { number } count\n   * @return { linear } The instance this method was called on\n   */\n  fn.nice = function nice(count) {\n    d3Scale.nice(count);\n\n    return fn;\n  };\n\n  // TODO Support this?\n  fn.tickFormat = function tickFormat(count, format) {\n    return d3Scale.tickFormat(count, format);\n  };\n\n  // TODO Support this?\n  fn.interpolate = function interpolate(func) {\n    d3Scale.interpolate(func);\n    return fn;\n  };\n\n  /**\n   * @param { number[] } [values] Set or Get domain values\n   * @return { linear | Number[] } The instance this method was called on if a parameter is provided, otherwise the current domain is returned\n   */\n  fn.domain = function domain(values) {\n    if (arguments.length) {\n      d3Scale.domain(values);\n      if (normScale.instance) {\n        normScale.instance.domain([fn.start(), fn.end()]);\n      }\n      return fn;\n    }\n    return d3Scale.domain();\n  };\n\n  /**\n   * @param { number[] } [values] Set or Get range values\n   * @return { linear | number[] } The instance this method was called on if a parameter is provided, otherwise the current range is returned\n   */\n  fn.range = function range(values) {\n    if (arguments.length) {\n      d3Scale.range(values);\n\n      return fn;\n    }\n    return d3Scale.range();\n  };\n\n  /**\n   * Get the first value of the domain\n   * @return { number }\n   */\n  fn.start = function start() {\n    return fn.domain()[0];\n  };\n\n  /**\n   * Get the last value of the domain\n   * @return { number }\n   */\n  fn.end = function end() {\n    return fn.domain()[this.domain().length - 1];\n  };\n\n  /**\n   * Get the minimum value of the domain\n   * @return { number }\n   */\n  fn.min = function min() {\n    return Math.min(this.start(), this.end());\n  };\n\n  /**\n   * Get the maximum value of the domain\n   * @return { number }\n   */\n  fn.max = function max() {\n    return Math.max(this.start(), this.end());\n  };\n\n  /**\n   * Divides the domain and range into uniform segments, based on start and end value\n   * @param  { number } segments The number of segments\n   * @return { function } The instance this method was called on\n   * @example\n   * let s = linear();\n   * s.domain([0, 10]);\n   * s.range([0, 1]);\n   * s.classify( 2 );\n   * s.domain(); // [10, 5, 5, 0]\n   * s.range(); // [0.75, 0.75, 0.25, 0.25]\n   */\n  fn.classify = function classify(segments) {\n    let valueRange = (fn.start() - fn.end()) / segments,\n      domain = [fn.end()],\n      range = [],\n      samplePos = valueRange / 2;\n\n    for (let i = 0; i < segments; i++) {\n      let lastVal = domain[domain.length - 1] || 0,\n        calIntervalPos = lastVal + valueRange,\n        calSamplePos = lastVal + samplePos,\n        sampleColValue = fn(calSamplePos);\n\n      domain.push(...[calIntervalPos, calIntervalPos]);\n      range.push(...[sampleColValue, sampleColValue]);\n    }\n    domain.pop();\n    fn.domain(domain);\n    fn.range(range);\n\n    return fn;\n  };\n\n  fn.copy = function copy() {\n    const cop = scaleLinear(settings, data, resources);\n    cop.domain(fn.domain());\n    cop.range(fn.range());\n    cop.clamp(d3Scale.clamp());\n    return cop;\n  };\n\n  /**\n   * @param {number} d - A domain value\n   * @return {number} A normalized range output given in range 0-1\n   * @example\n   * const scale = scaleLinear().domain([0, 10]).range([0, 10000]);\n   * scale.norm(5); // Returns 0.5\n   * scale(5); // Returns 5000\n   *\n   * scale.domain([0, 2, 10]);\n   * scale.norm(5); // Returns 0.5\n   */\n  fn.norm = function norm(d) {\n    initNormScale(normScale, fn);\n\n    return normScale.instance(d);\n  };\n\n  /**\n   * @param {number} d - A normalized value in range 0-1\n   * @return {number} A corresponding domain value\n   * @example\n   * const scale = scaleLinear().domain([0, 10]).range([0, 10000]);\n   * scale.normInvert(0.5); // Returns 5\n   * scale.invert(5000); // Returns 5\n   */\n  fn.normInvert = function norm(t) {\n    initNormScale(normScale, fn);\n\n    return normScale.instance.invert(t);\n  };\n\n  const { mini, maxi } = getMinMax(stgns, data ? data.fields : []);\n\n  fn.domain([mini, maxi]);\n  fn.range(stgns.invert ? [1, 0] : [0, 1]);\n  normScale.invert = stgns.invert;\n\n  return fn;\n}\n","import extend from 'extend';\nimport { scaleBand as d3ScaleBand } from 'd3-scale';\nimport { generateDiscreteTicks } from './ticks/tick-generators';\nimport resolveSettings from './settings-resolver';\n\nexport const DEFAULT_SETTINGS = {\n  padding: 0,\n  paddingInner: NaN,\n  paddingOuter: NaN,\n  align: 0.5,\n  invert: false,\n  maxPxStep: NaN\n};\n\n/**\n * @typedef {object} scale--band\n * @property {string} [type='band']\n * @property {number} [padding] - {@link https://github.com/d3/d3-scale#band_padding}\n * @property {number} [paddingInner] - {@link https://github.com/d3/d3-scale#band_paddingInner}\n * @property {number} [paddingOuter] - {@link https://github.com/d3/d3-scale#band_paddingOuter}\n * @property {number} [align] - {@link https://github.com/d3/d3-scale#band_align}\n * @property {boolean} [invert=false] - Invert the output range\n * @property {number} [maxPxStep] - Explicitly limit the bandwidth to a pixel value\n * @property {function} [label] - Callback label function, applied on each datum\n * @property {function} [value] - Callback value function, applied on each datum\n */\n\n/**\n * @alias scaleBand\n * @memberof picasso\n * @private\n * @param { Object } settings\n * @param { fields[] } [fields]\n * @param { dataset } [dataset]\n * @return { band }\n */\n\nexport default function scaleBand(settings = {}, data = {}, resources = {}) {\n  /**\n   * An augmented {@link https://github.com/d3/d3-scale#_band|d3 band scale}\n   * @alias band\n   * @private\n   * @kind function\n   * @param { Object } value\n   * @return { number }\n   */\n  const band = d3ScaleBand();\n  const ctx = { data, resources };\n  const stgns = resolveSettings(settings, DEFAULT_SETTINGS, ctx);\n  const items = data.items || [];\n  const domainToDataMapping = {};\n  const values = [];\n  const labels = [];\n\n  // I would like to define this outside of scaleBand but it cause the documentation to be in the wrong order\n  function augmentScaleBand(band, settings) { // eslint-disable-line no-shadow\n    band.data = () => data;\n\n    band.datum = domainValue => items[domainToDataMapping[domainValue]];\n\n    /**\n     * Get the first value of the domain\n     * @return { number }\n     */\n    band.start = function start() {\n      return band.domain()[0];\n    };\n\n    /**\n     * Get the last value of the domain\n     * @return { number }\n     */\n    band.end = function end() {\n      return band.domain()[band.domain().length - 1];\n    };\n\n    band.labels = () => labels;\n\n    /**\n     * Generate discrete ticks\n     * @return {Object[]} Array of ticks\n     */\n    band.ticks = function ticks(input = {}) {\n      input.scale = band;\n      return generateDiscreteTicks(input, settings.trackBy || 'label');\n    };\n  }\n  augmentScaleBand(band, settings);\n\n  /**\n   * if required creates a new scale with a restricted range\n   * so that step size is at most maxPxStep\n   * otherwise it returns itself\n   * @param { number } size\n   * @return { band }\n   */\n  band.pxScale = function pxScale(size) {\n    const max = stgns.maxPxStep;\n    if (isNaN(max)) {\n      return band;\n    }\n    const n = band.domain().length;\n    const sizeRelativeToStep = Math.max(1, (n - band.paddingInner()) + (2 * band.paddingOuter()));\n\n    if (sizeRelativeToStep * max >= size) {\n      return band;\n    }\n\n    const newBand = band.copy();\n    newBand.type = band.type;\n    augmentScaleBand(newBand, settings);\n    const t = (sizeRelativeToStep * max) / size;\n    const offset = (1 - t) * band.align();\n    newBand.range(stgns.invert ? [t + offset, offset] : [offset, t + offset]);\n\n    return newBand;\n  };\n\n  const valueFn = typeof settings.value === 'function' ? settings.value : d => d.datum.value;\n  const labelFn = typeof settings.label === 'function' ? settings.label : d => d.datum.label;\n\n  for (let i = 0; i < items.length; i++) {\n    const arg = extend({ datum: items[i] }, ctx);\n    const v = valueFn(arg, i);\n    if (values.indexOf(v) === -1) {\n      values.push(v);\n      labels.push(labelFn(arg, i));\n      domainToDataMapping[v] = i;\n    }\n  }\n\n  band.domain(values);\n  band.range(stgns.invert ? [1, 0] : [0, 1]);\n\n  band.padding(isNaN(stgns.padding) ? 0 : stgns.padding);\n  if (!isNaN(stgns.paddingInner)) { band.paddingInner(stgns.paddingInner); }\n  if (!isNaN(stgns.paddingOuter)) { band.paddingOuter(stgns.paddingOuter); }\n  band.align(isNaN(stgns.align) ? 0.5 : stgns.align);\n\n  return band;\n}\n","import extend from 'extend';\nimport bandScale, { DEFAULT_SETTINGS } from './band';\nimport resolveSettings from './settings-resolver';\n\nconst DEFAULT_TICKS_SETTINGS = {\n  depth: 0\n};\n\nfunction keyGen(node, valueFn, ctx) {\n  return node.ancestors()\n    .map(a => valueFn(extend({ datum: a.data }, ctx)))\n    .reverse()\n    .slice(1) // Delete root node\n    .toString();\n}\n\nfunction flattenTree(rootNode, settings, ctx) {\n  const ticksDepth = settings.ticks.depth;\n  const valueFn = settings.value;\n  const labelFn = settings.label;\n  const values = [];\n  const labels = [];\n  const items = {};\n  const ticks = [];\n  let expando = 0;\n  if (!rootNode) {\n    return {\n      values, labels, items, ticks\n    };\n  }\n\n  rootNode.eachAfter((node) => {\n    if (node.depth > 0) {\n      const key = keyGen(node, valueFn, ctx);\n      const leaves = node.leaves() || [node]; // If leaf node returns itself\n      const value = valueFn(extend({ datum: node.data }, ctx));\n      const label = labelFn(extend({ datum: node.data }, ctx));\n      const isBranch = Array.isArray(node.children);\n\n      const item = {\n        key,\n        count: leaves.length,\n        value,\n        label,\n        leftEdge: keyGen(leaves[0], valueFn, ctx),\n        rightEdge: keyGen(leaves[Math.max(leaves.length - 1, 0)], valueFn, ctx),\n        node\n        // isTick: ticksDepth === null ? !isBranch : node.depth === ticksDepth\n      };\n\n      if (isBranch) {\n        values.push(`SPACER_${expando}_SPACER`);\n        expando++;\n      } else {\n        values.push(key);\n        labels.push(label);\n      }\n\n      if ((ticksDepth <= 0 && !isBranch) || node.depth === ticksDepth) {\n        ticks.push(item);\n      }\n\n      items[key] = item;\n    }\n  });\n\n  const spill = rootNode.height - 1;\n  if (spill > 0) {\n    values.splice(-spill);\n  }\n\n  return {\n    values, labels, items, ticks\n  };\n}\n\n/**\n * @typedef {object} scale-hBand.settings\n * @private\n * @property {number} [padding=0] - Exposes {@link https://github.com/d3/d3-scale#band_padding}\n * @property {boolean} [paddingOuter=0] - Exposes {@link https://github.com/d3/d3-scale#band_paddingOuter}\n * @property {number[]} [paddingInner=0] - Exposes {@link https://github.com/d3/d3-scale#band_paddingInner}\n * @property {object} [align=0.5] - Exposes {@link https://github.com/d3/d3-scale#band_align}\n * @property {boolean} [invert=false] - Invert the output range\n */\n\n/**\n  * Hierarchical band scale, that is an augmented band scale, that takes hierarchical data as input\n * @alias scaleHierarchicalBand\n * @private\n * @param { Object } settings\n * @param { fields[] } [fields]\n * @param { dataset } [dataset] - With a root property that is an instance of D3.js Hierarchy\n * @return { h-band }\n */\n\nexport default function scaleHierarchicalBand(settings = {}, data = {}, resources = {}) {\n  const ctx = { data, resources };\n  const stgns = resolveSettings(settings, DEFAULT_SETTINGS, ctx);\n  stgns.ticks = resolveSettings(settings.ticks, DEFAULT_TICKS_SETTINGS, ctx);\n  stgns.value = typeof settings.value === 'function' ? settings.value : d => d.datum.value;\n  stgns.label = typeof settings.label === 'function' ? settings.label : d => d.datum.value;\n\n  let bandInstance = bandScale(stgns);\n\n  const {\n    values, labels, items, ticks\n  } = flattenTree(data.root, stgns, ctx);\n\n  /**\n   * @alias h-band\n   * @private\n   * @kind function\n   * @param { Object[] } value - Array where each value is a reference to a node, going from depth 1 to n.\n   * @return { number }\n   */\n  const hBand = function fn(val) {\n    const strVal = String(val);\n    const item = items[strVal];\n    if (item) {\n      return bandInstance(stgns.invert ? item.rightEdge : item.leftEdge);\n    }\n\n    return bandInstance(strVal);\n  };\n\n  extend(true, hBand, bandInstance);\n\n  /**\n   * Wrapped {@link https://github.com/d3/d3-scale#band_bandwidth}\n   * @param { Object[] } [val] - Array where each value is a reference to a node, going from depth 1 to n. If omitted, bandwidth for the leaf nodes is return.\n   * @return { number }\n   */\n\n  hBand.bandwidth = function bandwidth(val) {\n    const item = items[String(val)];\n    const bw = bandInstance.bandwidth();\n    if (item && !item.isLeaf) {\n      const left = hBand(item.leftEdge);\n      const right = hBand(item.rightEdge);\n      return Math.abs(left - right) + bw;\n    }\n    return bw;\n  };\n\n  /**\n   * Wrapped {@link https://github.com/d3/d3-scale#band_step}\n   * @param { Object[] } [val] - Array where each value is a reference to a node, going from depth 1 to n. If omitted, step size for the leaf nodes is return.\n   * @return { number }\n   */\n  hBand.step = function step(val) {\n    const item = items[String(val)];\n    const leafCount = item ? item.count : 1;\n    let stepSize = bandInstance.step();\n    stepSize *= leafCount;\n    return stepSize;\n  };\n\n  /**\n   * @return { dataset }\n   */\n  hBand.data = () => data;\n\n  /**\n   * Return datum for a given node\n   * @param { Object[] } val - Array where each value is a reference to a node, going from depth 1 to n.\n   * @return { Object } The datum\n   */\n  hBand.datum = (val) => {\n    const item = items[String(val)];\n    if (item) {\n      return item.node.data;\n    }\n    return null;\n  };\n\n  hBand.copy = () => scaleHierarchicalBand(settings, data, resources);\n\n  /**\n   * @return { Object[] } Labels for each leaf node\n   */\n  hBand.labels = () => labels;\n\n  /**\n   * Generate discrete ticks\n   * @return { Object[] } Ticks for each leaf node\n   */\n  hBand.ticks = () => { // eslint-disable-line arrow-body-style\n    return ticks.map((item) => {\n      const start = hBand(item.key);\n      const bandwidth = hBand.bandwidth(item.key);\n      return {\n        position: start + (bandwidth / 2),\n        label: item.label,\n        data: item.node.data,\n        start,\n        end: start + bandwidth\n      };\n    });\n  };\n\n  const orgPxScale = bandInstance.pxScale;\n  hBand.pxScale = function pxScale(size) {\n    bandInstance = orgPxScale(size);\n    return hBand;\n  };\n\n  hBand.domain(values);\n\n  return hBand;\n}\n\n","import { isNumber as numericFilter } from './is-number';\n\nconst minAccessor = v => v.min();\nconst maxAccessor = v => v.max();\n\n/**\n * Calculate the min/max value based on various inputs.\n *\n * Provided min/max setting takes presedence over all other inputs. If not provided, the respective values are calculated\n * from the given arr input, where each item in the array is expected to have a min/max accessor.\n *\n * @private\n * @param {object} [settings]\n * @param {number} [settings.min] The minimum value. Defaults to 0 if not provided.\n * @param {number} [settings.max] The maximum value. Defaults to 1 if not provided.\n * @param {object} [arr]\n * @returns { object[] } An array containing the min and max values.\n *\n * @example\n * minmax(); // [0, 1]\n *\n * minmax({}, [\n * { min: () => 13, max: () => 15 },\n * { min: () => NaN, max: () => 17 },\n * ]); // [13, 17]\n *\n * minmax({ min: -5, max: 4 }, [\n * { min: () => -20, max: () => 15 },\n * ]); // [-5, 4]\n */\nexport default function minmax(settings, arr) {\n  // const definedMin = settings && typeof settings.min !== 'undefined';\n  // const definedMax = settings && typeof settings.max !== 'undefined';\n  const definedMin = settings && !isNaN(settings.min);\n  const definedMax = settings && !isNaN(settings.max);\n\n  let min = definedMin ? +settings.min : 0;\n  let max = definedMax ? +settings.max : 1;\n\n  if (arr && arr.length) {\n    if (!definedMin) {\n      const arrMin = arr.map(minAccessor).filter(numericFilter);\n      min = arrMin.length ? Math.min(...arrMin) : min;\n    }\n\n    if (!definedMax) {\n      const arrMax = arr.map(maxAccessor).filter(numericFilter);\n      max = arrMax.length ? Math.max(...arrMax) : max;\n    }\n  }\n\n  return [min, max];\n}\n","import { interpolateRgb } from 'd3-interpolate';\nimport extend from 'extend';\nimport minmax from '../../utils/min-max';\nimport linear from '../linear';\nimport resolveSettings from '../settings-resolver';\n\nconst DEFAULT_SETTINGS = {\n  domain: [],\n  range: [],\n  invert: false,\n  min: NaN,\n  max: NaN\n};\n\nfunction generateDomain(range, min, max) {\n  const len = range.length;\n  if (len === 2) {\n    return [min, max];\n  }\n  const domain = [];\n  const part = (max - min) / (len - 1);\n\n  domain.push(min);\n  for (let i = 1; i < len - 1; i++) {\n    domain.push(min + (part * i));\n  }\n  domain.push(max);\n\n  return domain;\n}\n\n/**\n * @typedef {object} scale--sequential-color\n * @property {string} [type='sequential-color']\n * @property {string[]} [range] - CSS color values of the output range\n * @property {boolean} [invert=false] - Invert range\n * @property {number} [min] - Set an explicit minimum value\n * @property {number} [max] - Set an explicit maximum value\n */\n\n/**\n * @alias scaleSequentialColor\n * @private\n * @param { Object } [settings] Settings for this scale. If both range and domain are specified, they have to fulfill range.length === domain.length, otherwise they will be overriden.\n * @param { number[] } [settings.domain] Numeric values indicating stop limits between start and end values.\n * @param { color[] } [settings.range] CSS color values indicating stop colors between start and end values.\n * @param { field[] } [fields] Fields to dynamically calculate the domain extent.\n * @return { sequentialColor }\n *\n * @example\n * picasso.scaleSequentialColor({\n *  range: ['red', '#fc6', 'green'],\n *  domain: [-40, 0, 100]\n * });\n */\n\nexport default function scaleSequentialColor(settings = {}, data = {}, resources = {}) {\n  const s = linear(settings, data, resources).clamp(true).interpolate(interpolateRgb);\n  const stgns = resolveSettings(settings, DEFAULT_SETTINGS, { data, resources });\n  const isDomain = Array.isArray(stgns.domain) && stgns.domain.length;\n  const isRange = Array.isArray(stgns.range) && stgns.range.length;\n\n  /**\n   * @alias sequentialColor\n   * @private\n   * @kind function\n   * @param { Object } v Object containing a 'value' property\n   * @return { string } The blended color\n   */\n  const fn = s;\n\n  extend(true, fn, s);\n  const [min, max] = minmax(stgns, data ? data.fields : []);\n  const num = isDomain ? stgns.domain.length : -1;\n  const DEFAULT_COLORS = resources.theme ? resources.theme.palette('sequential', num > 0 ? num : 2) : [];\n\n  const range = isRange ? stgns.range : DEFAULT_COLORS;\n  fn.range(stgns.invert ? range.slice().reverse() : range.slice());\n  fn.domain(isDomain ? stgns.domain : generateDomain(fn.range(), min, max));\n\n  return fn;\n}\n","import { scaleThreshold, scaleLinear } from 'd3-scale';\nimport { notNumber } from '../../utils/is-number';\nimport minmax from '../../utils/min-max';\nimport sequential from './sequential';\nimport resolveSettings from '../settings-resolver';\n\n// const DEFAULT_COLORS = ['rgb(180,221,212)', 'rgb(34, 83, 90)'];\n\nconst DEFAULT_SETTINGS = {\n  domain: [],\n  range: [],\n  invert: false,\n  min: NaN,\n  max: NaN,\n  nice: false\n};\n\nfunction generateDomain(range, min, max) {\n  const len = range.length;\n  if (len === 2) {\n    return [min + ((max - min) / 2)];\n  }\n  const domain = [];\n  const part = (max - min) / len;\n\n  for (let i = 1; i < len; i++) {\n    domain.push(min + (part * i));\n  }\n  return domain;\n}\n\nfunction getBreaks(domain) {\n  const ret = [];\n  for (let i = 0; i < domain.length - 1; i++) {\n    ret.push((domain[i] + domain[i + 1]) / 2);\n  }\n  return ret;\n}\n\nfunction generateRange(domain, colors, min, max) {\n  min = domain[0];\n  max = domain && domain.length >= 2 ? domain[domain.length - 1] : max;\n  const seq = sequential().domain([min, max]).range(colors);\n  const values = [min, ...getBreaks(domain), max];\n  return values.map(v => seq(v));\n}\n\nfunction generateNiceDomain(range, min, max) {\n  const numPoints = range.length === 2 ? 10 : Math.max(1, range.length);\n  const lin = scaleLinear().domain([min, max]).nice(numPoints);\n  const domain = lin.ticks(numPoints);\n\n  if (!range || !range.length) {\n    return domain;\n  }\n\n  // remove values from endpoints\n  const num = Math.max(0, range.length - 1);\n  while (domain.length > num) {\n    if (domain[0] - min <= max - domain[domain.length - 1]) {\n      domain.shift();\n    } else {\n      domain.pop();\n    }\n  }\n\n  return domain;\n}\n\n/**\n * @typedef {object} scale--threshold-color\n * @property {string} [type='threshold-color']\n * @property {number[]} [domain] Values defining the thresholds\n * @property {string[]} [range] - CSS color values of the output range\n * @property {boolean} [invert=false] - Invert range\n * @property {number} [min] - Set an explicit minimum value\n * @property {number} [max] - Set an explicit maximum value\n * @property {boolean} [nice=false] If set to true, will generate 'nice' domain values. Ignored if domain is set.\n */\n\n/**\n * @alias scaleThresholdColor\n * @private\n * @param { object } [settings] Settings for this scale. If both domain and range are specified, they have to fulfill domain.length === range.length + 1,  otherwise they will be overriden.\n * @param { number[] } [settings.domain] Values defining the thresholds.\n * @param { color[] } [settings.range] CSS color values of the output range.\n * @param { boolean } [settings.nice=false] If set to true, will generate 'nice' domain values. Ignored if domain is set.\n * @param { number } [settings.min] Minimum value to generate domain extent from. Ignored if domain is set.\n * @param { number } [settings.max] Maximum value to generate domain extend from. Ignored if domain is set.\n * @param { field[] } [fields] Fields to dynamically calculate the domain extent from. Ignored if min/max are set.\n * @return { thresholdColor }\n *\n * @example\n * let t = threshold({\n *   range: ['black', 'white'],\n *   domain: [25,50,75],\n *   max: 100,\n *   min: 0\n * });\n * t.domain(); // [25,50,75]\n * t.range(); // Generates from colors and domain: ['rgb(0,0,0)','rgb(85,85,85)','rgb(170,170,170)','rgb(255,255,255)']\n */\n\nexport default function scaleThresholdColor(settings = {}, data = {}, resources = {}) {\n  const d3Scale = scaleThreshold();\n  const stgns = resolveSettings(settings, DEFAULT_SETTINGS, { data, resources });\n  const isDomain = Array.isArray(stgns.domain) && stgns.domain.length;\n  const isRange = Array.isArray(stgns.range) && stgns.range.length;\n\n  /**\n   * @alias thresholdColor\n   * @private\n   * @param { object } v Object literal containing a 'value' property.\n   * @return { string } A CSS color from the scale's range.\n   */\n  function fn(v) {\n    if (notNumber(v)) {\n      return NaN;\n    }\n    return d3Scale(v);\n  }\n\n  Object.keys(d3Scale).forEach(key => (fn[key] = d3Scale[key]));\n\n  const fields = data.fields;\n\n  const [min, max] = minmax(stgns, fields);\n  const num = isDomain ? stgns.domain.length : -1;\n  const DEFAULT_COLORS = resources.theme ? resources.theme.palette('sequential', num > 0 ? num : 2) : [];\n\n  let range = isRange ? stgns.range : DEFAULT_COLORS;\n  let domain = [];\n\n  if (isDomain) {\n    domain = stgns.domain;\n  } else if (stgns.nice) {\n    domain = generateNiceDomain(range, min, max);\n  } else {\n    domain = [min + ((max - min) / 2)];\n  }\n\n  if (range.length > domain.length + 1) {\n    // Generate limits from range\n    domain = generateDomain(range, min, max);\n  } else if (range.length < domain.length + 1) {\n    // Generate additional colors\n    range = generateRange(domain, range, min, max);\n  }\n\n  fn.data = () => data;\n\n  fn.range(stgns.invert ? range.slice().reverse() : range);\n  fn.domain(domain);\n\n  return fn;\n}\n","import { scaleOrdinal } from 'd3-scale';\nimport extend from 'extend';\nimport resolveSettings from './settings-resolver';\n\nconst DEFAULT_SETTINGS = {\n  domain: [],\n  range: []\n};\n\n/**\n * @alias scaleOrdinal\n * @private\n * @param { Object } settings\n * @param { field[] } [fields]\n * @param { dataset } data\n * @return { ordinal }\n */\nexport default function ordinal(settings = {}, data = {}, resources = {}) {\n  /**\n   * An augmented {@link https://github.com/d3/d3-scale#_ordinal|d3 ordinal scale}\n   * @private\n   * @alias ordinal\n   * @param { Object }\n   * @return { number }\n   */\n  const fn = scaleOrdinal();\n\n  const ctx = { data, resources };\n  const stgns = resolveSettings(settings, DEFAULT_SETTINGS, ctx);\n\n  const valueFn = typeof settings.value === 'function' ? settings.value : d => d.datum.value;\n  const labelFn = typeof settings.label === 'function' ? settings.label : d => d.datum.label;\n  const items = data.items || [];\n  const domainToDataMapping = {};\n  const values = [];\n  const labels = [];\n\n  for (let i = 0; i < items.length; i++) {\n    const arg = extend({ datum: items[i] }, ctx);\n    const v = valueFn(arg, i);\n    if (values.indexOf(v) === -1) {\n      values.push(v);\n      labels.push(labelFn(arg, i));\n      domainToDataMapping[v] = i;\n    }\n  }\n\n  fn.data = () => data;\n\n  fn.labels = () => labels;\n\n  fn.label = domainValue => labels[values.indexOf(domainValue)];\n\n  fn.datum = domainValue => items[domainToDataMapping[domainValue]];\n\n  fn.range(stgns.range);\n\n  if (Array.isArray(stgns.domain) && stgns.domain.length) {\n    fn.domain(stgns.domain);\n  } else {\n    fn.domain(values);\n  }\n  return fn;\n}\n","import ordinal from '../ordinal';\nimport resolveSettings from '../settings-resolver';\n\nconst DEFAULT_SETTINGS = {\n  domain: [],\n  range: [],\n  unknown: undefined\n};\n\nconst DEFAULT_EXPLICIT_SETTINGS = {\n  domain: [],\n  range: [],\n  override: false\n};\n\n/**\n * @typedef {object} scale--categorical-color\n * @property {string} [type='categorical-color']\n * @property {string[]} [range=false] - CSS color values of the output range\n * @property {string} [unknown] - {@link https://github.com/d3/d3-scale#ordinal_unknown}\n * @property {object} [explicit] - Explicitly bind values to an output\n * @property {object[]} [explicit.domain[]] - Values to bind\n * @property {string[]} [explicit.range[]] - Output range\n */\n\n/**\n * An ordinal scale with the output range set to default colors, as defined by *scaleCategorical.range*\n * @alias scaleCategorical\n * @private\n * @param { Object } settings\n * @param { field[] } [fields]\n * @param { dataset } [dataset]\n * @return { ordinal }\n */\nexport default function scaleCategorical(settings = {}, data = {}, resources = {}) {\n  const s = ordinal(settings, data, resources);\n  const theme = resources.theme;\n  const stgns = resolveSettings(settings, DEFAULT_SETTINGS, { data, resources });\n  stgns.explicit = resolveSettings(settings.explicit, DEFAULT_EXPLICIT_SETTINGS, { data, resources });\n\n  let range;\n  if (!Array.isArray(stgns.range) || stgns.range.length === 0) {\n    range = theme ? theme.palette('categorical', s.domain().length).slice() : [];\n  } else {\n    range = stgns.range.slice();\n  }\n\n  if (stgns.unknown) {\n    s.unknown(stgns.unknown);\n  } else if (theme && theme.palette('unknown')) {\n    let un = theme.palette('unknown');\n    s.unknown(un[0]);\n  }\n\n  if (Array.isArray(stgns.explicit.domain) && stgns.explicit.domain.length) {\n    const domain = s.domain().slice();\n    const explicitDomain = stgns.explicit.domain;\n    const explicitRange = Array.isArray(stgns.explicit.range) ? stgns.explicit.range : [];\n\n    // duplicate range values to cover entire domain\n    const numCopies = Math.floor(domain.length / range.length);\n    for (let i = 1; i < numCopies + 1; i *= 2) {\n      range = range.concat(range);\n    }\n\n    if (stgns.explicit.override) {\n      for (let i = 0; i < explicitDomain.length; i++) {\n        const index = domain.indexOf(explicitDomain[i]);\n        if (index > -1) {\n          range[index] = explicitRange[i];\n        }\n      }\n    } else {\n      // inject explicit colors\n      const order = explicitDomain.map((d, i) => [domain.indexOf(d), d, explicitRange[i]]).sort((a, b) => a[0] - b[0]);\n      order.forEach((v) => {\n        const idx = domain.indexOf(v[1]);\n        if (idx !== -1) {\n          range.splice(idx, 0, v[2]);\n        }\n      });\n    }\n\n    // cutoff excess range values\n    range.length = domain.length;\n  }\n\n  s.range(range);\n  return s;\n}\n","import registry from '../../utils/registry';\nimport linear from '../../scales/linear';\nimport band from '../../scales/band';\nimport hBand from '../../scales/h-band';\nimport sequential from '../../scales/color/sequential';\nimport threshold from '../../scales/color/threshold';\nimport categorical from '../../scales/color/categorical';\nimport extractData from '../../data/extractor';\n\nconst scaleRegistry = registry();\n\nscaleRegistry('linear', linear);\nscaleRegistry('band', band);\nscaleRegistry('h-band', hBand);\nscaleRegistry('sequential-color', sequential);\nscaleRegistry('threshold-color', threshold);\nscaleRegistry('categorical-color', categorical);\n\nexport { scaleRegistry as default };\n\nfunction getTypeFromMeta(fields) {\n  const types = fields.map(field => (field.type() === 'dimension' ? 'band' : 'linear'));\n  return types.indexOf('linear') !== -1 ? 'linear' : 'band';\n}\n\nfunction deduceScaleTypeFromData(data) {\n  if (data.root) {\n    return 'h-band';\n  }\n\n  if (data.fields && data.fields[0]) {\n    return getTypeFromMeta(data.fields);\n  }\n  return 'linear';\n}\n\nexport function create(options, d, deps) {\n  let dataSourceConfig = options.data;\n  if (options.source) { // DEPRECATION\n    deps.logger.warn('Deprecated: Scale data source configuration');\n    dataSourceConfig = {\n      extract: []\n    };\n    (Array.isArray(options.source) ? options.source : [options.source]).forEach((source) => {\n      dataSourceConfig.extract.push({\n        field: source\n      });\n    });\n  }\n\n  const data = extractData(dataSourceConfig, d, deps);\n  let type = options.type || deduceScaleTypeFromData(data);\n  let s;\n\n  if (type === 'color') {\n    if (data.fields && data.fields[0] && data.fields[0].type() === 'dimension') {\n      type = 'categorical-color';\n    } else {\n      type = 'sequential-color';\n    }\n  }\n\n  if (deps.scale.has(type)) {\n    s = deps.scale.get(type);\n    s = s(options, data, { theme: deps.theme, logger: deps.logger });\n    s.type = type;\n  }\n  return s;\n}\n\nexport function getOrCreateScale(v, scales, d, deps) {\n  let s;\n  if (typeof v === 'string' && scales[v]) { // return by name\n    s = scales[v];\n  } else if (typeof v === 'object' && 'scale' in v && scales[v.scale]) { // return by { scale: \"name\" }\n    s = scales[v.scale];\n  }\n\n  return s || create(v, d, deps);\n}\n\nexport function builder(obj, d, deps) {\n  const scales = {};\n  for (const s in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, s)) {\n      scales[s] = create(obj[s], d, deps);\n    }\n  }\n  return scales;\n}\n","/**\n * Utility functions\n */\n\nvar util = {};\n\nutil.isObject = function isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nutil.isNumber = function isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nutil.isUndefined = function isUndefined(arg) {\n  return arg === void 0;\n}\n\nutil.isFunction = function isFunction(arg){\n  return typeof arg === 'function';\n}\n\n\n/**\n * EventEmitter class\n */\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\nEventEmitter.init = function() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!util.isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error' && !this._events.error) {\n    er = arguments[1];\n    if (er instanceof Error) {\n      throw er; // Unhandled 'error' event\n    } else {\n      throw Error('Uncaught, unspecified \"error\" event.');\n    }\n    return false;\n  }\n\n  handler = this._events[type];\n\n  if (util.isUndefined(handler))\n    return false;\n\n  if (util.isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        len = arguments.length;\n        args = new Array(len - 1);\n        for (i = 1; i < len; i++)\n          args[i - 1] = arguments[i];\n        handler.apply(this, args);\n    }\n  } else if (util.isObject(handler)) {\n    len = arguments.length;\n    args = new Array(len - 1);\n    for (i = 1; i < len; i++)\n      args[i - 1] = arguments[i];\n\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!util.isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              util.isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (util.isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (util.isObject(this._events[type]) && !this._events[type].warned) {\n    var m;\n    if (!util.isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n\n      if (util.isFunction(console.error)) {\n        console.error('(node) warning: possible EventEmitter memory ' +\n                      'leak detected. %d listeners added. ' +\n                      'Use emitter.setMaxListeners() to increase limit.',\n                      this._events[type].length);\n      }\n      if (util.isFunction(console.trace))\n        console.trace();\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!util.isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!util.isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (util.isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (util.isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (util.isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (Array.isArray(listeners)) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (util.isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  var ret;\n  if (!emitter._events || !emitter._events[type])\n    ret = 0;\n  else if (util.isFunction(emitter._events[type]))\n    ret = 1;\n  else\n    ret = emitter._events[type].length;\n  return ret;\n};\n","import EventEmitter from 'node-event-emitter';\n\nexport default {\n  /**\n   * Function used to add event handling to objects passed in.\n   * @private\n   * @param {Object} obj Object instance that will get event handling.\n   */\n  mixin(obj) {\n    Object.keys(EventEmitter.prototype).forEach((key) => {\n      obj[key] = EventEmitter.prototype[key];\n    });\n    EventEmitter.init(obj);\n    return obj;\n  }\n};\n","import EventEmitter from '../utils/event-emitter';\n\nexport default function scrollApi() {\n  let min = 0;\n  let max = 0;\n  let start = 0;\n  let viewSize = 0;\n  start = start || min;\n\n  /**\n   * The scroll api\n   * @private\n   * @alias scroll\n   */\n  const s = {\n    /**\n     * Move the current scroll\n     * @param {number} value\n     * @emits update\n     */\n    move(value) {\n      this.moveTo(start + value);\n    },\n\n    /**\n     * Change the current scroll to a specific value\n     * @param {number} value\n     * @emits update\n     */\n    moveTo(value) {\n      const newStart = Math.max(min, Math.min(max - viewSize, value));\n      if (start !== newStart) {\n        start = newStart;\n        s.emit('update');\n      }\n    },\n\n    /**\n     * Update scroll settings\n     * @param {number} [settings.min]\n     * @param {number} [settings.max]\n     * @param {number} [settings.viewSize]\n     * @emits update\n     */\n    update(settings) {\n      let triggerUpdate = false;\n      ({ min = min, max = max } = settings);\n      if (settings.viewSize !== undefined && settings.viewSize !== viewSize) {\n        viewSize = settings.viewSize;\n        triggerUpdate = true;\n      }\n\n      // update scroll to be within the new bounds\n      const newStart = Math.max(min, Math.min(max - viewSize, start));\n      if (start !== newStart) {\n        start = newStart;\n        triggerUpdate = true;\n      }\n\n      if (triggerUpdate) {\n        s.emit('update');\n      }\n    },\n\n    /**\n     * Get the current scroll state\n     * @return {object} with min, max, start & viewSize\n     */\n    getState() {\n      return {\n        min, max, start, viewSize\n      };\n    }\n  };\n\n  EventEmitter.mixin(s);\n\n  return s;\n}\n","import scrollApi from '../../scroll-api';\n\nexport function createOrUpdate(options, oldApi) {\n  const min = options.min || 0;\n  const max = options.max || 0;\n  const viewSize = options.viewSize || 0;\n\n  const s = oldApi || scrollApi();\n  s.update({ min, max, viewSize });\n\n  return s;\n}\n\nexport default function builder(obj, oldScrollApis) {\n  const scrollApis = {};\n  for (const n in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, n)) {\n      scrollApis[n] = createOrUpdate(obj[n], oldScrollApis ? oldScrollApis[n] : null);\n    }\n  }\n  return scrollApis;\n}\n\nexport function getOrCreateScrollApi(v, scrollApis) {\n  if (!scrollApis[v]) {\n    scrollApis[v] = scrollApi();\n  }\n  return scrollApis[v];\n}\n","function index(boundaries, point, after) {\n  let i = 0;\n  while (i < boundaries.length && point > boundaries[i]) {\n    ++i;\n  }\n  if (boundaries[i] === point && after) {\n    ++i;\n  }\n  return i;\n}\n\nfunction contains(boundaries, point) {\n  const len = boundaries.length;\n\n  for (let i = 1; i < len; i += 2) {\n    if (boundaries[i - 1] <= point && point <= boundaries[i]) {\n      return true;\n    }\n  }\n  return false;\n}\n\nexport default function rangeCollection() {\n  let boundaries = [];\n\n  function fn() {}\n\n  fn.add = (range) => {\n    const min = range.min;\n    const max = range.max;\n\n    const i0 = index(boundaries, min);\n    const i1 = index(boundaries, max, true);\n\n    const args = [i0, i1 - i0];\n    if (i0 % 2 === 0) {\n      args.push(min);\n    }\n    if (i1 % 2 === 0) {\n      args.push(max);\n    }\n\n    const before = boundaries.join(',');\n    boundaries.splice(...args);\n    const after = boundaries.join(',');\n    return before !== after;\n  };\n\n  fn.remove = (range) => {\n    const min = range.min;\n    const max = range.max;\n\n    const i0 = index(boundaries, min);\n    const i1 = index(boundaries, max, true);\n\n    const args = [i0, i1 - i0];\n    if (i0 % 2 === 1) {\n      args.push(min);\n    }\n    if (i1 % 2 === 1) {\n      args.push(max);\n    }\n    const before = boundaries.join(',');\n    boundaries.splice(...args);\n    const after = boundaries.join(',');\n    return before !== after;\n  };\n\n  fn.set = (range) => {\n    const before = boundaries.join(',');\n    boundaries = [];\n    if (Array.isArray(range)) {\n      range.forEach(fn.add);\n    } else {\n      fn.add(range);\n    }\n    const after = boundaries.join(',');\n    return before !== after;\n  };\n\n  fn.clear = () => {\n    const before = boundaries.length > 0;\n    boundaries = [];\n    return before;\n  };\n\n  fn.containsValue = value => contains(boundaries, value);\n\n  fn.containsRange = (range) => {\n    const min = range.min;\n    const max = range.max;\n\n    const i0 = index(boundaries, min, true);\n    const i1 = index(boundaries, max);\n\n    return i0 === i1 && i1 % 2 === 1;\n  };\n\n  fn.toggle = (range) => {\n    if (fn.containsRange(range)) {\n      return fn.remove(range);\n    }\n    return fn.add(range);\n  };\n\n  fn.ranges = () => {\n    const collection = [];\n    for (let i = 1; i < boundaries.length; i += 2) {\n      collection.push({\n        min: boundaries[i - 1],\n        max: boundaries[i]\n      });\n    }\n    return collection;\n  };\n\n  return fn;\n}\n","export default function valueCollection() {\n  let values = [];\n  function vc() {}\n\n  vc.add = (value) => {\n    if (values.indexOf(value) === -1) {\n      values.push(value);\n      return true;\n    }\n    return false;\n  };\n\n  vc.remove = (value) => {\n    const idx = values.indexOf(value);\n    if (idx !== -1) {\n      values.splice(idx, 1);\n      return true;\n    }\n    return false;\n  };\n\n  vc.contains = value => values.indexOf(value) !== -1;\n\n  vc.values = () => values.slice();\n\n  vc.clear = () => (values = []);\n\n  vc.toString = () => values.join(';');\n\n  return vc;\n}\n","import extend from 'extend';\n\nimport EventEmitter from '../utils/event-emitter';\n\nimport rangeCollection from './range-collection';\nimport valueCollection from './value-collection';\n\nfunction add({\n  items,\n  collection,\n  vc\n}) {\n  const changedMap = {};\n  const changed = [];\n  let key;\n  let values;\n\n  for (let i = 0, num = items.length; i < num; i++) {\n    key = items[i].key;\n    if (!collection[key]) {\n      collection[key] = vc();\n    }\n    values = items[i].values || [items[i].value];\n    for (let vi = 0; vi < values.length; vi++) {\n      if (collection[key].add(values[vi])) {\n        changedMap[key] = changedMap[key] || [];\n        changedMap[key].push(values[vi]);\n      }\n    }\n  }\n\n  const keys = Object.keys(changedMap);\n  for (let i = 0, num = keys.length; i < num; i++) {\n    key = keys[i];\n    changed.push({ id: key, values: changedMap[key] });\n  }\n\n  return changed;\n}\n\nfunction remove({\n  items,\n  collection\n}) {\n  const changedMap = {};\n  const changed = [];\n  let key;\n  let values;\n\n  for (let i = 0, num = items.length; i < num; i++) {\n    key = items[i].key;\n    if (!collection[key]) {\n      continue;\n    }\n    values = items[i].values || [items[i].value];\n    for (let vi = 0; vi < values.length; vi++) {\n      if (collection[key].remove(values[vi])) {\n        changedMap[key] = changedMap[key] || [];\n        changedMap[key].push(values[vi]);\n      }\n    }\n  }\n\n  const keys = Object.keys(changedMap);\n  for (let i = 0, num = keys.length; i < num; i++) {\n    key = keys[i];\n    changed.push({ id: key, values: changedMap[key] });\n  }\n\n  return changed;\n}\n\nfunction collectUnique(items) {\n  const filteredSet = {};\n  let key;\n  let values;\n\n  for (let i = 0, num = items.length; i < num; i++) {\n    key = items[i].key;\n    values = items[i].values || [items[i].value];\n    if (!filteredSet[key]) {\n      filteredSet[key] = [];\n    }\n    for (let vi = 0; vi < values.length; vi++) {\n      const idx = filteredSet[key].indexOf(values[vi]);\n      if (idx === -1) {\n        filteredSet[key].push(values[vi]);\n      }\n    }\n  }\n\n  return filteredSet;\n}\n\nfunction createValueCollection({\n  key,\n  collection,\n  obj,\n  fn,\n  value\n}) {\n  if (!collection[key]) {\n    collection[key] = fn();\n  }\n  obj[key] = obj[key] || [];\n  obj[key].push(value);\n  collection[key].add(value);\n}\n\nexport function toggle({\n  items,\n  values,\n  vc\n}) {\n  const addedMap = {};\n  const removedMap = {};\n  const added = [];\n  const removed = [];\n  const filteredSet = collectUnique(items);\n  let key;\n  let value;\n  let fs;\n\n  const setKeys = Object.keys(filteredSet);\n  for (let i = 0, num = setKeys.length; i < num; i++) {\n    key = setKeys[i];\n    fs = filteredSet[key];\n\n    for (let k = 0, len = fs.length; k < len; k++) {\n      value = fs[k];\n      if (!values[key] || !values[key].contains(value)) {\n        createValueCollection({\n          key,\n          value,\n          collection: values,\n          obj: addedMap,\n          fn: vc\n        });\n      } else if (values[key] && values[key].contains(value)) {\n        removedMap[key] = removedMap[key] || [];\n        removedMap[key].push(value);\n        values[key].remove(value);\n      }\n    }\n  }\n\n  const addedKeys = Object.keys(addedMap);\n  for (let i = 0, num = addedKeys.length; i < num; i++) {\n    key = addedKeys[i];\n    added.push({ id: key, values: addedMap[key] });\n  }\n\n  const removedKeys = Object.keys(removedMap);\n  for (let i = 0, num = removedKeys.length; i < num; i++) {\n    key = removedKeys[i];\n    removed.push({ id: key, values: removedMap[key] });\n  }\n\n  return [added, removed];\n}\n\nfunction diff(old, current) {\n  const changed = [];\n  const keys = Object.keys(old);\n  let key;\n  let changedValues;\n  const filterFn = v => current[key].indexOf(v) === -1;\n\n  for (let i = 0, num = keys.length; i < num; i++) {\n    key = keys[i];\n    if (!current[key]) {\n      changed.push({ id: key, values: old[key] });\n    } else {\n      changedValues = old[key].filter(filterFn);\n      if (changedValues.length) {\n        changed.push({ id: key, values: changedValues });\n      }\n    }\n  }\n\n  return changed;\n}\n\nexport function set({\n  items,\n  vCollection,\n  vc\n}) {\n  const addedMap = {};\n  const filteredSet = collectUnique(items);\n  let added = [];\n  let removed = [];\n  let key;\n\n  const oldMap = {};\n  const vcKeys = Object.keys(vCollection);\n  for (let i = 0, num = vcKeys.length; i < num; i++) {\n    key = vcKeys[i];\n    oldMap[key] = vCollection[key].values().slice();\n    delete vCollection[key];\n  }\n\n  const createValueCollectionFn = (value) => {\n    if (!vCollection[key] || !vCollection[key].contains(value)) {\n      createValueCollection({\n        key,\n        value,\n        collection: vCollection,\n        obj: addedMap,\n        fn: vc\n      });\n    }\n  };\n\n  const fsKeys = Object.keys(filteredSet);\n  for (let i = 0, num = fsKeys.length; i < num; i++) {\n    key = fsKeys[i];\n    filteredSet[key].forEach(createValueCollectionFn);\n  }\n\n  removed = diff(oldMap, addedMap);\n  added = diff(addedMap, oldMap);\n\n  return [added, removed];\n}\n\n\nfunction applyAliases(items, aliases) {\n  if (!Object.keys(aliases).length) {\n    return items;\n  }\n  const len = items.length;\n  const its = Array(len);\n  for (let i = 0; i < len; i++) {\n    its[i] = items[i].key in aliases ? extend({}, items[i], { key: aliases[items[i].key] }) : items[i];\n  }\n  return its;\n}\n\nfunction intercept(handlers, items, aliases) {\n  const its = applyAliases(items, aliases);\n  return handlers && handlers.length ? handlers.reduce((value, interceptor) => interceptor(value), its) : its;\n}\n\nfunction toCamelCase(s) {\n  return s.replace(/(-[a-z])/g, $1 => $1.toUpperCase().replace('-', ''));\n}\n\nfunction toSnakeCase(s) {\n  return s.replace(/([A-Z])/g, $1 => `-${$1.toLowerCase()}`);\n}\n\nfunction updateRange(items, action, {\n  ranges,\n  interceptors,\n  rc,\n  aliases\n}) {\n  const inter = `${action}Ranges`;\n  const its = intercept(interceptors[inter], items, aliases);\n  let changed = false;\n  its.forEach((item) => {\n    const key = item.key;\n    if (!ranges[key]) {\n      ranges[key] = rc();\n    }\n    if (action === 'set') {\n      changed = ranges[key][action](item.ranges || item.range) || changed;\n    } else {\n      const rangeValues = item.ranges || [item.range];\n      for (let i = 0; i < rangeValues.length; i++) {\n        changed = ranges[key][action](rangeValues[i]) || changed;\n      }\n    }\n  });\n\n  return changed;\n}\n\nexport default function brush({\n  vc = valueCollection,\n  rc = rangeCollection\n} = {}) {\n  let activated = false;\n  let ranges = {};\n  let values = {};\n  let aliases = {};\n  const interceptors = {\n    addValues: [],\n    removeValues: [],\n    toggleValues: [],\n    setValues: [],\n    addRanges: [],\n    setRanges: [],\n    removeRanges: [],\n    toggleRanges: []\n  };\n\n  const getState = () => {\n    const state = {\n      values: {},\n      ranges: {}\n    };\n    Object.keys(values).forEach((key) => { state.values[key] = values[key].values(); });\n    Object.keys(ranges).forEach((key) => { state.ranges[key] = ranges[key].ranges(); });\n    return state;\n  };\n\n  const links = {\n    ls: [],\n    clear() {\n      this.ls.forEach(b => b.clear());\n    },\n    start() {\n      this.ls.forEach(b => b.start());\n    },\n    end() {\n      this.ls.forEach(b => b.end());\n    },\n    update() {\n      const s = getState();\n      this.ls.forEach(b => b._state(s));\n    },\n    updateValues() {\n      const s = getState();\n      this.ls.forEach(b => b._state({\n        values: s.values\n      }));\n    },\n    updateRanges() {\n      const s = getState();\n      this.ls.forEach(b => b._state({\n        ranges: s.ranges\n      }));\n    }\n  };\n\n  /**\n   * A brush context\n   * @alias brush\n   * @interface\n   */\n  const fn = {};\n\n  /**\n   * Link this brush to another brush instance.\n   *\n   * When linked, the `target` will receive updates whenever this brush changes.\n   * @param {brush} target - The brush instance to link to\n   */\n  fn.link = (target) => {\n    if (fn === target) {\n      throw new Error('Can\\'t link to self');\n    }\n    links.ls.push(target);\n    target._state(getState());\n  };\n\n  fn._state = (s) => {\n    if (!s) {\n      return getState();\n    }\n    if (s.values) {\n      const arr = [];\n      Object.keys(s.values).forEach((key) => {\n        if (!values[key] || s.values[key].join(';') !== values[key].toString()) {\n          arr.push({\n            key,\n            values: s.values[key]\n          });\n        }\n      });\n      Object.keys(values).forEach((key) => {\n        if (!s.values[key]) {\n          arr.push({\n            key,\n            values: []\n          });\n        }\n      });\n      if (arr.length) {\n        fn.setValues(arr);\n      }\n    }\n    if (s.ranges) {\n      const arr = [];\n      Object.keys(s.ranges).forEach((key) => {\n        if (!ranges[key] || s.ranges[key].join(';') !== ranges[key].toString()) {\n          arr.push({\n            key,\n            ranges: s.ranges[key]\n          });\n        }\n      });\n      Object.keys(ranges).forEach((key) => {\n        if (!s.ranges[key]) {\n          arr.push({\n            key,\n            ranges: []\n          });\n        }\n      });\n      if (arr.length) {\n        fn.setRanges(arr);\n      }\n    }\n    return undefined;\n  };\n\n  /**\n   * Starts this brush context\n   *\n   * Starts this brush context and emits a 'start' event if it is not already started.\n   * @emits brush#start\n   */\n  fn.start = () => {\n    if (!activated) {\n      activated = true;\n      fn.emit('start');\n      links.start();\n    }\n  };\n\n  /**\n   * Ends this brush context\n   *\n   * Ends this brush context and emits an 'end' event if it is not already ended.\n   * @emits brush#start\n   */\n  fn.end = () => {\n    if (!activated) {\n      return;\n    }\n    activated = false;\n    ranges = {};\n    values = {};\n    fn.emit('end');\n    links.end();\n  };\n\n  /**\n   * Checks if this brush is activated\n   *\n   * Returns true if started, false otherwise\n   * @return {boolean}\n   */\n  fn.isActive = () => activated;\n\n  /**\n   * Clears this brush context\n   */\n  fn.clear = () => {\n    const removed = fn.brushes().filter(b => b.type === 'value' && b.brush.values().length).map(b => ({ id: b.id, values: b.brush.values() }));\n    const hasChanged = Object.keys(ranges).length > 0 || removed.length;\n    ranges = {};\n    values = {};\n    if (hasChanged) {\n      fn.emit('update', [], removed); // TODO - do not emit update if state hasn't changed\n      links.clear();\n    }\n  };\n\n  /**\n   * Returns all brushes within this context\n   * @return {object}\n   */\n  fn.brushes = () => {\n    let result = [];\n    result = result.concat(Object.keys(ranges).map(key => ({\n      type: 'range',\n      id: key,\n      brush: ranges[key]\n    })));\n\n    result = result.concat(Object.keys(values).map(key => ({\n      type: 'value',\n      id: key,\n      brush: values[key]\n    })));\n\n    return result;\n  };\n\n  /**\n   * Adds a primitive value to this brush context\n   *\n   * If this brush context is not started, a 'start' event is emitted.\n   * If the state of the brush changes, ie. if the added value does not already exist, an 'update' event is emitted.\n   *\n   * @param {string} key  An identifier that represents the data source of the value\n   * @param {string|number} value The value to add\n   * @emits brush#start\n   * @emits brush#update\n   * @example\n   * brush.addValue('countries', 'Sweden');\n   * brush.addValue('/qHyperCube/qDimensionInfo/0', 3);\n   */\n  fn.addValue = (key, value) => {\n    fn.addValues([{ key, value }]);\n  };\n\n  /**\n   * @param {object[]} items Items to add\n   */\n  fn.addValues = (items) => {\n    const its = intercept(interceptors.addValues, items, aliases);\n    const added = add({\n      vc,\n      collection: values,\n      items: its\n    });\n\n    fn.emit('add-values', its);\n\n    if (added.length) {\n      if (!activated) {\n        activated = true;\n        fn.emit('start');\n      }\n      fn.emit('update', added, []);\n      links.updateValues();\n    }\n  };\n\n  /**\n   * @param {object[]} items Items to set\n   */\n  fn.setValues = (items) => {\n    const its = intercept(interceptors.setValues, items, aliases);\n    const changed = set({\n      items: its,\n      vCollection: values,\n      vc\n    });\n\n    fn.emit('set-values', its);\n\n    if (changed[0].length > 0 || changed[1].length > 0) {\n      if (!activated) {\n        activated = true;\n        fn.emit('start');\n      }\n      fn.emit('update', changed[0], changed[1]);\n      links.updateValues();\n    }\n  };\n\n  /**\n   * Removes a primitive values from this brush context\n   *\n   * If the state of the brush changes, ie. if the removed value does exist, an 'update' event is emitted.\n   *\n   * @param  {string} key  An identifier that represents the data source of the value\n   * @param  {string|number} value The value to remove\n   * @example\n   * brush.removeValue('countries', 'Sweden');\n   */\n  fn.removeValue = (key, value) => {\n    fn.removeValues([{ key, value }]);\n  };\n\n  /**\n   * @param {object[]} items Items to remove\n   */\n  fn.removeValues = (items) => {\n    const its = intercept(interceptors.removeValues, items, aliases);\n    const removed = remove({\n      collection: values,\n      items: its\n    });\n\n    fn.emit('remove-values', its);\n\n    if (removed.length) {\n      fn.emit('update', [], removed);\n      links.updateValues();\n      // TODO - emit 'end' event if there are no remaining active brushes\n    }\n  };\n\n  /**\n   * Add and remove values in a single operation\n   * almost the same as calling addValues and removeValues but only triggers one 'update' event\n   *\n   * If the state of the brush changes, an 'update' event is emitted.\n   *\n   * @param {object[]} addItems Items to add\n   * @param {object[]} removeItems Items to remove\n   */\n  fn.addAndRemoveValues = (addItems, removeItems) => {\n    const addIts = intercept(interceptors.addValues, addItems, aliases);\n    const removeIts = intercept(interceptors.removeValues, removeItems, aliases);\n    const added = add({\n      vc,\n      collection: values,\n      items: addIts\n    });\n    const removed = remove({\n      collection: values,\n      items: removeIts\n    });\n\n    fn.emit('add-values', addIts);\n    fn.emit('remove-values', removeIts);\n\n    if (added.length || removed.length) {\n      if (!activated) {\n        activated = true;\n        fn.emit('start');\n      }\n      fn.emit('update', added, removed);\n      links.updateValues();\n    }\n  };\n\n  /**\n   * Toggles a primitive value in this brush context\n   *\n   * If the given value exist in this brush context, it will be removed. If it does not exist it will be added.\n   *\n   * @param  {string} key  An identifier that represents the data source of the value\n   * @param  {string|number} value The value to toggle\n   * @example\n   * brush.toggleValue('countries', 'Sweden');\n   */\n  fn.toggleValue = (key, value) => {\n    fn.toggleValues([{ key, value }]);\n  };\n\n  /**\n   * @param {object[]} items Items to toggle\n   */\n  fn.toggleValues = (items) => {\n    const its = intercept(interceptors.toggleValues, items, aliases);\n    const toggled = toggle({\n      items: its,\n      values,\n      vc\n    });\n\n    fn.emit('toggle-values', its);\n\n    if (toggled[0].length > 0 || toggled[1].length > 0) {\n      if (!activated) {\n        activated = true;\n        fn.emit('start');\n      }\n      fn.emit('update', toggled[0], toggled[1]);\n      links.updateValues();\n    }\n  };\n\n  /**\n   * Checks if a certain value exists in this brush context\n   *\n   * Returns true if the values exists for the provided key, returns false otherwise.\n   *\n   * @param  {string} key  An identifier that represents the data source of the value\n   * @param  {string|number} value The value to check for\n   * @return {boolean}\n   * @example\n   * brush.addValue('countries', 'Sweden');\n   * brush.containsValue('countries', 'Sweden'); // true\n   * brush.toggleValue('countries', 'Sweden'); // remove 'Sweden'\n   * brush.containsValue('countries', 'Sweden'); // false\n   */\n  fn.containsValue = (key, value) => {\n    let k = aliases[key] || key;\n    if (!values[k]) {\n      return false;\n    }\n    return values[k].contains(value);\n  };\n\n  /**\n   * Adds a numeric range to this brush context\n   *\n   * @param {string} key - An identifier that represents the data source of the range\n   * @param {object} range - The range to add to this brush\n   * @param {number} range.min - Min value of the range\n   * @param {number} range.max - Max value of the range\n   * @example\n   * brush.addRange('Sales', { min: 20, max: 50 });\n   */\n  fn.addRange = (key, range) => {\n    fn.addRanges([{ key, range }]);\n  };\n\n  /**\n   * @see {brush.addRange}\n   * @param {object[]} items - Items containing the ranges to remove\n   * @param {string} items[].key\n   * @param {object} items[].range\n   */\n  fn.addRanges = (items) => {\n    const changed = updateRange(items, 'add', {\n      ranges,\n      rc,\n      interceptors,\n      aliases\n    });\n\n    if (!changed) {\n      return;\n    }\n\n    if (!activated) {\n      activated = true;\n      fn.emit('start');\n    }\n    fn.emit('update', [], []);\n    links.updateRanges();\n  };\n\n  /**\n   * Removes a numeric range from this brush context\n   *\n   * @param {string} key - An identifier that represents the data source of the range\n   * @param {object} range - The range to remove from this brush\n   * @param {number} range.min - Min value of the range\n   * @param {number} range.max - Max value of the range\n   */\n  fn.removeRange = (key, range) => {\n    fn.removeRanges([{ key, range }]);\n  };\n\n  /**\n   * @see {brush.removeRange}\n   * @param {object[]} items - Items containing the ranges to remove\n   */\n  fn.removeRanges = (items) => {\n    const changed = updateRange(items, 'remove', {\n      ranges,\n      rc,\n      interceptors,\n      aliases\n    });\n\n    if (!changed) {\n      return;\n    }\n\n    if (!activated) {\n      activated = true;\n      fn.emit('start');\n    }\n    fn.emit('update', [], []);\n    links.updateRanges();\n  };\n\n  /**\n   * Sets a numeric range to this brush context\n   *\n   * Overwrites any active ranges identified by `key`\n   *\n   * @param {string} key - An identifier that represents the data source of the range\n   * @param {object} range - The range to set on this brush\n   * @param {number} range.min - Min value of the range\n   * @param {number} range.max - Max value of the range\n   */\n  fn.setRange = (key, range) => {\n    fn.setRanges([{ key, range }]);\n  };\n\n  /**\n   * @see {brush.setRange}\n   * @param {object[]} items - Items containing the ranges to set\n   */\n  fn.setRanges = (items) => {\n    const changed = updateRange(items, 'set', {\n      ranges,\n      rc,\n      interceptors,\n      aliases\n    });\n\n    if (!changed) {\n      return;\n    }\n\n    if (!activated) {\n      activated = true;\n      fn.emit('start');\n    }\n    fn.emit('update', [], []);\n    links.updateRanges();\n  };\n\n  /**\n   * Toggles a numeric range in this brush context\n   *\n   * Removes the range if it's already contained within the given identifier,\n   * otherwise the given range is added to the brush.\n   *\n   * @param {string} key - An identifier that represents the data source of the range\n   * @param {object} range - The range to toggle in this brush\n   * @param {number} range.min - Min value of the range\n   * @param {number} range.max - Max value of the range\n   */\n  fn.toggleRange = (key, range) => {\n    fn.toggleRanges([{ key, range }]);\n  };\n\n  /**\n   * @see {brush.toggleRange}\n   * @param {object[]} items - Items containing the ranges to toggle\n   */\n  fn.toggleRanges = (items) => {\n    const changed = updateRange(items, 'toggle', {\n      ranges,\n      rc,\n      interceptors,\n      aliases\n    });\n\n    if (!changed) {\n      return;\n    }\n\n    if (!activated) {\n      activated = true;\n      fn.emit('start');\n    }\n    fn.emit('update', [], []);\n    links.updateRanges();\n  };\n\n  /**\n   * Checks if a value is contained within a range in this brush context\n   *\n   * Returns true if the values exists for the provided key, returns false otherwise.\n   *\n   * @param  {string} key - An identifier that represents the data source of the value\n   * @param  {number} value - The value to check for\n   * @return {boolean}\n   * @example\n   * brush.addRange('Sales', { min: 10, max: 50 });\n   * brush.containsRangeValue('Sales', 30); // true\n   * brush.containsRangeValue('Sales', 5); // false\n   */\n  fn.containsRangeValue = (key, value) => {\n    let k = aliases[key] || key;\n    if (!ranges[k]) {\n      return false;\n    }\n    return ranges[k].containsValue(value);\n  };\n\n  /**\n   * Checks if a range segment is contained within this brush context\n   *\n   * Returns true if the range segment exists for the provided key, returns false otherwise.\n   *\n   * @param {string} key - An identifier that represents the data source of the value\n   * @param {object} range - The range to check for\n   * @param {number} range.min - Min value of the range\n   * @param {number} range.max - Max value of the range\n   * @return {boolean}\n   * @example\n   * brush.addRange('Sales', { min: 10, max: 50 });\n   * brush.containsRange('Sales', { min: 15, max: 20 }); // true - the range segment is fully contained within [10, 50]\n   * brush.containsRange('Sales', { min: 5, max: 20 }); // false - part of the range segment is outside [10, 50]\n   * brush.containsRange('Sales', { min: 30, max: 80 }); // false - part of the range segment is outside [10, 50]\n   */\n  fn.containsRange = (key, range) => {\n    let k = aliases[key] || key;\n    if (!ranges[k]) {\n      return false;\n    }\n    return ranges[k].containsRange(range);\n  };\n\n  fn.containsMappedData = (d, props, mode) => {\n    let status = [];\n    const keys = Object.keys(d);\n    let key;\n    let item;\n    let source;\n    let value;\n\n    for (let i = 0, num = keys.length; i < num; i++) {\n      key = keys[i];\n      if (key === 'value') {\n        item = d;\n        status[i] = { key: '', i, bool: false };\n      } else if (key === 'source') {\n        continue;\n      } else {\n        item = d[key];\n        status[i] = { key, i, bool: false };\n      }\n      source = item.source && item.source.field;\n      if (typeof source === 'undefined') {\n        continue;\n      }\n      if (typeof item.source.key !== 'undefined') {\n        source = `${item.source.key}/${source}`;\n      }\n\n      if (source in aliases) {\n        source = aliases[source];\n      }\n\n      value = item.value;\n      if (ranges[source]) {\n        status[i].bool = Array.isArray(value) ? ranges[source].containsRange({ min: value[0], max: value[1] }) : ranges[source].containsValue(value);\n      } else if (values[source] && values[source].contains(value)) {\n        status[i].bool = true;\n      }\n    }\n\n    if (props) {\n      status = status.filter(b => props.indexOf(b.key) !== -1);\n      if (mode === 'and') {\n        return !!status.length && !status.some(s => s.bool === false);\n      } else if (mode === 'xor') {\n        return !!status.length && status.some(s => s.bool) && status.some(s => s.bool === false);\n      }\n      // !mode || mode === 'or'\n      return status.some(s => s.bool);\n    }\n    return status.some(s => s.bool);\n  };\n\n  /**\n   * Adds an event interceptor\n   *\n   * @param {string} name Name of the event to intercept\n   * @param {function} ic Handler to call before event is triggered\n   * @example\n   * brush.intercept('add-values', items => {\n   *  console.log('about to add the following items', items);\n   *  return items;\n   * });\n   */\n  fn.intercept = (name, ic) => {\n    const s = toCamelCase(name);\n    if (!interceptors[s]) {\n      return;\n    }\n    interceptors[s].push(ic);\n  };\n\n  /**\n   * Removes an interceptor\n   *\n   * @param {string} name Name of the event to intercept\n   * @param {function} ic Handler to remove\n   */\n  fn.removeInterceptor = (name, ic) => {\n    const s = toCamelCase(name);\n    if (!interceptors[s]) {\n      return;\n    }\n    const idx = interceptors[s].indexOf(ic);\n    if (idx !== -1) {\n      interceptors[s].splice(idx, 1);\n    }\n  };\n\n  /**\n   * Removes all interceptors\n   *\n   * @param {string} [name] Name of the event to remove interceptors for. If not provided, removes all interceptors.\n   */\n  fn.removeAllInterceptors = (name) => {\n    const toRemove = [];\n    if (name) {\n      const s = toCamelCase(name);\n      if (interceptors[s] && interceptors[s].length) {\n        toRemove.push({ name, handlers: interceptors[s] });\n      }\n    } else {\n      Object.keys(interceptors).forEach((n) => {\n        if (interceptors[n].length) {\n          toRemove.push({ name: toSnakeCase(n), handlers: interceptors[n] });\n        }\n      });\n    }\n\n    toRemove.forEach((ic) => {\n      const interceptorHandlers = ic.handlers.slice();\n      interceptorHandlers.forEach(handler => fn.removeInterceptor(ic.name, handler));\n    });\n  };\n\n  /**\n   * Adds an alias to the given key\n   *\n   * @param {string} key - Value to be replaced\n   * @param {string} alias - Value to replace key with\n   * @example\n   * brush.addKeyAlias('BadFieldName', 'Region');\n   * brush.addValue('BadFieldName', 'Sweden'); // 'BadFieldName' will be stored as 'Region'\n   * brush.containsValue('Region', 'Sweden'); // true\n   * brush.containsValue('BadFieldName', 'Sweden'); // true\n   */\n  fn.addKeyAlias = (key, alias) => {\n    aliases[key] = alias;\n  };\n\n  /**\n   * Removes an alias\n   *\n   * This will only remove the key to alias mapping for new manipulations of the brush,\n   * no changes will be made to the current state of this brush.\n   *\n   * @param {string} key - Value to remove as alias\n   * @example\n   * brush.removeKeyAlias('BadFieldName');\n   */\n  fn.removeKeyAlias = (key) => {\n    delete aliases[key];\n  };\n\n  EventEmitter.mixin(fn);\n\n  return fn;\n}\n\n/**\n * Triggered when this brush is activated\n * @event brush#start\n * @type {string}\n */\n\n/**\n * Triggered when this brush is updated\n * @event brush#update\n * @type {string}\n * @param {Array<object>} added - The added items\n * @param {Array<object>} removed - The removed items\n */\n\n/**\n * Triggered when this brush is deactivated\n * @event brush#end\n * @type {string}\n */\n","import brush from './brush';\nimport registry from '../utils/registry';\n\nconst reg = registry();\n\nexport function register(type, b) {\n  if (b) {\n    reg.add(type, b);\n  }\n  return reg.get(type);\n}\n\nexport default brush;\n","import registry from '../utils/registry';\n\nconst typeMixins = registry();\nconst mixins = [];\n\nexport function add(mixin, types = []) {\n  if (types.length) {\n    types.forEach(type => typeMixins.add(type, mixin));\n  } else {\n    mixins.push(mixin);\n  }\n}\n\nexport function list(type) {\n  return mixins.concat(typeMixins.get(type) || []);\n}\n","export function cubicIn(t) {\n  return t * t * t;\n}\n\nexport function cubicOut(t) {\n  return --t * t * t + 1;\n}\n\nexport function cubicInOut(t) {\n  return ((t *= 2) <= 1 ? t * t * t : (t -= 2) * t * t + 2) / 2;\n}\n","var pi = Math.PI,\n    halfPi = pi / 2;\n\nexport function sinIn(t) {\n  return 1 - Math.cos(t * halfPi);\n}\n\nexport function sinOut(t) {\n  return Math.sin(t * halfPi);\n}\n\nexport function sinInOut(t) {\n  return (1 - Math.cos(pi * t)) / 2;\n}\n","var tau = 2 * Math.PI,\n    amplitude = 1,\n    period = 0.3;\n\nexport var elasticIn = (function custom(a, p) {\n  var s = Math.asin(1 / (a = Math.max(1, a))) * (p /= tau);\n\n  function elasticIn(t) {\n    return a * Math.pow(2, 10 * --t) * Math.sin((s - t) / p);\n  }\n\n  elasticIn.amplitude = function(a) { return custom(a, p * tau); };\n  elasticIn.period = function(p) { return custom(a, p); };\n\n  return elasticIn;\n})(amplitude, period);\n\nexport var elasticOut = (function custom(a, p) {\n  var s = Math.asin(1 / (a = Math.max(1, a))) * (p /= tau);\n\n  function elasticOut(t) {\n    return 1 - a * Math.pow(2, -10 * (t = +t)) * Math.sin((t + s) / p);\n  }\n\n  elasticOut.amplitude = function(a) { return custom(a, p * tau); };\n  elasticOut.period = function(p) { return custom(a, p); };\n\n  return elasticOut;\n})(amplitude, period);\n\nexport var elasticInOut = (function custom(a, p) {\n  var s = Math.asin(1 / (a = Math.max(1, a))) * (p /= tau);\n\n  function elasticInOut(t) {\n    return ((t = t * 2 - 1) < 0\n        ? a * Math.pow(2, 10 * t) * Math.sin((s - t) / p)\n        : 2 - a * Math.pow(2, -10 * t) * Math.sin((s + t) / p)) / 2;\n  }\n\n  elasticInOut.amplitude = function(a) { return custom(a, p * tau); };\n  elasticInOut.period = function(p) { return custom(a, p); };\n\n  return elasticInOut;\n})(amplitude, period);\n","import extend from 'extend';\nimport { interpolateObject } from 'd3-interpolate';\nimport {\n  easeCubic,\n  easeElasticOut\n} from 'd3-ease';\n\n/* globals window */\n\nfunction nodeId(node, i) {\n  if (node.data) {\n    return node.data.value;\n  } else if (node.type === 'text') {\n    return node.text;\n  }\n  return i;\n}\n\nfunction tween({\n  old,\n  current\n}, {\n  renderer\n}, config) {\n  let ticker;\n  // let staticNodes = [];\n  let toBeUpdated = [];\n  let entered = { nodes: [], ips: [] };\n  let exited = { nodes: [], ips: [] };\n  let updated = { nodes: [], ips: [] };\n  let stages = [];\n  const trackBy = config.trackBy || nodeId;\n\n  const tweener = {\n    start() {\n      let ids = {};\n      old.forEach((node, i) => {\n        let id = trackBy(node, i);\n        ids[id] = node;\n      });\n      current.forEach((node, i) => {\n        let id = trackBy(node, i);\n        if (ids[id]) {\n          updated.ips.push(interpolateObject(ids[id], node));\n          updated.nodes.push(node);\n          toBeUpdated.push(ids[id]);\n          ids[id] = false;\n        } else {\n          entered.nodes.push(node);\n          entered.ips.push(interpolateObject({\n            r: 0.001,\n            opacity: 0\n          }, node));\n        }\n      });\n      Object.keys(ids).forEach((key) => {\n        if (ids[key]) {\n          exited.nodes.push(ids[key]);\n          exited.ips.push(interpolateObject(ids[key], extend({}, ids[key], { r: 0.0001, opacity: 0 })));\n        }\n      });\n      if (exited.ips.length) {\n        stages.push({\n          easing: easeCubic,\n          duration: 200,\n          tweens: exited.ips,\n          nodes: [...toBeUpdated]\n        });\n      }\n      if (updated.ips.length) {\n        stages.push({\n          easing: easeCubic,\n          duration: 400,\n          tweens: updated.ips,\n          nodes: []\n        });\n      }\n      if (entered.ips.length) {\n        stages.push({\n          easing: easeElasticOut,\n          duration: 1200,\n          tweens: entered.ips,\n          nodes: [...updated.nodes]\n        });\n      }\n      // console.log(stages);\n      if (stages.length) {\n        stages[0].started = Date.now();\n        if (typeof window !== 'undefined') {\n          ticker = window.requestAnimationFrame(tweener.tick);\n        }\n      }\n    },\n    tick() {\n      let currentStage = stages[0];\n      if (!currentStage) {\n        tweener.stop();\n      }\n      if (!currentStage.started) {\n        currentStage.started = Date.now();\n      }\n      let t = (Date.now() - currentStage.started) / currentStage.duration;\n      let currentNodes = [];\n      let tweenedNodes = currentStage.tweens.map(ip => ip(currentStage.easing(Math.min(1, t))));\n      currentNodes.push(...tweenedNodes);\n      currentNodes.push(...currentStage.nodes);\n      // currentNodes.push(...staticNodes);\n      // stages.slice(1).forEach(stage => currentNodes.push(...stage.nodes));\n      renderer.render(currentNodes);\n      if (t >= 1) {\n        // staticNodes.push(...currentStage.nodes);\n        stages.shift();\n        if (!stages.length) {\n          tweener.stop();\n        }\n      }\n      if (ticker) {\n        ticker = window.requestAnimationFrame(tweener.tick);\n      }\n    },\n    stop() {\n      if (ticker) {\n        window.cancelAnimationFrame(ticker);\n        ticker = false;\n      }\n    }\n  };\n\n  return tweener;\n}\n\nexport { tween as default };\n","import extend from 'extend';\n\nconst GLOBAL_DEFAULTS = {\n  fontFamily: 'Arial',\n  fontSize: '13px',\n  color: '#595959',\n  backgroundColor: '#ffffff',\n  stroke: '#000000',\n  strokeWidth: 0,\n  $fill: '#333333'\n};\n\nconst REF_RX = /^\\$/;\n\nfunction isPrimitive(x) {\n  const type = typeof x;\n  return type !== 'object' && type !== 'function' && type !== 'undefined';\n}\n\n/**\n * @callback datum-accessor\n * @param {datum-extract} d\n */\n\n/**\n * @typedef {object} datum-config\n * @property {string} [scale]\n * @property {datum-accessor} fn\n * @property {string} ref - A reference to a datum-extract property\n */\n\n/**\n * @typedef {string|datum-config|datum-accessor} datum-string\n */\n\n/**\n * @typedef {number|datum-config|datum-accessor} datum-number\n */\n\n/**\n * Normalizes property settings\n *\n * @ignore\n * @export\n * @param {any} settings\n * @param {any} defaults\n * @param {any} chart\n * @returns {any}\n */\nexport function normalizeSettings(settings, defaults, chart) {\n  const composition = extend({}, settings);\n  const defs = extend({}, defaults);\n  Object.keys(composition).forEach((key) => {\n    defs[key] = {};\n    const v = composition[key];\n    const vType = typeof v;\n    if (typeof v === 'function') {\n      defs[key].fn = v;\n    } else if (isPrimitive(v)) {\n      let defaultValue = defaults[key];\n      if (typeof defaultValue === 'string' && REF_RX.test(defaultValue)) {\n        defaultValue = GLOBAL_DEFAULTS[defaultValue];\n      }\n      const defaultType = typeof defaultValue;\n      if (defaultType === 'undefined') { // if property has no default, assign provided value\n        defs[key] = v;\n      } else { // assign provided value if it's of same type as default, otherwise use default\n        defs[key] = defaultType === vType ? v : defaultValue;\n      }\n    } else if (v && typeof v === 'object') {\n      if (typeof v.fn === 'function') {\n        defs[key].fn = v.fn;\n      }\n      if (typeof v.scale !== 'undefined') {\n        defs[key].scale = chart.scale(v.scale);\n      }\n      if (typeof v.ref === 'string') {\n        defs[key].ref = v.ref;\n      }\n    }\n  });\n\n  Object.keys(defaults).forEach((key) => {\n    if (key in composition) { // don't process same props again\n      return;\n    }\n    const v = defaults[key];\n    const defaultType = typeof v;\n    if (defaultType === 'string' && REF_RX.test(v)) {\n      defs[key] = GLOBAL_DEFAULTS[v];\n    } else {\n      defs[key] = v;\n    }\n  });\n\n  return defs;\n}\n\nexport function resolveForItem(context, normalized) {\n  const ret = {};\n  const keys = Object.keys(normalized);\n  const len = keys.length;\n  const fallbackData = context.datum;\n  const datum = context.datum;\n  const dataContext = context.data && context.data.items;\n  const idx = dataContext ? dataContext.indexOf(datum) : -1;\n  for (let i = 0; i < len; i++) {\n    const key = keys[i];\n    const normalizedProp = normalized[key];\n    const exists = typeof datum === 'object' && typeof normalizedProp !== 'undefined';\n    const hasExplicitDataProp = exists && typeof normalizedProp.ref === 'string';\n    const hasImplicitDataProp = exists && key in datum;\n    const propData = hasExplicitDataProp ? datum[normalizedProp.ref] : hasImplicitDataProp ? datum[key] : fallbackData; // eslint-disable-line\n    if (isPrimitive(normalizedProp)) {\n      ret[key] = normalizedProp;\n    } else if (exists && normalizedProp.fn) { // callback function\n      if (normalizedProp.scale) {\n        context.scale = normalizedProp.scale;\n      }\n      ret[key] = normalizedProp.fn.call(null, context, idx);\n    } else if (exists && normalizedProp.scale && propData) {\n      ret[key] = normalizedProp.scale(propData.value);\n      if (normalizedProp.scale.bandwidth) {\n        ret[key] += normalizedProp.scale.bandwidth() / 2;\n      }\n    } else if (hasExplicitDataProp && propData) {\n      ret[key] = propData.value;\n    } else if (normalizedProp.fn) {\n      ret[key] = normalizedProp.fn.call(null, context, idx);\n    } else {\n      ret[key] = normalizedProp;\n    }\n  }\n  return ret;\n}\n","\nexport function updateScaleSize(object, path, size) {\n  const o = object[path];\n  if (o && o.scale && o.scale.pxScale) {\n    o.scale = o.scale.pxScale(size);\n  } else if (o && o.pxScale) {\n    object[path] = o.pxScale(size);\n  }\n}\n\nexport function scaleWithSize(scale, size) {\n  return scale.pxScale ? scale.pxScale(size) : scale;\n}\n","import { normalizeSettings, resolveForItem } from '../chart-components/property-resolver';\nimport { updateScaleSize } from '../scales';\n\nconst externals = {\n  normalizeSettings,\n  resolveForItem,\n  updateScaleSize\n};\n\nexport default function (resources, deps = externals) {\n  let cache = {};\n\n  function resolve({\n    data,\n    settings,\n    defaults = {},\n    scaled\n  }) {\n    const norm = cache.norm = deps.normalizeSettings(settings, defaults, resources.chart);\n\n    const res = {\n      scale: resources.chart.scale,\n      formatter: resources.chart.formatter\n    };\n\n    if (scaled) {\n      Object.keys(scaled).forEach((key) => {\n        if (norm[key]) {\n          deps.updateScaleSize(norm, key, scaled[key]);\n        }\n      });\n    }\n\n    const resolved = [];\n\n    if (data && Array.isArray(data.items)) {\n      for (let i = 0, len = data.items.length; i < len; i++) {\n        const context = {\n          datum: data.items[i],\n          data,\n          resources: res\n        };\n        let obj = deps.resolveForItem(context, cache.norm);\n        obj.data = data.items[i];\n        resolved.push(obj);\n      }\n    } else {\n      const context = {\n        data,\n        resources: res\n      };\n      let obj = deps.resolveForItem(context, cache.norm);\n      return {\n        settings: cache.norm,\n        item: obj\n      };\n    }\n\n    return {\n      settings: cache.norm,\n      items: resolved\n    };\n  }\n\n  return {\n    resolve\n  };\n}\n","import { isTouchEvent } from '../utils/event-type';\n\n/**\n * Flatten the array of nodes by removing any containers as they do not support styling, thus unable to brush them.\n * @param {array} nodes\n * @ignore\n */\nexport function reduceToLeafNodes(nodes = []) {\n  return nodes.reduce((ary, node) => {\n    if (Array.isArray(node.children)) {\n      return ary.concat(reduceToLeafNodes(node.children));\n    }\n    ary.push(node);\n    return ary;\n  }, []);\n}\n\nexport function styler(obj, { context, data, style }) {\n  const brusher = obj.chart.brush(context);\n  const dataProps = data;\n  const active = style.active || {};\n  const inactive = style.inactive || {};\n  const styleProps = [];\n  Object.keys(active).forEach((key) => {\n    styleProps.push(key);\n  });\n\n  Object.keys(inactive).forEach((key) => {\n    if (styleProps.indexOf(key) === -1) {\n      styleProps.push(key);\n    }\n  });\n\n  const activeNodes = [];\n  let globalActivation = false; // track when we need to loop through all nodes, not just the active ones\n\n  const update = () => {\n    // TODO - render nodes only once, i.e. don't render for each brush, update nodes for all brushes and then render\n    const nodes = reduceToLeafNodes(obj.nodes);\n    const len = nodes.length;\n    let nodeData;\n    let globalChanged = false;\n\n    for (let i = 0; i < len; i++) { // TODO - update only added and removed nodes\n      nodeData = nodes[i].data;\n      if (!nodeData) {\n        continue;\n      }\n\n      if (!nodes[i].__style) {\n        nodes[i].__style = {};\n        styleProps.forEach((s) => {\n          nodes[i].__style[s] = nodes[i][s]; // store original value\n        });\n      }\n\n      const isActive = brusher.containsMappedData(nodeData, dataProps);\n      const activeIdx = activeNodes.indexOf(nodes[i]);\n      let changed = false;\n      if (isActive && activeIdx === -1) { // activated\n        activeNodes.push(nodes[i]);\n        changed = true;\n      } else if (!isActive && activeIdx !== -1) { // was active\n        activeNodes.splice(activeIdx, 1);\n        changed = true;\n      }\n      if (changed || globalActivation) {\n        styleProps.forEach((s) => {\n          if (isActive && s in active) {\n            nodes[i][s] = active[s];\n          } else if (!isActive && s in inactive) {\n            nodes[i][s] = inactive[s];\n          } else {\n            if (!nodes[i].__style) {\n              nodes[i].__style = nodes[i].__style || {};\n              styleProps.forEach((ss) => {\n                nodes[i].__style[ss] = nodes[i][ss]; // store original value\n              });\n            }\n            nodes[i][s] = nodes[i].__style[s];\n          }\n        });\n        globalChanged = true;\n      }\n    }\n    globalActivation = false;\n    return globalChanged;\n  };\n\n  const onStart = () => {\n    const nodes = reduceToLeafNodes(obj.nodes);\n    const len = nodes.length;\n    for (let i = 0; i < len; i++) {\n      nodes[i].__style = nodes[i].__style || {};\n      styleProps.forEach((s) => {\n        nodes[i].__style[s] = nodes[i][s]; // store original value\n        if (s in inactive) {\n          nodes[i][s] = inactive[s];\n        }\n      });\n    }\n    globalActivation = true;\n    activeNodes.length = 0;\n    obj.renderer.render(obj.nodes);\n  };\n\n  const onEnd = () => {\n    const nodes = reduceToLeafNodes(obj.nodes);\n    const len = nodes.length;\n\n    for (let i = 0; i < len; i++) {\n      if (nodes[i].__style) {\n        Object.keys(nodes[i].__style).forEach((s) => {\n          nodes[i][s] = nodes[i].__style[s];\n        });\n        nodes[i].__style = undefined;\n      }\n    }\n    activeNodes.length = 0;\n    obj.renderer.render(obj.nodes);\n  };\n  const onUpdate = (/* added, removed */) => {\n    const changed = update();\n    if (changed) {\n      obj.renderer.render(obj.nodes);\n    }\n  };\n\n  const externalUpdate = () => {\n    activeNodes.length = 0;\n    globalActivation = true;\n    update();\n  };\n\n  brusher.on('start', onStart);\n  brusher.on('end', onEnd);\n  brusher.on('update', onUpdate);\n\n  function cleanUp() {\n    brusher.removeListener('start', onStart);\n    brusher.removeListener('end', onEnd);\n    brusher.removeListener('update', onUpdate);\n  }\n\n  return {\n    isActive() {\n      return brusher.isActive();\n    },\n    update: externalUpdate,\n    cleanUp\n  };\n}\n\nexport function brushDataPoints({\n  dataPoints,\n  action,\n  chart,\n  trigger\n}) {\n  if (!trigger) {\n    return;\n  }\n\n  const dataProps = trigger.data || [''];\n\n  let rangeBrush = {\n    items: [],\n    actionFn: 'toggleRanges'\n  };\n  let valueBrush = {\n    items: [],\n    actionFn: 'toggleValues'\n  };\n\n  if (['add', 'remove', 'set', 'toggle'].indexOf(action) !== -1) {\n    rangeBrush.actionFn = `${action}Ranges`;\n    valueBrush.actionFn = `${action}Values`;\n  }\n\n  for (let i = 0; i < dataPoints.length; i++) {\n    const dataPoint = dataPoints[i];\n    if (!dataPoint) {\n      continue;\n    }\n    dataProps.forEach((p) => {\n      let d = dataPoint && !p ? dataPoint : dataPoint[p];\n      if (d) {\n        let it = { key: d.source.field };\n        if (typeof d.source.key !== 'undefined') {\n          it.key = `${d.source.key}/${d.source.field}`;\n        }\n        if (Array.isArray(d.value)) {\n          it.range = { min: d.value[0], max: d.value[1] };\n          rangeBrush.items.push(it);\n        } else {\n          it.value = d.value;\n          valueBrush.items.push(it);\n        }\n      }\n    });\n  }\n\n  trigger.contexts.forEach((c) => {\n    if (rangeBrush.items.length) {\n      chart.brush(c)[rangeBrush.actionFn](rangeBrush.items);\n    } else {\n      chart.brush(c)[valueBrush.actionFn](valueBrush.items); // call action even if there are items to potentially clear what is currently in the brush\n    }\n  });\n}\n\nexport function brushFromSceneNodes({\n  nodes,\n  action,\n  chart,\n  trigger\n}) {\n  const dataPoints = [];\n  for (let i = 0; i < nodes.length; i++) {\n    const node = nodes[i];\n    let nodeData = node.data;\n    if (nodeData !== null) {\n      dataPoints.push(nodeData);\n    }\n  }\n\n  brushDataPoints({\n    dataPoints,\n    action,\n    chart,\n    trigger\n  });\n}\n\nexport function resolveEvent({\n  collisions, t, config, action\n}) {\n  let brushCollisions = [];\n  let resolved = false;\n\n  if (collisions.length > 0) {\n    brushCollisions = collisions;\n    resolved = true;\n\n    if (t.propagation === 'stop') {\n      brushCollisions = [collisions[collisions.length - 1]];\n    }\n  }\n\n  const nodes = brushCollisions.map(c => c.node);\n  brushFromSceneNodes({\n    nodes,\n    action,\n    chart: config.chart,\n    data: config.data,\n    trigger: t\n  });\n\n  return resolved;\n}\n\nfunction touchSingleContactPoint(e, rect) {\n  if (e.changedTouches.length !== 1) {\n    return null;\n  }\n\n  return {\n    x: e.changedTouches[0].clientX - rect.left,\n    y: e.changedTouches[0].clientY - rect.top\n  };\n}\n\nfunction singleContactPoint(e, rect) {\n  return {\n    x: e.clientX - rect.left,\n    y: e.clientY - rect.top\n  };\n}\n\nfunction resolveCollisions(e, t, renderer) {\n  const rect = renderer.element().getBoundingClientRect();\n  let p = isTouchEvent(e) ? touchSingleContactPoint(e, rect) : singleContactPoint(e, rect);\n\n  if (p === null || p.x < 0 || p.y < 0 || p.x > rect.width || p.y > rect.height) { // TODO include radius in this check?\n    return [];\n  }\n\n  if (t.touchRadius > 0 && isTouchEvent(e)) {\n    p = {\n      cx: p.x,\n      cy: p.y,\n      r: t.touchRadius // TODO Use touch event radius/width value (Need to handle dpi scaling as well)\n    };\n  }\n\n  return renderer.itemsAt(p);\n}\n\nfunction resolveAction(action, e, def) {\n  if (action) {\n    if (typeof action === 'function') {\n      return action(e);\n    }\n    return action;\n  }\n  return def;\n}\n\nexport function resolveTapEvent({ e, t, config }) {\n  const collisions = resolveCollisions(e, t, config.renderer);\n\n  return resolveEvent({\n    collisions, t, config, action: resolveAction(t.action, e, 'toggle')\n  });\n}\n\nexport function resolveOverEvent({ e, t, config }) {\n  const collisions = resolveCollisions(e, t, config.renderer);\n\n  return resolveEvent({\n    collisions, t, config, action: resolveAction(t.action, e, 'set')\n  });\n}\n","/* eslint camelcase: 1 */\nimport extend from 'extend';\nimport EventEmitter from '../utils/event-emitter';\nimport { list as listMixins } from './component-mixins';\nimport extractData from '../data/extractor';\nimport tween from './tween';\nimport settingsResolver from './settings-resolver';\nimport {\n  styler as brushStyler,\n  resolveTapEvent,\n  resolveOverEvent,\n  brushFromSceneNodes\n} from './brushing';\n\nconst isReservedProperty = prop => [\n  'on', 'preferredSize', 'created', 'beforeMount', 'mounted', 'resize',\n  'beforeUpdate', 'updated', 'beforeRender', 'render', 'beforeUnmount', 'beforeDestroy',\n  'destroyed', 'defaultSettings', 'data', 'settings', 'formatter',\n  'scale', 'chart', 'dockConfig', 'mediator', 'style', 'resolver', 'registries',\n  '_DO_NOT_USE_getInfo'\n].some(name => name === prop);\n\nfunction prepareContext(ctx, definition, opts) {\n  const {\n    require = []\n  } = definition;\n  const mediatorSettings = definition.mediator || {};\n  const {\n    settings,\n    formatter,\n    scale,\n    data,\n    renderer,\n    chart,\n    dockConfig,\n    mediator,\n    instance,\n    style,\n    registries,\n    resolver,\n    update,\n    _DO_NOT_USE_getInfo\n  } = opts;\n\n  // TODO add setters and log warnings / errors to console\n  Object.defineProperty(ctx, 'settings', {\n    get: settings\n  });\n  Object.defineProperty(ctx, 'data', {\n    get: data\n  });\n  Object.defineProperty(ctx, 'formatter', {\n    get: formatter\n  });\n  Object.defineProperty(ctx, 'scale', {\n    get: scale\n  });\n  Object.defineProperty(ctx, 'mediator', {\n    get: mediator\n  });\n  Object.defineProperty(ctx, 'style', {\n    get: style\n  });\n  Object.defineProperty(ctx, 'registries', {\n    get: registries\n  });\n\n  // TODO _DO_NOT_USE_getInfo is a temporary solution to expose info from a component\n  // It should replace ASAP with a proper solution.\n  // The only component activaly in need of it is the legend-cat\n  if (_DO_NOT_USE_getInfo) {\n    ctx._DO_NOT_USE_getInfo = _DO_NOT_USE_getInfo;\n  }\n\n  Object.keys(definition).forEach((key) => {\n    if (!isReservedProperty(key)) {\n      // Add non-lifecycle methods to the context\n      if (typeof definition[key] === 'function') {\n        ctx[key] = definition[key].bind(ctx);\n      } else {\n        ctx[key] = definition[key];\n      }\n    }\n  });\n\n  // Add properties to context\n  require.forEach((req) => {\n    if (req === 'renderer') {\n      Object.defineProperty(ctx, 'renderer', {\n        get: renderer\n      });\n    } else if (req === 'chart') {\n      Object.defineProperty(ctx, 'chart', {\n        get: chart\n      });\n    } else if (req === 'dockConfig') {\n      Object.defineProperty(ctx, 'dockConfig', {\n        get: dockConfig\n      });\n    } else if (req === 'instance') {\n      Object.defineProperty(ctx, 'instance', {\n        get: instance\n      });\n    } else if (req === 'update' && update) {\n      Object.defineProperty(ctx, 'update', {\n        get: update\n      });\n    } else if (req === 'resolver') {\n      Object.defineProperty(ctx, 'resolver', {\n        get: resolver\n      });\n    }\n  });\n\n  Object.keys(mediatorSettings).forEach((eventName) => {\n    ctx.mediator.on(eventName, mediatorSettings[eventName].bind(ctx));\n  });\n}\n\nfunction updateDockConfig(config, settings) {\n  config.displayOrder = settings.displayOrder;\n  config.dock = settings.dock;\n  config.prioOrder = settings.prioOrder;\n  config.minimumLayoutMode = settings.minimumLayoutMode;\n  config.show = settings.show;\n  return config;\n}\n\nfunction setUpEmitter(ctx, emitter, settings) {\n  // Object.defineProperty(ctx, 'emitter', )\n  Object.keys(settings.on || {}).forEach((event) => {\n    ctx.eventListeners = ctx.eventListeners || [];\n    const listener = settings.on[event].bind(ctx);\n    ctx.eventListeners.push({ event, listener });\n    emitter.on(event, listener);\n  });\n  ctx.emit = (name, ...event) => emitter.emit(name, ...event);\n}\n\n// First render\n// preferredSize -> resize -> beforeRender -> render -> mounted\n\n// Normal update\n// beforeUpdate -> preferredSize -> resize -> beforeRender -> render -> updated\n\n// Update without relayout\n// beforeUpdate -> beforeRender -> render -> updated\n\n// TODO support es6 classes\nfunction componentFactory(definition, options = {}) {\n  const {\n    defaultSettings = {},\n    _DO_NOT_USE_getInfo = () => ({})\n  } = definition;\n  const {\n    chart,\n    container,\n    mediator,\n    registries,\n    theme,\n    renderer // Used by tests\n  } = options;\n  const config = options.settings || {};\n  const emitter = EventEmitter.mixin({});\n  let settings = extend(true, {}, defaultSettings, config);\n  let data = [];\n  let scale;\n  let formatter;\n  let element;\n  let size;\n  let style;\n  let resolver = settingsResolver({\n    chart\n  });\n\n  const brushArgs = {\n    nodes: [],\n    chart,\n    config: settings.brush || {},\n    renderer: null\n  };\n  const brushTriggers = {\n    tap: [],\n    over: []\n  };\n  const brushStylers = [];\n  const componentMixins = listMixins(settings.type);\n  const definitionContext = {};\n  const instanceContext = extend({}, config, componentMixins.filter(mixinName => !isReservedProperty(mixinName)));\n\n  // Create a callback that calls lifecycle functions in the definition and config (if they exist).\n  function createCallback(method, defaultMethod = () => {}) {\n    return function cb(...args) {\n      const inDefinition = typeof definition[method] === 'function';\n      const inConfig = typeof config[method] === 'function';\n\n      let returnValue;\n      if (inDefinition) {\n        returnValue = definition[method].call(definitionContext, ...args);\n      }\n      if (typeof config[method] === 'function') {\n        returnValue = config[method].call(instanceContext, ...args);\n      }\n      if (!inDefinition && !inConfig) {\n        returnValue = defaultMethod.call(definitionContext, ...args);\n      }\n      componentMixins.forEach((mixin) => {\n        if (mixin[method]) {\n          mixin[method].call(instanceContext, ...args);\n        }\n      });\n      return returnValue;\n    };\n  }\n\n  const preferredSize = createCallback('preferredSize', () => 0);\n  const resize = createCallback('resize', ({ inner }) => inner);\n  const created = createCallback('created');\n  const beforeMount = createCallback('beforeMount');\n  const mounted = createCallback('mounted');\n  const beforeUnmount = createCallback('beforeUnmount');\n  const beforeUpdate = createCallback('beforeUpdate');\n  const updated = createCallback('updated');\n  const beforeRender = createCallback('beforeRender');\n  const beforeDestroy = createCallback('beforeDestroy');\n  const destroyed = createCallback('destroyed');\n  const render = definition.render; // Do not allow overriding of this function\n\n  const addBrushStylers = () => {\n    if (settings.brush) {\n      (settings.brush.consume || []).forEach((b) => {\n        if (b.context && b.style) {\n          brushStylers.push(brushStyler(brushArgs, b));\n        }\n      });\n    }\n  };\n\n  const addBrushTriggers = () => {\n    if (settings.brush) {\n      (settings.brush.trigger || []).forEach((t) => {\n        if (t.on === 'over') {\n          brushTriggers.over.push(t);\n        } else {\n          brushTriggers.tap.push(t);\n        }\n      });\n    }\n  };\n\n  Object.defineProperty(brushArgs, 'data', {\n    get: () => data\n  });\n\n  const rendString = settings.renderer || definition.renderer;\n  const rend = rendString ? renderer || registries.renderer(rendString)() : renderer || registries.renderer()();\n  brushArgs.renderer = rend;\n\n  const dockConfig = {\n    requiredSize: (inner, outer) => preferredSize({\n      inner,\n      outer,\n      dock: dockConfig.dock\n    })\n  };\n  updateDockConfig(dockConfig, settings);\n\n  const appendComponentMeta = (node) => {\n    node.key = settings.key;\n    node.element = rend.element();\n  };\n\n  const fn = () => {};\n\n  fn.dockConfig = dockConfig;\n\n  // Set new settings - will trigger mapping of data and creation of scale / formatter.\n  fn.set = (opts = {}) => {\n    if (opts.settings) {\n      settings = extend(true, {}, defaultSettings, opts.settings);\n      updateDockConfig(dockConfig, settings);\n    }\n\n    if (settings.scale) {\n      scale = chart.scale(settings.scale);\n    }\n\n    if (settings.data) {\n      data = extractData(settings.data, { dataset: chart.dataset, collection: chart.dataCollection }, { logger: chart.logger() }, chart.dataCollection);\n    } else if (scale) {\n      data = scale.data();\n    } else {\n      data = [];\n    }\n\n    if (typeof settings.formatter === 'string') {\n      formatter = chart.formatter(settings.formatter);\n    } else if (typeof settings.formatter === 'object') {\n      formatter = chart.formatter(settings.formatter);\n    } else if (scale && scale.data().fields) {\n      formatter = scale.data().fields[0].formatter();\n    }\n\n    style = theme.style(settings.style || {});\n  };\n\n  fn.resize = (inner, outer) => {\n    const newSize = resize({\n      inner,\n      outer\n    });\n    if (newSize) {\n      rend.size(newSize);\n      size = newSize;\n    } else {\n      rend.size(inner);\n      size = inner;\n    }\n    instanceContext.rect = inner;\n  };\n\n  fn.getRect = () => instanceContext.rect;\n\n  const getRenderArgs = () => {\n    const renderArgs = rend.renderArgs ? rend.renderArgs.slice(0) : [];\n    renderArgs.push({\n      data\n    });\n    return renderArgs;\n  };\n\n  fn.beforeMount = beforeMount;\n\n  fn.beforeRender = () => {\n    beforeRender({\n      size\n    });\n  };\n\n  let currentNodes;\n\n  fn.render = () => {\n    const nodes = brushArgs.nodes = render.call(definitionContext, ...getRenderArgs());\n    rend.render(nodes);\n    currentNodes = nodes;\n  };\n\n  fn.hide = () => {\n    fn.unmount();\n    rend.size({\n      x: 0,\n      y: 0,\n      width: 0,\n      height: 0\n    });\n    rend.clear();\n  };\n\n  fn.beforeUpdate = () => {\n    beforeUpdate({\n      settings,\n      data\n    });\n  };\n\n  let currentTween;\n  fn.update = () => {\n    if (currentTween) {\n      currentTween.stop();\n    }\n    const nodes = brushArgs.nodes = render.call(definitionContext, ...getRenderArgs());\n\n    // Reset brush stylers and triggers\n    brushStylers.forEach(b => b.cleanUp());\n    brushStylers.length = 0;\n    brushTriggers.tap = [];\n    brushTriggers.over = [];\n\n    if (settings.brush) {\n      addBrushStylers();\n      addBrushTriggers();\n    }\n\n    brushStylers.forEach((bs) => {\n      if (bs.isActive()) {\n        bs.update();\n      }\n    });\n\n    if (currentNodes && settings.animations && settings.animations.enabled) {\n      currentTween = tween({\n        old: currentNodes,\n        current: nodes\n      }, { renderer: rend }, settings.animations);\n      currentTween.start();\n    } else {\n      rend.render(nodes);\n    }\n    currentNodes = nodes;\n  };\n\n  fn.updated = updated;\n\n  fn.destroy = () => {\n    fn.unmount();\n    beforeDestroy(element);\n    rend.destroy();\n    destroyed();\n    element = null;\n  };\n\n  /**\n   * Update active nodes. For now this can be used as a way update and apply brushing on nodes.\n   * Ex: if a component have changed the nodes since its initial render.\n   * @param {Nodes[]} nodes\n   * @deprecated\n   * @ignore\n   */\n  const updateNodes = (nodes) => {\n    brushArgs.nodes = nodes;\n    brushStylers.forEach((bs) => {\n      if (bs.isActive()) {\n        bs.update();\n      }\n    });\n    rend.render(nodes);\n  };\n\n  // Set contexts, note that the definition and instance need different contexts (for example if they have different 'require' props)\n  prepareContext(definitionContext, definition, {\n    settings: () => settings,\n    data: () => data,\n    scale: () => scale,\n    formatter: () => formatter,\n    renderer: () => rend,\n    chart: () => chart,\n    dockConfig: () => dockConfig,\n    mediator: () => mediator,\n    instance: () => instanceContext,\n    style: () => style,\n    update: () => updateNodes,\n    registries: () => registries,\n    resolver: () => resolver\n  });\n\n  prepareContext(instanceContext, config, {\n    settings: () => settings,\n    data: () => data,\n    scale: () => scale,\n    formatter: () => formatter,\n    renderer: () => rend,\n    chart: () => chart,\n    dockConfig: () => dockConfig,\n    mediator: () => mediator,\n    style: () => style,\n    _DO_NOT_USE_getInfo: _DO_NOT_USE_getInfo.bind(definitionContext)\n  });\n\n  fn.getBrushedShapes = function getBrushedShapes(context, mode, props) {\n    const shapes = [];\n    if (settings.brush && settings.brush.consume) {\n      const brusher = chart.brush(context);\n      const sceneNodes = rend.findShapes('*');\n      settings.brush.consume\n        .filter(t => t.context === context)\n        .forEach((consume) => {\n          for (let i = 0; i < sceneNodes.length; i++) {\n            const node = sceneNodes[i];\n            if (node.data && brusher.containsMappedData(node.data, props || consume.data, mode)) {\n              appendComponentMeta(node);\n              shapes.push(node);\n              sceneNodes.splice(i, 1);\n              i--;\n            }\n          }\n        });\n    }\n    return shapes;\n  };\n\n  fn.findShapes = (selector) => {\n    const shapes = rend.findShapes(selector);\n    for (let i = 0, num = shapes.length; i < num; i++) {\n      appendComponentMeta(shapes[i]);\n    }\n\n    return shapes;\n  };\n\n  fn.shapesAt = (shape, opts = {}) => {\n    const items = rend.itemsAt(shape);\n    let shapes;\n\n    if (opts && opts.propagation === 'stop' && items.length > 0) {\n      shapes = [items.pop().node];\n    } else {\n      shapes = items.map(i => i.node);\n    }\n\n    for (let i = 0, num = shapes.length; i < num; i++) {\n      appendComponentMeta(shapes[i]);\n    }\n\n    return shapes;\n  };\n\n  fn.brushFromShapes = (shapes, trigger = {}) => {\n    trigger.contexts = Array.isArray(trigger.contexts) ? trigger.contexts : [];\n    const action = trigger.action || 'toggle';\n\n    brushFromSceneNodes({\n      nodes: shapes,\n      action,\n      trigger,\n      chart,\n      data: brushArgs.data\n    });\n  };\n\n  fn.mount = () => {\n    element = rend.element && rend.element() ? element : rend.appendTo(container);\n\n    if (settings.brush) {\n      addBrushStylers();\n      addBrushTriggers();\n    }\n\n    setUpEmitter(instanceContext, emitter, config);\n    setUpEmitter(definitionContext, emitter, definition);\n  };\n\n  fn.mounted = () => mounted(element);\n\n  fn.unmount = () => {\n    [instanceContext, definitionContext].forEach((ctx) => {\n      (ctx.eventListeners || []).forEach(({ event, listener }) => {\n        emitter.removeListener(event, listener);\n      });\n    });\n    brushTriggers.tap = [];\n    brushTriggers.over = [];\n    brushStylers.forEach((bs) => {\n      bs.cleanUp();\n    });\n    brushStylers.length = 0;\n    beforeUnmount();\n  };\n\n  fn.onBrushTap = (e) => {\n    brushTriggers.tap.forEach((t) => {\n      if (resolveTapEvent({ e, t, config: brushArgs }) && t.globalPropagation === 'stop') {\n        chart.toggleBrushing(true);\n      }\n    });\n  };\n\n  fn.onBrushOver = (e) => {\n    brushTriggers.over.forEach((t) => {\n      if (resolveOverEvent({ e, t, config: brushArgs }) && t.globalPropagation === 'stop') {\n        chart.toggleBrushing(true);\n      }\n    });\n  };\n\n  /**\n   * Expose definition on instance\n   * @private\n   * @experimental\n   */\n  fn.def = definitionContext;\n\n  /**\n   * Expose instanceCtx on \"instance\"\n   * @private\n   * @experimental\n   */\n  fn.ctx = instanceContext;\n\n  fn.renderer = () => rend;\n\n  fn.set({ settings: config });\n  created();\n\n  return fn;\n}\n\nexport default componentFactory;\n","import EventEmitter from '../utils/event-emitter';\n\nexport default function mediator() {\n  const instance = {};\n  EventEmitter.mixin(instance);\n  return instance;\n}\n","export function add(v1, v2) {\n  return {\n    x: v1.x + v2.x,\n    y: v1.y + v2.y\n  };\n}\n\nexport function sub(v1, v2) {\n  return {\n    x: v1.x - v2.x,\n    y: v1.y - v2.y\n  };\n}\n\nexport function scalarMultiply(v, s) {\n  return {\n    x: v.x * s,\n    y: v.y * s\n  };\n}\n\nexport function sqrMagnitude(v) {\n  return Math.pow(v.x, 2) + Math.pow(v.y, 2);\n}\n\nexport function magnitude(v) {\n  return Math.sqrt(sqrMagnitude(v));\n}\n\nexport function distanceX(v1, v2) {\n  return v1.x - v2.x;\n}\n\nexport function distanceY(v1, v2) {\n  return v1.y - v2.y;\n}\n\nexport function sqrDistance(v1, v2) {\n  return Math.pow(distanceX(v1, v2), 2) + Math.pow(distanceY(v1, v2), 2);\n}\n\nexport function distance(v1, v2) {\n  return Math.sqrt(sqrDistance(v1, v2));\n}\n\nexport function determinant(v1, v2) {\n  return (v1.x * v2.y) - (v2.x * v1.y);\n}\n\nexport function dot(v1, v2) {\n  return (v1.x * v2.x) + (v1.y * v2.y);\n}\n\nexport function projectOnto(v1, v2) {\n  const m = dot(v1, v2) / dot(v2, v2) || 1;\n  return {\n    x: v2.x * m,\n    y: v2.y * m\n  };\n}\n\nexport function rotate(v, radians, origin = { x: 0, y: 0 }) {\n  const cos = Math.cos(radians);\n  const sin = Math.sin(radians);\n\n  const t1 = sub(v, origin);\n\n  const t2 = {\n    x: (cos * t1.x) - (sin * t1.y),\n    y: (sin * t1.x) + (cos * t1.y)\n  };\n\n  return add(t2, origin);\n}\n\nexport function unit(v) {\n  const m = magnitude(v);\n  return { x: v.x / m, y: v.y / m };\n}\n\nexport function cross(u, v, a) {\n  return ((v.x - u.x) * (a.y - u.y)) - ((v.y - u.y) * (v.x - u.x));\n}\n","import { add, sub, projectOnto, distance } from './vector';\n\nconst EPSILON = 1e-12;\n\nexport function closestPointToLine(start, end, p) {\n  const startToPoint = sub(p, start);\n  const startToEnd = sub(end, start);\n  const pointOnLine = add(projectOnto(startToPoint, startToEnd), start);\n  return pointOnLine;\n}\n\nexport function isPointOnLine(start, end, p) {\n  return (distance(start, p) + distance(end, p)) - distance(start, end) < EPSILON;\n}\n\nexport function isCollinear(p1, p2, p3, e = EPSILON) {\n  const t = Math.abs((p1.x * (p2.y - p3.y)) + (p2.x * (p3.y - p1.y)) + (p3.x * (p1.y - p2.y)));\n  return t < e;\n}\n","import {\n  sqrDistance,\n  distanceX,\n  distanceY\n} from './vector';\nimport {\n  closestPointToLine,\n  isPointOnLine\n} from './intersection';\nimport {\n  lineToPoints,\n  rectToPoints,\n  pointsToLine\n} from '../geometry/util';\n\nfunction lineHasNoLength(line) {\n  return line.x1 === line.x2 && line.y1 === line.y2;\n}\n\nfunction rectHasNoSize(rect) {\n  return rect.width <= 0 || rect.height <= 0;\n}\n\nfunction circleHasNoSize(circle) {\n  return circle.r <= 0;\n}\n\nfunction toFewEdges(polygon) {\n  return polygon.edges.length <= 2;\n}\n\n/**\n * @private\n */\nclass NarrowPhaseCollision {\n  /**\n   * Test if a Circle contains a point. If so, returns true and false otherwise.\n   * Circle muse have a radius greater then 0.\n   * @param {object} circle\n   * @param {number} circle.cx - center x-coordinate\n   * @param {number} circle.cy - center y-coordinate\n   * @param {number} circle.r - circle radius\n   * @param {object} point\n   * @param {number} point.x - x-coordinate\n   * @param {number} point.y - y-coordinate\n   * @return {boolean} true if circle contains point\n   */\n  static testCirclePoint(circle, point) {\n    if (circleHasNoSize(circle)) {\n      return false;\n    }\n\n    const center = { x: circle.cx, y: circle.cy };\n    const sqrDist = sqrDistance(center, point);\n\n    if (sqrDist <= Math.pow(circle.r, 2)) {\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Test if a Circle collide with a rectangle. If so, returns true and false otherwise.\n   * Circle muse have a radius greater then 0.\n   * Rectangle must have a width and height greather then 0.\n   * @param {object} circle\n   * @param {number} circle.cx - center x-coordinate\n   * @param {number} circle.cy - center y-coordinate\n   * @param {number} circle.r - circle radius\n   * @param {object} rect\n   * @param {number} rect.x - x-coordinate\n   * @param {number} rect.y - y-coordinate\n   * @param {number} rect.width - width\n   * @param {number} rect.height - height\n   * @return {boolean} true if circle collide with rectangle\n  */\n  static testCircleRect(circle, rect) {\n    if (rectHasNoSize(rect) || circleHasNoSize(circle)) {\n      return false;\n    }\n    const rX = rect.width / 2;\n    const rY = rect.height / 2;\n    const rcX = rect.x + rX;\n    const rcY = rect.y + rY;\n    const r = circle.r;\n    const cx = circle.cx;\n    const cy = circle.cy;\n    const dX = Math.abs(cx - rcX);\n    const dY = Math.abs(cy - rcY);\n\n    if (dX > rX + r || dY > rY + r) { return false; }\n\n    if (dX <= rX || dY <= rY) { return true; }\n\n    const sqrDist = Math.pow(dX - rX, 2) + Math.pow(dY - rY, 2);\n\n    return sqrDist <= Math.pow(r, 2);\n  }\n\n  /**\n   * Test if a Circle collide with a line segment. If so, returns true and false otherwise.\n   * Circle muse have a radius greater then 0.\n   * Line must have a length greater then 0.\n   * @param {object} circle\n   * @param {number} circle.cx - center x-coordinate\n   * @param {number} circle.cy - center y-coordinate\n   * @param {number} circle.r - circle radius\n   * @param {object} line\n   * @param {number} line.x1 - x-coordinate\n   * @param {number} line.y1 - y-coordinate\n   * @param {number} line.x1 - x-coordinate\n   * @param {number} line.y1 - y-coordinate\n   * @return {boolean} true if circle collide with line\n  */\n  static testCircleLine(circle, line) {\n    if (circleHasNoSize(circle) || lineHasNoLength(line)) {\n      return false;\n    }\n\n    const [p1, p2] = lineToPoints(line);\n    if (NarrowPhaseCollision.testCirclePoint(circle, p1) || NarrowPhaseCollision.testCirclePoint(circle, p2)) {\n      return true;\n    }\n\n    const center = { x: circle.cx, y: circle.cy };\n    const pointOnLine = closestPointToLine(p1, p2, center);\n    const dist = sqrDistance(pointOnLine, center);\n\n    return dist <= Math.pow(circle.r, 2) && isPointOnLine(p1, p2, pointOnLine);\n  }\n\n  /**\n   * Test if a Circle collide with another Circle. If so, returns true and false otherwise.\n   * Both circles muse have a radius greater then 0.\n   * @param {object} circle\n   * @param {number} circle.cx - center x-coordinate\n   * @param {number} circle.cy - center y-coordinate\n   * @param {number} circle.r - circle radius\n   * @param {object} circle\n   * @param {number} circle.cx - center x-coordinate\n   * @param {number} circle.cy - center y-coordinate\n   * @param {number} circle.r - circle radius\n   * @return {boolean} true if circle collide with circle\n  */\n  static testCircleCircle(circle1, circle2) {\n    if (circleHasNoSize(circle1) || circleHasNoSize(circle2)) { return false; }\n\n    const dx = circle1.cx - circle2.cx;\n    const dy = circle1.cy - circle2.cy;\n    const sqrDist = Math.pow(dx, 2) + Math.pow(dy, 2);\n\n    if (sqrDist <= Math.pow(circle1.r + circle2.r, 2)) {\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Test if a Circle collide with Polygon. If so, returns true and false otherwise.\n   * Circle muse have a radius greater then 0.\n   * Polygon must contain at least 2 vertices\n   * @param {object} circle\n   * @param {number} circle.cx - center x-coordinate\n   * @param {number} circle.cy - center y-coordinate\n   * @param {number} circle.r - circle radius\n   * @param {object} polygon\n   * @param {Array} polygon.vertices - Array of vertices\n   * @param {object} polygon.vertices.vertex\n   * @param {number} polygon.vertices.vertex.x - x-coordinate\n   * @param {number} polygon.vertices.vertex.y - y-coordinate\n   * @param {Array} polygon.edges - Array of edges\n   * @param {Array} polygon.edges.edge - Array of points\n   * @param {object} polygon.edges.edge.point\n   * @param {number} polygon.edges.edge.point.x - x-coordinate\n   * @param {number} polygon.edges.edge.point.y - y-coordinate\n   * @return {boolean} true if circle collide with polygon\n  */\n  static testCirclePolygon(circle, polygon) {\n    // TODO handle polygon that is a straight line, current impl will interrept it is a true, if radius is extended onto any of the edges\n    if (toFewEdges(polygon) || circleHasNoSize(circle)) {\n      return false;\n    }\n\n    const center = { x: circle.cx, y: circle.cy };\n    if (NarrowPhaseCollision.testPolygonPoint(polygon, center)) {\n      return true;\n    }\n\n    const num = polygon.edges.length;\n\n    for (let i = 0; i < num; i++) {\n      const edge = pointsToLine(polygon.edges[i]);\n      if (NarrowPhaseCollision.testCircleLine(circle, edge)) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  /**\n   * Test if a Polygon contains a Point. If so, returns true and false otherwise.\n   * Polygon must contain at least 2 vertices\n   * @param {object} polygon\n   * @param {Array} polygon.vertices - Array of vertices\n   * @param {object} polygon.vertices.vertex\n   * @param {number} polygon.vertices.vertex.x - x-coordinate\n   * @param {number} polygon.vertices.vertex.y - y-coordinate\n   * @param {Array} polygon.edges - Array of edges\n   * @param {Array} polygon.edges.edge - Array of points\n   * @param {object} polygon.edges.edge.point\n   * @param {number} polygon.edges.edge.point.x - x-coordinate\n   * @param {number} polygon.edges.edge.point.y - y-coordinate\n   * @param {object} point\n   * @param {number} point.x - x-coordinate\n   * @param {number} point.y - y-coordinate\n   * @return {boolean} true if polygon conatins point\n  */\n  static testPolygonPoint(polygon, point) {\n    // TODO handle polygon that is a straight line, current impl gives a non-deterministic output, that is depending on number of vertices\n    if (toFewEdges(polygon) || !NarrowPhaseCollision.testRectPoint(polygon.boundingRect(), point)) {\n      return false;\n    }\n\n    let even = true;\n    const num = polygon.vertices.length;\n    const rayStart = { x: polygon.xMin - 1, y: point.y };\n\n    for (let i = 0; i < num - 1; i++) {\n      const edge = pointsToLine(polygon.edges[i]);\n      if (!(edge.y1 < point.y && edge.y2 < point.y) && !(edge.y1 > point.y && edge.y2 > point.y)) { // filterout any edges that does not cross the ray\n        even = NarrowPhaseCollision.testLineLine(edge, pointsToLine([rayStart, point])) ? !even : even;\n      }\n    }\n    return !even;\n  }\n\n  /**\n   * Test if a Polygon collider with a line. If so, returns true and false otherwise.\n   * Polygon must contain at least 3 edges.\n   * Line must have length greater then 0.\n   * @param {object} polygon\n   * @param {Array} polygon.vertices - Array of vertices\n   * @param {object} polygon.vertices.vertex\n   * @param {number} polygon.vertices.vertex.x - x-coordinate\n   * @param {number} polygon.vertices.vertex.y - y-coordinate\n   * @param {Array} polygon.edges - Array of edges\n   * @param {Array} polygon.edges.edge - Array of points\n   * @param {object} polygon.edges.edge.point\n   * @param {number} polygon.edges.edge.point.x - x-coordinate\n   * @param {number} polygon.edges.edge.point.y - y-coordinate\n   * @param {object} line\n   * @param {number} line.x1 - x-coordinate\n   * @param {number} line.y1 - y-coordinate\n   * @param {number} line.x1 - x-coordinate\n   * @param {number} line.y1 - y-coordinate\n   * @return {boolean} true if polygon collider with line\n  */\n  static testPolygonLine(polygon, line) {\n    // TODO handle polygon that is a straight line, current impl gives a non-deterministic output, that is depending on number of vertices\n    if (toFewEdges(polygon)) {\n      return false;\n    }\n\n    for (let i = 0, num = polygon.edges.length; i < num; i++) {\n      const edge = pointsToLine(polygon.edges[i]);\n      if (NarrowPhaseCollision.testLineLine(line, edge)) {\n        return true;\n      }\n    }\n\n    const [p1, p2] = lineToPoints(line);\n\n    return NarrowPhaseCollision.testPolygonPoint(polygon, p1) ||\n      NarrowPhaseCollision.testPolygonPoint(polygon, p2);\n  }\n\n  /**\n   * Test if a Polygon collider with a rectangle. If so, returns true and false otherwise.\n   * Polygon must contain at least 3 edges.\n   * Rectangle must width and height greater then 0.\n   * @param {object} polygon\n   * @param {Array} polygon.vertices - Array of vertices\n   * @param {object} polygon.vertices.vertex\n   * @param {number} polygon.vertices.vertex.x - x-coordinate\n   * @param {number} polygon.vertices.vertex.y - y-coordinate\n   * @param {Array} polygon.edges - Array of edges\n   * @param {Array} polygon.edges.edge - Array of points\n   * @param {object} polygon.edges.edge.point\n   * @param {number} polygon.edges.edge.point.x - x-coordinate\n   * @param {number} polygon.edges.edge.point.y - y-coordinate\n   * @param {object} rect\n   * @param {number} rect.x - x-coordinate\n   * @param {number} rect.y - y-coordinate\n   * @param {number} rect.width - width\n   * @param {number} rect.height - height\n   * @return {boolean} true if polygon collider with rect\n  */\n  static testPolygonRect(polygon, rect) {\n    // TODO handle polygon that is a straight line, current impl gives a non-deterministic output, that is depending on number of vertices\n    if (toFewEdges(polygon)) {\n      return false;\n    }\n\n    for (let i = 0, num = polygon.edges.length; i < num; i++) {\n      const edge = pointsToLine(polygon.edges[i]);\n      if (NarrowPhaseCollision.testRectLine(rect, edge)) {\n        return true;\n      }\n    }\n\n    const [p1, p2, p3, p4] = rectToPoints(rect);\n    return NarrowPhaseCollision.testPolygonPoint(polygon, p1) ||\n      NarrowPhaseCollision.testPolygonPoint(polygon, p2) ||\n      NarrowPhaseCollision.testPolygonPoint(polygon, p3) ||\n      NarrowPhaseCollision.testPolygonPoint(polygon, p4);\n  }\n\n  /**\n   * Test if a Rectangle collide with another rectangle. If so, returns true and false otherwise.\n   * Both rectangles must have a width and height greather then 0.\n   * @param {object} rect\n   * @param {number} rect.x - x-coordinate\n   * @param {number} rect.y - y-coordinate\n   * @param {number} rect.width - width\n   * @param {number} rect.height - height\n   * @param {object} rect\n   * @param {number} rect.x - x-coordinate\n   * @param {number} rect.y - y-coordinate\n   * @param {number} rect.width - width\n   * @param {number} rect.height - height\n   * @return {boolean} true if rectangle collide with rectangle\n  */\n  static testRectRect(rect1, rect2) {\n    if (rectHasNoSize(rect1) || rectHasNoSize(rect2)) {\n      return false;\n    }\n\n    return rect1.x <= rect2.x + rect2.width &&\n      rect2.x <= rect1.x + rect1.width &&\n      rect1.y <= rect2.y + rect2.height &&\n      rect2.y <= rect1.y + rect1.height;\n  }\n\n  /**\n   * Test if a Rectangle contains a Point. If so, returns true and false otherwise.\n   * Rectangle must have a width and height greather then 0.\n   * @param {object} rect\n   * @param {number} rect.x - x-coordinate\n   * @param {number} rect.y - y-coordinate\n   * @param {number} rect.width - width\n   * @param {number} rect.height - height\n   * @param {object} point\n   * @param {number} point.x - x-coordinate\n   * @param {number} point.y - y-coordinate\n   * @return {boolean} true if rectangle contains point\n  */\n  static testRectPoint(rect, point) {\n    if (rectHasNoSize(rect)) { return false; }\n\n    return point.x >= rect.x &&\n      point.x <= rect.x + rect.width &&\n      point.y >= rect.y &&\n      point.y <= rect.y + rect.height;\n  }\n\n  /**\n   * Test if a Rectangle collider with a line. If so, returns true and false otherwise.\n   * Rectangle must have a width and height greather then 0.\n   * Line must have length greater then 0.\n   * @param {object} rect\n   * @param {number} rect.x - x-coordinate\n   * @param {number} rect.y - y-coordinate\n   * @param {number} rect.width - width\n   * @param {number} rect.height - height\n   * @param {object} line\n   * @param {number} line.x1 - x-coordinate\n   * @param {number} line.y1 - y-coordinate\n   * @param {number} line.x1 - x-coordinate\n   * @param {number} line.y1 - y-coordinate\n   * @return {boolean} true if rectangle collide with line\n  */\n  static testRectLine(rect, line) {\n    if (lineHasNoLength(line) || rectHasNoSize(rect)) { return false; }\n\n    const [p1, p2] = lineToPoints(line);\n\n    if (NarrowPhaseCollision.testRectPoint(rect, p1) || NarrowPhaseCollision.testRectPoint(rect, p2)) {\n      return true;\n    }\n\n    const rectEdges = rectToPoints(rect);\n    let num = rectEdges.length;\n    for (let i = 0; i < num; i++) {\n      const edge = pointsToLine([rectEdges[i], rectEdges[i !== 3 ? i + 1 : 0]]);\n      if (NarrowPhaseCollision.testLineLine(edge, line)) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Test if a Line collider with another line. If so, returns true and false otherwise.\n   * Both lines must have length greater then 0.\n   * @param {object} line\n   * @param {number} line.x1 - x-coordinate\n   * @param {number} line.y1 - y-coordinate\n   * @param {number} line.x1 - x-coordinate\n   * @param {number} line.y1 - y-coordinate\n   * @param {object} line\n   * @param {number} line.x1 - x-coordinate\n   * @param {number} line.y1 - y-coordinate\n   * @param {number} line.x1 - x-coordinate\n   * @param {number} line.y1 - y-coordinate\n   * @return {boolean} true if line collide with line\n  */\n  static testLineLine(line1, line2) {\n    const [p1, p2] = lineToPoints(line1);\n    const [p3, p4] = lineToPoints(line2);\n    const dx1 = distanceX(p2, p1);\n    const dy1 = distanceY(p2, p1);\n    const dx2 = distanceX(p4, p3);\n    const dy2 = distanceY(p4, p3);\n    const dx3 = distanceX(p1, p3);\n    const dy3 = distanceY(p1, p3);\n    let ub = (dy2 * dx1) - (dx2 * dy1);\n    const uat = (dx2 * dy3) - (dy2 * dx3);\n    const ubt = (dx1 * dy3) - (dy1 * dx3);\n    let t1;\n    let t2;\n\n    if (dx1 === 0 && dy1 === 0) { // Line segment has no length\n      return false;\n    }\n\n    if (dx2 === 0 && dy2 === 0) { // Line segment has no length\n      return false;\n    }\n\n    if (ub === 0) {\n      if (uat === 0 && ubt === 0) { // COINCIDENT;\n        if (dx1 === 0) {\n          if (dy1 === 0) { // p1 = p2\n            return p1.x === p2.x && p1.y === p2.y;\n          }\n          t1 = distanceY(p3, p1) / dy1;\n          t2 = distanceY(p4, p1) / dy1;\n        } else {\n          t1 = (p3.x - p1.x) / dx1;\n          t2 = (p4.x - p1.x) / dx1;\n        }\n        if ((t1 < 0 && t2 < 0) || (t1 > 1 && t2 > 1)) {\n          return false;\n        }\n        return true;\n      }\n      return false; // PARALLEL;\n    }\n    const ua = uat / ub;\n    ub = ubt / ub;\n    if (ua >= 0.0 && ua <= 1.0 && ub >= 0.0 && ub <= 1.0) {\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Test if a Line contains a Point. If so, returns true and false otherwise.\n   * Line must have length greater then 0.\n   * @param {object} line\n   * @param {number} line.x1 - x-coordinate\n   * @param {number} line.y1 - y-coordinate\n   * @param {number} line.x1 - x-coordinate\n   * @param {number} line.y1 - y-coordinate\n   * @param {object} point\n   * @param {number} point.x - x-coordinate\n   * @param {number} point.y - y-coordinate\n   * @return {boolean} true if line contains point\n  */\n  static testLinePoint(line, point) {\n    if (lineHasNoLength(line)) {\n      return false;\n    }\n\n    const [p1, p2] = lineToPoints(line);\n    return isPointOnLine(p1, p2, point);\n  }\n}\n\n\nexport { NarrowPhaseCollision as default };\n","import extend from 'extend';\n\nconst VARIABLE_RX = /^\\$/;\nconst EXTEND = '@extend';\n\nfunction throwCyclical(s) {\n  throw new Error(`Cyclical reference for \"${s}\"`);\n}\n\nfunction res(style, references, path) {\n  if (typeof style === 'string') {\n    let value = references[style];\n    if (path.indexOf(style) !== -1) {\n      throwCyclical(style);\n    }\n    if (VARIABLE_RX.test(value)) {\n      path.push(style);\n      return res(value, references, path);\n    }\n    return value;\n  }\n  let computed = style;\n  const refs = extend(true, {}, references, style);\n  const s = {};\n\n  if (style[EXTEND]) {\n    const extendFrom = style[EXTEND];\n    if (path.indexOf(extendFrom) !== -1) {\n      throwCyclical(extendFrom);\n    }\n    let pext = path.slice();\n    pext.push(extendFrom);\n    computed = extend(true, {}, res(refs[extendFrom], references, pext), style);\n  }\n\n  Object.keys(computed).forEach((key) => {\n    let p = path.slice();\n    if (key === EXTEND || VARIABLE_RX.test(key)) {\n      return;\n    }\n    s[key] = computed[key];\n    let value = s[key];\n    if (VARIABLE_RX.test(value) && value in refs) {\n      if (path.indexOf(value) !== -1) {\n        throwCyclical(value);\n      }\n      p.push(value);\n      value = refs[value];\n      if (typeof value === 'object') {\n        s[key] = res(value, refs, p);\n      } else if (VARIABLE_RX.test(value) && value in refs) {\n        s[key] = res(value, refs, p);\n      } else {\n        s[key] = value;\n      }\n    } else if (typeof value === 'object') {\n      s[key] = res(value, refs, p);\n    }\n  });\n  return s;\n}\n\n/**\n * Resolve style references\n * @private\n * @param {style-object} style\n * @param {style-object} references\n * @returns {object} The resolved style\n * @example\n * resolve({\n *   label: '$label--big'\n * }, {\n *   '$size--m': '12px',\n *   '$label--big': {\n *     fontFamily: 'Arial',\n *     fontSize: '$size--m'\n *   }\n * }); // { label: { fontFamily: 'Arial', fontSize: '12px' } }\n */\nfunction resolve(style, references) {\n  return res(style, references, []);\n}\n\nexport { resolve as default };\n","import styleResolver from '../style/resolver';\n\nfunction themeFn(style = {}, palettes = []) {\n  let pals = {};\n  const setPalettes = (p) => {\n    p.forEach((palette) => {\n      const pal = Array.isArray(palette.colors[0]) ? palette.colors : [palette.colors];\n      pals[palette.key] = {\n        colors: pal,\n        sizes: pal.map(colors => (colors ? colors.length : 0))\n      };\n    });\n  };\n\n  const getPalette = (key, num) => {\n    const palette = pals[key];\n    if (!palette) {\n      return [];\n    }\n    const sizes = palette.sizes;\n    // find the first color set containing at least 'num' colors\n    for (let i = 0; i < sizes.length; i++) {\n      if (num <= sizes[i]) {\n        return palette.colors[i];\n      }\n    }\n    return palette.colors[sizes.length - 1];\n  };\n\n  /**\n   * Theme API\n   * @private\n   * @experimental\n   */\n  const theme = {\n    /**\n     * Get an array of colors\n     * @param {string} name - Name of the color palette\n     * @param {number} [num] - The minimum number of colors to get from the palette\n     */\n    palette: (name, num) => getPalette(name, num),\n\n    setPalettes,\n\n    /**\n     * Resolve style references\n     * @param {style-object} s - Object containing\n     */\n    style: s => styleResolver(s, style)\n  };\n\n  setPalettes(palettes);\n\n  return theme;\n}\n\nexport { themeFn as default };\n","import extend from 'extend';\n\nimport * as mixins from './chart-mixins';\nimport createDockLayout from '../dock-layout/dock-layout';\nimport {\n  detectTouchSupport,\n  isValidTapEvent\n} from '../utils/event-type';\nimport { getShapeType } from '../geometry/util';\nimport datasources from '../data/data';\nimport dataCollections from '../data/collections';\nimport buildFormatters, { getOrCreateFormatter } from './formatter';\nimport { builder as buildScales, getOrCreateScale } from './scales';\nimport buildScroll, { getOrCreateScrollApi } from './scroll-api';\nimport brush from '../brush';\nimport componentFactory from '../component/component-factory';\nimport mediatorFactory from '../mediator';\nimport NarrowPhaseCollision from '../math/narrow-phase-collision';\nimport themeFn from '../theme';\n\n/**\n * @typedef {object} component-settings\n * @property {string} type - Component type (ex: axis, point, ...)\n * @property {function} [preferredSize] - Function returning the preferred size\n * @property {function} [created]\n * @property {function} [beforeMount]\n * @property {function} [mounted]\n * @property {function} [beforeUpdate]\n * @property {function} [updated]\n * @property {function} [beforeRender]\n * @property {function} [beforeDestroy]\n * @property {function} [destroyed]\n * @property {brush-setting} [brush] see [brushing](./brushing.md)\n * @property {number} [displayOrder = 0]\n * @property {number} [prioOrder = 0]\n * @property {boolean} [show = true] If the component should be rendered\n * @property {string | {width: string, height: string}} [minimumLayoutMode] Refer to layout sizes defined by layoutModes in dockLayout\n * @property {string} [dock] left, right, top or bottom\n * @property {string} [scale] Named scale. Will be provided to the component if it ask for it.\n * @property {string} [formatter] Named formatter. Fallback to create formatter from scale. Will be provided to the component if it ask for it.\n */\n\nconst isReservedProperty = prop => [\n  'on', 'created', 'beforeMount', 'mounted', 'resize',\n  'beforeUpdate', 'updated', 'beforeRender', 'render', 'beforeDestroy',\n  'destroyed', 'data', 'settings'\n].some(name => name === prop);\n\nfunction addComponentDelta(shape, containerBounds, componentBounds) {\n  const dx = containerBounds.left - componentBounds.left;\n  const dy = containerBounds.top - componentBounds.top;\n  const type = getShapeType(shape);\n  const deltaShape = extend(true, {}, shape);\n\n  switch (type) {\n    case 'circle':\n      deltaShape.cx += dx;\n      deltaShape.cy += dy;\n      break;\n    case 'polygon':\n      for (let i = 0, num = deltaShape.vertices.length; i < num; i++) {\n        const v = deltaShape.vertices[i];\n        v.x += dx;\n        v.y += dy;\n      }\n      break;\n    case 'line':\n      deltaShape.x1 += dx;\n      deltaShape.y1 += dy;\n      deltaShape.x2 += dx;\n      deltaShape.y2 += dy;\n      break;\n    case 'point':\n    case 'rect':\n      deltaShape.x += dx;\n      deltaShape.y += dy;\n      break;\n    default:\n      break;\n  }\n\n  return deltaShape;\n}\n\nfunction chartFn(definition, context) {\n  /**\n   * @typedef {object} chart-definition\n   */\n  let {\n    /**\n     * @type {HTMLElement}\n     * @memberof chart-definition\n     */\n    element,\n    /**\n     * @type {Array<data-source>}\n     * @memberof chart-definition\n     */\n    data = [],\n    /**\n     * @type {chart-settings}\n     * @memberof chart-definition\n     */\n    settings = {},\n    on = {}\n  } = definition;\n\n  const registries = context.registries;\n  const logger = context.logger;\n  const theme = themeFn(context.style, context.palettes);\n\n  const chartMixins = mixins.list();\n  const listeners = [];\n  /**\n   * @alias chart\n   * @interface\n   */\n  const instance = extend(\n    {},\n    definition,\n    chartMixins.filter(mixinName => !isReservedProperty(mixinName))\n  );\n  const mediator = mediatorFactory();\n  let currentComponents = []; // Augmented components\n  let visibleComponents = [];\n\n  let currentScales = null; // Built scales\n  let currentFormatters = null; // Built formatters\n  let currentScrollApis = null; // Build scroll apis\n  let currentInteractions = [];\n\n  let dataset = () => {};\n  let dataCollection = () => {};\n  const brushes = {};\n  let stopBrushing = false;\n\n  const createComponent = (compSettings, container) => {\n    const componentDefinition = registries.component(compSettings.type);\n    const compInstance = componentFactory(componentDefinition, {\n      settings: compSettings,\n      chart: instance,\n      mediator,\n      registries,\n      theme,\n      container\n    });\n    return {\n      instance: compInstance,\n      settings: extend(true, {}, compSettings),\n      key: compSettings.key,\n      hasKey: typeof compSettings.key !== 'undefined'\n    };\n  };\n\n  // Create a callback that calls lifecycle functions in the definition and config (if they exist).\n  function createCallback(method, defaultMethod = () => {}) {\n    return function cb(...args) {\n      const inDefinition = typeof definition[method] === 'function';\n\n      let returnValue;\n      if (inDefinition) {\n        returnValue = definition[method].call(instance, ...args);\n      } else {\n        returnValue = defaultMethod.call(instance, ...args);\n      }\n      chartMixins.forEach((mixin) => {\n        if (mixin[method]) {\n          mixin[method].call(instance, ...args);\n        }\n      });\n      return returnValue;\n    };\n  }\n\n  const findComponent = (componentInstance) => {\n    for (let i = 0; i < currentComponents.length; i++) {\n      if (currentComponents[i].instance === componentInstance) {\n        return currentComponents[i];\n      }\n    }\n    return null;\n  };\n\n  const findComponentIndexByKey = (key) => {\n    for (let i = 0; i < currentComponents.length; i++) {\n      const currComp = currentComponents[i];\n      if (currComp.hasKey && currComp.key === key) {\n        return i;\n      }\n    }\n    return -1;\n  };\n\n  const layout = (components) => {\n    const dockLayout = createDockLayout(settings.dockLayout);\n    components.forEach((c) => { dockLayout.addComponent(c.instance, c.key); });\n\n    const { visible, hidden } = dockLayout.layout(element);\n    return {\n      visible: visible.map(v => findComponent(v)),\n      hidden: hidden.map(h => findComponent(h))\n    };\n  };\n\n  const moveToPosition = (comp, index) => {\n    const el = comp.instance.renderer().element();\n    if (isNaN(index) || !el || !element || !element.childNodes) { return; }\n    const nodes = element.childNodes;\n    const i = Math.min(nodes.length - 1, Math.max(index, 0));\n    const node = nodes[i];\n    if (element.insertBefore && typeof node !== 'undefined') {\n      element.insertBefore(el, nodes[i]);\n    }\n  };\n\n  const created = createCallback('created');\n  const beforeMount = createCallback('beforeMount');\n  const mounted = createCallback('mounted');\n  const beforeUpdate = createCallback('beforeUpdate');\n  const updated = createCallback('updated');\n  const beforeRender = createCallback('beforeRender');\n  const beforeDestroy = createCallback('beforeDestroy');\n  const destroyed = createCallback('destroyed');\n\n  const set = (_data, _settings, { partialData } = {}) => {\n    const {\n      formatters = {},\n      scales = {},\n      scroll = {}\n    } = _settings;\n\n    dataset = datasources(_data, { logger, types: registries.data });\n    if (!partialData) {\n      Object.keys(brushes).forEach(b => brushes[b].clear());\n    }\n    if (_settings.palettes) {\n      theme.setPalettes(_settings.palettes);\n    }\n    dataCollection = dataCollections(_settings.collections, { dataset }, { logger });\n    currentScales = buildScales(scales, { dataset, collection: dataCollection }, { scale: registries.scale, theme, logger });\n    currentFormatters = buildFormatters(formatters, { dataset, collection: dataCollection }, { formatter: registries.formatter, theme, logger });\n    currentScrollApis = buildScroll(scroll, currentScrollApis);\n  };\n\n  const render = () => {\n    const {\n      components = []\n    } = settings;\n\n    beforeRender();\n\n    set(data, settings);\n\n    currentComponents = components.map(compSettings => (\n      createComponent(compSettings, element)\n    ));\n\n    const { visible, hidden } = layout(currentComponents);\n    visibleComponents = visible;\n\n    hidden.forEach((comp) => {\n      comp.instance.hide();\n      comp.visible = false;\n    });\n\n    visible.forEach(comp => comp.instance.beforeMount());\n    visible.forEach(comp => comp.instance.mount());\n    visible.forEach(comp => comp.instance.beforeRender());\n\n    visible.forEach(comp => comp.instance.render());\n    visible.forEach(comp => comp.instance.mounted());\n    visible.forEach((comp) => { comp.visible = true; });\n  };\n\n  function setInteractions(interactions = []) {\n    const current = {};\n    const newKeys = interactions.filter(it => !!it.key).map(it => it.key);\n    currentInteractions.forEach((cit) => {\n      if (cit.key && newKeys.indexOf(cit.key) !== -1) { // keep old instance\n        current[cit.key] = cit;\n      } else {\n        cit.destroy();\n      }\n    });\n    currentInteractions = interactions.map((intSettings) => {\n      const intDefinition = intSettings.key && current[intSettings.key] ? current[intSettings.key] : registries.interaction(intSettings.type)(instance, mediator, element);\n      intDefinition.set(intSettings);\n      return intDefinition;\n    });\n  }\n\n  const componentsFromPoint = (p) => {\n    const br = element.getBoundingClientRect();\n    const x = 'clientX' in p ? p.clientX : p.x;\n    const y = 'clientY' in p ? p.clientY : p.y;\n    const tp = { x: x - br.left, y: y - br.top };\n    const ret = [];\n    visibleComponents.forEach((c) => {\n      const r = c.instance.getRect();\n      if (NarrowPhaseCollision.testRectPoint(r, tp)) {\n        ret.push(c);\n      }\n    });\n    return ret;\n  };\n\n  // Browser only\n  const mount = () => {\n    element.innerHTML = '';\n\n    render();\n\n    Object.keys(on).forEach((key) => {\n      const listener = on[key].bind(instance);\n      element.addEventListener(key, listener);\n      listeners.push({\n        key,\n        listener\n      });\n    });\n\n    const eventInfo = {};\n    const onTapDown = (e) => {\n      if (e.touches) {\n        eventInfo.x = e.touches[0].clientX;\n        eventInfo.y = e.touches[0].clientY;\n        eventInfo.multiTouch = e.touches.length > 1;\n      } else {\n        eventInfo.x = e.clientX;\n        eventInfo.y = e.clientY;\n        eventInfo.multiTouch = false;\n      }\n      eventInfo.time = Date.now();\n      eventInfo.comps = componentsFromPoint(eventInfo);\n    };\n\n    const onBrushTap = (e) => {\n      const comps = eventInfo.comps || componentsFromPoint(e);\n      if (comps.every(c => c.instance.def.disableTriggers)) {\n        return;\n      }\n\n      if (e.type === 'touchend') {\n        e.preventDefault();\n      }\n      if (!isValidTapEvent(e, eventInfo)) {\n        return;\n      }\n\n      for (let i = comps.length - 1; i >= 0; i--) {\n        const comp = comps[i];\n        comp.instance.onBrushTap(e);\n        if (stopBrushing) {\n          stopBrushing = false;\n          break;\n        }\n      }\n    };\n\n    const onBrushOver = (e) => {\n      const comps = componentsFromPoint(e);\n      for (let i = comps.length - 1; i >= 0; i--) {\n        const comp = comps[i];\n        comp.instance.onBrushOver(e);\n        if (stopBrushing) {\n          stopBrushing = false;\n          break;\n        }\n      }\n    };\n\n    const brushEventList = [];\n\n    brushEventList.push({ key: 'mousedown', listener: onTapDown });\n    brushEventList.push({ key: 'mouseup', listener: onBrushTap });\n\n    if (detectTouchSupport(element)) {\n      brushEventList.push({ key: 'touchstart', listener: onTapDown });\n      brushEventList.push({ key: 'touchend', listener: onBrushTap });\n    }\n\n    brushEventList.push({ key: 'mousemove', listener: onBrushOver });\n\n    brushEventList.forEach((event) => {\n      element.addEventListener(event.key, event.listener);\n      listeners.push(event);\n    });\n    setInteractions(settings.interactions);\n  };\n\n  const unmount = () => {\n    listeners.forEach(({ key, listener }) => element.removeEventListener(key, listener));\n    setInteractions();\n  };\n\n  /**\n   * Update the chart with new settings and / or data\n   * @param {chart-definition} [chart] - Chart definition\n   */\n  instance.update = (newProps = {}) => {\n    const { partialData } = newProps;\n    if (newProps.data) {\n      data = newProps.data;\n    }\n    if (newProps.settings) {\n      settings = newProps.settings;\n      setInteractions(newProps.settings.interactions);\n    }\n\n    beforeUpdate();\n\n    set(data, settings, { partialData });\n\n    const {\n      formatters,\n      scales,\n      components = []\n    } = settings;\n\n    for (let i = currentComponents.length - 1; i >= 0; i--) {\n      const currComp = currentComponents[i];\n      // TODO warn when there is no key\n      if (!components.some(c => currComp.hasKey && currComp.key === c.key)) {\n        // Component is removed\n        currentComponents.splice(i, 1);\n        currComp.instance.destroy();\n      }\n    }\n\n    // Let the \"components\" array determine order of components\n    currentComponents = components.map((comp) => {\n      const idx = findComponentIndexByKey(comp.key);\n      if (idx === -1) {\n        // Component is added\n        return createComponent(comp, element);\n      }\n      // Component is (potentially) updated\n      currentComponents[idx].updateWith = {\n        formatters,\n        scales,\n        data,\n        settings: comp\n      };\n      return currentComponents[idx];\n    });\n\n    currentComponents.forEach((comp) => {\n      if (comp.updateWith) {\n        comp.instance.set(comp.updateWith);\n      }\n    });\n    currentComponents.forEach((comp) => {\n      if (comp.updateWith) {\n        comp.instance.beforeUpdate();\n      }\n    });\n\n    const toUpdate = [];\n    const toRender = [];\n    if (partialData) {\n      currentComponents.forEach((comp) => {\n        if (comp.updateWith && comp.visible) {\n          toUpdate.push(comp);\n        }\n      });\n    } else {\n      const { visible, hidden } = layout(currentComponents); // Relayout\n      visibleComponents = visible;\n\n      visible.forEach((comp) => {\n        if (comp.updateWith && comp.visible) {\n          toUpdate.push(comp);\n        } else {\n          toRender.push(comp);\n        }\n      });\n\n      hidden.forEach((comp) => {\n        comp.instance.hide();\n        comp.visible = false;\n        delete comp.updateWith;\n      });\n    }\n\n    toRender.forEach(comp => comp.instance.beforeMount());\n    toRender.forEach(comp => comp.instance.mount());\n\n    toRender.forEach(comp => comp.instance.beforeRender());\n    toUpdate.forEach(comp => comp.instance.beforeRender());\n\n    toRender.forEach(comp => comp.instance.render());\n    toUpdate.forEach(comp => comp.instance.update());\n\n    // Ensure that displayOrder is keept, only do so on re-layout update.\n    // Which is only the case if partialData is false.\n    if (!partialData) {\n      visibleComponents.forEach((comp, i) => moveToPosition(comp, i));\n    }\n\n    toRender.forEach(comp => comp.instance.mounted());\n    toUpdate.forEach(comp => comp.instance.updated());\n\n    visibleComponents.forEach((comp) => {\n      delete comp.updateWith;\n      comp.visible = true;\n    });\n\n    updated();\n  };\n\n  /**\n   * Destroy the chart instance.\n   */\n  instance.destroy = () => {\n    beforeDestroy();\n    currentComponents.forEach(comp => comp.instance.destroy());\n    currentComponents = [];\n    unmount();\n    delete instance.update;\n    delete instance.destroy;\n    destroyed();\n  };\n\n  /**\n   * Get all shapes associated with the provided context\n   * @param {string} context The brush context\n   * @param {string} mode Property comparasion mode.\n   * @param {Array<string>} props Which specific data properties to compare\n   * @param {string} key Which component to get shapes from. Default gives shapes from all components.\n   * @return {Array<object>} Array of objects containing shape and parent element\n   */\n  instance.getAffectedShapes = (ctx, mode = 'and', props, key) => {\n    const shapes = [];\n    currentComponents.filter(comp => key === undefined || key === null || comp.key === key).forEach((comp) => {\n      shapes.push(...comp.instance.getBrushedShapes(ctx, mode, props));\n    });\n    return shapes;\n  };\n\n  /**\n   * Get all nodes matching the provided selector\n   * @param {string} selector CSS selector [type, attribute, universal, class]\n   * @returns {Array<SceneNode>} Array of objects containing matching nodes\n   *\n   * @example\n   * chart.findShapes('Circle') // [<CircleNode>, <CircleNode>]\n   * chart.findShapes('Circle[fill=\"red\"][stroke!=\"black\"]') // [CircleNode, CircleNode]\n   * chart.findShapes('Container Rect') // [Rect, Rect]\n   */\n  instance.findShapes = (selector) => {\n    const shapes = [];\n    visibleComponents.forEach((c) => {\n      shapes.push(...c.instance.findShapes(selector));\n    });\n    return shapes;\n  };\n\n  /**\n   * Get components overlapping a point.\n   * @param {point} p - Point with x- and y-cooridnate. The coordinate is relative to the browser viewport.\n   * @returns {Array<component-context>} Array of component contexts\n   */\n  instance.componentsFromPoint = p => componentsFromPoint(p).map(comp => comp.instance.ctx);\n\n  /**\n   * Get all nodes colliding with a geometrical shape (circle, line, rectangle, point, polygon).\n   *\n   * The input shape is identified based on the geometrical attributes in the following order: circle => line => rectangle => point => polygon.\n   * Note that not all nodes on a scene have collision detection enabled.\n   * @param {line|rect|point|circle} shape - A geometrical shape. Coordinates are relative to the top-left corner of the chart instance container.\n   * @param {object} opts - Options\n   * @param {object[]} [opts.components] - Array of components to include in the lookup. If no components are specified, all components will be included.\n   * @param {string} [opts.components[].component.key] - Component key\n   * @param {string} [opts.components[].component.propagation] - if set to `stop`, will start lookup on top visible shape and propagate downwards until a shape is found.\n   * @param {string} [opts.propagation] - if set to `stop`, will start lookup on top visible component and propagate downwards until a component has at least a match.\n   * @returns {Array<SceneNode>} Array of objects containing colliding nodes\n   *\n   * @example\n   * chart.shapesAt(\n   *  {\n   *    x: 0,\n   *    y: 0,\n   *    width: 100,\n   *    height: 100\n   *  },\n   *  {\n   *    components: [\n   *      { key: 'key1', propagation: 'stop' },\n   *      { key: 'key2' }\n   *    ],\n   *    propagation: 'stop'\n   *  }\n   * );\n   */\n  instance.shapesAt = (shape, opts = {}) => {\n    const result = [];\n    const containerBounds = element.getBoundingClientRect();\n    let comps = visibleComponents; // Assume that visibleComponents is ordererd according to displayOrder\n\n    if (Array.isArray(opts.components) && opts.components.length > 0) {\n      const compKeys = opts.components.map(c => c.key);\n      comps = visibleComponents\n        .filter(c => compKeys.indexOf(c.key) !== -1)\n        .map(c => ({\n          instance: c.instance,\n          opts: opts.components[compKeys.indexOf(c.key)]\n        }));\n    }\n\n    for (let i = comps.length - 1; i >= 0; i--) {\n      const c = comps[i];\n      const componentBounds = c.instance.renderer().element().getBoundingClientRect();\n      const deltaShape = addComponentDelta(shape, containerBounds, componentBounds);\n      const shapes = c.instance.shapesAt(deltaShape, c.opts);\n      const stopPropagation = shapes.length > 0 && opts.propagation === 'stop';\n\n      result.push(...shapes);\n\n      if (result.length > 0 && stopPropagation) {\n        return result;\n      }\n    }\n    return result;\n  };\n\n\n  /**\n   * Brush data by providing a collection of data bound shapes.\n   * @param {SceneNode[]} shapes - An array of data bound shapes.\n   * @param {object} config - Options\n   * @param {Array<object>} opts.components - Array of components to include in the lookup.\n   * @param {string} [opts.components.component.key] - Component key\n   * @param {Array<string>} [opts.components.component.contexts] - Name of the brushing contexts to affect\n   * @param {Array<string>} [opts.components.component.data] - The mapped data properties to add to the brush\n   * @param {string} [opts.components.component.action] - Type of action to respond with\n   *\n   * @example\n   * const shapes = chartInstance.shapesAt(...);\n   * const config = {\n   *  components:[\n   *    {\n   *      key: 'key1',\n   *      contexts: ['myContext'],\n   *      data: [''],\n   *      action: 'add'\n   *    }\n   *  ]\n   * };\n   * chartInstance.brushFromShapes(shapes, config);\n   */\n  instance.brushFromShapes = (shapes, config = { components: [] }) => {\n    const configKeys = config.components.map(conf => conf.key);\n    visibleComponents.forEach((c) => {\n      const configIndex = configKeys.indexOf(c.key);\n      if (configIndex !== -1) {\n        const compShapes = [];\n        for (let i = 0, num = shapes.length; i < num; i++) {\n          const shape = shapes[i];\n          if (shape.key === c.key) {\n            compShapes.push(shape);\n          }\n        }\n        c.instance.brushFromShapes(compShapes, config.components[configIndex]);\n      }\n    });\n  };\n\n  /**\n   * @param {string} name - Name of scroll api\n   * @returns {scroll}\n   */\n  instance.scroll = function scroll(name = 'default') {\n    return getOrCreateScrollApi(name, currentScrollApis);\n  };\n\n  /**\n   * Get\n   * @param {string} key - Get the dataset identified by `key`\n   * @returns {dataset}\n   */\n  instance.dataset = key => dataset(key);\n\n  instance.dataCollection = key => dataCollection(key);\n\n  /**\n   * Get the all registered scales\n   * @returns {Array<scale>} Array of scales\n   */\n  instance.scales = function scales() {\n    return currentScales;\n  };\n\n  /**\n   * Get the all registered formatters\n   * @returns {Array<formatter>} Array of formatters\n   */\n  instance.formatters = function formatters() {\n    return currentFormatters;\n  };\n\n  /**\n   * Get or create brush context for this chart\n   * @param {string} name - Name of the brush context. If no match is found, a new brush context is created and returned.\n   * @returns {brush}\n   */\n  instance.brush = function brushFn(name = 'default') {\n    if (!brushes[name]) {\n      brushes[name] = brush();\n    }\n    return brushes[name];\n  };\n\n  /**\n   * Get or create a scale for this chart\n   * @param {string|object} v - Scale reference or scale options\n   * @returns {scale}\n   * @example\n   * instance.scale('nameOfMyScale'); // Fetch an existing scale by name\n   * instance.scale({ scale: 'nameOfMyScale' }); // Fetch an existing scale by name\n   * instance.scale({ source: '0/1', type: 'linear' }); // Create a new scale\n   */\n  instance.scale = function scale(v) {\n    return getOrCreateScale(v, currentScales, { dataset, collection: dataCollection }, { scale: registries.scale, theme, logger });\n  };\n\n  /**\n   * Get or create a formatter for this chart\n   * @param {string|object} v - Formatter reference or formatter options\n   * @returns {formatter}\n   * @example\n   * instance.formatter('nameOfMyFormatter'); // Fetch an existing formatter by name\n   * instance.formatter({ formatter: 'nameOfMyFormatter' }); // Fetch an existing formatter by name\n   * instance.formatter({ type: 'q' }); // Fetch an existing formatter by type\n   * instance.formatter({\n   *  formatter: 'd3',\n   *  type: 'number',\n   *  format: '1.0.%'\n   * }); // Create a new formatter\n   */\n  instance.formatter = function formatter(v) {\n    return getOrCreateFormatter(v, currentFormatters, { dataset, collection: dataCollection }, { formatter: registries.formatter, theme, logger });\n  };\n\n  /**\n   * @param {boolean} [val] - Toggle brushing on or off. If value is omitted, a toggle action is applied to the current state.\n   */\n  instance.toggleBrushing = function toggleBrushing(val) {\n    if (typeof val !== 'undefined') {\n      stopBrushing = val;\n    } else {\n      stopBrushing = !stopBrushing;\n    }\n  };\n\n  /**\n   * Get a component context\n   * @param {string} key - Component key\n   * @returns {component-context} Component context\n   */\n  instance.component = (key) => {\n    const idx = findComponentIndexByKey(key);\n    if (idx !== -1) {\n      return currentComponents[idx].instance.ctx;\n    }\n    return undefined;\n  };\n\n  instance.logger = () => logger;\n\n  instance.theme = () => theme;\n\n  /**\n   * Get the all interactions instances\n   * @name chart.interactions\n   * @type {object}\n   * @example\n   * chart.interactions.instances; // Array of all interaction instances\n   * chart.interactions.on(); // Toggle on all interactions instances\n   * chart.interactions.off(); // Toggle off all interactions instances\n   */\n  Object.defineProperty(instance, 'interactions', {\n    get() {\n      return /** @lends chart.interactions */ {\n        /** @type Array<interaction> */\n        instances: currentInteractions,\n        /** Enable all interaction instances */\n        on() {\n          currentInteractions.forEach(i => i.on());\n        },\n        /** Disable all interaction instances */\n        off() {\n          currentInteractions.forEach(i => i.off());\n        }\n      };\n    }\n  });\n\n  created();\n\n  if (element) {\n    beforeMount();\n    mount(element);\n    mounted(element);\n    instance.element = element;\n  }\n\n  return instance;\n}\n\nchartFn.mixin = mixins.add; // Expose mixin registering function\n\nexport default chartFn;\n","import registry from '../utils/registry';\n\nconst rendererRegistry = (reg) => {\n  let f = registry(reg);\n  f.prio = p => (p ? f.default(p[0]) : [f.default()]);\n  f.types = () => f.getKeys();\n  return f;\n};\n\nexport { rendererRegistry as default };\n","// import * as mixins from './component-mixins';\nimport registry from '../utils/registry';\n\nconst componentRegistry = registry();\n\n// TODO - mixins?\n\nexport { componentRegistry as default };\n\n// export default function componentFactory(parentRegistry) {\n//   const reg = registry(parentRegistry);\n\n//   function component(name, definition) {\n//     if (definition) {\n//       reg.register(name, definition);\n//     }\n//     return reg.get(name);\n//   }\n//   component.mixin = mixins.add;\n\n//   return component;\n// }\n","export function findField(query, { cache }) {\n  if (typeof query === 'number') {\n    return cache.fields[query];\n  }\n\n  // Find by key first\n  for (let i = 0; i < cache.fields.length; i++) {\n    if (cache.fields[i].key() === query) {\n      return cache.fields[i];\n    }\n  }\n  // find by title\n  for (let i = 0; i < cache.fields.length; i++) {\n    if (cache.fields[i].title() === query) {\n      return cache.fields[i];\n    }\n  }\n  return null;\n}\n\nconst filters = {\n  numeric: values => values.filter(v => typeof v === 'number' && !isNaN(v))\n};\n\nconst unfilteredReducers = {\n  sum: values => values.reduce((a, b) => a + b, 0)\n};\n\n// function isPrimitive(x) {\n//   const type = typeof x;\n//   return (type !== 'object' && type !== 'function');\n// }\n\n/**\n * [reducers description]\n * @type {Object}\n * @private\n */\nexport const reducers = {\n  first: values => values[0],\n  last: values => values[values.length - 1],\n  min: (values) => {\n    const filtered = filters.numeric(values);\n    return !filtered.length ? NaN : Math.min.apply(null, filtered);\n  },\n  max: (values) => {\n    const filtered = filters.numeric(values);\n    return !filtered.length ? NaN : Math.max.apply(null, filtered);\n  },\n  sum: (values) => {\n    const filtered = filters.numeric(values);\n    return !filtered.length ? NaN : filtered.reduce((a, b) => a + b, 0);\n  },\n  avg: (values) => {\n    const filtered = filters.numeric(values);\n    const len = filtered.length;\n    return !len ? NaN : unfilteredReducers.sum(filtered) / len;\n  }\n};\n\nfunction normalizeProperties(cfg, dataset, dataProperties, main) {\n  // console.log('======', cfg, main, dataset);\n  const props = {};\n  const mainField = main.field || (typeof cfg.field !== 'undefined' ? dataset.field(cfg.field) : null);\n  Object.keys(dataProperties).forEach((key) => {\n    const pConfig = dataProperties[key];\n    const prop = props[key] = {};\n    if (['number', 'string', 'boolean'].indexOf(typeof pConfig) !== -1) {\n      prop.type = 'primitive';\n      prop.value = pConfig;\n    } else if (typeof pConfig === 'function') {\n      prop.type = 'function';\n      prop.value = pConfig;\n      prop.label = pConfig;\n      prop.field = mainField;\n    } else if (typeof pConfig === 'object') {\n      if (pConfig.fields) {\n        prop.fields = pConfig.fields.map(ff => normalizeProperties(cfg, dataset, { main: ff }, main).main);\n      } else if (typeof pConfig.field !== 'undefined') {\n        prop.type = 'field';\n        prop.field = dataset.field(pConfig.field);\n        prop.value = prop.field.value;\n        prop.label = prop.field.label;\n      } else if (mainField) {\n        prop.value = mainField.value;\n        prop.label = mainField.label;\n        prop.field = mainField;\n      }\n\n      if (typeof pConfig.filter === 'function') {\n        prop.filter = pConfig.filter;\n      }\n      if (typeof pConfig.value !== 'undefined') {\n        prop.value = pConfig.value;\n      }\n      if (typeof pConfig.label !== 'undefined') {\n        prop.label = pConfig.label;\n      }\n      if (typeof pConfig.reduce === 'function') {\n        prop.reduce = pConfig.reduce;\n      } else if (pConfig.reduce) {\n        prop.reduce = reducers[pConfig.reduce];\n      } else if (prop.field && prop.field.reduce) {\n        prop.reduce = typeof prop.field.reduce === 'string' ? reducers[prop.field.reduce] : prop.field.reduce;\n      }\n    }\n  });\n\n  return props;\n}\n\n/*\nexample of configuration input\ncfg = {\n  field: 'State', // the 'top level' values are extracted from field state\n  value: d => d.qText, // the value of the output\n  props: { // additional data properties ammended to each item\n    a: 3, // constant value\n    b: d => d.qElemNumber, // function will receive the original field value\n    c: {\n      field: 'Country', // reference to another field\n      value: d => d.qText // extract the qText value from the referenced field\n    },\n    d: {\n      value: d => d.qRow //  extract qRow from field 'State'\n    }\n  }\n}\n\n// output\n[{\n  value: 'CA', source: { field: 'State' },\n  a: { value: 3 },\n  b: { value: 26, source: 'State' },\n  c: { value: 'USA', source: 'Country' },\n  d: { value: 131, source: 'State' }\n},\n...]\n*/\nexport function getPropsInfo(cfg, dataset) {\n  // console.log('222', cfg);\n  const { main } = normalizeProperties(cfg, dataset, {\n    main: {\n      value: cfg.value, label: cfg.label, reduce: cfg.reduce, filter: cfg.filter\n    }\n  }, {});\n  const props = normalizeProperties(cfg, dataset, cfg.props || {}, main);\n  return { props, main };\n}\n\n// collect items that have been grouped and reduce per group and property\nexport function collect(trackedItems, {\n  main,\n  propsArr,\n  props\n}) {\n  let dataItems = [];\n  const mainFormatter = main.field.formatter() || (v => v);\n  const propsFormatters = {};\n  propsArr.forEach((prop) => {\n    propsFormatters[prop] = props[prop].field ? props[prop].field.formatter() : v => v;\n  });\n  dataItems.push(...trackedItems.map((t) => {\n    let mainValues = t.items.map(item => item.value);\n    const mainReduce = main.reduce;\n    const ret = {\n      value: mainReduce ? mainReduce(mainValues) : mainValues,\n      source: t.items[0].source\n    };\n    ret.label = mainFormatter(ret.value);\n    propsArr.forEach((prop) => {\n      let values = [];\n      values = t.items.map(item => item[prop].value);\n      const reduce = props[prop].reduce;\n      ret[prop] = {\n        value: reduce ? reduce(values) : values\n      };\n      ret[prop].label = String(propsFormatters[prop](ret[prop].value));\n      if (t.items[0][prop].source) {\n        ret[prop].source = t.items[0][prop].source;\n      }\n    });\n    return ret;\n  }));\n\n  return dataItems;\n}\n\nexport function track({\n  cfg,\n  itemData,\n  obj,\n  target,\n  tracker,\n  trackType\n}) {\n  const trackId = trackType === 'function' ? cfg.trackBy(itemData) : itemData[cfg.trackBy];\n  let trackedItem = tracker[trackId];\n  if (!trackedItem) {\n    trackedItem = tracker[trackId] = {\n      items: [],\n      id: trackId\n    };\n    target.push(trackedItem);\n  }\n  trackedItem.items.push(obj);\n}\n","import {\n  getPropsInfo,\n  collect,\n  track as storeTracked\n} from './util';\n\nfunction datumExtract(propCfg, cell, {\n  key\n}) {\n  const datum = {\n    value: typeof propCfg.value === 'function' ? propCfg.value(cell) : typeof propCfg.value !== 'undefined' ? propCfg.value : cell // eslint-disable-line no-nested-ternary\n  };\n\n  datum.label = typeof propCfg.label === 'function' ? propCfg.label(cell) : typeof propCfg.label !== 'undefined' ? String(propCfg.label) : String(datum.value); // eslint-disable-line no-nested-ternary\n\n  if (propCfg.field) {\n    datum.source = {\n      key,\n      field: propCfg.field.key()\n    };\n  }\n\n  return datum;\n}\n\nexport default function extract(config, dataset) {\n  const cfgs = Array.isArray(config) ? config : [config];\n  let dataItems = [];\n  cfgs.forEach((cfg) => {\n    if (typeof cfg.field !== 'undefined') {\n      const f = dataset.field(cfg.field);\n      const sourceKey = dataset.key();\n      if (!f) {\n        throw Error(`Field '${cfg.field}' not found`);\n      }\n      const { props, main } = getPropsInfo(cfg, dataset);\n      const propsArr = Object.keys(props);\n\n      const track = !!cfg.trackBy;\n      const trackType = typeof cfg.trackBy;\n      const tracker = {};\n      const trackedItems = [];\n\n      const items = f.items();\n      const mapped = [];\n      for (let idx = 0; idx < items.length; idx++) {\n        const mainCell = items[idx];\n        const exclude = main.filter && !main.filter(mainCell);\n        if (exclude) {\n          continue;\n        }\n        const ret = datumExtract(main, mainCell, { key: sourceKey });\n\n        // loop through all props that need to be mapped and\n        // assign 'value' and 'source' to each property\n        propsArr.forEach((prop) => {\n          const p = props[prop];\n          let propCell = p.field ? p.field.items()[idx] : mainCell;\n          ret[prop] = datumExtract(p, propCell, { key: sourceKey });\n        });\n\n        // collect items based on the trackBy value\n        // items with the same trackBy value are placed in an array and reduced later\n        if (track) {\n          storeTracked({\n            cfg,\n            itemData: mainCell,\n            obj: ret,\n            target: trackedItems,\n            tracker,\n            trackType\n          });\n        }\n\n        mapped.push(ret);\n      }\n\n      // reduce if items have been grouped\n      if (track) {\n        dataItems.push(...collect(trackedItems, {\n          main,\n          propsArr,\n          props\n        }));\n      } else {\n        dataItems.push(...mapped);\n      }\n    }\n  });\n  return dataItems;\n}\n","import extend from 'extend';\nimport field from './field';\nimport extract from './extractor-matrix';\n\nimport {\n  findField,\n  getPropsInfo,\n  collect,\n  track\n} from './util';\n\nconst filters = {\n  numeric: values => values.filter(v => typeof v === 'number' && !isNaN(v))\n};\n\nfunction createFields({\n  source, data, cache, config\n}) {\n  let headers;\n  let content = data;\n  const parse = config && config.parse;\n  if (Array.isArray(data[0])) { // assume 2d matrix of data\n    if (parse && parse.headers === false) {\n      headers = data[0].map((v, i) => i);\n    } else {\n      headers = data[0];\n      content = data.slice(1);\n    }\n  } else {\n    headers = Object.keys(data[0]);\n  }\n\n  const rowFn = !!parse && typeof parse.row === 'function' && parse.row;\n  let flds = headers;\n\n  if (parse && typeof parse.fields === 'function') {\n    flds = parse.fields(flds.slice());\n  } else {\n    flds = headers.map(h => ({\n      key: h,\n      title: h\n    }));\n  }\n\n  let fieldValues;\n  if (Array.isArray(data[0])) {\n    fieldValues = flds.map(() => []);\n  } else {\n    fieldValues = {};\n    flds.forEach((f) => { fieldValues[f.key] = []; });\n  }\n\n  for (let r = 0; r < content.length; r++) {\n    const row = rowFn ? rowFn(content[r], r, flds) : content[r];\n    if (!row) {\n      continue;\n    }\n    if (Array.isArray(row)) {\n      for (let c = 0; c < flds.length; c++) {\n        fieldValues[c].push(row[c]);\n      }\n    } else {\n      for (let c = 0; c < flds.length; c++) {\n        fieldValues[flds[c].key].push(row[flds[c].key]);\n      }\n    }\n  }\n  const fv = Array.isArray(fieldValues) ? (i => fieldValues[i]) : (i => fieldValues[flds[i].key]);\n  for (let c = 0; c < flds.length; c++) {\n    const values = fv(c);\n    const numericValues = filters.numeric(values);\n    const isMeasure = numericValues.length > 0;\n    const type = isMeasure ? 'measure' : 'dimension';\n    const min = isMeasure ? Math.min(...numericValues) : NaN;\n    const max = isMeasure ? Math.max(...numericValues) : NaN;\n\n    cache.fields.push(field(extend({\n      source,\n      key: c,\n      title: flds[c].title,\n      values,\n      min,\n      max,\n      type\n    }, flds[c]), {\n      value: flds[c].value,\n      label: flds[c].label\n    }));\n  }\n}\n\nconst dsv = ({ data, config }) => {\n  const rows = data.split('\\n');\n  const row0 = rows[0];\n  const row1 = rows[1];\n  let delimiter = ',';\n  if (config && config.parse && config.parse.delimiter) {\n    delimiter = config.parse.delimiter;\n  } else if (row0) { // guess delimiter\n    const guesses = [/,/, /\\t/, /;/];\n    for (let i = 0; i < guesses.length; i++) {\n      const d = guesses[i];\n      if (row0 && row1) {\n        if (d.test(row0) && d.test(row1) && row0.split(d).length === row1.split(d).length) {\n          delimiter = d;\n          break;\n        }\n      } else if (d.test(row0)) {\n        delimiter = d;\n      }\n    }\n  }\n  return rows.map(row => row.split(delimiter));\n};\n\nconst parseData = ({\n  source, data, cache, config\n}) => {\n  if (!data) {\n    return;\n  }\n  let dd = data;\n\n  if (typeof dd === 'string') { // assume dsv\n    dd = dsv({ data, config });\n  }\n\n  if (!Array.isArray(dd)) {\n    return; // warn?\n  }\n\n  createFields({\n    data: dd,\n    cache,\n    source,\n    config\n  });\n};\n\n/**\n * Create a new dataset with default settings\n * @private\n * @return {dataset}\n */\nfunction ds({\n  key,\n  data,\n  config\n} = {}) {\n  const cache = {\n    fields: []\n  };\n\n  /**\n   * @alias dataset\n   * @interface\n   */\n  const dataset = {\n    /**\n     * Get the key identifying this dataset\n     * @returns {string}\n     */\n    key: () => key,\n\n    /**\n     * Get the raw data\n     * @returns {any}\n     */\n    raw: () => data,\n\n    /**\n     * Find a field within this dataset\n     * @param {string} query - The field to find\n     * @returns {field}\n     */\n    field: query => findField(query, {\n      cache,\n      matrix: data\n    }),\n\n    /**\n     * Get all fields within this dataset\n     * @returns {Array<field>}\n     */\n    fields: () => cache.fields.slice(),\n\n    /**\n     * Extract data items from this dataset\n     * @param {data-extract-config} config\n     * @returns {Array<datum-extract>}\n     */\n    extract: cfg => extract(cfg, dataset, cache),\n\n    /**\n     * @returns {null}\n     */\n    hierarchy: () => null\n  };\n\n  parseData({\n    key, data, config, cache\n  });\n\n  return dataset;\n}\n\nds.util = {\n  normalizeConfig: getPropsInfo,\n  collect,\n  track\n};\n\nexport { ds as default };\n\n/**\n * @typedef {object} data-extract-config\n * @property {string} field - The field to extract data from\n * @property {data-extract-config~valueFn} [value] - The field value accessor\n * @property {data-extract-config~labelFn} [label] - The field label accessor\n * @property {data-extract-config~trackByFn} [trackBy] - Track by value accessor\n * @property {data-extract-config~reduceFn} [reduce] - Reducer function\n * @property {data-extract-config~filterFn} [filter] - Filter function\n * @property {object} [props] - Additional properties to add to the extracted item\n */\n\n/**\n * @callback data-extract-config~valueFn\n * @param {any} cell The field cell\n * @returns {any}\n */\n\n/**\n * @callback data-extract-config~labelFn\n * @param {any} cell The field cell\n * @returns {string}\n */\n\n/**\n * @callback data-extract-config~filterFn\n * @param {any} cell The field cell\n * @returns {boolean}\n */\n\n/**\n * @callback data-extract-config~trackByFn\n * @param {any} cell The field cell\n * @returns {any}\n */\n\n/**\n * @callback data-extract-config~reduceFn\n * @param {any} cell The field cell\n * @returns {any}\n */\n\n/**\n * @typedef {object} datum-extract\n * @property {any} value - The extracted value\n * @property {string} label - The extracted value as a string\n * @property {object} source - The data source of the extracted data\n * @property {string} source.key - The data-source key\n * @property {string} source.field - The source field\n */\n","import registry from '../utils/registry';\nimport dataset from './dataset';\n\nconst dataRegistry = registry();\n\ndataRegistry.default('matrix');\n\ndataRegistry('matrix', dataset);\n\ndataRegistry('default', dataset); // deprecated\n\nexport { dataRegistry as default };\n","\n/**\n * Manages event handlers for native events\n * @private\n */\nfunction native(chart, mediator, element) {\n  let instance = { chart, mediator, element };\n  let nativeEvents = [];\n  let settings;\n  let itKey;\n  let isOn = true;\n\n  /**\n   * Set default settings\n   * @private\n   */\n  function setDefaultSettings(newSettings) {\n    itKey = newSettings.key;\n    settings = newSettings;\n    settings.events = settings.events || [];\n    if (settings.enable === undefined) {\n      settings.enable = true;\n    }\n  }\n\n  /**\n   * Add native events based on settings\n   * @private\n   */\n  function addEvents() {\n    if (typeof settings.enable === 'function') {\n      settings.enable = settings.enable.bind(instance)();\n    }\n    if (!settings.enable) {\n      return; // interaction is disabled\n    }\n    Object.keys(settings.events).forEach((key) => {\n      const listener = settings.events[key].bind(instance);\n      element.addEventListener(key, listener);\n      nativeEvents.push({ key, listener });\n    });\n  }\n\n  /**\n   * Removes all added native events\n   * @private\n   */\n  function removeAddedEvents() {\n    // remove added native events\n    nativeEvents.forEach(({ key, listener }) => {\n      element.removeEventListener(key, listener);\n    });\n    nativeEvents = [];\n  }\n\n  return {\n    /**\n     * Getter for the key.\n     * @private\n     */\n    get key() {\n      return itKey;\n    },\n    /**\n     * Updates this with new settings\n     * @private\n     * @param {object} newSettings\n     * @param {string} [newSettings.type] - The interaction type. Is 'native' for this component\n     * @param {boolean|function} [newSettings.enable=true] - Should the interactions defined here be enabled or not.\n     * This is only run when adding event handlers. In effect at startup, update or during on/off.\n     * It does not run during every event loop.\n     * @param {array} [newSettings.gestures] - The keys in this object is the names of native events\n     * that should be added to the chart element and they should all point to function which\n     * will be the corresponding event handler.\n     */\n    set(newSettings) {\n      setDefaultSettings(newSettings);\n      removeAddedEvents();\n      if (isOn) {\n        addEvents();\n      }\n    },\n    /**\n     * Turns off interactions\n     * @private\n     */\n    off() {\n      isOn = false;\n      removeAddedEvents();\n    },\n    /**\n     * Turns off interactions\n     * @private\n     */\n    on() {\n      isOn = true;\n      if (nativeEvents.length === 0) {\n        addEvents();\n      }\n    },\n    /**\n     * Destroys and unbinds all event handlers\n     * @private\n     */\n    destroy() {\n      removeAddedEvents();\n      instance = null;\n      settings = null;\n    }\n  };\n}\n\nexport { native as default };\n","import registry from '../utils/registry';\nimport native from '../../web/interactions/native';\n\nconst reg = registry();\n\nreg('native', native);\n\nexport default reg;\n","/**\n * Short-hand for max(min())\n *\n * @param {number} min Minimum allowed value\n * @param {number} max Maximum allowed value\n * @param {number} value The actual value to cap\n * @ignore\n */\nexport function cap(min, max, value) {\n  return Math.max(min, Math.min(max, value));\n}\n\n/**\n * Resolve a diff, i.e. resolveDiff(0.2, 0.6, 1, 100) = 20\n *\n * @param {object} params parameters\n * @param {number} params.start Normalized start value\n * @param {number} params.end Normalized end value\n * @param {number} params.minPx The minimum number of pixels\n * @param {number} params.maxPx Maximum number of pixels, i.e. the width or height\n * @ignore\n */\nexport function resolveDiff({\n  start, end, minPx = 0.1, maxPx = 1\n}) {\n  const high = Math.max(start, end);\n  const low = Math.min(start, end);\n  const highModified = cap(-0.1, 1.2, high);\n  const lowModified = cap(-0.1, 1.2, low);\n\n  const wantedDiff = (highModified * maxPx) - (lowModified * maxPx);\n  const actualDiff = Math.max(minPx, wantedDiff);\n  const startModifier = (actualDiff - wantedDiff) / 2;\n  const actualLow = (lowModified * maxPx) - startModifier;\n\n  return {\n    actualDiff,\n    startModifier,\n    actualLow\n  };\n}\n","import extend from 'extend';\nimport { resolveDiff } from './box-math';\n\nimport { isNumber } from '../../utils/is-number';\n\nexport function box({\n  item, boxWidth, boxPadding, rendwidth, rendheight, flipXY\n}) {\n  let x = 'x';\n  let y = 'y';\n  let width = 'width';\n  let height = 'height';\n  let calcwidth = rendwidth;\n  let calcheight = rendheight;\n\n  if (flipXY) {\n    x = 'y';\n    y = 'x';\n    width = 'height';\n    height = 'width';\n    calcwidth = rendheight;\n    calcheight = rendwidth;\n  }\n\n  const { actualDiff, actualLow } = resolveDiff({\n    start: item.start, end: item.end, minPx: item.box.minHeightPx, maxPx: calcheight\n  });\n\n  return extend({}, item.box, {\n    type: 'rect',\n    [x]: (boxPadding + item.major) * calcwidth,\n    [y]: actualLow,\n    [height]: actualDiff,\n    [width]: boxWidth * calcwidth,\n    data: item.data || {},\n    collider: {\n      type: null\n    }\n  });\n}\n\nexport function verticalLine({\n  item, from, to, boxCenter, rendwidth, rendheight, flipXY\n}) {\n  let x1 = 'x1';\n  let y1 = 'y1';\n  let x2 = 'x2';\n  let y2 = 'y2';\n  let calcwidth = rendwidth;\n  let calcheight = rendheight;\n\n  if (flipXY) {\n    x1 = 'y1';\n    y1 = 'x1';\n    x2 = 'y2';\n    y2 = 'x2';\n    calcwidth = rendheight;\n    calcheight = rendwidth;\n  }\n\n  return extend({}, item.line, {\n    type: 'line',\n    [y2]: Math.floor(from * calcheight),\n    [x1]: boxCenter * calcwidth,\n    [y1]: Math.floor(to * calcheight),\n    [x2]: boxCenter * calcwidth,\n    data: item.data || {},\n    collider: {\n      type: null\n    }\n  });\n}\n\nexport function horizontalLine({\n  item, key, position, width, boxCenter, rendwidth, rendheight, flipXY\n}) {\n  let x1 = 'x1';\n  let y1 = 'y1';\n  let x2 = 'x2';\n  let y2 = 'y2';\n  let calcwidth = rendwidth;\n  let calcheight = rendheight;\n\n  if (flipXY) {\n    x1 = 'y1';\n    y1 = 'x1';\n    x2 = 'y2';\n    y2 = 'x2';\n    calcwidth = rendheight;\n    calcheight = rendwidth;\n  }\n\n  const halfWidth = width / 2;\n\n  return extend({ type: 'line' }, item[key], {\n    [y1]: Math.floor(position * calcheight),\n    [x1]: (boxCenter - halfWidth) * calcwidth,\n    [y2]: Math.floor(position * calcheight),\n    [x2]: (boxCenter + halfWidth) * calcwidth,\n    r: halfWidth * calcwidth,\n    cx: boxCenter * calcwidth,\n    cy: position * calcheight,\n    width: width * calcwidth,\n    data: item.data || {},\n    collider: {\n      type: null\n    }\n  });\n}\n\nexport function buildShapes({\n  width,\n  height,\n  flipXY,\n  resolved,\n  keys\n}) {\n  // if (!settings || !settings.major || !settings.major.scale || !settings.minor || !settings.minor.scale) {\n  //   return [];\n  // }\n\n  const output = [];\n\n  let major = null;\n  const items = resolved.major.items;\n\n  for (let i = 0, len = items.length; i < len; i++) {\n    const d = items[i].data;\n    let children = [];\n\n    let majorVal = null;\n    let majorEndVal = null;\n\n    if (typeof resolved.major.settings.binStart !== 'undefined') { // if start and end is defined\n      majorVal = resolved.major.items[i].binStart;\n      majorEndVal = resolved.major.items[i].binEnd;\n      major = resolved.major.settings.binStart.scale;\n    } else {\n      major = resolved.major.settings.major.scale;\n      majorVal = major ? resolved.major.items[i].major : 0;\n    }\n\n    let bandwidth = 0;\n    if (!major) {\n      bandwidth = 1;\n    } else if (major.bandwidth) {\n      bandwidth = major.bandwidth();\n      majorVal -= (bandwidth / 2);\n    } else {\n      bandwidth = majorEndVal - majorVal;\n    }\n\n    let item = extend({}, {\n      major: majorVal,\n      majorEnd: majorEndVal\n    }, resolved.minor.items[i]);\n\n    keys.forEach(key => (item[key] = resolved[key].items[i]));\n\n    const maxMajorWidth = flipXY ? height : width;\n    const boxWidth = Math.min(bandwidth * item.box.width, isNaN(item.box.maxWidthPx) ? maxMajorWidth : item.box.maxWidthPx / maxMajorWidth);\n    const boxPadding = (bandwidth - boxWidth) / 2;\n    const boxCenter = boxPadding + item.major + (boxWidth / 2);\n\n    const rendwidth = width;\n    const rendheight = height;\n\n    if (item.box.show && isNumber(item.start) && isNumber(item.end)) {\n      children.push(box({\n        item, boxWidth, boxPadding, rendwidth, rendheight, flipXY\n      }));\n    }\n\n    if (item.line.show && isNumber(item.min) && isNumber(item.start)) {\n      children.push(verticalLine({\n        item, from: item.min, to: item.start, boxCenter, rendwidth, rendheight, flipXY\n      }));\n    }\n\n    if (item.line.show && isNumber(item.max) && isNumber(item.end)) {\n      children.push(verticalLine({\n        item, from: item.max, to: item.end, boxCenter, rendwidth, rendheight, flipXY\n      }));\n    }\n\n    if (item.median.show && isNumber(item.med)) {\n      children.push(horizontalLine({\n        item, key: 'median', position: item.med, width: boxWidth, boxCenter, rendwidth, rendheight, flipXY\n      }));\n    }\n\n    if (item.whisker.show) {\n      const whiskerWidth = boxWidth * item.whisker.width;\n\n      if (isNumber(item.min)) {\n        children.push(horizontalLine({\n          item, key: 'whisker', position: item.min, width: whiskerWidth, boxCenter, rendwidth, rendheight, flipXY\n        }));\n      }\n\n      if (isNumber(item.max)) {\n        children.push(horizontalLine({\n          item, key: 'whisker', position: item.max, width: whiskerWidth, boxCenter, rendwidth, rendheight, flipXY\n        }));\n      }\n    }\n\n    const container = {\n      type: 'container',\n      data: d,\n      collider: { type: 'bounds' },\n      children\n    };\n\n    output.push(container);\n  }\n\n  return output;\n}\n","import extend from 'extend';\n\n/**\n * Resolve a complex object using the built-in resolver from this.resolver in component\n * @ignore\n */\nexport default function complexResolver({\n  keys, data, defaultSettings, style, settings, width, height, resolver\n}) {\n  const defaults = extend(true, {}, defaultSettings || {}, style || {});\n  const scaled = {\n    major: settings.orientation === 'horizontal' ? height : width,\n    minor: settings.orientation === 'horizontal' ? width : height\n  };\n\n  const majorSettings = settings.major;\n\n  let majorResolved;\n\n  if (typeof majorSettings === 'object' && typeof majorSettings.ref === 'object' && (typeof majorSettings.ref.start !== 'undefined' && typeof majorSettings.ref.end !== 'undefined')) {\n    // temporary backwards compatibility\n    majorResolved = resolver.resolve({\n      data,\n      defaults: {\n        start: 0,\n        end: 1\n      },\n      scaled,\n      settings: extend(true, {}, {\n        binStart: { scale: settings.major.scale, ref: settings.major.ref.start },\n        binEnd: { scale: settings.major.scale, ref: settings.major.ref.end }\n      })\n    });\n  } else if (typeof majorSettings === 'object' && (typeof majorSettings.binStart !== 'undefined' && typeof majorSettings.binEnd !== 'undefined')) {\n    majorResolved = resolver.resolve({\n      data,\n      defaults: {\n        start: 0,\n        end: 1\n      },\n      scaled,\n      settings: extend(true, {}, {\n        binStart: { scale: settings.major.scale, ref: 'binStart' },\n        binEnd: { scale: settings.major.scale, ref: 'binEnd' }\n      }, settings.major)\n    });\n  } else {\n    majorResolved = resolver.resolve({\n      data,\n      scaled,\n      defaults: {\n        major: 0.5\n      },\n      settings: {\n        major: settings.major\n      }\n    });\n  }\n\n  const minorSettings = settings.minor || {};\n\n  const minorResolved = resolver.resolve({\n    data,\n    defaults: {\n      start: 0,\n      end: 1\n    },\n    scaled,\n    settings: extend(true, {}, {\n      start: { scale: minorSettings.scale, ref: 'start' },\n      end: { scale: minorSettings.scale, ref: 'end' },\n      min: { scale: minorSettings.scale, ref: 'min' },\n      max: { scale: minorSettings.scale, ref: 'max' },\n      med: { scale: minorSettings.scale, ref: 'med' }\n    }, minorSettings)\n  });\n\n  let key;\n  let ext = {\n    major: majorResolved,\n    minor: minorResolved\n  };\n\n  for (let ki = 0, len = keys.length; ki < len; ki++) {\n    key = keys[ki];\n    ext[key] = resolver.resolve({\n      data,\n      defaults: defaults[key],\n      settings: settings[key],\n      scaled\n    });\n  }\n\n  return ext;\n}\n","import { buildShapes } from './box-shapes';\nimport complexResolver from './box-resolver';\n\nconst DEFAULT_DATA_SETTINGS = {\n  line: {\n    show: true,\n    stroke: '#000',\n    strokeWidth: 1\n  },\n  median: {\n    show: true,\n    stroke: '#000',\n    strokeWidth: 1\n  },\n  whisker: {\n    show: true,\n    stroke: '#000',\n    strokeWidth: 1,\n    fill: '',\n    type: 'line',\n    width: 1\n  },\n  box: {\n    show: true,\n    fill: '#fff',\n    stroke: '#000',\n    strokeWidth: 1,\n    width: 1,\n    maxWidthPx: undefined,\n    minWidthPx: 1,\n    minHeightPx: 1\n  }\n};\n\nconst dataKeys = Object.keys(DEFAULT_DATA_SETTINGS);\n\nconst component = {\n  require: ['chart', 'resolver'],\n  defaultSettings: {\n    settings: {},\n    data: {},\n    style: {\n      box: '$shape',\n      line: '$shape-guide',\n      whisker: '$shape-guide',\n      median: '$shape-guide--inverted'\n    }\n  },\n  created() {\n    this.rect = {\n      x: 0, y: 0, width: 0, height: 0\n    };\n    this.state = {};\n  },\n  beforeRender(opts) {\n    this.rect = opts.size;\n  },\n  render({ data }) {\n    const { width, height } = this.rect;\n\n    const flipXY = this.settings.settings.orientation === 'horizontal';\n\n    const { style, resolver } = this;\n\n    const resolved = complexResolver({\n      keys: dataKeys,\n      data,\n      defaultSettings: DEFAULT_DATA_SETTINGS,\n      style,\n      settings: this.settings.settings,\n      width,\n      height,\n      resolver\n    });\n\n    const { settings, items } = resolved;\n\n    const shapes = buildShapes({\n      items,\n      settings,\n      width,\n      height,\n      flipXY,\n      resolved,\n      keys: dataKeys\n    });\n\n    return shapes;\n  }\n};\n\nexport default component;\n","import component from './box';\n\nexport default function box(picasso) {\n  picasso.component('box', component);\n  picasso.component('box-marker', component); // temporary backwards compatibility - DEPRECATED\n}\n\n/**\n * @typedef {object} component--box\n * @property {string} type - \"box\"\n * @property {component--box~data} data - Box data\n * @property {component--box~settings} settings - Box settings\n * @example\n * {\n *   type: \"box\",\n *   data: {\n *    mapTo: {\n *      min: { source: \"/qHyperCube/qMeasureInfo/0\" },\n *      start: { source: \"/qHyperCube/qMeasureInfo/1\" },\n *      med: { source: \"/qHyperCube/qMeasureInfo/2\" },\n *      end: { source: \"/qHyperCube/qMeasureInfo/3\" },\n *      max: { source: \"/qHyperCube/qMeasureInfo/4\" },\n *    },\n *    groupBy: {\n *      source: \"/qHyperCube/qDimensionInfo/0\"\n *    }\n *  },\n *  settings: {\n *    major: {\n *      scale: { source: \"/qHyperCube/qDimensionInfo/0\" }\n *    },\n *    minor: {\n *      scale: { source: [\"/qHyperCube/qMeasureInfo/0\",\n *               \"/qHyperCube/qMeasureInfo/1\",\n *               \"/qHyperCube/qMeasureInfo/2\",\n *               \"/qHyperCube/qMeasureInfo/3\",\n *               \"/qHyperCube/qMeasureInfo/4\"] }\n *    }\n *  }\n * }\n */\n\n/**\n * @typedef {object} component--box~settings\n * @property {object} major\n * @property {string} major.scale - The scale to use along the major axis\n * @property {string|component--box~settings~majorReference} [major.ref='self'] - Reference to the data property along the major axis\n * @property {object} minor\n * @property {string} minor.scale - The scale to use along the minor axis\n * @property {string} [orientation='vertical']\n * @property {object} [box]\n * @property {boolean} [box.show=true]\n * @property {string} [box.fill='#fff']\n * @property {string} [box.stroke='#000']\n * @property {number} [box.strokeWidth=1]\n * @property {number} [box.width=1]\n * @property {number} [box.maxWidthPx=100]\n * @property {number} [box.minWidthPx=1]\n * @property {number} [box.minHeightPx=1]\n * @property {object} [line]\n * @property {boolean} [line.show=true]\n * @property {string} [stroke='#000']\n * @property {number} [strokeWidth=1]\n * @property {object} [whisker]\n * @property {boolean} [whisker.show=true]\n * @property {string} [whisker.stroke='#000']\n * @property {number} [whisker.strokeWidth=1]\n * @property {number} [whisker.width=1]\n * @property {object} [median]\n * @property {number} [median.show=true]\n * @property {number} [median.stroke='#000']\n * @property {number} [median.strokeWidth=1]\n */\n\n/**\n * @typedef {object} component--box~settings~majorReference\n * @property {string} start - Reference to the data property of the start value along the major axis\n * @property {string} end - Reference to the data property of the end value along the major axis\n */\n\n/**\n * @typedef {object} component--box~data\n * @property {number} [min] - min\n * @property {number} [max] - max\n * @property {number} [start] - start\n * @property {number} [end] - end\n * @property {number} [med] - med\n */\n","/**\n * A list of supported attributes in lower camelCase notation mapped to corresponding kebab-case notation.\n * The kebab-case notations are a sub-set of SVG attributes (https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute).\n * @ignore\n */\nconst mappedAttributes = {\n  fill: 'fill',\n  stroke: 'stroke',\n  opacity: 'opacity',\n  strokeWidth: 'stroke-width',\n  fontFamily: 'font-family',\n  fontSize: 'font-size',\n  baseline: 'dominant-baseline', // Special case where we have defined our own attribute name\n  dominantBaseline: 'dominant-baseline',\n  anchor: 'text-anchor', // Special case where we have defined our own attribute name\n  textAnchor: 'text-anchor',\n  maxWidth: 'maxWidth',\n  transform: 'transform',\n  strokeDasharray: 'stroke-dasharray',\n  id: 'id'\n};\n\n/**\n * Takes a target object and assign each supported attribute from a source object to that target.\n * Each supported attributes is converted to a mapped kebab-case notation.\n * @ignore\n *\n * @param {object} target - Target object on which to assign mapped attribute values\n * @param {object} source - Source object\n */\nfunction assignMappedAttribute(target, source) {\n  Object.keys(mappedAttributes).forEach((key) => {\n    const sourceValue = source[key];\n    if (typeof sourceValue !== 'undefined') {\n      const mappedKey = mappedAttributes[key];\n      target[mappedKey] = sourceValue;\n    }\n  });\n}\n\nexport { mappedAttributes, assignMappedAttribute };\n\n","/**\n * @extends symbol-config\n * @typedef {object} symbol--circle\n */\nfunction circle(options) {\n  return {\n    type: 'circle',\n    fill: 'black',\n    cx: options.x,\n    cy: options.y,\n    r: options.size / 2,\n    collider: {\n      type: 'circle'\n    }\n  };\n}\n\nexport { circle as default };\n","export default function pointsToPath(points, close = true) {\n  let d = '';\n\n  for (let i = 0; i < points.length; i++) {\n    const p = points[i];\n    if (i === 0) {\n      d += `M${p.x} ${p.y}`;\n    } else {\n      d += `L${p.x} ${p.y}`;\n    }\n\n    d += ' ';\n  }\n\n  if (close) {\n    d += 'Z';\n  }\n\n  return d;\n}\n","import pointsToPath from '../utils/points-to-path';\n\n/**\n * @extends symbol-config\n * @typedef {object} symbol--diamond\n */\nfunction diamond(options) {\n  const size = options.size;\n  const left = options.x - (size / 2);\n  const top = options.y - (size / 2);\n  const points = [\n    { x: left, y: top + (size / 2) },\n    { x: left + (size / 2), y: top },\n    { x: left + size, y: top + (size / 2) },\n    { x: left + (size / 2), y: top + size },\n    { x: left, y: top + (size / 2) }\n  ];\n\n  return {\n    type: 'path',\n    fill: 'black',\n    d: pointsToPath(points)\n  };\n}\n\nexport { diamond as default };\n","import pointsToPath from '../utils/points-to-path';\n\nexport function generateCrossPoints(x, y, size, barWidth) {\n  const r = size / 2;\n  const innerLeft = x - (barWidth / 2);\n  const innerTop = y - (barWidth / 2);\n  const left = x - r;\n  const top = y - r;\n\n  return [\n    { x: innerLeft, y: innerTop }, // Top\n    { x: innerLeft, y: top },\n    { x: innerLeft + barWidth, y: top },\n    { x: innerLeft + barWidth, y: innerTop }, // Right\n    { x: left + size, y: innerTop },\n    { x: left + size, y: innerTop + barWidth },\n    { x: innerLeft + barWidth, y: innerTop + barWidth }, // Bottom\n    { x: innerLeft + barWidth, y: top + size },\n    { x: innerLeft, y: top + size },\n    { x: innerLeft, y: innerTop + barWidth }, // Left\n    { x: left, y: innerTop + barWidth },\n    { x: left, y: innerTop }\n  ];\n}\n\n/**\n * @extends symbol-config\n * @typedef {object} symbol--cross\n * @property {number} [width] - Width of the diagonals\n */\nfunction cross(options) {\n  const x = options.x;\n  const y = options.y;\n  const r = options.size / 2;\n  const width = isNaN(options.width) ? r / 2 : options.width;\n  const barWidth = Math.min(width, r);\n\n  const points = generateCrossPoints(x, y, options.size, barWidth);\n\n  return {\n    type: 'path',\n    fill: 'black',\n    d: pointsToPath(points)\n  };\n}\n\nexport { cross as default };\n","/**\n * Get x1, y1, x2, y2 point from angle\n * Source: {@link https://codepen.io/NV/pen/jcnmK}\n * @private\n *\n * @param  {number} angle Radians\n * @return {object}       Point with x1, y2, x2, y2.\n */\nexport function angleToPoints(angle) {\n  let segment = Math.floor((angle / Math.PI) * 2) + 2;\n  let diagonal = ((0.5 * segment) + 0.25) * Math.PI;\n  let op = Math.cos(Math.abs(diagonal - angle)) * Math.sqrt(2);\n  let x = op * Math.cos(angle);\n  let y = op * Math.sin(angle);\n\n  return {\n    x1: x < 0 ? 1 : 0,\n    y1: y < 0 ? 1 : 0,\n    x2: x >= 0 ? x : x + 1,\n    y2: y >= 0 ? y : y + 1\n  };\n}\n\n/**\n * Turns degrees into radians\n * @private\n *\n * @param  {number} degrees Degrees\n * @return {number}         Radians\n */\nexport function toRadians(d) {\n  return ((-d) / 180) * Math.PI;\n}\n\n/**\n * Turns radians into degrees\n * @private\n *\n * @param  {number} degrees Degrees\n * @return {number}         Radians\n */\nexport function toDegrees(r) {\n  return r * (180 / Math.PI);\n}\n\n/**\n * Get x1, y1, x2, y2 point from degree\n * @private\n *\n * @param  {number} d Degree\n * @return {object}   Point with x1, y2, x2, y2.\n */\nexport function degreesToPoints(d) {\n  return angleToPoints(toRadians(d));\n}\n","import { generateCrossPoints } from './cross';\nimport { toRadians } from '../math/angles';\nimport { rotate } from '../math/vector';\nimport pointsToPath from '../utils/points-to-path';\n\n/**\n * @extends symbol-config\n * @typedef {object} symbol--saltire\n * @property {number} [width] - Width of the diagonals\n */\nfunction saltire(options) {\n  const radians = toRadians(45);\n  const r = options.size / 2;\n  const width = isNaN(options.width) ? r / 2 : options.width;\n  const barWidth = Math.min(width, r);\n  let adjustedSize = options.size;\n\n  // Adjust for the barwidth and rotation angle, so that the visual part is always inside the symbol area\n  const h = Math.sin(Math.asin(-radians)) * (barWidth / 2);\n  const c = r / Math.sin(-radians);\n  adjustedSize += (c - r) * 2;\n  adjustedSize -= h * 2;\n\n  const centroid = { x: options.x, y: options.y };\n  const points = generateCrossPoints(options.x, options.y, adjustedSize, barWidth)\n    .map(p => rotate(p, radians, centroid));\n\n  return {\n    type: 'path',\n    fill: 'black',\n    d: pointsToPath(points)\n  };\n}\n\nexport { saltire as default };\n","/**\n * @extends symbol-config\n * @typedef {object} symbol--square\n */\nfunction square(options) {\n  const size = options.size;\n\n  return {\n    type: 'rect',\n    fill: 'black',\n    x: options.x - (size / 2),\n    y: options.y - (size / 2),\n    width: size,\n    height: size\n  };\n}\n\nexport { square as default };\n","import pointsToPath from '../utils/points-to-path';\nimport { rotate } from '../math/vector';\nimport { toRadians } from '../math/angles';\n\nconst DIRECTION_TO_ANGLE = {\n  up: 0,\n  down: 180,\n  left: 90,\n  right: -90\n};\n\n/**\n * @extends symbol-config\n * @typedef {object} symbol--triangle\n * @property {string} [direction='up'] - Direction of the triangle ('up'|'down'|'left'|'right')\n */\nfunction triangle(options) {\n  const size = options.size;\n  const p = { x: options.x, y: options.y };\n  const directionAngle = DIRECTION_TO_ANGLE[options.direction] || 0;\n  const halfSize = (size / 2);\n  const left = options.x - halfSize;\n  const top = options.y - halfSize;\n  let points = [\n    { x: left, y: top + size },\n    { x: left + halfSize, y: top },\n    { x: left + size, y: top + size },\n    { x: left, y: top + size }\n  ];\n\n  const radians = toRadians(directionAngle);\n  points = points.map(pp => rotate(pp, radians, p));\n\n  return {\n    type: 'path',\n    fill: 'black',\n    d: pointsToPath(points)\n  };\n}\n\nexport { triangle as default };\n","/**\n * @extends symbol-config\n * @typedef {object} symbol--line\n * @property {string} [direction='horizontal'] - Direction of line ('horizontal'|'vertical').\n */\nfunction line(options) {\n  const isVertical = options.direction === 'vertical';\n  const r = options.size / 2;\n  const x = options.x;\n  const y = options.y;\n\n  return {\n    type: 'line',\n    stroke: 'black',\n    strokeWidth: 1,\n    x1: x - (isVertical ? 0 : r),\n    y1: y - (isVertical ? r : 0),\n    x2: x + (isVertical ? 0 : r),\n    y2: y + (isVertical ? r : 0)\n  };\n}\n\nexport { line as default };\n","import pointsToPath from '../utils/points-to-path';\nimport { toRadians } from '../math/angles';\n\n/**\n * @extends symbol-config\n * @typedef {object} symbol--star\n * @property {number} [points=5] - Number of points on the star\n * @property {number} [startAngle=90] - Start drawing angle\n * @property {number} [innerRadius=size/2] - Size of the star core. My not exceed size of symbol.\n */\nfunction star(options) {\n  const size = options.size;\n  const points = [];\n  const outerRadius = size / 2;\n  const drawPoints = options.points || 5;\n  const innerRadius = (Math.min(options.innerRadius || size / 2, size) / 2);\n  const startAngle = isNaN(options.startAngle) ? 90 : options.startAngle;\n  const angle = 360 / drawPoints;\n\n  for (let i = 1; i <= drawPoints; i++) {\n    const pAngle = (angle * i) + startAngle;\n    const radians = toRadians(pAngle);\n    const innerRadians = toRadians(pAngle + (angle / 2));\n    const y = Math.sin(radians);\n    const x = Math.cos(radians);\n    const iy = Math.sin(innerRadians);\n    const ix = Math.cos(innerRadians);\n\n    points.push({\n      x: options.x + (x * outerRadius),\n      y: options.y + (y * outerRadius)\n    });\n\n    points.push({\n      x: options.x + (ix * innerRadius),\n      y: options.y + (iy * innerRadius)\n    });\n  }\n\n  return {\n    type: 'path',\n    fill: 'black',\n    d: pointsToPath(points)\n  };\n}\n\nexport { star as default };\n","import pointsToPath from '../utils/points-to-path';\nimport { toRadians } from '../math/angles';\n\n/**\n * @extends symbol-config\n * @typedef {object} symbol--n-polygon\n * @property {object} [sides=6] - Number of sides on the regular polygon\n * @property {object} [startAngle=0] - Start drawing angle\n */\nfunction nPolygon(options) {\n  const points = [];\n  const radius = options.size / 2;\n  const drawPoints = Math.max(isNaN(options.sides) ? 6 : options.sides, 3);\n  const angle = 360 / drawPoints;\n  const startAngle = isNaN(options.startAngle) ? 0 : options.startAngle;\n\n  for (let i = 1; i <= drawPoints; i++) {\n    const radians = toRadians((angle * i) + startAngle);\n    const y = Math.sin(radians);\n    const x = Math.cos(radians);\n    points.push({\n      x: options.x + (x * radius),\n      y: options.y + (y * radius)\n    });\n  }\n\n  return {\n    type: 'path',\n    fill: 'black',\n    d: pointsToPath(points)\n  };\n}\n\nexport { nPolygon as default };\n","import { rotate } from '../math/vector';\nimport { pointsToRect } from '../geometry/util';\nimport { toRadians } from '../math/angles';\n\n/**\n * @extends symbol-config\n * @typedef {object} symbol--bar\n * @property {string} [direction='horizontal'] - Direction of bar ('horizontal'|'vertical').\n */\nfunction bar(options) {\n  const p = { x: options.x, y: options.y };\n  const isVertical = options.direction === 'vertical';\n  const r = options.size / 2;\n  const width = r / 2;\n  const halfWidth = width / 2;\n\n  let points = [\n    { x: p.x - r, y: p.y + halfWidth },\n    { x: p.x - r, y: p.y - halfWidth },\n    { x: p.x + r, y: p.y - halfWidth },\n    { x: p.x + r, y: p.y + halfWidth }\n  ];\n\n  if (isVertical) {\n    const radians = toRadians(90);\n    points = points.map(pp => rotate(pp, radians, p));\n  }\n\n  const rect = pointsToRect(points);\n  rect.type = 'rect';\n  rect.fill = 'black';\n  rect.collider = { type: 'rect' };\n\n  return rect;\n}\n\nexport { bar as default };\n","import { mappedAttributes } from '../scene-graph//attributes';\nimport circle from './circle';\nimport diamond from './diamond';\nimport saltire from './saltire';\nimport square from './square';\nimport triangle from './triangle';\nimport line from './line';\nimport star from './star';\nimport nPolygon from './n-polygon';\nimport cross from './cross';\nimport bar from './bar';\nimport registry from '../utils/registry';\n\nconst reg = registry();\n\nreg.add('circle', circle);\nreg.add('diamond', diamond);\nreg.add('saltire', saltire);\nreg.add('square', square);\nreg.add('triangle', triangle);\nreg.add('line', line);\nreg.add('star', star);\nreg.add('n-polygon', nPolygon);\nreg.add('cross', cross);\nreg.add('bar', bar);\n\nfunction createRectCollider({ x, y, size }) {\n  const r = size / 2;\n  return {\n    type: 'rect',\n    x: x - r,\n    y: y - r,\n    width: size,\n    height: size\n  };\n}\n\nfunction applyOpts(obj, opts = {}) {\n  Object.keys(opts).forEach((key) => {\n    if (typeof mappedAttributes[key] !== 'undefined' && key !== 'transform') {\n      obj[key] = opts[key];\n    }\n  });\n}\n\n/**\n * Factory function for symbols.\n * Options object is passed to symbols function.\n * @private\n * @param {symbol--bar|symbol--circle|symbol--cross|symbol--diamond|symbol--line|symbol--n-polygon|symbol--saltire|symbol--square|symbol--star|symbol--triangle} options - Options definition may contain any of the supported display-object attributes\n * @returns {object} A node definition\n */\nfunction create(options = {}) { // TODO handle reserverd properties x, y, size, data, etc..\n  const fn = reg.get(options.type);\n  if (fn) {\n    const s = fn(options);\n    if (!s.collider) {\n      s.collider = createRectCollider(options);\n    }\n\n    applyOpts(s, options);\n\n    if (typeof options.data !== 'undefined') {\n      s.data = options.data;\n    }\n\n    return s;\n  }\n  return fn;\n}\n\nconst symbols = {\n  add: (type, fn) => reg.add(type, fn),\n  get: type => reg.get(type),\n  remove: type => reg.remove(type),\n  create\n};\n\nexport {\n  create as default,\n  symbols\n};\n\n/**\n * Mandatory symbol config\n * @typedef {object} symbol-config\n * @property {object} options - Options definition may contain any of the supported display-object attributes\n * @property {string} options.type - Type of symbol\n * @property {number} options.x - x-coordinate\n * @property {number} options.y - y-coordinate\n * @property {number} options.size\n * @property {object} [options.data]\n */\n","import extend from 'extend';\nimport { notNumber } from '../../utils/is-number';\nimport shapeFactory from '../../symbols';\n\nconst DEFAULT_ERROR_SETTINGS = {\n  errorShape: {\n    shape: 'saltire',\n    width: 2,\n    size: 0.5,\n    fill: '#333',\n    stroke: '#333',\n    strokeWidth: 0\n  }\n};\n\n/**\n  * @typedef {object}\n  * @alias component--point.settings\n  */\nconst DEFAULT_DATA_SETTINGS = {\n  /** Type of shape\n   * @type {datum-string=} */\n  shape: 'circle',\n  label: '',\n  /** Fill color\n   * @type {datum-string=} */\n  fill: '#333',\n  /** Stroke color\n   * @type {datum-string=} */\n  stroke: '#ccc',\n  /** Stroke width\n   * @type {datum-number=} */\n  strokeWidth: 0,\n  /** Opacity of shape\n   * @type {datum-number=} */\n  opacity: 1,\n  /** Normalized x coordinate\n   * @type {datum-number=} */\n  x: 0.5,\n  /** Normalized y coordinate\n   * @type {datum-number=} */\n  y: 0.5,\n  /** Normalized size of shape\n   * @type {datum-number=} */\n  size: 1,\n  strokeDasharray: ''\n};\n\n/**\n  * @typedef {object}\n  * @alias component--point.settings.sizeLimits\n  */\nconst SIZE_LIMITS = {\n  /** Maximum size of shape, in pixels\n   * @type {number=} */\n  maxPx: 10000,\n  /** Minimum size of shape, in pixels\n   * @type {number=} */\n  minPx: 1,\n  /** Maximum size relative linear scale extent\n   * @type {number=} */\n  maxRelExtent: 0.1,\n  /** Minimum size relative linear scale extent\n   * @type {number=} */\n  minRelExtent: 0.01,\n  /** Maximum size relative discrete scale banwidth\n   * @type {number=} */\n  maxRelDiscrete: 1,\n  /** Minimum size relative discrete scale banwidth\n   * @type {number=} */\n  minRelDiscrete: 0.1\n};\n\nfunction getPxSpaceFromScale(s, space) {\n  if (s && typeof s.bandwidth === 'function') { // some kind of ordinal scale\n    return {\n      isBandwidth: true,\n      value: Math.max(1, s.bandwidth() * space)\n    };\n  }\n  return {\n    isBandwidth: false,\n    value: Math.max(1, space)\n  };\n}\n\nfunction getPointSizeLimits(x, y, width, height, limits) {\n  const xSpacePx = getPxSpaceFromScale(x ? x.scale : undefined, width, limits);\n  const ySpacePx = getPxSpaceFromScale(y ? y.scale : undefined, height, limits);\n  let maxSizePx = Math.min(xSpacePx.value * limits[xSpacePx.isBandwidth ? 'maxRelDiscrete' : 'maxRelExtent'], ySpacePx.value * limits[ySpacePx.isBandwidth ? 'maxRelDiscrete' : 'maxRelExtent']);\n  let minSizePx = Math.min(xSpacePx.value * limits[xSpacePx.isBandwidth ? 'minRelDiscrete' : 'minRelExtent'], ySpacePx.value * limits[ySpacePx.isBandwidth ? 'minRelDiscrete' : 'minRelExtent']);\n  const min = Math.max(1, Math.floor(minSizePx));\n  const max = Math.max(1, Math.floor(maxSizePx));\n  return {\n    min, max, maxGlobal: limits.maxPx, minGlobal: limits.minPx\n  };\n}\n\nfunction createDisplayPoints(dataPoints, {\n  width, height\n}, pointSize, shapeFn) {\n  return dataPoints.filter(p =>\n    !isNaN(p.x + p.y)).map((p) => {\n    const s = notNumber(p.size) ? DEFAULT_ERROR_SETTINGS.errorShape : p;\n    const size = pointSize.min + (s.size * (pointSize.max - pointSize.min));\n    const shapeSpec = {\n      type: s.shape === 'rect' ? 'square' : s.shape,\n      label: p.label,\n      x: p.x * width,\n      y: p.y * height,\n      fill: s.fill,\n      size: Math.min(pointSize.maxGlobal, Math.max(pointSize.minGlobal, size)),\n      stroke: s.stroke,\n      strokeWidth: s.strokeWidth,\n      strokeDasharray: s.strokeDasharray,\n      opacity: s.opacity\n    };\n    if (s === p.errorShape) {\n      shapeSpec.width = s.width;\n    }\n    const shape = shapeFn(shapeSpec);\n\n    shape.data = p.data;\n    return shape;\n  });\n}\n\nconst component = {\n  require: ['chart', 'resolver'],\n  defaultSettings: {\n    settings: {},\n    data: {},\n    animations: {\n      enabled: false,\n      trackBy: node => node.data.value\n    },\n    style: {\n      item: '$shape'\n    }\n  },\n  created() {\n    this.rect = {\n      x: 0, y: 0, width: 0, height: 0\n    };\n  },\n  beforeRender(opts) {\n    this.rect = opts.size;\n  },\n  render({ data }) {\n    const resolved = this.resolver.resolve({\n      data,\n      defaults: extend({}, DEFAULT_DATA_SETTINGS, this.style.item),\n      settings: this.settings.settings,\n      scaled: {\n        x: this.rect.width,\n        y: this.rect.height\n      }\n    });\n    const { width, height } = this.rect;\n    const limits = extend({}, SIZE_LIMITS, this.settings.settings.sizeLimits);\n    const points = resolved.items;\n    const pointSize = getPointSizeLimits(resolved.settings.x, resolved.settings.y, width, height, limits);\n    return createDisplayPoints(points, this.rect, pointSize, this.settings.shapeFn || shapeFactory);\n  }\n};\n\nexport default component;\n","import pointMarkerComponent from './point';\n\n/**\n * @typedef {object} component--point\n */\n\n/**\n * @type {string}\n * @memberof component--point\n */\nconst type = 'point';\n\nexport default function pointMarker(picasso) {\n  picasso.component(type, pointMarkerComponent);\n\n  picasso.component('point-marker', pointMarkerComponent); // temporary backwards compatibility - DEPRECATED\n}\n\n","import extend from 'extend';\nimport { pie, arc } from 'd3-shape';\n\n/**\n * @typedef {object}\n * @alias component--pie-settings\n */\nconst DEFAULT_DATA_SETTINGS = {\n  /** Start angle of the pie, in radians\n   * @type {number=} */\n  startAngle: 0,\n  /** End angle of the pie, in radians\n   * @type {number=} */\n  endAngle: 2 * Math.PI,\n  /**\n   * @typedef {object}\n   */\n  slice: {\n    label: '',\n    /** Absolute value of the slice's arc length\n     * @type {number=} */\n    arc: 1,\n    /** Visibility of the slice\n     * @type {boolean=} */\n    show: true,\n    /** Fill color of the slice\n     * @type {string=} */\n    fill: '#333',\n    /** Stroke color of the slice\n     * @type {string=} */\n    stroke: '#ccc',\n    /** Stroke width of the slice\n     * @type {number=} */\n    strokeWidth: 1,\n    /** Opacity of the slice\n     * @type {number=} */\n    opacity: 1,\n    /** Inner radius of the slice\n     * @type {number=} */\n    innerRadius: 0,\n    /** Outer radius of the slice\n     * @type {number=} */\n    outerRadius: 0.8,\n    /** Corner radius of the slice, in pixels\n     * @type {number=} */\n    cornerRadius: 0,\n    /** Radial offset of the slice\n     * @type {number=} */\n    offset: 0\n  }\n};\n\n/**\n * @typedef {object} component--pie\n * @property {string} [type='pie']\n * @example\n * {\n *   type: 'pie',\n *   data: {\n *     extract: {\n *       field: 'Region',\n *       props: {\n *         num: { field: 'Population' }\n *       }\n *     }\n *   },\n *   settings: {\n *     startAngle: Math.PI / 2,\n *     endAngle: -Math.PI / 2,\n *     slice: {\n *       arc: { ref: 'num' },\n *       fill: 'green',\n *       stroke: 'red',\n *       strokeWidth: 2,\n *       innerRadius: 0.6,\n *       outerRadius 0.8,\n *       opacity: 0.8,\n *       offset: 0.2\n *     }\n *   }\n * }\n */\n\nfunction offsetSlice(centroid, offset, outerRadius, innerRadius) {\n  let [vx, vy] = centroid;\n  const vlen = Math.sqrt((vx * vx) + (vy * vy));\n  vx /= vlen;\n  vy /= vlen;\n  const diff = outerRadius - innerRadius;\n  return { x: vx * offset * diff, y: vy * offset * diff };\n}\n\nfunction createDisplayPies(arcData, {\n  x, y, width, height\n}, slices, sum) {\n  const arcGen = arc();\n  const center = { x: x + (width / 2), y: y + (height / 2) };\n  const innerRadius = (Math.min(width, height) / 2);\n  const outerRadius = (Math.min(width, height) / 2);\n  const cornerRadius = outerRadius / 100;\n  return arcData.map((a, i) => {\n    const slice = slices[i];\n    slice.type = 'path';\n    const or = outerRadius * slice.outerRadius;\n    const ir = innerRadius * slice.innerRadius;\n    arcGen.innerRadius(ir);\n    arcGen.outerRadius(or);\n    arcGen.cornerRadius(cornerRadius * slice.cornerRadius);\n    slice.d = arcGen(a);\n    const centroid = arcGen.centroid(a);\n    const offset = slice.offset ? offsetSlice(centroid, slice.offset, or, ir) : { x: 0, y: 0 };\n    slice.transform = `translate(${offset.x}, ${offset.y}) translate(${center.x}, ${center.y})`;\n    slice.desc = {\n      share: a.value / sum,\n      slice: {\n        start: a.startAngle,\n        end: a.endAngle,\n        innerRadius: ir,\n        outerRadius: or,\n        offset: { x: center.x + offset.x, y: center.y + offset.y }\n      }\n    };\n\n    return slice;\n  });\n}\n\nexport function arcValue(stngs, item) {\n  if (stngs.slice && 'arc' in stngs.slice) {\n    return item.arc;\n  }\n  return item.data.value;\n}\n\nconst pieComponent = {\n  require: ['chart', 'resolver'],\n  defaultSettings: {\n    settings: {\n      startAngle: 0,\n      endAngle: 2 * Math.PI,\n      padAngle: 0,\n      slice: {}\n    },\n    style: {\n      slice: '$shape'\n    },\n    data: {}\n  },\n  created() {\n    this.rect = {\n      x: 0, y: 0, width: 0, height: 0\n    };\n  },\n  beforeRender(opts) {\n    this.rect = opts.size;\n  },\n  render({ data }) {\n    const arcValues = [];\n    const slices = [];\n    const stngs = this.settings.settings;\n    const { items } = this.resolver.resolve({\n      data,\n      defaults: extend({}, DEFAULT_DATA_SETTINGS.slice, this.style.slice),\n      settings: stngs.slice\n    });\n\n    let sum = 0;\n    for (let i = 0, len = items.length; i < len; i++) {\n      const val = arcValue(stngs, items[i]);\n      if (val > 0) {\n        arcValues.push(val);\n        slices.push(items[i]);\n        sum += val;\n      }\n    }\n\n    const pieGen = pie().sortValues(null);\n    pieGen.startAngle(stngs.startAngle);\n    pieGen.endAngle(stngs.endAngle);\n    pieGen.padAngle(stngs.padAngle);\n    const arcData = pieGen(arcValues);\n\n    return createDisplayPies(\n      arcData,\n      extend({}, this.rect, { x: 0, y: 0 }),\n      slices,\n      sum\n    );\n  }\n};\n\nexport default pieComponent;\n","import pieComponent from './pie';\n\nexport default function pie(picasso) {\n  picasso.component('pie', pieComponent);\n}\n\n","/**\n * Create a crispifier\n * @ignore\n *\n * @param  {Object} [crispMap] Optional crispmap if you need custom crisping.\n * @return {Function}          crispItem function\n *\n * @example\n * import { crispifierFactory } from \"core/crispifier\";\n *\n * let crispify = crispifierFactory(customCrispMap);\n *\n * // For a single item\n * crispify(myItem);\n *\n * // For multiple items\n * crispify.multiple(myArrayOfItems);\n */\nexport function crispifierFactory(crispMap) {\n  // Define the crispMap\n  if (crispMap === undefined) {\n    crispMap = {};\n\n    crispMap.line = {\n      append: ['x1', 'x2', 'y1', 'y2'],\n      round: [],\n      condition: item => (item.x1 === item.x2 || item.y1 === item.y2),\n      conditionAppend: item => item.strokeWidth % 2 !== 0\n    };\n\n    crispMap.rect = {\n      append: ['x', 'y'],\n      round: ['width', 'height'],\n      condition: () => true,\n      conditionAppend: item => item.strokeWidth % 2 !== 0\n    };\n  }\n\n  // Re-map the crispmap\n  Object.keys(crispMap).forEach((type) => {\n    const self = crispMap[type];\n\n    self.items = [];\n\n    self.append.forEach((toAppend) => {\n      self.items.push({\n        key: toAppend,\n        type: 'append'\n      });\n    });\n\n    self.round.forEach((toAppend) => {\n      self.items.push({\n        key: toAppend,\n        type: 'round'\n      });\n    });\n  });\n\n  /**\n   * Crispify a single item\n   * @ignore\n   * @param  {Object} item  Item with renderer variables such as X, Y, and type.\n   * @return {Undefined}    Returns nothing, modifies the original item instead\n   */\n  function crispItem(item) {\n    if (crispMap[item.type] && crispMap[item.type].condition(item)) {\n      const self = crispMap[item.type];\n      const doAppend = self.conditionAppend === undefined || self.conditionAppend(item);\n\n      self.items.forEach((i) => {\n        const rounded = Math.round(item[i.key]);\n        const diff = item[i.key] - rounded;\n        item[i.key] = rounded;\n\n        if (doAppend && i.type === 'append') {\n          if (diff > 0) {\n            item[i.key] += 0.5;\n          } else {\n            item[i.key] -= 0.5;\n          }\n        }\n      });\n    }\n  }\n\n  /**\n   * Crispify multiple items\n   * @ignore\n   *\n   * @param  {Array} items  Array of objects to crispify\n   * @return {Undefined}    Returns nothing, modifies the original item instead\n   */\n  crispItem.multiple = items => items.forEach(item => crispItem(item));\n\n  return crispItem;\n}\n\nconst crispifier = crispifierFactory();\n\nexport default crispifier;\n","import crispify from './crispifier';\n\nclass Transposer {\n  /**\n   * @private\n   */\n  constructor(...items) {\n    this.reset();\n\n    this.push(...items);\n  }\n\n  /**\n   * Evaluate a key for a transposed coordinate\n   *\n   * @param  {String} key   Key\n   * @return {String}         Actual key\n   */\n  static evaluateKey(key, flipXY) {\n    if (flipXY) {\n      const firstChar = key.substring(0, 1);\n      const rest = key.substring(1);\n\n      if (firstChar === 'x') {\n        return `y${rest}`;\n      } else if (firstChar === 'y') {\n        return `x${rest}`;\n      } else if (key === 'cx') {\n        return 'cy';\n      } else if (key === 'cy') {\n        return 'cx';\n      } else if (key === 'width') {\n        return 'height';\n      } else if (key === 'height') {\n        return 'width';\n      }\n    }\n\n    return key;\n  }\n\n  /**\n   * Transpose a coordinate according to this.flipXY and\n   * the available rendering area\n   *\n   * @param  {String} key        The key of the coordinate to transpose\n   * @param  {Number} coordinate The coordinate\n   * @return {Number}            The actual location of the coordinate\n   */\n  transposeCoordinate(key, coordinate, flipXY) {\n    if (typeof coordinate === 'number' && isFinite(coordinate)) {\n      const firstChar = key.substring(0, 1);\n\n      if (firstChar === 'x' || key === 'cx') {\n        return coordinate * this.width;\n      } else if (key === 'width') {\n        return coordinate * this.width;\n      } else if (key === 'r') {\n        return coordinate * (!flipXY ? this.width : this.height);\n      } else if (firstChar === 'y' || key === 'cy') {\n        return coordinate * this.height;\n      } else if (key === 'height') {\n        return coordinate * this.height;\n      }\n    }\n\n    return coordinate;\n  }\n\n  /**\n   * Push an item into the storage of the transposer\n   *\n   * @param  {Object} items An item to be drawed\n   * @return {Object}       Can be chained\n   */\n  push(...items) {\n    this.storage.push(...items);\n    return this;\n  }\n\n  processItem(item) {\n    let newItem = {};\n    const flipXY = (typeof item.flipXY !== 'undefined' ? item.flipXY : this.flipXY);\n    const crisp = (typeof item.crisp !== 'undefined' ? item.crisp : this.crisp);\n\n    if (item.fn && typeof item.fn === 'function') {\n      let width = flipXY ? this.height : this.width;\n      let height = flipXY ? this.width : this.height;\n\n      item = item.fn({ width, height, flipXY });\n\n      const objectKeys = Object.keys(item);\n\n      for (let ki = 0, kl = objectKeys.length; ki < kl; ki++) {\n        let key = objectKeys[ki];\n        const nkey = Transposer.evaluateKey(key, flipXY);\n        newItem[nkey] = item[key];\n      }\n    } else {\n      const objectKeys = Object.keys(item);\n\n      for (let ki = 0, kl = objectKeys.length; ki < kl; ki++) {\n        let key = objectKeys[ki];\n        const nkey = Transposer.evaluateKey(key, flipXY);\n        const nval = this.transposeCoordinate(nkey, item[key], flipXY);\n        newItem[nkey] = nval;\n      }\n    }\n\n    if (crisp) {\n      crispify(newItem);\n    }\n\n    return newItem;\n  }\n\n  /**\n   * Get the output of the transposer\n   *\n   * @return {Array}   Array of objects\n   */\n  output() {\n    let items = [];\n\n    for (let i = 0, l = this.storage.length; i < l; i++) {\n      let newItem = this.processItem(this.storage[i]);\n\n      items.push(newItem);\n    }\n\n    return items;\n  }\n\n  /**\n   * Reset the transposer\n   *\n   * @return {Undefined}  Does not return anything\n   */\n  reset() {\n    this.storage = [];\n    this.flipXY = false;\n    this.crisp = false;\n\n    this.width = 0;\n    this.height = 0;\n  }\n}\n\nexport function transposer(...items) {\n  return new Transposer(...items);\n}\n\nexport default Transposer;\n","import extend from 'extend';\nimport { transposer } from '../../transposer/transposer';\nimport { updateScaleSize } from '../../scales';\n\n/**\n * Generate array of lines (ticks) from scale\n *\n * @param {object} scale - A scale supplied by the chart\n * @param {object} settings - The settings object from the grid line component\n * @param {object} rect - The rect containing width and height to renderer in\n * @returns {array} - Returns an array of ticks\n * @ignore\n */\nfunction lineGen(scale, distance) {\n  if (!scale || !distance) {\n    return [];\n  }\n  return (scale.cachedTicks && scale.cachedTicks()) || scale.ticks({ distance });\n}\n\nconst gridLineComponent = {\n  created() {\n  },\n\n  require: ['chart', 'renderer'],\n  defaultSettings: {\n    displayOrder: 0,\n    style: { // Theming style\n      ticks: '$guide-line',\n      minorTicks: '$guide-line--minor'\n    }\n  },\n\n  beforeRender(opts) {\n    this.rect = opts.size;\n\n    this.blueprint = transposer();\n\n    this.blueprint.width = this.rect.width;\n    this.blueprint.height = this.rect.height;\n    this.blueprint.x = this.rect.x;\n    this.blueprint.y = this.rect.y;\n    this.blueprint.crisp = true;\n  },\n\n  render() {\n    // Setup scales\n    this.x = this.settings.x ? this.chart.scale(this.settings.x) : null;\n    this.y = this.settings.y ? this.chart.scale(this.settings.y) : null;\n    updateScaleSize(this, 'x', this.rect.width);\n    updateScaleSize(this, 'y', this.rect.height);\n\n    // Return an empty array to abort rendering when no scales are available to renderer\n    if (!this.x && !this.y) {\n      return [];\n    }\n\n    this.settings.ticks = extend({ show: true }, this.style.ticks, this.settings.ticks || {});\n    this.settings.minorTicks = extend({ show: false }, this.style.minorTicks, this.settings.minorTicks || {});\n\n    // Setup lines for X and Y\n    this.lines = {\n      x: [],\n      y: []\n    };\n\n    // Use the lineGen function to generate appropriate ticks\n    this.lines.x = lineGen(this.x, this.rect.width);\n    this.lines.y = lineGen(this.y, this.rect.height);\n\n    // Set all Y lines to flipXY by default\n    // This makes the transposer flip them individually\n    this.lines.y = this.lines.y.map(i => extend(i, { flipXY: true }));\n\n    // Define a style that differs between major and minor ticks.\n    let style = {};\n\n    // Loop through all X and Y lines\n    [...this.lines.x, ...this.lines.y].forEach((p) => {\n      style = p.isMinor ? this.settings.minorTicks : this.settings.ticks;\n\n      // If the style's show is falsy, don't renderer this item (to respect axis settings).\n      if (style.show) {\n        // Use the transposer to handle actual positioning\n        this.blueprint.push({\n          type: 'line',\n          x1: p.position,\n          y1: 0,\n          x2: p.position,\n          y2: 1,\n          stroke: style.stroke || 'black',\n          strokeWidth: typeof style.strokeWidth !== 'undefined' ? style.strokeWidth : 1,\n          flipXY: p.flipXY || false // This flips individual points (Y-lines)\n        });\n      }\n    });\n\n    return this.blueprint.output();\n  }\n};\n\nexport default gridLineComponent;\n","import gridLineComponent from './line';\n\n/**\n * @typedef {object} component--grid-line-settings\n * @property {object} x\n * @property {string} x.scale - The scale to use along x\n * @property {object} y\n * @property {string} y.scale - The scale to use along y\n * @property {object} [ticks]\n * @property {boolean} [ticks.show=true]\n * @property {string} [ticks.stroke='black']\n * @property {number} [ticks.strokeWidth='1']\n * @property {object} [minorTicks]\n * @property {boolean} [minorTicks.show=true]\n * @property {string} [minorTicks.stroke='black']\n * @property {number} [minorTicks.strokeWidth='1']\n */\n\nexport default function gridLine(picasso) {\n  picasso.component('grid-line', gridLineComponent);\n}\n","/**\n * Return a D property for a SVG path to get a direction marker\n *\n * @param {number} x - X coordinate\n * @param {number} y - Y coordinate\n * @param {number} r - Radius\n * @param {string} [d='bottom'] - Direction\n * @returns {string} - Finished D property\n * @ignore\n */\nexport function directionMarker(x, y, r, d = 'bottom') {\n  r *= 0.8;\n  if (d === 'left' || d === 'right') {\n    let right = d === 'right';\n    return `\n      M ${x} ${y - r}\n      A ${r * 1.25} ${r * 1.25}, 0, 1, ${right ? 0 : 1}, ${x} ${y + r}\n      L ${right ? x + r : x - r} ${y} Z\n    `;\n  }\n  let bottom = d === 'bottom';\n  return `\n    M ${x - r} ${y}\n    A ${r * 1.25} ${r * 1.25}, 0, 1, ${bottom ? 1 : 0}, ${x + r} ${y}\n    L ${x} ${bottom ? y + r : y - r} Z\n  `;\n}\n\nfunction directionTriangle(x, y, r, d = 'bottom') {\n  r *= 0.75;\n  if (d === 'left' || d === 'right') {\n    let right = d === 'right';\n    x += (right ? r * 1.5 : -(r * 1.5));\n    return `\n      M ${x} ${y - r}\n      L ${x} ${y + r}\n      L ${right ? x + r : x - r} ${y} Z\n    `;\n  }\n  let bottom = d === 'bottom';\n  y += (bottom ? r * 1.5 : -(r * 1.5));\n  return `\n    M ${x - r} ${y}\n    L ${x + r} ${y}\n    L ${x} ${bottom ? y + r : y - r} Z\n  `;\n}\n\n/**\n * Handle out of bound shapes\n * Does not return anything, modifies \"items\" property instead (should be re-considered)\n *\n * @param {object} oob - Out of bounds object from parent\n * @param {object} settings - Settings object from parent\n * @param {object[]} items - Array of all items (for collision detection)\n * @ignore\n */\nexport function oobManager({\n  blueprint, oob, settings, items\n}) {\n  const oobKeys = Object.keys(oob);\n  let style = settings.style.oob || {};\n\n  for (let i = 0, len = oobKeys.length; i < len; i++) {\n    const key = oobKeys[i];\n    const value = oob[key];\n\n    if (value.length > 0) {\n      let position = (key.charAt(1));\n      let flipXY = key.charAt(0) === 'y';\n\n      let xPadding = style.padding.x + (style.width);\n      let yPadding = style.padding.y + style.width;\n      let direction = 'bottom';\n\n      if (flipXY) {\n        direction = (position === '1' ? 'bottom' : 'top');\n      } else {\n        direction = (position === '1' ? 'right' : 'left');\n      }\n\n      let indicator = blueprint.processItem({\n        fn: ({ width, height }) => { /* eslint no-loop-func: 0 */\n          let x = (position * width) + (position === '1' ? -xPadding : xPadding);\n          let y = flipXY ? yPadding : height - yPadding;\n\n          if (style.type === 'arc') {\n            return {\n              type: 'path',\n              d: directionMarker(flipXY ? y : x, flipXY ? x : y, style.width, direction),\n              x,\n              y,\n              stroke: style.stroke,\n              fill: style.fill,\n              strokeWidth: style.strokeWidth || 0\n            };\n          }\n\n          return {\n            type: 'circle',\n            cx: x,\n            cy: y,\n            r: style.width,\n            stroke: style.stroke,\n            fill: style.fill,\n            strokeWidth: style.strokeWidth || 0,\n            opacity: style.opacity,\n            data: value\n          };\n        },\n        flipXY\n      });\n\n      let x = indicator.cx || indicator.x;\n      let y = indicator.cy || indicator.y;\n\n      let text = {\n        type: 'text',\n        text: value.length || '',\n        x: x - (style.width * 0.4),\n        y: y + (style.width * 0.4),\n        fontFamily: style.text.fontFamily,\n        fontSize: `${style.width * 1.3}px`,\n        stroke: style.text.stroke,\n        fill: style.text.fill,\n        strokeWidth: style.text.strokeWidth || 0,\n        opacity: style.text.opacity\n      };\n\n      let triangle = {\n        type: 'path',\n        d: directionTriangle(x, y, style.width, direction),\n        x,\n        y,\n        stroke: style.triangle.stroke,\n        fill: style.triangle.fill,\n        strokeWidth: style.triangle.strokeWidth || 0,\n        opacity: style.triangle.opacity\n      };\n\n      items.push(indicator, text, triangle);\n    }\n  }\n}\n","import extend from 'extend';\nimport Collision from '../../math/narrow-phase-collision';\n\nexport function refLabelDefaultSettings() {\n  return {\n    fill: '#000',\n    fontFamily: 'Arial',\n    fontSize: '12px',\n    opacity: 1,\n    maxWidth: 1,\n    maxWidthPx: 9999,\n    padding: 5,\n    background: {\n      fill: '#fff',\n      stroke: 'transparent',\n      strokeWidth: 0,\n      opacity: 0.5\n    }\n  };\n}\n\n/**\n * Converts a numerical OR string value to a normalized value\n *\n * @param {string|number} align -Description how to align (Numerical from 0-1 or 'top', 'left', 'center', 'middle', 'bottom' or 'right')\n * @returns {number} - Normalized value 0...1\n * @ignore\n */\nexport function alignmentToNumber(align) {\n  if (typeof align === 'undefined') {\n    return 0;\n  } else if (typeof align === 'number' && isFinite(align)) {\n    return align;\n  } else if (typeof align === 'string') {\n    switch (align) {\n      case 'center':\n      case 'middle':\n        return 0.5;\n      case 'bottom':\n      case 'right':\n        return 1;\n      case 'top':\n      case 'left':\n      default:\n        return 0;\n    }\n  }\n\n  return 0;\n}\n\n/**\n * Create line and label (if applicable)\n * Does not return anything, modifies \"items\" property instead (should be re-considered)\n *\n * @param {object} p - Current point\n * @param {object} style - Applicable line styling\n * @param {object} settings - Settings object derived from parent\n * @param {object[]} items - Array of all items (for collision detection)\n * @ignore\n */\nexport function createLineWithLabel({\n  chart, blueprint, renderer, p, settings, items\n}) {\n  let doesNotCollide = true;\n  let line = false;\n  let rect = false;\n  let label = false;\n  let value = false;\n  let style = extend(true, {}, settings.style.line, p.line || {});\n\n  // Use the transposer to handle actual positioning\n  line = blueprint.processItem({\n    type: 'line',\n    x1: p.position,\n    y1: 0,\n    x2: p.position,\n    y2: 1,\n    stroke: style.stroke || 'black',\n    strokeWidth: style.strokeWidth || 1,\n    flipXY: p.flipXY || false // This flips individual points (Y-lines)\n  });\n\n  if (p.label) {\n    const item = extend(true, refLabelDefaultSettings(), settings.style.label || {}, { fill: style.stroke }, p.label);\n    let formatter;\n    let measuredValue = {\n      width: 0,\n      height: 0\n    };\n    let valueString = '';\n\n    if (typeof p.formatter === 'string') {\n      formatter = chart.formatter(p.formatter);\n    } else if (typeof p.formatter === 'object') {\n      formatter = chart.formatter(p.formatter);\n    } else if (typeof p.scale !== 'undefined' && p.scale.data) {\n      // TODO - Add support for array as source into formatter\n      const scaleData = p.scale.data() && p.scale.data().fields;\n      formatter = scaleData && scaleData[0] ? scaleData[0].formatter() : null;\n    }\n\n    if (formatter) {\n      valueString = ` (${formatter(p.value)})`;\n    } else if (p.scale) {\n      valueString = ` (${p.value})`;\n    }\n\n    if (valueString) {\n      measuredValue = renderer.measureText({\n        text: valueString,\n        fontFamily: item.fontFamily,\n        fontSize: item.fontSize\n      });\n    }\n\n    // Measure the label text\n    let measuredLabel = renderer.measureText({\n      text: item.text || '',\n      fontFamily: item.fontFamily,\n      fontSize: item.fontSize\n    });\n\n    let measured = {\n      width: measuredLabel.width + measuredValue.width,\n      height: Math.max(measuredLabel.height, measuredValue.height)\n    };\n\n    let labelPadding = item.padding;\n\n    // let anchor = item.anchor === 'end' ? 'end' : 'start';\n\n    let align = alignmentToNumber(p.flipXY ? item.vAlign : item.align);\n    let vAlign = alignmentToNumber(p.flipXY ? item.align : item.vAlign);\n\n    let calcWidth = Math.min(1 + measured.width + (labelPadding * 2), item.maxWidth * blueprint.width, item.maxWidthPx);\n    let calcHeight = measured.height + (labelPadding * 2);\n\n    let rectWidth = (p.flipXY ? calcHeight : calcWidth);\n    let rectHeight = (p.flipXY ? calcWidth : calcHeight);\n\n    rect = blueprint.processItem({\n      fn: ({ width, height }) => {\n        let x = (p.position * width) - ((p.flipXY ? calcHeight : calcWidth) * (1 - align));\n        x = p.flipXY ? x : Math.max(x, 0);\n        const y = Math.max(Math.abs((vAlign * height) - (rectHeight * vAlign)), 0);\n        return {\n          type: 'rect',\n          x,\n          y,\n          width: p.flipXY ? rectWidth : Math.min(rectWidth, blueprint.width - x),\n          height: rectHeight,\n          stroke: item.background.stroke,\n          strokeWidth: item.background.strokeWidth,\n          fill: item.background.fill,\n          opacity: item.background.opacity\n        };\n      },\n      flipXY: p.flipXY || false // This flips individual points (Y-lines)\n    });\n\n    if (\n      rect.x < -1 || (rect.x + rect.width) > (blueprint.width + 1) ||\n      rect.y < -1 || (rect.y + rect.height) > (blueprint.height + 1)\n    ) {\n      // do not create labels if out of bounds\n      rect = undefined;\n    } else {\n      // Labels are just basic objects attached to a corner of a rect,\n      // and this rect needs to already be processed\n      // so there is no blueprint.processItem required here\n      label = {\n        type: 'text',\n        text: item.text || '',\n        fill: item.fill,\n        opacity: item.opacity,\n        fontFamily: item.fontFamily,\n        fontSize: item.fontSize,\n        x: rect.x + labelPadding,\n        y: rect.y + (rect.height / 2) + (measured.height / 3),\n        maxWidth: rect.width - (labelPadding * 2) - measuredValue.width,\n        anchor: 'start'\n      };\n\n      if (valueString) {\n        value = {\n          type: 'text',\n          text: valueString || '',\n          fill: item.fill,\n          opacity: item.opacity,\n          fontFamily: item.fontFamily,\n          fontSize: item.fontSize,\n          x: label.x + 3 + (rect.width - (measuredValue.width + (labelPadding * 2))),\n          y: label.y\n        };\n      }\n\n      // Detect collisions with other labels/rects or lines\n      for (let i = 0, len = items.length; i < len; i++) {\n        let curItem = items[i];\n\n        if (curItem.type === 'rect') {\n          // We only detect rects here, since rects are always behind labels,\n          // and we wouldn't want to measure text one more time\n          if (Collision.testRectRect(rect, curItem)) {\n            doesNotCollide = false;\n          }\n        } else if (curItem.type === 'line') {\n          // This will only collide when flipXY are the same for both objects,\n          // So it only collides on objects on the same \"axis\"\n          if (p.flipXY === curItem.flipXY && Collision.testRectLine(rect, curItem)) {\n            doesNotCollide = false;\n          }\n        }\n      }\n    }\n  }\n\n  // Always push the line,\n  // but this is done after collision detection,\n  // because otherwise it would collide with it's own line\n  items.push(line);\n\n  // Only push rect & label if we haven't collided and both are defined\n  if (doesNotCollide && rect && label) {\n    items.push(rect, label);\n    if (value) {\n      items.push(value);\n    }\n  }\n}\n","import extend from 'extend';\nimport { transposer } from '../../transposer/transposer';\nimport { oobManager } from './oob';\nimport { createLineWithLabel } from './lines-and-labels';\n\nfunction createOobData(line) {\n  const data = {\n    value: line.value\n  };\n\n  if (line.label) {\n    data.label = line.label.text;\n  }\n\n  return data;\n}\n\nfunction filterUndefinedValue(line) {\n  return typeof line.value !== 'undefined';\n}\n\n/**\n * @typedef {object} component--ref-line\n * @experimental\n * @property {refline-generic-style} [style=refline-generic-style] - x coordinate\n * @property {object} lines - X & Y Lines\n * @property {reflines-x[]} [lines.x=refline-line[]] - lines along X\n * @property {reflines-y[]} [lines.y=refline-line[]] - lines along Y\n */\n\n/**\n * @typedef {object} component--ref-line.style\n * @property {refline-oob-style} [oob=component--ref-line.style.oob] - Style for out of bounds object (oob)\n * @property {refline-line} [line=refline-line] - Generic style for lines\n * @property {refline-line-label} [label=refline-line-label] - Generic style for labels\n */\n\n/**\n * @typedef {object} component--ref-line.style.oob\n * @property {boolean} [show=true] - Show out of bounds items\n * @property {string} [type=undefined] - EXPERIMENTAL:  Set this to 'arc' for an experimental out of bounds shape (only works with SVG)\n * @property {number} [width=10] - Width of the out of bounds object\n * @property {string} [fill='#1A1A1A'] - Fill color of the OOB object\n * @property {string} [stroke='transparent'] - Stroke of the OOB object\n * @property {number} [strokeWidth=0] - Stroke width of the OOB object\n * @property {number} [opacity=1] - Opacity of the OOB object\n * @property {refline-generic-text} [text=refline-generic-text] - Text configuration for out of bounds\n * @property {refline-generic-object} [triangle=refline-generic-object] - The triangle in OOB\n * @property {object} [padding] - Padding on X\n * @property {number} [padding.x=28] - Padding on X\n * @property {number} [padding.y=5] - Padding on X\n */\n\n/**\n * @typedef {object} component--ref-line.generic-text\n * @property {string} [text=''] - Text (if applicable)\n * @property {string} [fontSize='12px'] - Font size (if applicable)\n * @property {string} [fontFamily='Arial'] - Font family\n * @property {string} [fill='#fff'] - Fill color\n * @property {string} [stroke='transparent'] - Stroke\n * @property {number} [strokeWidth=0] - Stroke width\n * @property {number} [opacity=1] - Opacity\n */\n\n/**\n * @typedef {object} component--ref-line.line\n * @property {number} value - The value of the reference line. If a scale is specified, it is applied.\n * @property {Scale} [scale=undefined] - Scale to use (if undefined will use normalized value 0-1)\n * @property {refline-generic-object} [line=refline-generic-object] - The style of the line\n * @property {refline-line-label} [label=refline-line-label] - The label style of the line\n */\n\n/**\n * @typedef {object} component--ref-line.line-label\n * @property {number} padding=5 - Padding inside the label\n * @property {string} [text=''] - Text\n * @property {string} [fontSize='12px'] - Font size\n * @property {string} [fontFamily='Arial'] - Font family\n * @property {string} [stroke='transparent'] - Stroke\n * @property {number} [strokeWidth=0] - Stroke width\n * @property {number} [opacity=1] - Opacity\n * @property {number|string} [align=0] - Alignment property left to right (0 = left, 1 = right). Also supports string ('left', 'center', 'middle', 'right')\n * @property {number|string} [vAlign=0] - Alignment property top to bottom (0 = top, 1 = bottom). Also supports string ('top', 'center', 'middle', 'bottom')\n * @property {number} [maxWidth=1] - The maximum relative width to the width of the rendering area (see maxWidthPx below aswell)\n * @property {number} [maxWidthPx=9999] - The maximum width in pixels.\n * @property {refline-line-label-background} [background=refline-line-label-background] - The background style (rect behind text)\n */\n\n/**\n * @example\n * // Labels will be rendered with the maximum size of the smallest value of maxWidth and maxWidthPx size, so you may specify maxWidth 0.8 but maxWidthPx 100 and will never be over 100px and never over 80% of the renderable area.\n */\n\n/**\n * @typedef {object} component--ref-line.line-label-background\n * @property {string} [fill='#fff'] - Fill color\n * @property {string} [stroke='transparent'] - Stroke\n * @property {number} [strokeWidth=0] - Stroke width\n * @property {number} [opacity=0.5] - Opacity\n */\n\n/**\n * @typedef {object} component--ref-line.generic-object\n * @property {string} [fill='#fff'] - Fill color\n * @property {string} [stroke='transparent'] - Stroke\n * @property {number} [strokeWidth=0] - Stroke width\n * @property {number} [opacity=1] - Opacity\n */\n\nconst refLineComponent = {\n  require: ['chart', 'renderer', 'dockConfig'],\n  defaultSettings: {\n    displayOrder: 0,\n    style: {\n      oob: {\n        show: true,\n        width: 10,\n        fill: '#1A1A1A',\n        stroke: 'transparent',\n        strokeWidth: 0,\n        opacity: 1,\n        text: {\n          fontFamily: 'Arial',\n          stroke: 'transparent',\n          fill: '#fff',\n          strokeWidth: 0,\n          opacity: 1\n        },\n        triangle: {\n          fill: '#4D4D4D',\n          stroke: 'transparent',\n          strokeWidth: 0,\n          opacity: 1\n        },\n        padding: {\n          x: 28,\n          y: 5\n        }\n      },\n      line: {\n        stroke: '#000'\n      },\n      label: {\n        strokeWidth: 0\n      }\n    }\n  },\n\n  preferredSize() {\n    return 30;\n  },\n\n  beforeRender(opts) {\n    this.rect = opts.size;\n\n    this.blueprint = transposer();\n\n    this.blueprint.width = this.rect.width;\n    this.blueprint.height = this.rect.height;\n    this.blueprint.x = this.rect.x;\n    this.blueprint.y = this.rect.y;\n    this.blueprint.crisp = true;\n  },\n\n  render() {\n    let settings = this.settings;\n\n    // Setup lines for X and Y\n    this.lines = {\n      x: [],\n      y: []\n    };\n\n    this.lines.x = (settings.lines && settings.lines.x) || [];\n    this.lines.y = (settings.lines && settings.lines.y) || [];\n\n    if (this.lines.x.length === 0 && this.lines.y.length === 0) {\n      return [];\n    }\n\n    const oob = {\n      x0: [],\n      x1: [],\n      y0: [],\n      y1: []\n    };\n\n    // Convert a value to an actual position using the scale\n    this.lines.x = this.lines.x.filter(filterUndefinedValue).map((line) => {\n      if (line.scale) {\n        let scale = this.chart.scale(line.scale);\n        return extend(line, { scale, position: scale(line.value) });\n      }\n\n      return extend(line, { position: line.value });\n    });\n    // Set all Y lines to flipXY by default\n    // This makes the transposer flip them individually\n    this.lines.y = this.lines.y.filter(filterUndefinedValue).map((line) => {\n      if (line.scale) {\n        let scale = this.chart.scale(line.scale);\n        return extend(line, { scale, position: scale(line.value), flipXY: true });\n      }\n\n      return extend(line, { position: line.value, flipXY: true });\n    });\n\n    // Move out of bounds lines (OOB) to separate rendering\n    this.lines.x = this.lines.x.filter((line) => {\n      if (line.position < 0 || line.position > 1) {\n        oob[`x${line.position > 1 ? 1 : 0}`].push(createOobData(line));\n        return false;\n      }\n      return true;\n    });\n\n    this.lines.y = this.lines.y.filter((line) => {\n      if (line.position < 0 || line.position > 1) {\n        oob[`y${line.position > 1 ? 1 : 0}`].push(createOobData(line));\n        return false;\n      }\n      return true;\n    });\n\n    let items = [];\n\n    // Loop through all X and Y lines\n    [...this.lines.x, ...this.lines.y].forEach((p) => {\n      let show = p.show === true || typeof p.show === 'undefined';\n\n      if (show) {\n        // Create line with labels\n        createLineWithLabel({\n          chart: this.chart, blueprint: this.blueprint, renderer: this.renderer, p, settings, items\n        });\n      }\n    });\n\n    // Handle out of bounds\n    if (settings.style.oob.show) {\n      oobManager({\n        blueprint: this.blueprint, oob, settings, items\n      });\n    }\n\n    return items;\n  }\n};\n\nexport default refLineComponent;\n","import refLineComponent from './refline';\n\nexport default function refLine(picasso) {\n  picasso.component('ref-line', refLineComponent);\n}\n","import extend from 'extend';\n\nfunction appendStyle(struct, buildOpts) {\n  extend(struct, buildOpts.style);\n  const halfWidth = struct.strokeWidth / 2;\n\n  if (buildOpts.align === 'top') {\n    struct.y1 -= halfWidth;\n    struct.y2 -= halfWidth;\n  } else if (buildOpts.align === 'bottom') {\n    struct.y1 += halfWidth;\n    struct.y2 += halfWidth;\n  } else if (buildOpts.align === 'left') {\n    struct.x1 -= halfWidth;\n    struct.x2 -= halfWidth;\n  } else if (buildOpts.align === 'right') {\n    struct.x1 += halfWidth;\n    struct.x2 += halfWidth;\n  }\n}\n\nexport default function buildLine(buildOpts) {\n  const struct = {\n    type: 'line',\n    x1: 0,\n    x2: 0,\n    y1: 0,\n    y2: 0,\n    collider: {\n      type: null\n    }\n  };\n\n  if (buildOpts.align === 'top' || buildOpts.align === 'bottom') {\n    struct.x1 = buildOpts.innerRect.x - buildOpts.outerRect.x;\n    struct.x2 = buildOpts.innerRect.width + buildOpts.innerRect.x;\n    struct.y1 = struct.y2 = buildOpts.align === 'top' ? buildOpts.innerRect.height - buildOpts.padding : buildOpts.padding;\n  } else {\n    struct.x1 = struct.x2 = buildOpts.align === 'left' ? buildOpts.innerRect.width - buildOpts.padding : buildOpts.padding;\n    struct.y1 = buildOpts.innerRect.y - buildOpts.outerRect.y;\n    struct.y2 = buildOpts.innerRect.height + buildOpts.innerRect.y;\n  }\n\n  appendStyle(struct, buildOpts);\n\n  return struct;\n}\n","import { rotate as rotateVector } from '../../math/vector';\n\nfunction checkText(text) {\n  return typeof text === 'string' || typeof text === 'number' ? text : '-';\n}\n\nfunction appendStyle(struct, buildOpts) {\n  ['fill', 'fontSize', 'fontFamily'].forEach((style) => {\n    struct[style] = buildOpts.style[style];\n  });\n}\n\nfunction clampEnds(struct, buildOpts) {\n  if (buildOpts.tilted || buildOpts.stepSize) {\n    return;\n  }\n\n  const outerBoundaryMultipler = 0.75;\n  if (buildOpts.align === 'top' || buildOpts.align === 'bottom') {\n    const leftBoundary = 0;\n    const rightBoundary = buildOpts.outerRect.width;\n    const textWidth = Math.min((buildOpts.maxWidth * outerBoundaryMultipler) / 2, buildOpts.textRect.width / 2);\n    const leftTextBoundary = struct.x - textWidth;\n    const rightTextBoundary = struct.x + textWidth;\n    if (leftTextBoundary < leftBoundary) {\n      struct.anchor = 'start';\n      struct.x = buildOpts.innerRect.x - buildOpts.outerRect.x;\n      struct.maxWidth *= outerBoundaryMultipler;\n    } else if (rightTextBoundary > rightBoundary) {\n      struct.anchor = 'end';\n      struct.x = buildOpts.innerRect.width + buildOpts.innerRect.x;\n      struct.maxWidth *= outerBoundaryMultipler;\n    }\n  } else {\n    const topBoundary = 0;\n    const bottomBoundary = buildOpts.outerRect.height;\n    const textHeight = buildOpts.maxHeight / 2;\n    const topTextBoundary = struct.y - textHeight;\n    const bottomTextBoundary = struct.y + textHeight;\n    if (topTextBoundary < topBoundary) {\n      struct.y = buildOpts.innerRect.y - buildOpts.outerRect.y;\n      struct.baseline = 'text-before-edge';\n    } else if (bottomTextBoundary > bottomBoundary) {\n      struct.y = buildOpts.innerRect.height + (buildOpts.innerRect.y - buildOpts.outerRect.y);\n      struct.baseline = 'text-after-edge';\n    }\n  }\n}\n\nfunction appendPadding(struct, buildOpts) {\n  if (buildOpts.align === 'top') {\n    struct.y -= buildOpts.padding;\n  } else if (buildOpts.align === 'bottom') {\n    struct.y += buildOpts.padding + buildOpts.maxHeight;\n  } else if (buildOpts.align === 'left') {\n    struct.x -= buildOpts.padding;\n  } else if (buildOpts.align === 'right') {\n    struct.x += buildOpts.padding;\n  }\n}\n\nfunction appendTilting(struct, buildOpts) {\n  if (buildOpts.tilted) {\n    const r = -buildOpts.angle;\n    const radians = r * (Math.PI / 180);\n\n    if (buildOpts.align === 'bottom') {\n      struct.x -= (buildOpts.maxHeight * Math.sin(radians)) / 2;\n      struct.y -= buildOpts.maxHeight;\n      struct.y += (buildOpts.maxHeight * Math.cos(radians)) / 2;\n    } else {\n      struct.x -= (buildOpts.maxHeight * Math.sin(radians)) / 3;\n    }\n\n    struct.transform = `rotate(${r}, ${struct.x}, ${struct.y})`;\n    struct.anchor = (buildOpts.align === 'bottom') === (buildOpts.angle < 0) ? 'start' : 'end';\n\n    // adjustForEnds\n    const textWidth = Math.cos(radians) * buildOpts.maxWidth;\n    if ((buildOpts.align === 'bottom') === (buildOpts.angle < 0)) {\n      // right\n      const rightBoundary = buildOpts.outerRect.width - buildOpts.paddingEnd;\n      const rightTextBoundary = struct.x + textWidth;\n      if (rightTextBoundary > rightBoundary) {\n        struct.maxWidth = (rightBoundary - struct.x - 10) / Math.cos(radians);\n      }\n    } else {\n      // left\n      const leftBoundary = buildOpts.paddingEnd;\n      const leftTextBoundary = struct.x - textWidth;\n      if (leftTextBoundary < leftBoundary) {\n        struct.maxWidth = (struct.x - leftBoundary - 10) / Math.cos(radians);\n      }\n    }\n  }\n}\n\nfunction bandwidthCollider(tick, struct, buildOpts) {\n  if (buildOpts.align === 'bottom' || buildOpts.align === 'top') {\n    const tickCenter = tick.position * buildOpts.innerRect.width;\n    const leftBoundary = tickCenter + (buildOpts.innerRect.x - buildOpts.outerRect.x - (buildOpts.stepSize / 2));\n    struct.collider = {\n      type: 'rect',\n      x: leftBoundary,\n      y: 0,\n      width: leftBoundary < 0 ? buildOpts.stepSize + leftBoundary : buildOpts.stepSize, // Adjust collider so that it doesnt extend onto neighbor collider\n      height: buildOpts.innerRect.height\n    };\n  } else {\n    const tickCenter = tick.position * buildOpts.innerRect.height;\n    const topBoundary = tickCenter + (buildOpts.innerRect.y - buildOpts.outerRect.y - (buildOpts.stepSize / 2));\n    struct.collider = {\n      type: 'rect',\n      x: 0,\n      y: topBoundary,\n      width: buildOpts.innerRect.width,\n      height: topBoundary < 0 ? buildOpts.stepSize + topBoundary : buildOpts.stepSize // Adjust collider so that it doesnt extend onto neighbor collider\n    };\n  }\n\n  // Clip edges of the collider, should not extend beyoned the outerRect\n  const collider = struct.collider;\n  collider.x = Math.max(collider.x, 0);\n  collider.y = Math.max(collider.y, 0);\n  const widthClip = (collider.x + collider.width) - (buildOpts.outerRect.x + buildOpts.outerRect.width);\n  collider.width = widthClip > 0 ? collider.width - widthClip : collider.width;\n  const heightClip = (collider.y + collider.height) - (buildOpts.outerRect.y + buildOpts.outerRect.height);\n  collider.height = heightClip > 0 ? collider.height - heightClip : collider.height;\n}\n\nfunction boundsCollider(tick, struct) {\n  struct.collider = {\n    type: 'polygon',\n    vertices: [\n      { x: struct.boundingRect.x, y: struct.boundingRect.y },\n      { x: struct.boundingRect.x + struct.boundingRect.width, y: struct.boundingRect.y },\n      { x: struct.boundingRect.x + struct.boundingRect.width, y: struct.boundingRect.y + struct.boundingRect.height },\n      { x: struct.boundingRect.x, y: struct.boundingRect.y + struct.boundingRect.height }\n    ]\n  };\n}\n\nfunction tiltedCollider(tick, struct, buildOpts) {\n  const radians = buildOpts.angle * (Math.PI / 180);\n  const halfWidth = Math.max(buildOpts.stepSize / 2, struct.boundingRect.height / 2); // Handle if bandwidth is zero\n  const startAnchor = struct.anchor === 'start';\n  const em = struct.anchor === 'end' && radians < 0;\n  const sp = struct.anchor === 'start' && radians >= 0;\n  const y = struct.boundingRect.y + (sp || em ? struct.boundingRect.height : 0);\n  // Generate starting points at bandwidth boundaries\n  const points = [\n    { x: struct.x - halfWidth, y },\n    { x: struct.x + halfWidth, y }\n  ].map(p => rotateVector(p, radians, { x: struct.x, y: struct.y })); // Rotate around center point to counteract labels rotation\n\n  // Append points to wrap polygon around label\n  const margin = 10; // extend slightly to handle single char labels better\n  const leftPoint = {\n    x: startAnchor ? struct.boundingRect.x + struct.boundingRect.width + margin : struct.boundingRect.x - margin,\n    y: struct.boundingRect.y + struct.boundingRect.height\n  };\n\n  const rightPoint = {\n    x: startAnchor ? struct.boundingRect.x + struct.boundingRect.width + margin : struct.boundingRect.x - margin,\n    y: struct.boundingRect.y\n  };\n\n  const orderedPoints = radians >= 0 ? [leftPoint, rightPoint] : [rightPoint, leftPoint];\n  points.push(...orderedPoints);\n\n  struct.collider = {\n    type: 'polygon',\n    vertices: points\n  };\n}\n\nfunction appendCollider(tick, struct, buildOpts) {\n  if (buildOpts.layered || !buildOpts.stepSize) {\n    boundsCollider(tick, struct);\n  } else if (buildOpts.tilted) {\n    tiltedCollider(tick, struct, buildOpts);\n  } else {\n    bandwidthCollider(tick, struct, buildOpts);\n  }\n}\n\nfunction appendBounds(struct, buildOpts) {\n  struct.boundingRect = buildOpts.textBounds(struct);\n}\n\nfunction wiggle(buildOpts, isVertical) {\n  const a = isNaN(buildOpts.style.align) ? 0.5 : Math.min(Math.max(buildOpts.style.align, 0), 1);\n  let w = 0;\n  if (buildOpts.tilted) {\n    w = (buildOpts.stepSize * a);\n  } else {\n    const size = isVertical ? buildOpts.textRect.height : buildOpts.textRect.width;\n    w = Math.max(0, buildOpts.stepSize - size) * a;\n  }\n\n  return w;\n}\n\nexport default function buildNode(tick, buildOpts) {\n  const struct = {\n    type: 'text',\n    text: checkText(tick.label),\n    x: 0,\n    y: 0,\n    maxWidth: buildOpts.maxWidth,\n    maxHeight: buildOpts.maxHeight\n  };\n\n  if (buildOpts.align === 'top' || buildOpts.align === 'bottom') {\n    struct.x = (tick.start * buildOpts.innerRect.width) + (buildOpts.innerRect.x - buildOpts.outerRect.x) + wiggle(buildOpts, false);\n    struct.y = buildOpts.align === 'top' ? buildOpts.innerRect.height : 0;\n    struct.anchor = buildOpts.stepSize ? 'start' : 'middle';\n\n    struct.x += isNaN(buildOpts.style.offset) ? 0 : +buildOpts.style.offset;\n  } else {\n    struct.y = (tick.start * buildOpts.innerRect.height) + (buildOpts.innerRect.y - buildOpts.outerRect.y) + wiggle(buildOpts, true);\n    struct.x = buildOpts.align === 'left' ? buildOpts.innerRect.width : 0;\n    struct.anchor = buildOpts.align === 'left' ? 'end' : 'start';\n    struct.baseline = buildOpts.stepSize ? 'text-before-edge' : 'central';\n\n    struct.y += isNaN(buildOpts.style.offset) ? 0 : +buildOpts.style.offset;\n  }\n\n  appendStyle(struct, buildOpts);\n  clampEnds(struct, buildOpts);\n  appendPadding(struct, buildOpts);\n  appendTilting(struct, buildOpts);\n  appendBounds(struct, buildOpts);\n  appendCollider(tick, struct, buildOpts);\n\n  return struct;\n}\n","import extend from 'extend';\n\nfunction appendStyle(struct, buildOpts) {\n  extend(struct, buildOpts.style);\n}\n\nfunction appendPadding(struct, buildOpts) {\n  if (buildOpts.align === 'top') {\n    struct.y1 -= buildOpts.padding;\n    struct.y2 -= buildOpts.padding;\n  } else if (buildOpts.align === 'bottom') {\n    struct.y1 += buildOpts.padding;\n    struct.y2 += buildOpts.padding;\n  } else if (buildOpts.align === 'left') {\n    struct.x1 -= buildOpts.padding;\n    struct.x2 -= buildOpts.padding;\n  } else if (buildOpts.align === 'right') {\n    struct.x1 += buildOpts.padding;\n    struct.x2 += buildOpts.padding;\n  }\n}\n\nfunction adjustForEnds(struct, buildOpts) {\n  const halfWidth = struct.strokeWidth / 2;\n\n  if (struct.x1 === buildOpts.innerRect.width) { // outer end tick\n    struct.x1 -= halfWidth;\n    struct.x2 -= halfWidth;\n  } else if (struct.x1 === 0) { // outer start tick\n    struct.x1 += halfWidth;\n    struct.x2 += halfWidth;\n  } else if (struct.y1 === buildOpts.innerRect.height) {\n    struct.y1 -= halfWidth;\n    struct.y2 -= halfWidth;\n  } else if (struct.y1 === 0) {\n    struct.y1 += halfWidth;\n    struct.y2 += halfWidth;\n  }\n}\n\nexport default function buildNode(tick, buildOpts) {\n  const struct = {\n    type: 'line',\n    x1: 0,\n    x2: 0,\n    y1: 0,\n    y2: 0,\n    collider: {\n      type: null\n    }\n  };\n\n  if (buildOpts.align === 'top' || buildOpts.align === 'bottom') {\n    struct.x1 = struct.x2 = (tick.position * buildOpts.innerRect.width) + (buildOpts.innerRect.x - buildOpts.outerRect.x);\n    struct.y1 = buildOpts.align === 'top' ? buildOpts.innerRect.height : 0;\n    struct.y2 = buildOpts.align === 'top' ? struct.y1 - buildOpts.tickSize : struct.y1 + buildOpts.tickSize;\n  } else {\n    struct.y1 = struct.y2 = (tick.position * (buildOpts.innerRect.height)) + (buildOpts.innerRect.y - buildOpts.outerRect.y);\n    struct.x1 = buildOpts.align === 'left' ? buildOpts.innerRect.width : 0;\n    struct.x2 = buildOpts.align === 'left' ? struct.x1 - buildOpts.tickSize : struct.x1 + buildOpts.tickSize;\n  }\n\n  appendStyle(struct, buildOpts);\n  appendPadding(struct, buildOpts);\n  adjustForEnds(struct, buildOpts);\n  return struct;\n}\n","function isMajorTick(tick) {\n  return !tick.isMinor;\n}\n\nfunction isVerticalLabelOverlapping({\n  majorTicks,\n  measureText,\n  rect\n}) {\n  const size = rect.height;\n  const textHeight = measureText('M').height;\n  if (majorTicks.length < 2) {\n    return false;\n  }\n\n  const d = size * Math.abs(majorTicks[0].position - majorTicks[1].position);\n  if (d < textHeight) {\n    return true;\n  }\n\n  return false;\n}\n\nfunction isHorizontalLabelOverlapping({\n  majorTicks,\n  measureText,\n  rect,\n  state\n}) {\n  /*\n   * Currently isn't any good way of doing a accurate measurement on size available (bandWidth * width) for labels.\n   * It's a lifecycle limitation as components docked either left or right can affect the width available after the calculation is done.\n   * <number of components docked left/right> * <width of components> => Less accurate ===> Can result in only ellips char rendered as labels.\n   */\n  const m = state.labels.activeMode === 'layered' ? 2 : 1;\n  const size = rect.width;\n  const tickSize = majorTicks\n    .map(tick => tick.label)\n    .map(l => `${l.slice(0, 1)}${l.length > 1 ? '' : ''}`) // Measure the size of 1 chars + the ellips char.\n    .map(measureText)\n    .map(r => r.width);\n  for (let i = 0; i < majorTicks.length; ++i) {\n    const tick = majorTicks[i];\n    const d1 = m * size * Math.abs(tick.start - tick.end);\n    const d2 = tickSize[i];\n    if (d1 < d2) {\n      return true;\n    }\n  }\n  return false;\n}\n\nfunction shouldAutoTilt({\n  majorTicks,\n  measure,\n  rect,\n  state,\n  settings\n}) {\n  const glyphCount = settings.labels.maxGlyphCount;\n  const m = state.labels.activeMode === 'layered' ? 2 : 1;\n  const magicSizeRatioMultipler = 0.7; // So that if less the 70% of labels are visible, toggle on tilt\n  const ellipsCharSize = measure('').width; // include ellipsed char in calc as it's generally large then the char it replaces\n  const size = rect.width;\n  let maxLabelWidth = 0;\n  let d1 = 0;\n\n  if (!isNaN(glyphCount)) {\n    const minBandwidth = majorTicks.reduce((prev, curr) => Math.min(Math.abs(curr.start - curr.end), prev), Infinity);\n    d1 = m * size * minBandwidth;\n    maxLabelWidth = measure('M').width * magicSizeRatioMultipler * glyphCount;\n    if (maxLabelWidth + ellipsCharSize > d1) {\n      return true;\n    }\n  } else {\n    for (let i = 0; i < majorTicks.length; i++) {\n      const tick = majorTicks[i];\n      const label = tick.label;\n      const width = measure(label).width * (label.length > 1 ? magicSizeRatioMultipler : 1);\n      d1 = m * size * Math.abs(tick.start - tick.end);\n      if (width + ellipsCharSize > d1) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n}\n\nfunction isTiltedLabelOverlapping({\n  majorTicks,\n  measureText,\n  rect,\n  bleedSize,\n  angle\n}) {\n  if (majorTicks.length < 2) {\n    return false;\n  } else if (angle === 0) {\n    return true; // TODO 0 angle should be considered non-tilted\n  }\n  const absAngle = Math.abs(angle);\n  const size = rect.width - bleedSize;\n  const stepSize = size * Math.abs(majorTicks[0].position - majorTicks[1].position);\n  const textHeight = measureText('M').height;\n  const reciprocal = 1 / stepSize; // 1 === Math.sin(90 * (Math.PI / 180))\n  const distanceBetweenLabels = Math.sin(absAngle * (Math.PI / 180)) / reciprocal;\n\n  return textHeight > distanceBetweenLabels;\n}\n\nfunction isToLarge({\n  rect,\n  state,\n  majorTicks,\n  measure,\n  horizontal\n}) {\n  if (horizontal) {\n    return isHorizontalLabelOverlapping({\n      majorTicks,\n      measureText: measure,\n      rect,\n      state\n    });\n  }\n\n  return isVerticalLabelOverlapping({\n    majorTicks,\n    measureText: measure,\n    rect,\n    state\n  });\n}\n\nexport function getClampedValue({\n  value, maxValue, minValue, range, modifier\n}) {\n  if (!isNaN(range) && !isNaN(modifier)) {\n    value = range * modifier;\n  }\n\n  if (value > maxValue) {\n    value = maxValue;\n  }\n\n  if (value < minValue) {\n    value = minValue;\n  }\n\n  return value;\n}\n\nexport default function getSize({\n  isDiscrete,\n  rect,\n  formatter,\n  measureText,\n  scale,\n  settings,\n  state\n}) {\n  let size = 0;\n  const edgeBleed = {\n    left: 0, top: 0, right: 0, bottom: 0\n  };\n  const {\n    maxLengthPx: maxValue,\n    minLengthPx: minValue\n  } = settings.labels;\n\n  if (settings.labels.show) {\n    const align = settings.align;\n    const horizontal = align === 'top' || align === 'bottom';\n    const distance = horizontal ? rect.width : rect.height;\n    const majorTicks = scale.ticks({\n      settings,\n      distance,\n      formatter\n    }).filter(isMajorTick);\n\n    const measure = (text) => {\n      const m = measureText({\n        text,\n        fontSize: settings.labels.fontSize,\n        fontFamily: settings.labels.fontFamily\n      });\n      m.width = getClampedValue({ value: m.width, maxValue, minValue });\n      return m;\n    };\n\n    if (isDiscrete && horizontal && settings.labels.mode === 'auto') {\n      if (shouldAutoTilt({\n        majorTicks, measure, rect, state, settings\n      })) {\n        state.labels.activeMode = 'tilted';\n      } else {\n        state.labels.activeMode = 'horizontal';\n      }\n    }\n\n    if (isDiscrete && state.labels.activeMode !== 'tilted' && isToLarge({\n      rect, state, majorTicks, measure, horizontal\n    })) {\n      const toLargeSize = Math.max(rect.width, rect.height); // used to hide the axis\n      return { size: toLargeSize, isToLarge: true };\n    }\n\n    let sizeFromTextRect;\n    if (state.labels.activeMode === 'tilted') {\n      const radians = Math.abs(settings.labels.tiltAngle) * (Math.PI / 180); // angle in radians\n      sizeFromTextRect = r => (getClampedValue({ value: r.width, maxValue, minValue }) * Math.sin(radians)) + (r.height * Math.cos(radians));\n    } else if (horizontal) {\n      sizeFromTextRect = r => r.height;\n    } else {\n      sizeFromTextRect = r => getClampedValue({ value: r.width, maxValue, minValue });\n    }\n\n    let labels;\n    if (horizontal && state.labels.activeMode !== 'tilted') {\n      labels = ['M'];\n    } else if (!isNaN(settings.labels.maxGlyphCount)) {\n      let label = '';\n      for (let i = 0; i < settings.labels.maxGlyphCount; i++) {\n        label += 'M';\n      }\n      labels = [label];\n    } else {\n      labels = majorTicks.map(tick => tick.label);\n    }\n    const tickMeasures = labels.map(measure);\n    const labelSizes = tickMeasures.map(sizeFromTextRect);\n    const textSize = Math.max(...labelSizes, 0);\n    size += textSize;\n    size += settings.labels.margin;\n\n    if (state.labels.activeMode === 'layered') {\n      size *= 2;\n    }\n\n    if (state.labels.activeMode === 'tilted') {\n      const extendLeft = (settings.align === 'bottom') === (settings.labels.tiltAngle >= 0);\n      const radians = Math.abs(settings.labels.tiltAngle) * (Math.PI / 180); // angle in radians\n      const h = measureText('M').height;\n      const maxWidth = (textSize - (h * Math.cos(radians))) / Math.sin(radians);\n      const labelWidth = r => (Math.min(maxWidth, r.width) * Math.cos(radians)) + r.height;\n      const adjustByPosition = (s, i) => {\n        const pos = majorTicks[i] ? majorTicks[i].position : 0;\n        if (extendLeft) {\n          return s - (pos * rect.width);\n        }\n        return s - ((1 - pos) * rect.width);\n      };\n      const bleedSize = Math.min(settings.labels.maxEdgeBleed, Math.max(...tickMeasures.map(labelWidth).map(adjustByPosition), 0)) + settings.paddingEnd;\n      const bleedDir = extendLeft ? 'left' : 'right';\n      edgeBleed[bleedDir] = bleedSize;\n\n      if (isDiscrete && isTiltedLabelOverlapping({\n        majorTicks, measureText, rect, bleedSize, angle: settings.labels.tiltAngle\n      })) {\n        return { size: Math.max(rect.width, rect.height), isToLarge: true };\n      }\n    }\n  }\n\n  return { size, edgeBleed };\n}\n","import buildLine from './axis-line-node';\nimport buildLabel from './axis-label-node';\nimport buildTick from './axis-tick-node';\nimport NarrowPhaseCollision from '../../math/narrow-phase-collision';\nimport { getClampedValue } from './axis-label-size';\n\nfunction tickSpacing(settings) {\n  let spacing = 0;\n  spacing += settings.paddingStart;\n  spacing += settings.line.show ? settings.line.strokeWidth : 0;\n  spacing += settings.ticks.show ? settings.ticks.margin : 0;\n  return spacing;\n}\n\nfunction tickMinorSpacing(settings) {\n  return settings.line.strokeWidth + settings.minorTicks.margin;\n}\n\nfunction labelsSpacing(settings) {\n  let spacing = 0;\n  spacing += settings.ticks.show ? settings.ticks.tickSize : 0;\n  spacing += tickSpacing(settings) + settings.labels.margin;\n  return spacing;\n}\n\nfunction calcActualTextRect({ style, measureText, tick }) {\n  return measureText({\n    text: tick.label,\n    fontSize: style.fontSize,\n    fontFamily: style.fontFamily\n  });\n}\n\nfunction majorTicks(ticks) {\n  return ticks.filter(t => !t.isMinor);\n}\n\nfunction minorTicks(ticks) {\n  return ticks.filter(t => t.isMinor);\n}\n\nfunction tickBuilder(ticks, buildOpts) {\n  return ticks.map(tick => buildTick(tick, buildOpts));\n}\n\nfunction tickBandwidth(scale, tick) {\n  return tick ? Math.abs(tick.end - tick.start) : scale.bandwidth();\n}\n\nfunction labelBuilder(ticks, buildOpts, tickFn) {\n  return ticks.map((tick) => {\n    tickFn(tick);\n    const label = buildLabel(tick, buildOpts);\n    label.data = tick.data;\n    return label;\n  });\n}\n\nfunction layeredLabelBuilder(ticks, buildOpts, settings, tickFn) {\n  const padding = buildOpts.padding;\n  const spacing = labelsSpacing(settings);\n  return ticks.map((tick, i) => {\n    tickFn(tick);\n    const padding2 = spacing + buildOpts.maxHeight + settings.labels.margin;\n    buildOpts.layer = i % 2;\n    buildOpts.padding = i % 2 === 0 ? padding : padding2;\n    const label = buildLabel(tick, buildOpts);\n    label.data = tick.data;\n    return label;\n  });\n}\n\nexport function filterOverlappingLabels(labels, ticks) {\n  const isOverlapping = (l1, l2) => { // eslint-disable-line arrow-body-style\n    const rect1 = l1.boundingRect;\n    const rect2 = l2.boundingRect;\n\n    return NarrowPhaseCollision.testRectRect(rect1, rect2);\n  };\n\n  for (let i = 0; i <= labels.length - 1; i++) {\n    for (let k = i + 1; k <= Math.min(i + 5, i + (labels.length - 1)); k++) { // TODO Find a better way to handle exteme/layered labels then to iterare over ~5 next labels\n      if (labels[i] && labels[k] && isOverlapping(labels[i], labels[k])) {\n        if (k === labels.length - 1) { // On collition with last label, remove current label instead\n          labels.splice(i, 1);\n          if (ticks) { ticks.splice(i, 1); }\n        } else {\n          labels.splice(k, 1);\n          if (ticks) { ticks.splice(k, 1); }\n        }\n        k--;\n        i--;\n      }\n    }\n  }\n}\n\nfunction discreteCalcMaxTextRect({\n  measureText, settings, innerRect, scale, tilted, layered, tick\n}) {\n  const h = measureText({\n    text: 'M',\n    fontSize: settings.labels.fontSize,\n    fontFamily: settings.labels.fontFamily\n  }).height;\n\n  const bandwidth = tickBandwidth(scale, tick);\n\n  const textRect = { width: 0, height: h };\n  if (settings.align === 'left' || settings.align === 'right') {\n    textRect.width = innerRect.width - labelsSpacing(settings) - settings.paddingEnd;\n  } else if (layered) {\n    textRect.width = (bandwidth * innerRect.width) * 2;\n  } else if (tilted) {\n    const radians = Math.abs(settings.labels.tiltAngle) * (Math.PI / 180);\n    textRect.width = (innerRect.height - labelsSpacing(settings) - settings.paddingEnd - (h * Math.cos(radians))) / Math.sin(radians);\n  } else {\n    textRect.width = bandwidth * innerRect.width;\n  }\n\n  textRect.width = getClampedValue({ value: textRect.width, maxValue: settings.labels.maxLengthPx, minValue: settings.labels.minLengthPx });\n\n  return textRect;\n}\n\nfunction continuousCalcMaxTextRect({\n  measureText, settings, innerRect, ticks, tilted, layered\n}) {\n  const h = measureText({\n    text: 'M',\n    fontSize: settings.labels.fontSize,\n    fontFamily: settings.labels.fontFamily\n  }).height;\n\n  const textRect = { width: 0, height: h };\n  if (settings.align === 'left' || settings.align === 'right') {\n    textRect.width = innerRect.width - labelsSpacing(settings) - settings.paddingEnd;\n  } else if (layered) {\n    textRect.width = (innerRect.width / majorTicks(ticks).length) * 0.75 * 2;\n  } else if (tilted) {\n    const radians = Math.abs(settings.labels.tiltAngle) * (Math.PI / 180);\n    textRect.width = (innerRect.height - labelsSpacing(settings) - settings.paddingEnd - (h * Math.cos(radians))) / Math.sin(radians);\n  } else {\n    textRect.width = (innerRect.width / majorTicks(ticks).length) * 0.75;\n  }\n\n  textRect.width = getClampedValue({ value: textRect.width, maxValue: settings.labels.maxLengthPx, minValue: settings.labels.minLengthPx });\n\n  return textRect;\n}\n\nfunction getStepSizeFn({\n  innerRect, scale, settings, tick\n}) {\n  const size = settings.align === 'top' || settings.align === 'bottom' ? innerRect.width : innerRect.height;\n  const bandwidth = tickBandwidth(scale, tick);\n  return size * bandwidth;\n}\n\nexport default function nodeBuilder(isDiscrete) {\n  let calcMaxTextRectFn;\n  let filterLabels = false;\n\n  function continuous() {\n    calcMaxTextRectFn = continuousCalcMaxTextRect;\n    filterLabels = true;\n    return continuous;\n  }\n\n  function discrete() {\n    calcMaxTextRectFn = discreteCalcMaxTextRect;\n    return discrete;\n  }\n\n  function build({\n    settings, scale, innerRect, outerRect, measureText, ticks, state, textBounds\n  }) {\n    const nodes = [];\n    const major = majorTicks(ticks);\n    const minor = minorTicks(ticks);\n    const buildOpts = {\n      innerRect,\n      align: settings.align,\n      outerRect\n    };\n    const tilted = state.labels.activeMode === 'tilted';\n    const layered = state.labels.activeMode === 'layered';\n    let majorTickNodes;\n\n    if (settings.line.show) {\n      buildOpts.style = settings.line;\n      buildOpts.padding = settings.paddingStart;\n\n      nodes.push(buildLine(buildOpts));\n    }\n    if (settings.ticks.show) {\n      buildOpts.style = settings.ticks;\n      buildOpts.tickSize = settings.ticks.tickSize;\n      buildOpts.padding = tickSpacing(settings);\n\n      majorTickNodes = tickBuilder(major, buildOpts);\n    }\n    if (settings.labels.show) {\n      const padding = labelsSpacing(settings);\n      buildOpts.style = settings.labels;\n      buildOpts.padding = padding;\n      buildOpts.tilted = tilted;\n      buildOpts.layered = layered;\n      buildOpts.angle = settings.labels.tiltAngle;\n      buildOpts.paddingEnd = settings.paddingEnd;\n      buildOpts.textBounds = textBounds;\n      const tickFn = (tick) => {\n        const maxSize = calcMaxTextRectFn({\n          measureText, settings, innerRect, ticks, scale, tilted, layered, tick\n        });\n        buildOpts.maxWidth = maxSize.width;\n        buildOpts.maxHeight = maxSize.height;\n        buildOpts.textRect = calcActualTextRect({ tick, measureText, style: buildOpts.style });\n        buildOpts.stepSize = getStepSizeFn({\n          innerRect, scale, ticks, settings, tick\n        });\n      };\n\n      let labelNodes = [];\n      if (layered && (settings.align === 'top' || settings.align === 'bottom')) {\n        labelNodes = layeredLabelBuilder(major, buildOpts, settings, tickFn);\n      } else {\n        labelNodes = labelBuilder(major, buildOpts, tickFn);\n      }\n\n      // Remove labels (and paired tick) that are overlapping\n      if (filterLabels && !buildOpts.tilted) {\n        filterOverlappingLabels(labelNodes, majorTickNodes);\n      }\n\n      nodes.push(...labelNodes);\n    }\n\n    if (settings.minorTicks && settings.minorTicks.show && minor.length > 0) {\n      buildOpts.style = settings.minorTicks;\n      buildOpts.tickSize = settings.minorTicks.tickSize;\n      buildOpts.padding = tickMinorSpacing(settings);\n\n      nodes.push(...tickBuilder(minor, buildOpts));\n    }\n\n    if (majorTickNodes) {\n      nodes.push(...majorTickNodes);\n    }\n\n    return nodes;\n  }\n\n  continuous.build = build;\n  discrete.build = build;\n\n  return isDiscrete ? discrete() : continuous();\n}\n","// const DEFAULT_LAYOUT_SETTINGS = { // TODO create dis and con specific settings\n//   anchor: 'auto', // TODO re-name from align..\n//   // orientation: 'auto', // TODO impl. v/h/auto\n//   // direction: 'auto', // TODO impl. left/right/top/bottom/auto\n//   padding: { // TODO use dock layout margin instead..\n//     start: 0,\n//     end: 10\n//   },\n//   maxGlyphCount: NaN,\n//   maxEdgeBleed: Infinity\n//   // labelMode: 'auto' // TODO move here? auto, horizontal, layered\n// };\n\n/**\n * Discrete axis settings\n * @typedef {object}\n * @alias component--axis-discrete\n */\nconst DEFAULT_DISCRETE_SETTINGS = {\n  /**\n   * @typedef {object}\n   */\n  labels: {\n    /** Toggle labels on/off\n    * @type {boolean=} */\n    show: true,\n    /** Tilting angle in degrees. Capped between -90 and 90. Only applicable when labels are in `tilted` mode.\n    * @type {number=} */\n    tiltAngle: 40,\n    /** Control the amount of space (in pixels) that labes can occupy outside their docking area. Only applicable when labels are in `tilted` mode.\n    * @type {number=} */\n    maxEdgeBleed: Infinity,\n    /** Space in pixels between the tick and label.\n    * @type {number=} */\n    margin: 4,\n    /** Max length of labels in pixels\n    * @type {number=} */\n    maxLengthPx: 150,\n    /** Min length of labels in pixels. Labels will always at least require this much space\n    * @type {number=} */\n    minLengthPx: 0,\n    /** Control how labels arrange themself. Availabe modes are `auto`, `horizontal`, `layered` and `tilted`. When set to `auto` the axis determines the best possible layout in the current context.\n    * @type {string=} */\n    mode: 'auto',\n    /** When only a sub-set of data is available, ex. when paging. This property can be used to let the axis estimate how much space the labels will consume, allowing it to give a consistent space estimate over the entire dataset when paging.\n    * @type {number=} */\n    maxGlyphCount: NaN,\n    /** Align act as a slider for the text bounding rect over the item bandwidth, given that the item have a bandwidth. Except when labels are tilted, then the align is a pure align that shifts the position of the label anchoring point.\n    * @type {number=} */\n    align: 0.5,\n    /** Offset in pixels along the axis direction.\n    * @type {number=} */\n    offset: 0\n  },\n  /**\n   * @typedef {object}\n   */\n  ticks: {\n    /** Toggle ticks on/off\n    * @type {boolean=} */\n    show: false,\n    /** Space in pixels between the ticks and the line.\n    * @type {number=} */\n    margin: 0,\n    /** Size of the ticks in pixels.\n    * @type {number=} */\n    tickSize: 4\n  },\n  /**\n   * @typedef {object}\n   */\n  line: {\n    /** Toggle line on/off\n    * @type {boolean=} */\n    show: false\n  },\n  /** Padding in direction perpendicular to the axis\n    * @type {number=} */\n  paddingStart: 0,\n  /** Padding in direction perpendicular to the axis\n    * @type {number=} */\n  paddingEnd: 10,\n  /** Set the anchoring point of the axis. Avaialable options are `auto/left/right/bottom/top`. In `auto` the axis determines the best option. The options are restricted based on the axis orientation, a vertical axis may only anchor on `left` or `right`\n    * @type {string=} */\n  align: 'auto'\n};\n\n/**\n * Continuous axis settings\n * @typedef {object}\n * @alias component--axis-continuous\n */\nconst DEFAULT_CONTINUOUS_SETTINGS = {\n  /**\n   * @typedef {object}\n   */\n  labels: {\n    /** Toggle labels on/off\n    * @type {boolean=} */\n    show: true,\n    /** Space in pixels between the tick and label.\n    * @type {number=} */\n    margin: 4,\n    /** Max length of labels in pixels\n    * @type {number=} */\n    maxLengthPx: 150,\n    /** Min length of labels in pixels. Labels will always at least require this much space\n    * @type {number=} */\n    minLengthPx: 0,\n    /** Align act as a slider for the text bounding rect over the item bandwidth, given that the item have a bandwidth.\n    * @type {number=} */\n    align: 0.5,\n    /** Offset in pixels along the axis direction.\n    * @type {number=} */\n    offset: 0\n  },\n  /**\n   * @typedef {object}\n   */\n  ticks: {\n    /** Toggle ticks on/off\n    * @type {boolean=} */\n    show: true,\n    /** Space in pixels between the ticks and the line.\n    * @type {number=} */\n    margin: 0,\n    /** Size of the ticks in pixels.\n    * @type {number=} */\n    tickSize: 8\n  },\n  /**\n   * @typedef {object}\n   */\n  minorTicks: {\n    /** Toggle minor-ticks on/off\n    * @type {boolean=} */\n    show: false,\n    /** Size of the ticks in pixels.\n    * @type {number=} */\n    tickSize: 3,\n    /** Space in pixels between the ticks and the line.\n    * @type {number=} */\n    margin: 0\n  },\n  /**\n   * @typedef {object}\n   */\n  line: {\n    /** Toggle line on/off\n    * @type {boolean=} */\n    show: true\n  },\n  /** Padding in direction perpendicular to the axis\n    * @type {number=} */\n  paddingStart: 0,\n  /** Padding in direction perpendicular to the axis\n    * @type {number=} */\n  paddingEnd: 10,\n  /** Set the anchoring point of the axis. Avaialable options are `auto/left/right/bottom/top`. In `auto` the axis determines the best option. The options are restricted based on the axis orientation, a vertical axis may only anchor on `left` or `right`\n    * @type {string=} */\n  align: 'auto'\n};\n\nexport {\n  DEFAULT_DISCRETE_SETTINGS,\n  DEFAULT_CONTINUOUS_SETTINGS\n};\n","import getLabelSize from './axis-label-size';\n\nexport default function calcRequiredSize({\n  isDiscrete,\n  rect,\n  formatter,\n  measureText,\n  scale,\n  settings,\n  state\n}) {\n  let size = 0;\n\n  const { size: labelSize, edgeBleed, isToLarge } = getLabelSize({\n    isDiscrete,\n    rect,\n    formatter,\n    measureText,\n    scale,\n    settings,\n    state\n  });\n\n  size += labelSize;\n\n  if (isToLarge) {\n    return { size };\n  }\n\n  if (settings.ticks.show) {\n    size += settings.ticks.margin;\n    size += settings.ticks.tickSize;\n  }\n  if (settings.minorTicks && settings.minorTicks.show) {\n    const minorTicksSize = settings.minorTicks.margin + settings.minorTicks.tickSize;\n    if (minorTicksSize > size) {\n      size = minorTicksSize;\n    }\n  }\n  if (settings.line.show) {\n    size += settings.line.strokeWidth;\n  }\n  size += settings.paddingStart;\n  size += settings.paddingEnd;\n\n  return { size, edgeBleed };\n}\n","import extend from 'extend';\n\nimport nodeBuilder from './axis-node-builder';\nimport {\n  DEFAULT_CONTINUOUS_SETTINGS,\n  DEFAULT_DISCRETE_SETTINGS\n} from './axis-default-settings';\nimport calcRequiredSize from './axis-size-calculator';\nimport crispify from '../../transposer/crispifier';\nimport { scaleWithSize } from '../../scales';\n\nfunction alignTransform({ align, inner }) {\n  if (align === 'left') {\n    return { x: inner.width + inner.x };\n  } else if (align === 'right' || align === 'bottom') {\n    return inner;\n  }\n  return { y: inner.y + inner.height };\n}\n\nfunction resolveAlign(align, dock) {\n  const horizontal = ['top', 'bottom'];\n  const vertical = ['left', 'right'];\n  if (horizontal.indexOf(align) !== -1 && vertical.indexOf(dock) === -1) {\n    return align;\n  } else if (vertical.indexOf(align) !== -1 && horizontal.indexOf(dock) === -1) {\n    return align;\n  }\n  return dock; // Invalid align, return current dock as default\n}\n\n/**\n * @ignore\n * @param {object} context - The component context\n */\nfunction resolveLocalSettings({\n  state,\n  style,\n  settings\n}) {\n  const defaultStgns = extend(true, {}, state.isDiscrete ? DEFAULT_DISCRETE_SETTINGS : DEFAULT_CONTINUOUS_SETTINGS, style);\n  const localStgns = extend(true, {}, defaultStgns, settings.settings);\n\n  const dock = settings.dock || state.defaultDock;\n  localStgns.dock = dock;\n  localStgns.align = resolveAlign(settings.settings.align, dock);\n  localStgns.labels.tiltAngle = Math.max(-90, Math.min(localStgns.labels.tiltAngle, 90));\n\n  return localStgns;\n}\n\nfunction updateActiveMode(state, settings, isDiscrete) {\n  const mode = settings.labels.mode;\n\n  if (!isDiscrete || !state.isHorizontal) {\n    return 'horizontal';\n  }\n\n  if (mode === 'auto') {\n    return state.labels.activeMode;\n  } else if (['layered', 'tilted'].indexOf(settings.labels.mode) !== -1 && ['top', 'bottom'].indexOf(settings.dock) !== -1) {\n    return mode;\n  }\n  return 'horizontal';\n}\n\nconst axisComponent = {\n  require: ['chart', 'renderer', 'dockConfig'],\n  defaultSettings: {\n    displayOrder: 0,\n    prioOrder: 0,\n    settings: {},\n    style: {\n      labels: '$label',\n      ticks: '$guide-line',\n      minorTicks: '$guide-line--minor',\n      line: '$guide-line'\n    }\n  },\n  created() {\n    // State is a representation of properties that are private to this component defintion and may be modified by only in this context.\n    this.state = {\n      isDiscrete: !!this.scale.bandwidth,\n      isHorizontal: false,\n      labels: {\n        activeMode: 'horizontal'\n      },\n      ticks: [],\n      innerRect: {\n        width: 0, height: 0, x: 0, y: 0\n      },\n      outerRect: {\n        width: 0, height: 0, x: 0, y: 0\n      },\n      defaultDock: undefined,\n      concreteNodeBuilder: undefined,\n      settings: undefined\n    };\n\n    if (this.state.isDiscrete) {\n      this.state.defaultDock = 'bottom';\n    } else {\n      this.state.defaultDock = 'left';\n    }\n\n    this.setState(this.settings);\n  },\n  setState() {\n    this.state.isDiscrete = !!this.scale.bandwidth;\n    this.state.settings = resolveLocalSettings(this);\n\n    this.state.concreteNodeBuilder = nodeBuilder(this.state.isDiscrete);\n\n    this.dockConfig.dock = this.state.settings.dock; // Override the dock setting (TODO should be removed)\n\n    this.state.isHorizontal = this.state.settings.align === 'top' || this.state.settings.align === 'bottom';\n    this.state.labels.activeMode = updateActiveMode(this.state, this.state.settings, this.state.isDiscrete);\n  },\n  preferredSize(opts) {\n    const {\n      formatter,\n      state,\n      scale\n    } = this;\n\n    const distance = this.state.isHorizontal ? opts.inner.width : opts.inner.height;\n\n    this.state.pxScale = scaleWithSize(scale, distance);\n\n    const reqSize = calcRequiredSize({\n      isDiscrete: this.state.isDiscrete,\n      rect: opts.inner,\n      formatter,\n      measureText: this.renderer.measureText,\n      scale: this.state.pxScale,\n      settings: this.state.settings,\n      state\n    });\n\n    return reqSize;\n  },\n  beforeUpdate(opts = {}) {\n    const {\n      settings\n    } = opts;\n    this.setState(settings);\n  },\n  resize(opts) {\n    const {\n      inner,\n      outer\n    } = opts;\n\n    const extendedInner = extend({}, inner, alignTransform({\n      align: this.state.settings.align,\n      inner\n    }));\n\n    const finalOuter = outer || extendedInner;\n    extend(this.state.innerRect, extendedInner);\n    extend(this.state.outerRect, finalOuter);\n\n    return outer;\n  },\n  beforeRender() {\n    const {\n      scale,\n      formatter\n    } = this;\n\n    const distance = this.state.isHorizontal ? this.state.innerRect.width : this.state.innerRect.height;\n\n    this.state.pxScale = scaleWithSize(scale, distance);\n    this.state.ticks = this.state.pxScale.ticks({\n      distance,\n      formatter\n    });\n  },\n  render() {\n    const {\n      state\n    } = this;\n\n    const nodes = [];\n    nodes.push(...this.state.concreteNodeBuilder.build({\n      settings: this.state.settings,\n      scale: this.state.pxScale,\n      innerRect: this.state.innerRect,\n      outerRect: this.state.outerRect,\n      measureText: this.renderer.measureText,\n      textBounds: this.renderer.textBounds,\n      ticks: this.state.ticks,\n      state\n    }));\n\n    crispify.multiple(nodes);\n\n    return nodes;\n  }\n};\n\nexport default axisComponent;\n","import axisComponent from './axis';\n\n/**\n * @typedef {object} component--axis\n */\n\n/**\n * @type {string}\n * @memberof component--axis\n */\n\nconst type = 'axis';\n\nexport default function axis(picasso) {\n  picasso.component(type, axisComponent);\n}\n","import extend from 'extend';\n\nfunction parseTitle(text, join, scale) {\n  let title = '';\n  if (typeof text === 'function') {\n    title = text();\n  } else if (typeof text === 'string') {\n    title = text;\n  } else if (scale) {\n    let data = scale.data();\n    const titles = (data.fields || []).map(field => field.title());\n    title = titles.join(join);\n  }\n\n  return title;\n}\n\nfunction getTextAnchor(dock, anchor) {\n  let val = 'middle';\n  if (dock === 'left') {\n    if (anchor === 'top') {\n      val = 'end';\n    } else if (anchor === 'bottom') {\n      val = 'start';\n    }\n  } else if (dock === 'right') {\n    if (anchor === 'top') {\n      val = 'start';\n    } else if (anchor === 'bottom') {\n      val = 'end';\n    }\n  } else if (anchor === 'left') {\n    val = 'start';\n  } else if (anchor === 'right') {\n    val = 'end';\n  }\n  return val;\n}\n\nfunction generateTitle({\n  title,\n  definitionSettings,\n  dock,\n  rect,\n  measureText,\n  style\n}) {\n  const struct = {\n    type: 'text',\n    text: title,\n    x: 0,\n    y: 0,\n    dx: 0,\n    dy: 0,\n    anchor: getTextAnchor(dock, definitionSettings.anchor),\n    baseline: 'alphabetical'\n  };\n\n  extend(struct, style.text);\n  const textRect = measureText(struct);\n\n  if (dock === 'top' || dock === 'bottom') {\n    let x = rect.width / 2;\n    if (definitionSettings.anchor === 'left') {\n      x = definitionSettings.paddingLeft || 0;\n    } else if (definitionSettings.anchor === 'right') {\n      x = rect.width - (definitionSettings.paddingRight || 0);\n    }\n\n    struct.x = x;\n    struct.y = dock === 'top' ? rect.height - definitionSettings.paddingStart : definitionSettings.paddingStart + textRect.height;\n    struct.dy = dock === 'top' ? -(textRect.height / 6) : -(textRect.height / 3);\n    struct.maxWidth = rect.width * 0.8;\n  } else {\n    let y = rect.height / 2;\n    if (definitionSettings.anchor === 'top') {\n      y = definitionSettings.paddingStart;\n    } else if (definitionSettings.anchor === 'bottom') {\n      y = rect.height - definitionSettings.paddingStart;\n    }\n\n    struct.y = y;\n    struct.x = dock === 'left' ? rect.width - definitionSettings.paddingStart : definitionSettings.paddingStart;\n    struct.dx = dock === 'left' ? -(textRect.height / 3) : (textRect.height / 3);\n    const rotation = dock === 'left' ? 270 : 90;\n    struct.transform = `rotate(${rotation}, ${struct.x + struct.dx}, ${struct.y + struct.dy})`;\n    struct.maxWidth = rect.height * 0.8;\n  }\n\n  if (!isNaN(definitionSettings.maxLengthPx)) {\n    struct.maxWidth = Math.min(struct.maxWidth, definitionSettings.maxLengthPx);\n  }\n\n  return struct;\n}\n\n/**\n * @typedef {object} component--text\n * @property {string} [type='text']\n * @property {string|function} text\n * @property {component--text-settings} settings - Text settings\n * @example\n * {\n *  type: 'text',\n *  text: 'my title',\n *  dock: 'left',\n *  settings: {\n *    anchor: 'left',\n *    style: {\n *      fill: 'red'\n *    }\n *  }\n * }\n */\n\n/**\n * @typedef {object} component--text-settings\n * @property {number} [paddingStart=5]\n * @property {number} [paddingEnd=5]\n * @property {number} [paddingLeft=0]\n * @property {number} [paddingRight=0]\n * @property {string} [anchor='center'] - Where to v- or h-align the text. Supports `left`, `right`, `top`, `bottom` and `center`\n * @property {string} [join=', '] - String to add when joining titles from multiple sources\n * @property {number} [maxLengthPx] - Limit the text length to this value in pixels\n */\nconst textComponent = {\n  require: ['renderer', 'chart'],\n  defaultSettings: {\n    dock: 'bottom',\n    displayOrder: 0,\n    prioOrder: 0,\n    settings: {\n      paddingStart: 5,\n      paddingEnd: 5,\n      paddingLeft: 0,\n      paddingRight: 0,\n      anchor: 'center',\n      join: ', ',\n      maxLengthPx: NaN\n    },\n    style: {\n      text: '$title'\n    }\n  },\n\n  created() {\n    this.rect = {\n      x: 0,\n      y: 0,\n      width: 0,\n      height: 0\n    };\n\n    this.definitionSettings = this.settings.settings;\n\n    const text = this.settings.text;\n    const join = this.definitionSettings.join;\n    this.title = parseTitle(text, join, this.scale);\n  },\n\n  preferredSize() {\n    const height = this.renderer.measureText({\n      text: this.title,\n      fontSize: this.style.text.fontSize,\n      fontFamily: this.style.text.fontFamily\n    }).height;\n    return height + this.definitionSettings.paddingStart + this.definitionSettings.paddingEnd;\n  },\n\n  beforeRender(opts) {\n    extend(this.rect, opts.size);\n  },\n\n  render() {\n    const {\n      title,\n      definitionSettings,\n      rect\n    } = this;\n    const nodes = [];\n    nodes.push(generateTitle({\n      title,\n      dock: this.settings.dock,\n      definitionSettings,\n      rect,\n      measureText: this.renderer.measureText,\n      style: this.style\n    }));\n    return nodes;\n  },\n\n  beforeUpdate(opts) {\n    if (opts.settings) {\n      extend(this.settings, opts.settings);\n      this.definitionSettings = opts.settings.settings;\n    }\n    const text = this.settings.text;\n    const join = this.definitionSettings.join;\n    this.title = parseTitle(text, join, this.scale);\n  }\n};\n\nexport default textComponent;\n","import textComponent from './text';\n\nexport default function text(picasso) {\n  picasso.component('text', textComponent);\n}\n","/**\n * @typedef {object} component--scrollbar\n * @private\n */\n\n/**\n * @typedef {object} component--scrollbar.settings\n * @property {boolean} [backgroundColor = '#eee']\n * @property {boolean} [thumbColor = '#ccc']\n * @property {boolean} [width = 16]\n */\n\nfunction start(_scrollbar, pos) {\n  const dock = _scrollbar.settings.dock;\n  const invert = _scrollbar.settings.settings.invert;\n  const horizontal = dock === 'top' || dock === 'bottom';\n  const lengthAttr = horizontal ? 'width' : 'height';\n  const length = _scrollbar.rect[lengthAttr];\n  const scroll = _scrollbar.chart.scroll(_scrollbar.settings.scroll);\n  let currentMove;\n\n  { // local scope to allow reuse of variable names later\n    let offset = pos[horizontal ? 'x' : 'y'];\n    if (invert) {\n      offset = length - offset;\n    }\n    const scrollState = scroll.getState();\n\n    currentMove = {\n      startOffset: offset,\n      startScroll: scrollState.start,\n      swipe: false\n    };\n\n    // Detect swipe start outsize the thumb & change startScroll to jump the scroll there.\n    const scrollPoint = ((offset / length) * (scrollState.max - scrollState.min)) + scrollState.min;\n    if (scrollPoint < scrollState.start) {\n      currentMove.startScroll = scrollPoint;\n    } else if (scrollPoint > scrollState.start + scrollState.viewSize) {\n      currentMove.startScroll = scrollPoint - scrollState.viewSize;\n    }\n  }\n\n  const update = (p) => {\n    let offset = p[horizontal ? 'x' : 'y'];\n    if (invert) {\n      offset = length - offset;\n    }\n    if (!currentMove.swipe) {\n      if (Math.abs(currentMove.startOffset - offset) <= 1) {\n        return;\n      }\n      currentMove.swipe = true;\n    }\n\n    const scrollState = scroll.getState();\n    const scrollMove = ((offset - currentMove.startOffset) / length) * (scrollState.max - scrollState.min);\n    const scrollStart = currentMove.startScroll + scrollMove;\n    scroll.moveTo(scrollStart);\n  };\n  const end = (p) => {\n    let offset = p[horizontal ? 'x' : 'y'];\n    if (invert) {\n      offset = length - offset;\n    }\n    const scrollState = scroll.getState();\n    if (currentMove.swipe) {\n      const scrollMove = ((offset - currentMove.startOffset) / length) * (scrollState.max - scrollState.min);\n      const scrollStart = currentMove.startScroll + scrollMove;\n      scroll.moveTo(scrollStart);\n    } else {\n      const scrollCenter = ((offset / length) * (scrollState.max - scrollState.min)) + scrollState.min;\n      const scrollStart = scrollCenter - (scrollState.viewSize / 2);\n      scroll.moveTo(scrollStart);\n    }\n  };\n\n  return {\n    update,\n    end\n  };\n}\n\nfunction getLocalPos(event, renderer) {\n  const containerRect = renderer.element().getBoundingClientRect();\n  return {\n    x: event.center.x - containerRect.left,\n    y: event.center.y - containerRect.top\n  };\n}\n\nconst scrollbarComponent = {\n  require: ['chart', 'renderer'],\n  on: {\n    panStart(event) {\n      const pos = getLocalPos(event, this.renderer);\n      const startPos = {\n        x: pos.x - event.deltaX,\n        y: pos.y - event.deltaY\n      };\n      this.currentMove = start(this, startPos);\n      this.currentMove.update(pos);\n    },\n    panMove(event) {\n      if (!this.currentMove) { return; }\n      const pos = getLocalPos(event, this.renderer);\n      this.currentMove.update(pos);\n    },\n    panEnd(event) {\n      if (!this.currentMove) { return; }\n      const pos = getLocalPos(event, this.renderer);\n      this.currentMove.end(pos);\n      this.currentMove = null;\n    },\n    panCancel() {\n      this.currentMove = null;\n    },\n    tap(event) {\n      const pos = getLocalPos(event, this.renderer);\n      const move = start(this, pos);\n      move.end(pos);\n    }\n  },\n  defaultSettings: {\n    settings: {\n      backgroundColor: '#eee',\n      thumbColor: '#ccc',\n      width: 16 // 32 for touch\n    }\n  },\n  created: function created() {\n    this.rect = {\n      x: 0,\n      y: 0,\n      width: 0,\n      height: 0\n    };\n  },\n\n  preferredSize: function preferredSize(rect) {\n    const scrollState = this.chart.scroll(this.settings.scroll).getState();\n    // hide the scrollbar if it is not possible to scroll\n    if (scrollState.viewSize >= scrollState.max - scrollState.min) {\n      const toLargeSize = Math.max(rect.width, rect.height);\n      return toLargeSize;\n    }\n    return this.settings.settings.width;\n  },\n\n  resize: function resize(opts) {\n    const inner = opts.inner;\n    this.rect = inner;\n    return inner;\n  },\n\n  render: function render(h) {\n    const dock = this.settings.dock;\n    const invert = this.settings.settings.invert;\n    const horizontal = dock === 'top' || dock === 'bottom';\n    const lengthAttr = horizontal ? 'width' : 'height';\n\n    const _rect = this.rect;\n    const length = _rect[lengthAttr];\n\n    const scrollState = this.chart.scroll(this.settings.scroll).getState();\n    let thumbStart = (length * (scrollState.start - scrollState.min)) / (scrollState.max - scrollState.min);\n    const thumbRange = (length * scrollState.viewSize) / (scrollState.max - scrollState.min);\n\n    if (invert) {\n      thumbStart = length - thumbStart - thumbRange;\n    }\n\n    return h(\n      'div',\n      {\n        style: {\n          position: 'relative',\n          width: '100%',\n          height: '100%',\n          background: this.settings.settings.backgroundColor,\n          pointerEvents: 'auto'\n        }\n      },\n      [].concat(h('div', {\n        class: {\n          scroller: true\n        },\n        style: {\n          position: 'absolute',\n          [horizontal ? 'left' : 'top']: `${thumbStart}px`,\n          [horizontal ? 'top' : 'left']: '25%',\n          [horizontal ? 'height' : 'width']: '50%', // ${width}px\n          [lengthAttr]: `${Math.max(1, thumbRange)}px`,\n          background: this.settings.settings.thumbColor\n        }\n      }))\n    );\n  },\n\n  renderer: 'dom'\n};\n\nexport default function scrollbar(picasso) {\n  picasso.component('scrollbar', scrollbarComponent);\n}\n","const TARGET_SIZE = 5;\nconst VERTICAL = 0;\nconst HORIZONTAL = 1;\n\nexport {\n  TARGET_SIZE,\n  VERTICAL,\n  HORIZONTAL\n};\n","import extend from 'extend';\n\nimport {\n  TARGET_SIZE,\n  VERTICAL\n} from './brush-range-const';\n\nfunction buildLine({\n  h, isVertical, value, pos, align, borderHit, state\n}) {\n  const isAlignStart = align !== 'end';\n  const alignStart = { left: '0', top: '0' };\n  const alignEnd = { right: '0', bottom: '0' };\n  const alignStyle = isAlignStart ? alignStart : alignEnd;\n  let start = 0;\n  let width = '100%';\n  let height = '100%';\n\n  if (state.targetRect && state.settings.bubbles.align === 'start') {\n    width = `${state.targetRect.x + state.targetRect.width}px`;\n    height = `${state.targetRect.y + state.targetRect.height}px`;\n  } else if (state.targetRect && state.settings.bubbles.align === 'end') {\n    start = isVertical ? state.targetRect.x : state.targetRect.y;\n    width = `${state.rect.width - start}px`;\n    height = `${state.rect.height - start}px`;\n  }\n\n  if (!isAlignStart) {\n    pos -= borderHit;\n  }\n\n  // edge\n  return h('div', {\n    on: {\n      mouseover() {\n        this.children[0].elm.style.backgroundColor = '#000';\n        this.children[0].elm.style[isVertical ? 'height' : 'width'] = '2px';\n      },\n      mouseout() {\n        this.children[0].elm.style.backgroundColor = state.style.line.stroke;\n        this.children[0].elm.style[isVertical ? 'height' : 'width'] = '1px';\n      }\n    },\n    attrs: {\n      'data-value': value\n    },\n    style: {\n      cursor: isVertical ? 'ns-resize' : 'ew-resize',\n      position: 'absolute',\n      left: isVertical ? `${start}px` : `${pos}px`,\n      top: isVertical ? `${pos}px` : `${start}px`,\n      height: isVertical ? `${borderHit}px` : height,\n      width: isVertical ? width : `${borderHit}px`,\n      pointerEvents: 'auto'\n    }\n  }, [\n    // line\n    h('div', {\n      style: extend(\n        {\n          backgroundColor: state.style.line.stroke,\n          position: 'absolute',\n          height: isVertical ? `${1}px` : '100%',\n          width: isVertical ? '100%' : `${1}px`\n        },\n        alignStyle\n      )\n    })\n  ]);\n}\n\nfunction buildBubble({\n  h, isVertical, label, otherValue, idx, pos, align, state\n}) {\n  const isAlignStart = align !== 'end';\n  const isOutside = state.settings.bubbles.placement === 'outside';\n  let outside = 'none';\n  let bubbleDock;\n  if (isVertical) {\n    bubbleDock = isAlignStart ? 'left' : 'right';\n    if (isOutside) {\n      outside = isAlignStart ? 'translate(-100%,  0px)' : 'translate(100%,  0px)';\n    }\n  } else {\n    bubbleDock = isAlignStart ? 'top' : 'bottom';\n    if (isOutside) {\n      outside = isAlignStart ? 'translate(0px, -100%)' : 'translate(0px,  100%)';\n    }\n  }\n\n  // bubble wrapper\n  return h('div', {\n    style: {\n      position: 'absolute',\n      [bubbleDock]: '0',\n      [isVertical ? 'top' : 'left']: `${pos}px`,\n      transform: outside\n    }\n  }, [\n    // bubble\n    h('div', {\n      attrs: {\n        'data-other-value': otherValue,\n        'data-idx': idx\n      },\n      style: extend({\n        position: 'relative',\n        borderRadius: `${state.style.bubble.borderRadius}px`,\n        border: `${state.style.bubble.strokeWidth}px solid ${state.style.bubble.stroke}`,\n        backgroundColor: state.style.bubble.fill,\n        color: state.style.bubble.color,\n        fontFamily: state.style.bubble.fontFamily,\n        fontSize: state.style.bubble.fontSize,\n        padding: '4px 8px',\n        textAlign: 'center',\n        overflow: 'hidden',\n        textOverflow: 'ellipsis',\n        whiteSpace: 'nowrap',\n        maxWidth: '150px',\n        minWidth: '50px',\n        minHeight: '1em',\n        pointerEvents: 'auto',\n        transform: isVertical ? 'translate(0,-50%)' : 'translate(-50%,0)'\n      })\n    }, [label])\n  ]);\n}\n\nfunction buildArea({\n  h, isVertical, top, height, color, on, opacity\n}) {\n  return h('div', {\n    style: {\n      backgroundColor: color,\n      opacity,\n      position: 'absolute',\n      left: isVertical ? 0 : `${top}px`,\n      top: isVertical ? `${top}px` : 0,\n      height: isVertical ? `${height}px` : '100%',\n      width: isVertical ? '100%' : `${height}px`,\n      pointerEvents: 'auto'\n    },\n    on\n  }, []);\n}\n\nexport default function buildRange({\n  borderHit, els, isVertical, state, vStart, vEnd, idx\n}) {\n  let targetOffset = 0;\n  if (state.targetRect) {\n    targetOffset = isVertical ? state.targetRect.y : state.targetRect.x;\n  }\n  const hasScale = !!state.scale;\n  const start = hasScale ? state.scale.norm(vStart) * state.size : vStart;\n  const end = hasScale ? state.scale.norm(vEnd) * state.size : vEnd;\n  const height = Math.abs(start - end);\n  const top = Math.min(start, end) + targetOffset;\n  const bottom = top + height;\n\n  if (state.targetRect) {\n    const target = state.targetFillRect || state.targetRect;\n    const targetSize = isVertical ? target.height : target.width;\n    const targetStart = hasScale ? state.scale.norm(vStart) * targetSize : vStart;\n    const targetEnd = hasScale ? state.scale.norm(vEnd) * targetSize : vEnd;\n    const targetHeight = Math.abs(targetStart - targetEnd);\n    const targetTop = Math.min(targetStart, targetEnd);\n    const targetArea = {\n      h: state.h,\n      isVertical,\n      top: targetTop,\n      height: targetHeight,\n      color: state.style.target.fill,\n      opacity: state.style.target.opacity\n    };\n    if (state.style.target.opacity < 0.8) {\n      targetArea.on = {\n        mouseover() {\n          this.elm.style.opacity = state.style.target.opacity + 0.1;\n        },\n        mouseout() {\n          this.elm.style.opacity = state.style.target.opacity;\n        }\n      };\n    }\n    els.push(state.h('div', {\n      style: {\n        position: 'absolute',\n        left: `${target.x}px`,\n        top: `${target.y}px`,\n        height: `${target.height}px`,\n        width: `${target.width}px`\n      }\n    }, [\n      buildArea(targetArea)\n    ]));\n  }\n\n  // active range area\n  // els.push(buildArea({\n  //   h: state.h,\n  //   isVertical,\n  //   top,\n  //   height,\n  //   color: state.settings.fill\n  // }));\n\n  els.push(buildLine({\n    h: state.h,\n    isVertical,\n    borderHit,\n    value: start < end ? vStart : vEnd,\n    pos: top,\n    align: 'start',\n    state\n  }));\n\n  els.push(buildLine({\n    h: state.h,\n    isVertical,\n    borderHit,\n    value: start < end ? vEnd : vStart,\n    pos: bottom,\n    align: 'end',\n    state\n  }));\n\n  const bubbles = state.settings.bubbles;\n  if (bubbles && bubbles.show) {\n    const fontSize = bubbles.fontSize;\n    const fontFamily = bubbles.fontFamily;\n    const fill = bubbles.fill;\n    const style = {\n      fontSize,\n      fontFamily,\n      color: fill\n    };\n\n    const range = [vStart, vEnd];\n    els.push(buildBubble({\n      h: state.h,\n      isVertical,\n      align: bubbles.align,\n      style,\n      idx,\n      otherValue: start < end ? vEnd : vStart,\n      label: `${state.format(start < end ? vStart : vEnd, range)}`,\n      pos: top,\n      state\n    }));\n\n    els.push(buildBubble({\n      h: state.h,\n      isVertical,\n      align: bubbles.align,\n      style,\n      idx,\n      otherValue: start < end ? vStart : vEnd,\n      label: `${state.format(start < end ? vEnd : vStart, range)}`,\n      pos: bottom,\n      state\n    }));\n  }\n}\n\nexport function getMoveDelta(state) {\n  const posDelta = state.active.limitHigh - state.active.end;\n  const negDelta = state.active.limitLow - state.active.start;\n  let delta = state.current - state.start;\n  if (delta < 0) {\n    delta = Math.max(delta, negDelta);\n  } else {\n    delta = Math.min(delta, posDelta);\n  }\n\n  return delta;\n}\n\nexport function nodes(state) {\n  if (!state.active) {\n    return [];\n  }\n  let vStart = state.start;\n  let vEnd = state.current;\n  if (state.active.idx !== -1) {\n    if (state.active.mode === 'foo') {\n      vStart = Math.min(state.active.start, state.active.end);\n      vEnd = Math.max(state.active.start, state.active.end);\n    } else if (state.active.mode === 'modify') {\n      vStart = Math.min(state.start, state.current);\n      vEnd = Math.max(state.start, state.current);\n    } else {\n      const delta = getMoveDelta(state);\n      vStart = state.active.start + delta;\n      vEnd = state.active.end + delta;\n    }\n  }\n\n  let els = [];\n\n  const isVertical = state.direction === VERTICAL;\n\n  // add all other ranges\n  state.ranges.forEach((r, i) => {\n    if (i !== state.active.idx) {\n      buildRange({\n        borderHit: TARGET_SIZE,\n        els,\n        isVertical,\n        state,\n        vStart: Math.min(r.min, r.max),\n        vEnd: Math.max(r.min, r.max),\n        idx: i\n      });\n    }\n  });\n\n  // add active range\n  buildRange({\n    borderHit: TARGET_SIZE,\n    els,\n    isVertical,\n    state,\n    vStart,\n    vEnd,\n    idx: state.active.idx\n  });\n\n  return els;\n}\n","import extend from 'extend';\nimport Collisions from '../../../core/math/narrow-phase-collision';\n\nfunction rangelimits(state) {\n  return {\n    min: state.scale.min(),\n    max: state.scale.max()\n  };\n}\n\nfunction areaLimits(state) {\n  return {\n    min: 0,\n    max: state.direction ? state.rect.width : state.rect.height\n  };\n}\n\nfunction findActive(state, value, limits) {\n  let rs = state.ranges;\n  let i;\n  let activeIdx = -1;\n  for (i = 0; i < rs.length; i++) {\n    if (rs[i].min <= value && value <= rs[i].max) {\n      activeIdx = i;\n      limits.min = i ? rs[i - 1].max : limits.min;\n      limits.max = i + 1 < rs.length ? rs[i + 1].min : limits.max;\n      break;\n    } else if (value < rs[i].min) {\n      limits.max = rs[i].min;\n      limits.min = i ? rs[i - 1].max : limits.min;\n      break;\n    }\n  }\n  if (activeIdx === -1 && rs.length && i >= rs.length) {\n    limits.min = rs[rs.length - 1].max;\n  }\n\n  let activeRange;\n\n  if (activeIdx !== -1) {\n    activeRange = {\n      idx: activeIdx,\n      start: rs[activeIdx].min,\n      end: rs[activeIdx].max,\n      limitLow: limits.min,\n      limitHigh: limits.max,\n      mode: 'foo'\n    };\n  }\n  state.active = activeRange;\n}\n\nexport function startArea({\n  state, e, renderer, ranges, targetSize\n}) {\n  if (state.started) {\n    return;\n  }\n  const x = (e.center.x - e.deltaX);\n  const y = (e.center.y - e.deltaY);\n  let target = document.elementFromPoint(x, y);\n  if (!renderer.element().contains(target)) {\n    target = null;\n  }\n\n  const tempState = {\n    started: true\n  };\n\n  state.offset = renderer.element().getBoundingClientRect();\n  state.ranges = ranges(state);\n  const relX = x - state.offset.left; // coordinate relative renderer\n  const relY = y - state.offset.top;\n  const startPoint = (e.center[state.cssCoord.coord] - e[state.cssCoord.pos]) - state.offset[state.cssCoord.offset];\n  const relStart = (e.center[state.cssCoord.coord]) - state.offset[state.cssCoord.offset];\n  let v = relStart;\n  let vStart = startPoint;\n\n  tempState.start = startPoint;\n  tempState.current = relStart;\n\n  let rs = state.ranges;\n  const limits = areaLimits(state);\n  let i;\n  let activeIdx = -1;\n  if (target && target.hasAttribute('data-idx')) {\n    activeIdx = parseInt(target.getAttribute('data-idx'), 10);\n    limits.min = activeIdx > 0 ? rs[activeIdx - 1].max : limits.min;\n    limits.max = activeIdx + 1 < rs.length ? rs[activeIdx + 1].min : limits.max;\n  } else {\n    for (i = 0; i < rs.length; i++) {\n      if (rs[i].min <= vStart && vStart <= rs[i].max) {\n        activeIdx = i;\n        limits.min = i ? rs[i - 1].max : limits.min;\n        limits.max = i + 1 < rs.length ? rs[i + 1].min : limits.max;\n        break;\n      } else if (vStart < rs[i].min) {\n        limits.max = rs[i].min;\n        limits.min = i ? rs[i - 1].max : limits.min;\n        break;\n      }\n    }\n    if (activeIdx === -1 && rs.length && i >= rs.length) {\n      limits.min = rs[rs.length - 1].max;\n    }\n  }\n\n  if (activeIdx === -1 && !state.multi) {\n    tempState.ranges = [];\n    limits.min = 0;\n    limits.max = state.direction ? state.rect.width : state.rect.height;\n  }\n  let activeRange;\n\n  if (activeIdx !== -1) {\n    activeRange = {\n      idx: activeIdx,\n      start: rs[activeIdx].min,\n      end: rs[activeIdx].max,\n      limitLow: limits.min,\n      limitHigh: limits.max,\n      mode: 'move'\n    };\n\n    if (target && target.hasAttribute('data-other-value')) {\n      tempState.start = parseFloat(target.getAttribute('data-other-value'));\n      activeRange.mode = 'modify';\n    } else {\n      let pxStart = activeRange.start;\n      let pxEnd = activeRange.end;\n      if (Math.abs(startPoint - pxStart) <= targetSize) {\n        tempState.start = activeRange.end;\n        activeRange.mode = 'modify';\n      } else if (Math.abs(startPoint - pxEnd) <= targetSize) {\n        tempState.start = activeRange.start;\n        activeRange.mode = 'modify';\n      }\n    }\n  } else {\n    activeRange = {\n      idx: -1,\n      start: vStart,\n      end: v,\n      limitLow: limits.min,\n      limitHigh: limits.max,\n      mode: 'current'\n    };\n  }\n\n  tempState.active = activeRange;\n\n  if (activeRange.mode !== 'modify' && state.targetRect && !Collisions.testRectPoint(state.targetRect, { x: relX, y: relY })) {\n    // do nothing\n  } else {\n    Object.keys(tempState).forEach(key => (state[key] = tempState[key]));\n  }\n}\n\nexport function start({\n  state, e, renderer, ranges, targetSize\n}) {\n  if (state.started) {\n    return;\n  }\n  const x = (e.center.x - e.deltaX);\n  const y = (e.center.y - e.deltaY);\n  let target = document.elementFromPoint(x, y);\n  if (!renderer.element().contains(target)) {\n    target = null;\n  }\n\n  const tempState = {\n    started: true\n  };\n\n  state.offset = extend({}, renderer.element().getBoundingClientRect());\n  const relX = x - state.offset.left; // coordinate relative renderer\n  const relY = y - state.offset.top;\n  state.offset.left += state.targetRect ? state.targetRect.x : 0; // make offset relative to targetRect\n  state.offset.top += state.targetRect ? state.targetRect.y : 0;\n  state.ranges = ranges(state, state.fauxBrushInstance || state.brushInstance);\n  const startPoint = (e.center[state.cssCoord.coord] - e[state.cssCoord.pos]) - state.offset[state.cssCoord.offset];\n  const relStart = (e.center[state.cssCoord.coord]) - state.offset[state.cssCoord.offset];\n  tempState.current = state.scale.normInvert(relStart / state.size);\n  tempState.start = state.scale.normInvert(startPoint / state.size);\n\n  let rs = state.ranges;\n  const limits = rangelimits(state);\n  let i;\n  let activeIdx = -1;\n  if (target && target.hasAttribute('data-idx')) {\n    activeIdx = parseInt(target.getAttribute('data-idx'), 10);\n    limits.min = activeIdx > 0 ? rs[activeIdx - 1].max : limits.min;\n    limits.max = activeIdx + 1 < rs.length ? rs[activeIdx + 1].min : limits.max;\n  } else {\n    for (i = 0; i < rs.length; i++) {\n      if (rs[i].min <= tempState.start && tempState.start <= rs[i].max) {\n        activeIdx = i;\n        limits.min = i ? rs[i - 1].max : limits.min;\n        limits.max = i + 1 < rs.length ? rs[i + 1].min : limits.max;\n        break;\n      } else if (tempState.start < rs[i].min) {\n        limits.max = rs[i].min;\n        limits.min = i ? rs[i - 1].max : limits.min;\n        break;\n      }\n    }\n    if (activeIdx === -1 && rs.length && i >= rs.length) {\n      limits.min = rs[rs.length - 1].max;\n    }\n  }\n\n  if (activeIdx === -1 && !state.multi) {\n    tempState.ranges = [];\n    limits.min = state.scale.min();\n    limits.max = state.scale.max();\n  }\n  let activeRange;\n\n  if (activeIdx !== -1) {\n    activeRange = {\n      idx: activeIdx,\n      start: rs[activeIdx].min,\n      end: rs[activeIdx].max,\n      limitLow: limits.min,\n      limitHigh: limits.max,\n      mode: 'move'\n    };\n\n    if (target && target.hasAttribute('data-other-value')) {\n      tempState.start = parseFloat(target.getAttribute('data-other-value'));\n      activeRange.mode = 'modify';\n    } else {\n      let pxStart = state.scale.norm(activeRange.start) * state.size;\n      let pxEnd = state.scale.norm(activeRange.end) * state.size;\n      if (Math.abs(startPoint - pxStart) <= targetSize) {\n        tempState.start = activeRange.end;\n        activeRange.mode = 'modify';\n      } else if (Math.abs(startPoint - pxEnd) <= targetSize) {\n        tempState.start = activeRange.start;\n        activeRange.mode = 'modify';\n      }\n    }\n  } else {\n    activeRange = {\n      idx: -1,\n      start: tempState.start,\n      end: tempState.current,\n      limitLow: limits.min,\n      limitHigh: limits.max,\n      mode: 'current'\n    };\n  }\n\n  tempState.active = activeRange;\n\n  if (activeRange.mode !== 'modify' && state.targetRect && !Collisions.testRectPoint(state.targetRect, { x: relX, y: relY })) {\n    // do nothing\n  } else {\n    Object.keys(tempState).forEach(key => (state[key] = tempState[key]));\n  }\n}\nexport function end(state, ranges) {\n  state.started = false;\n  state.ranges = ranges(state, state.fauxBrushInstance || state.brushInstance);\n  const limits = rangelimits(state);\n  findActive(state, state.current, limits);\n}\n\nexport function endArea(state, ranges) {\n  state.started = false;\n  state.ranges = ranges(state);\n  const limits = areaLimits(state);\n  findActive(state, state.current, limits);\n}\n\nexport function move(state, e) {\n  const relY = e.center[state.cssCoord.coord] - state.offset[state.cssCoord.offset];\n  const rel = relY / state.size;\n  const v = state.scale.normInvert(rel);\n  state.current = Math.max(Math.min(v, state.active.limitHigh), state.active.limitLow);\n}\n\nexport function moveArea(state, e) {\n  const rel = e.center[state.cssCoord.coord] - state.offset[state.cssCoord.offset];\n\n  state.current = Math.max(Math.min(rel, state.active.limitHigh), state.active.limitLow);\n}\n","import {\n  nodes,\n  getMoveDelta\n} from './brush-range-node-builder';\nimport { start, end, move } from './brush-range-interaction';\nimport linear from '../../../core/scales/linear';\nimport { scaleWithSize } from '../../../core/scales';\nimport brushFactory from '../../../core/brush';\nimport {\n  TARGET_SIZE,\n  VERTICAL,\n  HORIZONTAL\n} from './brush-range-const';\nimport {\n  pointsToRect,\n  rectToPoints\n} from '../../../core/geometry/util';\n\nfunction render(state) {\n  state.renderer.render(nodes(state));\n}\n\nfunction ranges(state, brush) {\n  if (!brush || !brush.isActive()) {\n    return [];\n  }\n\n  const sourceData = state.scale.data();\n  const sourceFields = sourceData ? sourceData.fields || [] : [];\n  const sources = sourceFields.map(field => field.id());\n  const rangeBrush = brush.brushes().filter(f => f.type === 'range' && sources.indexOf(f.id) !== -1)[0];\n\n  if (!rangeBrush) {\n    return [];\n  }\n\n  return rangeBrush.brush.ranges();\n}\n\nfunction setRanges(state) {\n  let rs = state.ranges.map(r => ({ min: r.min, max: r.max }));\n  if (state.active.idx !== -1) {\n    if (state.active.mode === 'modify') {\n      rs[state.active.idx].min = Math.min(state.start, state.current);\n      rs[state.active.idx].max = Math.max(state.start, state.current);\n    } else {\n      const delta = getMoveDelta(state);\n      rs[state.active.idx].min += delta;\n      rs[state.active.idx].max += delta;\n    }\n  } else {\n    rs.push({\n      min: Math.min(state.start, state.current),\n      max: Math.max(state.start, state.current)\n    });\n  }\n\n  const scaleData = state.scale.data();\n  if (scaleData && scaleData.fields) {\n    scaleData.fields.forEach((field) => {\n      if (state.fauxBrushInstance) {\n        let ordRS = ranges(state, state.fauxBrushInstance);\n        let oldValues = state.findValues(ordRS);\n        let values = state.findValues(rs);\n\n        let addedValues = values.filter(v => oldValues.indexOf(v) === -1);\n        let removedValues = oldValues.filter(v => values.indexOf(v) === -1);\n\n        let addItems = addedValues.map(v => ({ key: field.id(), value: v }));\n        let removeItems = removedValues.map(v => ({ key: field.id(), value: v }));\n\n        state.brushInstance.addAndRemoveValues(addItems, removeItems);\n\n        state.fauxBrushInstance.setRange(field.id(), rs);\n      } else {\n        state.brushInstance.setRange(field.id(), rs);\n      }\n    });\n  }\n}\n\nfunction findClosest(value, scale) {\n  let name;\n  let minDist = Infinity;\n  const domain = scale.domain();\n  const halfBandwidth = scale.bandwidth() / 2;\n  for (let i = 0; i < domain.length; ++i) {\n    const d = Math.abs(value - halfBandwidth - scale(domain[i]));\n    if (d < minDist) {\n      minDist = d;\n      name = domain[i];\n    }\n  }\n  return name;\n}\n\nfunction findClosestLabel(value, scale) {\n  const ticks = scale.ticks();\n  const idx = scale.domain().indexOf(findClosest(value, scale));\n  return idx !== -1 ? ticks[idx].label : '-';\n}\n\nfunction rangesOverlap(r1, r2) {\n  return Math.min(...r1) <= Math.max(...r2) && Math.max(...r1) >= Math.min(...r2);\n}\n\nfunction findValues(rangesValues, scale) {\n  const domain = scale.domain();\n  const scaleRange = scale.range();\n  const values = [];\n  rangesValues.forEach((range) => {\n    if (!rangesOverlap(scaleRange, [range.min, range.max])) {\n      return;\n    }\n    const startIdx = domain.indexOf(findClosest(range.min, scale));\n    const endIdx = domain.indexOf(findClosest(range.max, scale));\n    values.push.apply(values, domain.slice(Math.min(startIdx, endIdx), Math.max(startIdx, endIdx) + 1)); /* eslint prefer-spread:0 */\n  });\n\n  return values;\n}\n\nfunction resolveNodeBounds(targetNodes) {\n  const points = targetNodes.reduce((ary, node) => {\n    ary.push(...rectToPoints(node.bounds));\n    return ary;\n  }, []);\n  return pointsToRect(points);\n}\n\nfunction resolveTarget(ctx) {\n  const resolved = {\n    targetRect: null,\n    targetFillRect: null,\n    scale: null,\n    size: null\n  };\n  const stngs = ctx.settings.settings;\n  const target = stngs.target ? ctx.chart.component(stngs.target.component) : null;\n  const targetNodes = stngs.target && stngs.target.selector ? ctx.chart.findShapes(stngs.target.selector) : [];\n  const targetFillNodes = stngs.target && stngs.target.fillSelector ? ctx.chart.findShapes(stngs.target.fillSelector) : [];\n  if (targetNodes.length > 0) {\n    const bounds = resolveNodeBounds(targetNodes);\n    resolved.size = bounds[ctx.state.direction === VERTICAL ? 'height' : 'width'];\n    resolved.scale = scaleWithSize(ctx.chart.scale(stngs.scale), resolved.size);\n    resolved.targetRect = bounds;\n    if (targetFillNodes.length > 0) {\n      const fillBounds = resolveNodeBounds(targetFillNodes);\n      resolved.targetFillRect = fillBounds;\n    }\n  } else if (target && target.rect) {\n    resolved.targetRect = {\n      x: target.rect.x - ctx.state.rect.x,\n      y: target.rect.y - ctx.state.rect.y,\n      width: target.rect.width,\n      height: target.rect.height\n    };\n  }\n\n  return resolved;\n}\n\n/**\n * @typedef {object} component--brush-range-settings\n * @property {string} brush - Brush context to apply changes to\n * @property {string} scale - Scale to extract data from\n * @property {string} [direction=vertical] - Rendering direction [horizontal|vertical]\n * @property {object} [bubbles]\n * @property {boolean} [bubbles.show=true] - True to show label bubble, false otherwise\n * @property {string} [bubbles.align=start] - Where to anchor bubble [start|end]\n * @property {object} [target]\n * @property {string} [target.component] - Render matching overlay on target component\n * @property {string} [target.selector] - Instead of targeting a component, target one or more shapes\n * @property {string} [target.fillSelector] - Target a subset of the selector as fill area. Only applicable if `selector` property is set\n */\n\n/**\n * @typedef {object} component--brush-range-style\n * @property {object} [bubble]\n * @property {string} [bubble.fontSize]\n * @property {string} [bubble.fontFamily]\n * @property {string} [bubble.fill]\n * @property {string} [bubble.color]\n * @property {string} [bubble.stroke]\n * @property {number} [bubble.strokeWidth]\n * @property {number} [bubble.borderRadius]\n * @property {object} [line]\n * @property {string} [line.stroke]\n * @property {number} [line.strokeWidth]\n * @property {object} [target]\n * @property {string} [target.fill]\n * @property {number} [target.strokeWidth]\n * @property {number} [target.opacity]\n */\n\nconst brushRangeComponent = {\n  require: ['chart', 'settings', 'renderer'],\n  defaultSettings: {\n    settings: {\n      bubbles: {\n        show: true,\n        align: 'start'\n      }\n    },\n    style: {\n      bubble: '$label-overlay',\n      line: '$shape-guide--inverted',\n      target: '$selection-area-target'\n    }\n  },\n  renderer: 'dom',\n  on: {\n    rangeStart(e) { this.start(e); },\n    rangeMove(e) { this.move(e); },\n    rangeEnd(e) { this.end(e); },\n    rangeClear(e) { this.clear(e); }\n  },\n  created() {\n    this.state = {};\n  },\n  beforeRender(opts) {\n    this.state.rect = opts.size;\n  },\n  render(h) {\n    const stngs = this.settings.settings;\n    this.state.direction = stngs.direction === 'vertical' ? VERTICAL : HORIZONTAL;\n    const offset = this.renderer.element().getBoundingClientRect();\n    const size = this.state.rect[this.state.direction === VERTICAL ? 'height' : 'width'];\n    let scale = scaleWithSize(this.chart.scale(stngs.scale), size);\n\n    const target = resolveTarget(this);\n    scale = target.scale ? target.scale : scale;\n    this.state.targetRect = target.targetRect;\n    this.state.targetFillRect = target.targetFillRect;\n    this.state.size = target.size === null ? size : target.size;\n\n    this.state.settings = stngs;\n    this.state.style = this.style;\n    this.state.offset = offset;\n    this.state.brush = stngs.brush;\n    this.state.brushInstance = this.chart.brush(this.state.brush);\n    this.state.renderer = this.renderer;\n    this.state.multi = !!stngs.multiple;\n    this.state.h = h;\n    this.state.cssCoord = {\n      offset: this.state.direction === VERTICAL ? 'top' : 'left',\n      coord: this.state.direction === VERTICAL ? 'y' : 'x',\n      pos: this.state.direction === VERTICAL ? 'deltaY' : 'deltaX'\n    };\n\n    if (!{}.hasOwnProperty.call(scale, 'norm')) { // Non-linear scale if norm method is unavailable\n      this.state.scale = linear();\n      this.state.scale.data = scale.data;\n      this.state.format = (v, r) => {\n        if (!rangesOverlap(scale.range(), r)) {\n          return '-';\n        }\n        return findClosestLabel(v, scale);\n      };\n      this.state.fauxBrushInstance = brushFactory();\n      this.state.findValues = valueRanges => findValues(valueRanges, scale);\n    } else {\n      this.state.fauxBrushInstance = null;\n      this.state.findValues = null;\n      this.state.scale = scale;\n      const scaleData = this.state.scale.data();\n      if (scaleData && scaleData.fields && scaleData.fields[0]) {\n        this.state.format = scaleData.fields[0].formatter();\n      }\n    }\n    return [];\n  },\n  start(e) {\n    start({\n      e,\n      state: this.state,\n      renderer: this.renderer,\n      ranges,\n      targetSize: TARGET_SIZE\n    });\n  },\n  end() {\n    if (!this.state.started) {\n      return;\n    }\n    end(this.state, ranges);\n    render(this.state);\n  },\n  move(e) {\n    if (!this.state.started) {\n      return;\n    }\n    move(this.state, e);\n    setRanges(this.state);\n    render(this.state);\n  },\n  clear() {\n    if (this.state.fauxBrushInstance) {\n      this.state.fauxBrushInstance.clear();\n    }\n    this.state.renderer.render([]);\n  }\n};\n\nexport default brushRangeComponent;\n","import {\n  getMoveDelta,\n  nodes\n} from './brush-range-node-builder';\nimport {\n  startArea,\n  moveArea,\n  endArea\n} from './brush-range-interaction';\nimport rangeCollection from '../../../core/brush/range-collection';\nimport {\n  TARGET_SIZE,\n  VERTICAL,\n  HORIZONTAL\n} from './brush-range-const';\n\nfunction render(state) {\n  state.renderer.render(nodes(state));\n}\n\nfunction ranges(state) {\n  return state.rc.ranges();\n}\n\nfunction shapesFromRange(state, brushRange) {\n  const shapeAt = {\n    x: state.direction ? brushRange.min + state.rect.x : state.rect.x,\n    y: state.direction ? state.rect.y : brushRange.min + state.rect.y,\n    width: state.direction ? brushRange.max - brushRange.min : state.rect.width + state.rect.x,\n    height: state.direction ? state.rect.height + state.rect.y : brushRange.max - brushRange.min\n  };\n  return state.chart.shapesAt(shapeAt, state.settings.brush);\n}\n\nfunction brushFromShape(state, newShapes) {\n  state.chart.brushFromShapes(newShapes, state.settings.brush);\n}\n\nfunction setRanges(state) {\n  const rs = state.ranges.map(r => ({ min: r.min, max: r.max }));\n\n  if (state.active.idx !== -1) {\n    if (state.active.mode === 'modify') {\n      rs[state.active.idx].min = Math.min(state.start, state.current);\n      rs[state.active.idx].max = Math.max(state.start, state.current);\n    } else {\n      const delta = getMoveDelta(state);\n      rs[state.active.idx].min = state.active.start + delta;\n      rs[state.active.idx].max = state.active.end + delta;\n    }\n  } else {\n    rs.push({\n      min: Math.min(state.start, state.current),\n      max: Math.max(state.start, state.current)\n    });\n  }\n\n  state.rc.set(rs);\n\n  const shapes = [];\n  rs.forEach((range) => {\n    shapes.push(...shapesFromRange(state, range));\n  });\n\n  brushFromShape(state, shapes);\n}\n\nfunction getBubbleLabel(state, value, range) {\n  const min = Math.min(...range);\n  const max = Math.max(...range);\n  const shapeAt = {\n    x: state.direction ? min + state.rect.x : state.rect.x,\n    y: state.direction ? state.rect.y : min + state.rect.y,\n    width: state.direction ? max - min : state.rect.width + state.rect.x,\n    height: state.direction ? state.rect.height + state.rect.y : max - min\n  };\n\n  const shapes = state.chart.shapesAt(shapeAt, state.settings.brush);\n\n  if (shapes.length === 0) {\n    return '-';\n  }\n\n  const labelShape = shapes.reduce((s0, s1) => {\n    // Min value\n    const bounds0 = s0.bounds;\n    const bounds1 = s1.bounds;\n\n    if (value === min) {\n      if (bounds0[state.cssCoord.coord] <= bounds1[state.cssCoord.coord]) {\n        return s0;\n      }\n      return s1;\n    }\n\n    // Max value\n    if (bounds0[state.cssCoord.coord] + bounds0[state.cssCoord.area] >= bounds1[state.cssCoord.coord] + bounds1[state.cssCoord.area]) {\n      return s0;\n    }\n    return s1;\n  });\n\n  const compConfig = state.settings.brush.components.reduce((c0, c1) => (c0.key === labelShape.key ? c0 : c1));\n\n  if (typeof state.settings.bubbles.label === 'function') {\n    return state.settings.bubbles.label(labelShape.data);\n  } else if (Array.isArray(compConfig.data) && compConfig.data.length) {\n    return labelShape.data[compConfig.data[0]].label;\n  }\n\n  return labelShape.data && labelShape.data.label ? labelShape.data.label : '-';\n}\n\n/**\n * @typedef {object} component--brush-area-dir-settings\n * @property {object} brush\n * @property {array} brush.components\n * @property {object} brush.components[].key - Component key\n * @property {object} brush.components[].contexts[] - Brush context to apply changes to\n * @property {object} [brush.components[].data] - Data reference\n * @property {object} [brush.components[].action] - Type of brush action\n * @property {string} [direction=vertical] - Rendering direction [horizontal|vertical]\n * @property {object} [bubbles]\n * @property {boolean} [bubbles.show=true] - True to show label bubble, false otherwise\n * @property {string} [bubbles.align=start] - Where to anchor bubble [start|end]\n * @property {function} [bubbles.label] - Callback function for the labels\n * @property {object} [target]\n * @property {string} [target.component] - Render matching overlay on target component\n */\n\n/**\n * @typedef {object} component--brush-area-dir-style\n * @property {object} [bubble]\n * @property {string} [bubble.fontSize]\n * @property {string} [bubble.fontFamily]\n * @property {string} [bubble.fill]\n * @property {string} [bubble.color]\n * @property {string} [bubble.stroke]\n * @property {number} [bubble.strokeWidth]\n * @property {number} [bubble.borderRadius]\n * @property {object} [line]\n * @property {string} [line.stroke]\n * @property {number} [line.strokeWidth]\n * @property {object} [target]\n * @property {string} [target.fill]\n * @property {number} [target.strokeWidth]\n * @property {number} [target.opacity]\n */\n\nconst brushAreaDirectionalComponent = {\n  require: ['chart', 'settings', 'renderer'],\n  defaultSettings: {\n    settings: {\n      bubbles: {\n        show: true,\n        align: 'start'\n      }\n    },\n    style: {\n      bubble: '$label-overlay',\n      line: '$shape-guide--inverted',\n      target: '$selection-area-target'\n    }\n  },\n  renderer: 'dom',\n  on: {\n    areaStart(e) { this.start(e); },\n    areaMove(e) { this.move(e); },\n    areaEnd(e) { this.end(e); },\n    areaClear(e) { this.clear(e); }\n  },\n  created() {\n    this.rect = {\n      x: 0, y: 0, width: 0, height: 0\n    };\n    this.state = {};\n  },\n  beforeRender(opts) {\n    this.rect = opts.size;\n  },\n  render(h) {\n    this.state.rect = this.rect;\n\n    const stngs = this.settings.settings;\n    const direction = stngs.direction === 'vertical' ? VERTICAL : HORIZONTAL;\n    const size = this.state.rect[direction === VERTICAL ? 'height' : 'width'];\n    const offset = this.renderer.element().getBoundingClientRect();\n\n    const target = stngs.target ? this.chart.component(stngs.target.component) : null;\n    if (target && target.rect) {\n      this.state.targetRect = {\n        x: (target.rect.x - this.rect.x),\n        y: (target.rect.y - this.rect.y),\n        width: target.rect.width,\n        height: target.rect.height\n      };\n    } else {\n      this.state.targetRect = null;\n    }\n    this.state.style = this.style;\n    this.state.chart = this.chart;\n    this.state.direction = direction;\n    this.state.settings = stngs;\n    this.state.offset = offset;\n    this.state.rc = rangeCollection();\n    this.state.renderer = this.renderer;\n    this.state.multi = !!stngs.multiple;\n    this.state.h = h;\n    this.state.size = size;\n    this.state.cssCoord = {\n      offset: this.state.direction === VERTICAL ? 'top' : 'left',\n      coord: this.state.direction === VERTICAL ? 'y' : 'x',\n      pos: this.state.direction === VERTICAL ? 'deltaY' : 'deltaX',\n      area: this.state.direction === VERTICAL ? 'height' : 'width'\n    };\n\n    this.state.format = function getFormat(v, r) {\n      return getBubbleLabel(this, v, r);\n    };\n\n    return [];\n  },\n  start(e) {\n    startArea({\n      e,\n      state: this.state,\n      renderer: this.renderer,\n      ranges,\n      targetSize: TARGET_SIZE\n    });\n  },\n  end() {\n    if (!this.state.started) {\n      return;\n    }\n    endArea(this.state, ranges);\n    render(this.state);\n  },\n  move(e) {\n    if (!this.state.started) {\n      return;\n    }\n    moveArea(this.state, e);\n    setRanges(this.state);\n    render(this.state);\n  },\n  clear() {\n    if (this.state.rc) {\n      this.state.rc.clear();\n    }\n    this.state.renderer.render([]);\n  }\n};\n\nexport default brushAreaDirectionalComponent;\n","import rangeBrushComponent from './brush-range';\nimport brushAreaDirectionalComponent from './brush-area-dir';\n\nexport default function rangeBrush(picasso) {\n  picasso.component('brush-range', rangeBrushComponent);\n  picasso.component('brush-area-dir', brushAreaDirectionalComponent);\n}\n","import { scaleWithSize } from '../../scales';\n\nconst FILL = '#ccc';\nconst OPACITY = 1;\n\nfunction ranges(state) {\n  const brush = state.brush;\n  if (!brush || !brush.isActive()) {\n    return [];\n  }\n\n  const sourceData = state.scale.data();\n  const sourceFields = sourceData ? sourceData.fields || [] : [];\n  const sources = sourceFields.map(field => field.id());\n  const rangeBrush = brush.brushes().filter(f => f.type === 'range' && sources.indexOf(f.id) !== -1)[0];\n\n  if (!rangeBrush) {\n    return [];\n  }\n\n  return rangeBrush.brush.ranges();\n}\n\nfunction shapes(state) {\n  const isVertical = state.direction === 'vertical';\n  const size = state.rect[isVertical ? 'height' : 'width'];\n  const otherSize = state.rect[isVertical ? 'width' : 'height'];\n  return ranges(state).map((range) => {\n    const start = state.scale(range.min) * size;\n    const end = state.scale(range.max) * size;\n    const low = Math.min(start, end);\n    const s = Math.abs(start - end);\n    return {\n      type: 'rect',\n      fill: state.fill,\n      opacity: state.opacity,\n      x: isVertical ? 0 : low,\n      width: isVertical ? otherSize : s,\n      y: isVertical ? low : 0,\n      height: isVertical ? s : otherSize\n    };\n  });\n}\n\nfunction onStart(state) {\n  state.renderer.render(shapes(state));\n}\n\nfunction onUpdate(state) {\n  state.renderer.render(shapes(state));\n}\n\nfunction onEnd(state) {\n  state.renderer.render(shapes(state));\n}\n\nfunction setup(state, brush, scale, renderer) {\n  state.brush = brush;\n\n  if (!brush) {\n    return;\n  }\n\n  function start() {\n    onStart(state);\n  }\n\n  function update() {\n    onUpdate(state);\n  }\n\n  function end() {\n    onEnd(state);\n  }\n\n  brush.on('start', start);\n  brush.on('update', update);\n  brush.on('end', end);\n\n  state.start = start;\n  state.update = update;\n  state.end = end;\n  state.brush = brush;\n  state.scale = scale;\n  state.renderer = renderer;\n}\n\nfunction teardown(state) {\n  if (state.brush) {\n    state.brush.removeListener('start', state.start);\n    state.brush.removeListener('update', state.update);\n    state.brush.removeListener('end', state.end);\n  }\n\n  state.start = undefined;\n  state.update = undefined;\n  state.end = undefined;\n  state.brush = undefined;\n  state.scale = undefined;\n  state.renderer = undefined;\n}\n\n/**\n * @typedef {object} component--range\n */\n\n/**\n * @typedef {object} component--range.settings\n * @property {string} brush - Name of brush instance\n * @property {string} scale - Name of a scale\n * @property {string} [direction='horizontal'] - Direction of the brush\n * @property {string} [fill='#ccc'] - Fill color\n * @property {number} [opacity=1] - Layer opacity\n */\n\nconst rangeComponent = {\n  require: ['chart', 'settings', 'renderer'],\n  defaultSettings: {\n    settings: {}\n  },\n  preferredSize: () => 50,\n  created() {\n    this.rect = {\n      x: 0, y: 0, width: 0, height: 0\n    };\n    this.state = {};\n  },\n  beforeRender(opts) {\n    this.rect = opts.size;\n  },\n  render() {\n    const stngs = this.settings.settings;\n    const brush = this.chart.brush(stngs.brush);\n    const direction = stngs.direction || 'horizontal';\n    const distance = direction === 'horizontal' ? this.rect.width : this.rect.height;\n    const scale = scaleWithSize(this.chart.scale(stngs.scale), distance);\n\n    teardown(this.state);\n    setup(this.state, brush, scale, this.renderer);\n\n    this.state.rect = this.rect;\n    this.state.fill = stngs.fill || FILL;\n    this.state.opacity = typeof stngs.opacity !== 'undefined' ? stngs.opacity : OPACITY;\n    this.state.direction = direction;\n\n    return shapes(this.state);\n  },\n  beforeDestroy() {\n    teardown(this.state);\n  }\n};\n\nexport default rangeComponent;\n","import rangeBrushComponent from './range';\n\nexport default function rangeBrush(picasso) {\n  picasso.component('range', rangeBrushComponent);\n}\n","import { sqrDistance } from '../../math/vector';\n\nfunction getPoint(rendererBounds, event) {\n  const eventOffsetX = event.center.x;\n  const eventOffsetY = event.center.y;\n  return {\n    x: eventOffsetX - rendererBounds.left,\n    y: eventOffsetY - rendererBounds.top\n  };\n  // return {\n  //   x: Math.min(Math.max(eventOffsetX - rendererBounds.left, 0), rendererBounds.width),\n  //   y: Math.min(Math.max(eventOffsetY - rendererBounds.top, 0), rendererBounds.height)\n  // };\n}\n\nfunction withinThreshold(p, state, settings) {\n  const startPoint = state.points[0];\n  const sqrDist = sqrDistance(p, startPoint);\n  return sqrDist < Math.pow(settings.settings.snapIndicator.threshold, 2);\n}\n\nfunction appendToPath(state, p) {\n  if (state.path.d == null) {\n    state.path.d = `M${p.x} ${p.y} `;\n  } else {\n    state.path.d += `L${p.x} ${p.y} `;\n  }\n  state.points.push(p);\n}\n\nfunction render(state, renderer) {\n  const nodes = [\n    state.startPoint,\n    state.path,\n    state.snapIndicator\n  ].filter(node => node.visible);\n\n  renderer.render(nodes);\n}\n\nfunction setSnapIndictor({ state, start = null, end = null }) {\n  if (start !== null) {\n    state.snapIndicator.x1 = start.x;\n    state.snapIndicator.y1 = start.y;\n  }\n  if (end !== null) {\n    state.snapIndicator.x2 = end.x;\n    state.snapIndicator.y2 = end.y;\n  }\n}\n\nfunction showSnapIndicator(state, show) {\n  state.snapIndicator.visible = show;\n}\n\nfunction setStartPoint(state, p) {\n  state.startPoint.cx = p.x;\n  state.startPoint.cy = p.y;\n}\n\nfunction getComponentDelta(chart, rendererBounds) {\n  const chartBounds = chart.element.getBoundingClientRect();\n  return {\n    x: rendererBounds.left - chartBounds.left,\n    y: rendererBounds.top - chartBounds.top\n  };\n}\n\nfunction doLineBrush(state, chart) {\n  if (state.active) {\n    const p1 = state.points[state.points.length - 2];\n    const p2 = state.points[state.points.length - 1];\n    state.lineBrushShape.x1 = p1.x + state.componentDelta.x;\n    state.lineBrushShape.y1 = p1.y + state.componentDelta.y;\n    state.lineBrushShape.x2 = p2.x + state.componentDelta.x;\n    state.lineBrushShape.y2 = p2.y + state.componentDelta.y;\n\n    const shapes = chart.shapesAt(state.lineBrushShape, { components: state.brushConfig });\n    chart.brushFromShapes(shapes, { components: state.brushConfig });\n  }\n}\n\nfunction doPolygonBrush(state, chart) {\n  if (state.active) {\n    const dx = state.componentDelta.x;\n    const dy = state.componentDelta.y;\n    const vertices = state.points.map(p => ({\n      x: p.x + dx,\n      y: p.y + dy\n    }));\n\n    const shapes = chart.shapesAt({ vertices }, { components: state.brushConfig });\n    chart.brushFromShapes(shapes, { components: state.brushConfig });\n  }\n}\n\nfunction initPath(stgns) {\n  return {\n    visible: true,\n    type: 'path',\n    d: null,\n    fill: stgns.fill,\n    stroke: stgns.stroke,\n    strokeWidth: stgns.strokeWidth,\n    opacity: stgns.opacity,\n    strokeDasharray: stgns.strokeDasharray,\n    collider: {\n      type: null\n    }\n  };\n}\n\nfunction initSnapIndicator(stgns) {\n  return {\n    visible: false,\n    type: 'line',\n    x1: 0,\n    y1: 0,\n    x2: 0,\n    y2: 0,\n    strokeDasharray: stgns.strokeDasharray,\n    stroke: stgns.stroke,\n    strokeWidth: stgns.strokeWidth,\n    opacity: stgns.opacity,\n    collider: {\n      type: null\n    }\n  };\n}\n\nfunction initStartPoint(stgns) {\n  return {\n    visible: true,\n    type: 'circle',\n    cx: 0,\n    cy: 0,\n    r: stgns.r,\n    fill: stgns.fill,\n    opacity: stgns.opacity,\n    stroke: stgns.stroke,\n    strokeWidth: stgns.strokeWidth,\n    collider: {\n      type: null\n    }\n  };\n}\n\nfunction getBrushConfig(settings) {\n  return settings.settings.brush.components.map(b => (\n    {\n      key: b.key,\n      contexts: b.contexts || ['lassoBrush'],\n      data: b.data || [''],\n      action: b.action || 'add'\n    }));\n}\n\nfunction endBrush(state, chart) {\n  state.brushConfig.forEach((config) => {\n    config.contexts.forEach((context) => {\n      chart.brush(context).end();\n    });\n  });\n}\n\nfunction resetState() {\n  return {\n    points: [],\n    active: false,\n    path: null,\n    snapIndicator: null,\n    startPoint: null,\n    rendererBounds: null,\n    componentDelta: null,\n    brushConfig: null,\n    lineBrushShape: {\n      x1: 0, y1: 0, x2: 0, y2: 0\n    } // Keep a single shape instance to avoid instantiating a new object on each lookup\n  };\n}\n\n/**\n * @typedef {object} component--brush-lasso\n */\n\n/**\n * @typedef {object} component--brush-lasso-settings\n * @property {object} [lasso] - Lasso style settings\n * @property {string} [lasso.fill='transparent']\n * @property {string} [lasso.stroke='black']\n * @property {number} [lasso.strokeWidth=2]\n * @property {number} [lasso.opacity=0.7]\n * @property {number} [lasso.strokeDasharray]\n * @property {object} [snapIndicator] - Snap indicator settings\n * @property {number} [snapIndicator.threshold=75] - The distance in pixel to show the snap indicator, if less then threshold the indicator is dispalyed\n * @property {string} [snapIndicator.strokeDasharray='5, 5']\n * @property {string} [snapIndicator.stroke='black']\n * @property {number} [snapIndicator.strokeWidth=2]\n * @property {number} [snapIndicator.opacity=0.5]\n * @property {object} [startPoint] - Start point style settings\n * @property {number} [startPoint.r=10] - Circle radius\n * @property {string} [startPoint.stroke='green']\n * @property {number} [startPoint.strokeWidth=1]\n * @property {number} [startPoint.opacity=1]\n * @property {object} [brush]\n * @property {object[]} brush.components - Array of components to brush on.\n * @property {string} [brush.components[].component.key] - Component key\n * @property {string[]} [brush.components[].component.contexts=['brushLasso']] - Name of the brushing contexts to affect\n * @property {string[]} [brush.components[].component.data=['']] - The mapped data properties to add to the brush\n * @property {string} [brush.components[].component.action='add'] - Type of action to respond with\n */\n\nconst brushLassoComponent = {\n  require: ['chart', 'renderer', 'settings'],\n  defaultSettings: {\n    displayOrder: 0,\n    settings: {\n      brush: {\n        components: []\n      },\n      snapIndicator: {\n        threshold: 75,\n        strokeDasharray: '5, 5',\n        stroke: 'black',\n        strokeWidth: 2,\n        opacity: 0.5\n      },\n      lasso: {\n        fill: 'transparent',\n        stroke: 'black',\n        strokeWidth: 2,\n        opacity: 0.7,\n        strokeDasharray: '20, 10'\n      },\n      startPoint: {\n        r: 10,\n        fill: 'green',\n        stroke: 'black',\n        strokeWidth: 1,\n        opacity: 1\n      }\n    }\n  },\n  on: {\n    lassoStart(e) {\n      this.start(e);\n    },\n    lassoEnd(e) {\n      this.end(e);\n    },\n    lassoMove(e) {\n      this.move(e);\n    },\n    lassoCancel() {\n      this.cancel();\n    }\n  },\n  created() {\n    this.state = resetState();\n  },\n  start(e) {\n    this.state.active = true;\n    this.state.path = initPath(this.settings.settings.lasso);\n    this.state.snapIndicator = initSnapIndicator(this.settings.settings.snapIndicator);\n    this.state.startPoint = initStartPoint(this.settings.settings.startPoint);\n    this.state.rendererBounds = this.renderer.element().getBoundingClientRect();\n    this.state.componentDelta = getComponentDelta(this.chart, this.state.rendererBounds);\n    this.state.brushConfig = getBrushConfig(this.settings);\n\n    const p = getPoint(this.state.rendererBounds, e);\n\n    appendToPath(this.state, p);\n    setSnapIndictor({ state: this.state, start: p });\n    setStartPoint(this.state, p);\n  },\n  move(e) {\n    if (!this.state.active) {\n      return;\n    }\n\n    const p = getPoint(this.state.rendererBounds, e);\n\n    if (withinThreshold(p, this.state, this.settings)) {\n      showSnapIndicator(this.state, true);\n    } else {\n      showSnapIndicator(this.state, false);\n    }\n\n    appendToPath(this.state, p);\n    setSnapIndictor({ state: this.state, end: p });\n    render(this.state, this.renderer);\n\n    doLineBrush(\n      this.state,\n      this.chart\n    );\n  },\n  end(e) {\n    if (!this.state.active) {\n      return;\n    }\n\n    showSnapIndicator(this.state, false);\n    const p = getPoint(this.state.rendererBounds, e);\n    const shouldSnap = withinThreshold(p, this.state, this.settings);\n\n    if (shouldSnap) {\n      doPolygonBrush(this.state, this.chart);\n    }\n\n    this.state = resetState();\n    this.renderer.render([]);\n  },\n  cancel() {\n    if (!this.state.active) {\n      return;\n    }\n    endBrush(this.state, this.chart);\n    this.state = resetState();\n    this.renderer.render([]);\n  },\n  render() {\n    // Do nothing\n  }\n};\n\nexport default brushLassoComponent;\n","import lassoBrushComponent from './brush-lasso';\n\nexport default function lassoBrush(picasso) {\n  picasso.component('brush-lasso', lassoBrushComponent);\n}\n","import extend from 'extend';\nimport collisions from '../../../math/narrow-phase-collision';\n\nconst LINE_HEIGHT = 1.5;\nconst PADDING = 4;\n// const DOUBLE_PADDING = PADDING * 2;\n\nfunction cbContext(node, chart) {\n  return {\n    node,\n    data: node.data,\n    scale: chart.scale,\n    formatter: chart.formatter,\n    dataset: chart.dataset\n  };\n}\n\nexport function placeTextInRect(rect, text, opts) {\n  const label = {\n    type: 'text',\n    text,\n    maxWidth: opts.rotate ? rect.height : rect.width,\n    x: 0,\n    y: rect.y,\n    dx: 0,\n    dy: 0,\n    fill: opts.fill,\n    anchor: opts.rotate ? 'end' : 'start',\n    baseline: 'alphabetical',\n    fontSize: `${opts.fontSize}px`,\n    fontFamily: opts.fontFamily\n  };\n\n  const textMetrics = opts.textMetrics;\n\n  if (rect.width < opts.fontSize || rect.height < textMetrics.height) {\n    return false;\n  }\n\n  if (opts.rotate) {\n    const wiggleHor = Math.max(0, rect.width - (textMetrics.height / (LINE_HEIGHT * 0.8)));\n    const wiggleVert = Math.max(0, rect.height - textMetrics.width);\n    label.x = rect.x + (textMetrics.height / LINE_HEIGHT) + (opts.align * wiggleHor);\n    label.y = rect.y + (opts.justify * wiggleVert);\n    label.transform = `rotate(-90, ${label.x + label.dx}, ${label.y + label.dy})`;\n  } else {\n    const wiggleWidth = Math.max(0, rect.width - textMetrics.width);\n    const wiggleHeight = Math.max(0, rect.height - (textMetrics.height / (LINE_HEIGHT * 0.8))); // 0.8 - MAGIC NUMBER - need to figure out why this works the best\n    label.x = rect.x + (opts.align * wiggleWidth);\n    label.y = rect.y + (textMetrics.height / LINE_HEIGHT) + (opts.justify * wiggleHeight);\n  }\n\n  return label;\n}\n\nfunction limitBounds(bounds, view) {\n  const minY = Math.max(0, Math.min(bounds.y, view.height));\n  const maxY = Math.max(0, Math.min(bounds.y + bounds.height, view.height));\n  const minX = Math.max(0, Math.min(bounds.x, view.width));\n  const maxX = Math.max(0, Math.min(bounds.x + bounds.width, view.width));\n  bounds.x = minX;\n  bounds.width = maxX - minX;\n  bounds.y = minY;\n  bounds.height = maxY - minY;\n}\n\nfunction pad(bounds, padding) {\n  bounds.x += padding;\n  bounds.width -= (padding * 2);\n  bounds.y += padding;\n  bounds.height -= (padding * 2);\n}\n\nexport function getBarRect({\n  bar, view, direction, position, padding = PADDING\n}) {\n  const bounds = {};\n  extend(bounds, bar);\n\n  if (!position || position === 'inside') {\n    // do nothing\n  } else if (direction === 'up' || direction === 'down') {\n    const start = Math.max(0, Math.min(bar.y, view.height));\n    const end = Math.max(0, Math.min(bar.y + bar.height, view.height));\n\n    if ((position === 'outside' && direction === 'up') || (position === 'opposite' && direction === 'down')) {\n      bounds.y = 0;\n      bounds.height = start;\n    } else if ((position === 'outside' && direction === 'down') || (position === 'opposite' && direction === 'up')) {\n      bounds.y = end;\n      bounds.height = view.height - end;\n    }\n  } else {\n    const start = Math.max(0, Math.min(bar.x, view.width));\n    const end = Math.max(0, Math.min(bar.x + bar.width, view.width));\n\n    if ((position === 'outside' && direction === 'left') || (position === 'opposite' && direction === 'right')) {\n      bounds.x = 0;\n      bounds.width = start;\n    } else if ((position === 'outside' && direction === 'right') || (position === 'opposite' && direction === 'left')) {\n      bounds.x = end;\n      bounds.width = view.width - end;\n    }\n  }\n\n  limitBounds(bounds, view);\n  pad(bounds, padding);\n\n  return bounds;\n}\n\nexport function findBestPlacement({\n  direction,\n  fitsHorizontally,\n  // lblStngs,\n  measured,\n  node,\n  orientation,\n  // placements,\n  placementSettings,\n  rect\n}, barRect = getBarRect) {\n  let largest;\n  let bounds;\n  let placement;\n  let testBounds;\n  let p;\n  const boundaries = [];\n  for (p = 0; p < placementSettings.length; p++) {\n    placement = placementSettings[p];\n    testBounds = barRect({\n      bar: node.localBounds,\n      view: rect,\n      direction,\n      position: placement.position\n    });\n    boundaries.push(testBounds);\n    largest = !p || testBounds.height > largest.height ? testBounds : largest;\n\n    if (orientation === 'v' && ((fitsHorizontally && testBounds.height > measured.height * LINE_HEIGHT) ||\n      (!fitsHorizontally && testBounds.height > measured.width))) {\n      bounds = testBounds;\n      break;\n    } else if (orientation === 'h' && (testBounds.height > measured.height) &&\n      (testBounds.width > measured.width)) {\n      bounds = testBounds;\n      break;\n    }\n  }\n\n  // fallback strategy - place the text in the largest rectangle\n  if (!bounds) {\n    bounds = largest;\n    p = boundaries.indexOf(bounds);\n  }\n  placement = placementSettings[p];\n\n  return { bounds, placement };\n}\n\nexport function placeInBars(\n  {\n    chart,\n    targetNodes,\n    rect,\n    fitsHorizontally,\n    collectiveOrientation\n  }, findPlacement = findBestPlacement,\n  placer = placeTextInRect\n) {\n  const labels = [];\n  let label;\n  let target;\n  let node;\n  let text;\n  let justify;\n  let bounds;\n  let fill;\n  let measured;\n  let direction;\n  let lblStngs;\n  let placement;\n  let placements;\n  let arg;\n  let orientation;\n\n  for (let i = 0, len = targetNodes.length; i < len; i++) {\n    bounds = null;\n    target = targetNodes[i];\n    node = target.node;\n    arg = cbContext(node, chart);\n    direction = target.direction;\n    orientation = direction === 'left' || direction === 'right' ? 'h' : 'v';\n    for (let j = 0; j < target.texts.length; j++) {\n      text = target.texts[j];\n      if (!text) {\n        continue;\n      }\n\n      lblStngs = target.labelSettings[j];\n      measured = target.measurements[j];\n      placements = lblStngs.placements;\n\n      const bestPlacement = findPlacement({\n        direction,\n        fitsHorizontally,\n        lblStngs,\n        measured,\n        node,\n        orientation,\n        placements,\n        placementSettings: target.placementSettings[j],\n        rect\n      });\n\n      bounds = bestPlacement.bounds;\n      placement = bestPlacement.placement;\n\n      if (bounds && placement) {\n        justify = placement.justify;\n        fill = typeof placement.fill === 'function' ? placement.fill(arg, i) : placement.fill;\n\n        if (direction === 'up') {\n          justify = 1 - justify;\n        }\n        if (placement.position === 'opposite') {\n          justify = 1 - justify;\n        }\n\n        label = placer(bounds, text, {\n          fill,\n          justify: orientation === 'h' ? placement.align : justify,\n          align: orientation === 'h' ? justify : placement.align,\n          fontSize: lblStngs.fontSize,\n          fontFamily: lblStngs.fontFamily,\n          textMetrics: measured,\n          rotate: !(collectiveOrientation === 'h' || fitsHorizontally)\n        });\n\n        if (label) {\n          labels.push(label);\n        }\n      }\n    }\n  }\n\n  return labels;\n}\n\nexport function precalculate({\n  nodes,\n  rect,\n  chart,\n  labelSettings,\n  placementSettings,\n  settings,\n  renderer\n}) {\n  const labelStruct = {};\n  const targetNodes = [];\n  let target;\n  let fitsHorizontally = true;\n  let hasHorizontalDirection = false;\n  let node;\n  let text;\n  let bounds;\n  let measured;\n  let lblStng;\n  let direction;\n\n  for (let i = 0; i < nodes.length; i++) {\n    node = nodes[i];\n    bounds = node.localBounds;\n    if (!collisions.testRectRect(bounds, rect)) {\n      continue;\n    }\n    let arg = cbContext(node, chart);\n\n    target = {\n      node,\n      texts: [],\n      measurements: [],\n      labelSettings: [],\n      placementSettings: []\n      // direction: 'up'\n    };\n\n    for (let j = 0; j < labelSettings.length; j++) {\n      lblStng = labelSettings[j];\n      text = typeof lblStng.label === 'function' ? lblStng.label(arg, i) : '';\n      if (!text) {\n        continue; // eslint-ignore-line\n      }\n      direction = typeof settings.direction === 'function' ? settings.direction(arg, i) : settings.direction || 'up';\n      hasHorizontalDirection = hasHorizontalDirection || direction === 'left' || direction === 'right';\n\n      labelStruct.fontFamily = lblStng.fontFamily;\n      labelStruct.fontSize = `${lblStng.fontSize}px`;\n      labelStruct.text = text;\n\n      measured = renderer.measureText(labelStruct);\n      target.measurements.push(measured);\n      target.texts.push(text);\n      target.labelSettings.push(lblStng);\n      target.placementSettings.push(placementSettings[j]);\n      target.direction = direction;\n      fitsHorizontally = fitsHorizontally && measured.width <= (bounds.width - (PADDING * 2));\n    }\n\n    targetNodes.push(target);\n  }\n\n  return {\n    targetNodes,\n    fitsHorizontally,\n    hasHorizontalDirection\n  };\n}\n\n/**\n * @typedef {object} component--labels~label-strategy\n *\n */\n\n/**\n * @typedef {object} component--labels~label-strategy.settings\n * @property {string|function} [direction='up'] - The direction in which the bars are growing: 'up', 'down', 'right' or 'left'.\n * @property {string} [fontFamily='Arial']\n * @property {number} [fontSize=12]\n * @property {Array<object>} labels\n * @property {string|function} labels[].label - The text value\n * @property {Array<object>} labels[].placements\n * @property {string} labels[].placements[].position - 'inside' | 'outside' | 'opposite'\n * @property {number} [labels[].placements[].justify=0] - Placement of the label along the direction of the bar\n * @property {number} [labels[].placements[].align=0.5] - Placement of the label along the perpendicular direction of the bar\n * @property {string} [labels[].placements[].fill='#333'] - Color of the label\n */\n\nexport function bars({\n  settings,\n  chart,\n  nodes,\n  rect,\n  renderer,\n  style\n}, placer = placeInBars) {\n  const defaults = extend({\n    fontSize: 12,\n    fontFamily: 'Arial',\n    align: 0.5,\n    justify: 0,\n    fill: '#333'\n  }, style.label);\n\n  defaults.fontSize = parseInt(defaults.fontSize, 10);\n\n  const labelSettings = settings.labels.map(labelSetting =>\n    extend({}, defaults, settings, labelSetting));\n\n  const placementSettings = settings.labels.map(labelSetting =>\n    labelSetting.placements.map(placement =>\n      extend({}, defaults, settings, labelSetting, placement)));\n\n  const {\n    fitsHorizontally,\n    hasHorizontalDirection,\n    targetNodes\n  } = precalculate({\n    nodes,\n    chart,\n    renderer,\n    settings,\n    rect,\n    labelSettings,\n    placementSettings\n  });\n\n  return placer({\n    chart,\n    targetNodes,\n    stngs: settings,\n    rect,\n    fitsHorizontally,\n    collectiveOrientation: hasHorizontalDirection ? 'h' : 'v'\n  });\n}\n","import extend from 'extend';\nimport collisions from '../../../math/narrow-phase-collision';\n\nfunction pad(bounds, padding) {\n  bounds.x += padding;\n  bounds.width -= (padding * 2);\n  bounds.y += padding;\n  bounds.height -= (padding * 2);\n}\n\n// assume 0 <= angle < (PI / 2)\nfunction getLineCircleIntersection(radius, offset, angle) {\n  let { x, y } = offset;\n\n  if ((x * x) + (y * y) > radius * radius) { return null; }\n\n  let dx = Math.sin(angle);\n  let dy = Math.cos(angle);\n  let D = (x * dy) - (y * dx);\n\n  let d = (radius * radius) - (D * D);\n  if (d < 0) {\n    return null;\n  }\n  let sqrtD = Math.sqrt(d);\n  return {\n    x: (D * dy) + (dx * sqrtD),\n    y: -(D * dx) + (dy * sqrtD)\n  };\n}\n\n// assume 0 <= angle < (PI * 2)\nfunction getRectFromCircleIntersection({ radius, size, angle }) {\n  let { width, height } = size;\n  let lineOffset = { x: width / 2, y: height / 2 };\n  let section = Math.floor(angle / (Math.PI / 2));\n  let intersection;\n  let offset;\n  switch (section) {\n    case 0:\n      intersection = getLineCircleIntersection(radius, lineOffset, angle);\n      if (!intersection) { return null; }\n      intersection.y *= -1;\n      offset = { x: -width, y: 0 };\n      break;\n    case 1:\n      intersection = getLineCircleIntersection(radius, lineOffset, Math.PI - angle);\n      if (!intersection) { return null; }\n      offset = { x: -width, y: -height };\n      break;\n    case 2:\n      intersection = getLineCircleIntersection(radius, lineOffset, angle - Math.PI);\n      if (!intersection) { return null; }\n      intersection.x *= -1;\n      offset = { x: 0, y: -height };\n      break;\n    case 3:\n      intersection = getLineCircleIntersection(radius, lineOffset, (2 * Math.PI) - angle);\n      if (!intersection) { return null; }\n      intersection.x *= -1;\n      intersection.y *= -1;\n      offset = { x: 0, y: 0 };\n      break;\n    default:\n      throw new Error('invalid angle');\n  }\n  let bounds = {\n    x: intersection.x + offset.x,\n    y: intersection.y + offset.y,\n    width,\n    height\n  };\n  return bounds;\n}\n\nfunction getHorizontalInsideSliceRect({ slice, padding, measured }) {\n  let {\n    start, end, innerRadius, outerRadius\n  } = slice;\n  let middle = (start + end) / 2;\n\n  let size = {\n    width: measured.width + (padding * 2),\n    height: measured.height + (padding * 2)\n  };\n\n  let PI2 = Math.PI * 2;\n  middle = ((middle % PI2) + PI2) % PI2; // normalize\n\n  let bounds = getRectFromCircleIntersection({\n    radius: outerRadius,\n    size,\n    angle: middle\n  });\n\n  if (!bounds) { return null; }\n\n  bounds.baseline = 'top';\n\n  let startLine = {\n    x1: 0, y1: 0, x2: Math.sin(start) * outerRadius, y2: -Math.cos(start) * outerRadius\n  };\n  if (collisions.testRectLine(bounds, startLine)) { return null; }\n  let endLine = {\n    x1: 0, y1: 0, x2: Math.sin(end) * outerRadius, y2: -Math.cos(end) * outerRadius\n  };\n  if (collisions.testRectLine(bounds, endLine)) { return null; }\n  let circle = { cx: 0, cy: 0, r: innerRadius };\n  if (collisions.testCircleRect(circle, bounds)) { return null; }\n\n  pad(bounds, padding);\n\n  return bounds;\n}\n\n// TODO: this case can support a justify setting\nfunction getRotatedInsideSliceRect({ slice, measured, padding }) {\n  let {\n    start, end, innerRadius, outerRadius\n  } = slice;\n\n  let maxWidth = outerRadius - innerRadius - (padding * 2);\n  let size = end - start;\n  if (size < Math.PI) {\n    let x = ((measured.height / 2) + padding) / Math.tan(size / 2);\n    if (x > innerRadius) {\n      maxWidth = outerRadius - x - (padding * 2);\n    }\n  }\n  if (maxWidth < 0) {\n    return null;\n  }\n\n  let middle = (start + end) / 2;\n  let PI2 = Math.PI * 2;\n  middle = ((middle % PI2) + PI2) % PI2; // normalize\n  let r = outerRadius - padding;\n  let bounds = {\n    x: Math.sin(middle) * r,\n    y: -Math.cos(middle) * r,\n    width: maxWidth,\n    height: measured.height\n  };\n  if (middle < Math.PI) {\n    bounds.angle = middle - (Math.PI / 2);\n    bounds.anchor = 'end';\n  } else {\n    bounds.angle = middle + (Math.PI / 2);\n    bounds.anchor = 'start';\n  }\n  return bounds;\n}\n\n\nfunction getRotatedOusideSliceRect({\n  slice, measured, padding, view\n}) {\n  let {\n    start, end, outerRadius, offset\n  } = slice;\n  let r = outerRadius + padding;\n  let size = end - start;\n  if (size < Math.PI) {\n    let minR = ((measured.height / 2) + padding) / Math.tan(size / 2);\n    if (minR > r) {\n      return null;\n    }\n  }\n  let middle = (start + end) / 2;\n  let PI2 = Math.PI * 2;\n  middle = ((middle % PI2) + PI2) % PI2; // normalize\n  let x = Math.sin(middle) * r;\n  let y = -Math.cos(middle) * r;\n\n  let maxWidth = measured.width;\n  let v = middle % Math.PI;\n  if (v > Math.PI / 2) {\n    v = Math.PI - v;\n  }\n  if (Math.cos(v) > 0.001) {\n    let edge = y < 0 ? view.y : view.y + view.height;\n    let d = Math.abs(edge - offset.y);\n    let w = (d / Math.cos(v)) - (Math.tan(v) * (measured.height / 2)) - (padding * 2) - outerRadius;\n    if (w < maxWidth) {\n      maxWidth = w;\n    }\n  }\n  if (Math.sin(v) > 0.001) {\n    let edge = x < 0 ? view.x : view.x + view.width;\n    let d = Math.abs(edge - offset.x);\n    let w = (d / Math.sin(v)) - ((measured.height / 2) / Math.tan(v)) - (padding * 2) - outerRadius;\n    if (w < maxWidth) {\n      maxWidth = w;\n    }\n  }\n\n  if (maxWidth <= 0) { return 0; }\n\n  let bounds = {\n    x,\n    y,\n    width: maxWidth,\n    height: measured.height\n  };\n  if (middle < Math.PI) {\n    bounds.angle = middle - (Math.PI / 2);\n    bounds.anchor = 'start';\n  } else {\n    bounds.angle = middle + (Math.PI / 2);\n    bounds.anchor = 'end';\n  }\n  return bounds;\n}\n\nfunction getHorizontalOusideSliceRect({\n  slice, measured, padding, view\n}) {\n  let {\n    start, end, outerRadius, offset\n  } = slice;\n  let r = outerRadius + padding + (measured.height / 2);\n\n  let middle = (start + end) / 2;\n  let PI2 = Math.PI * 2;\n  middle = ((middle % PI2) + PI2) % PI2; // normalize\n  let maxWidth = measured.width;\n  let x = Math.sin(middle) * r;\n  let y = -Math.cos(middle) * r;\n\n  if (middle < Math.PI) {\n    let w = Math.abs((view.x + view.width) - (x + offset.x));\n    if (w < maxWidth) {\n      maxWidth = w;\n    }\n  } else {\n    let w = Math.abs(view.x - (x + offset.x));\n    if (w < maxWidth) {\n      maxWidth = w;\n    }\n  }\n\n  let bounds = {\n    x,\n    y,\n    width: maxWidth,\n    height: measured.height\n  };\n  if (middle < Math.PI) {\n    bounds.anchor = 'start';\n  } else {\n    bounds.anchor = 'end';\n  }\n  return bounds;\n}\n\nfunction cbContext(node, chart) {\n  return {\n    node,\n    data: node.data,\n    scale: chart.scale,\n    formatter: chart.formatter,\n    dataset: chart.dataset\n  };\n}\n\nfunction placeTextOnPoint(rect, text, opts) {\n  const label = {\n    type: 'text',\n    text,\n    maxWidth: rect.width,\n    x: rect.x,\n    y: rect.y + (rect.baseline === 'top' ? rect.height / 2 : 0),\n    fill: opts.fill,\n    anchor: rect.anchor || 'start',\n    baseline: 'middle',\n    fontSize: `${opts.fontSize}px`,\n    fontFamily: opts.fontFamily\n  };\n\n  if (!isNaN(rect.angle)) {\n    let angle = rect.angle * (360 / (Math.PI * 2));\n    label.transform = `rotate(${angle}, ${label.x}, ${label.y})`;\n  }\n\n  return label;\n}\n\nexport function getSliceRect({\n  slice, direction, position, padding, measured, view\n}) {\n  let {\n    start,\n    end,\n    innerRadius,\n    offset\n  } = slice;\n\n  let bounds;\n  let s;\n  switch (position) {\n    case 'into':\n      if (direction === 'rotate') {\n        bounds = getRotatedInsideSliceRect({ slice, measured, padding });\n      } else {\n        bounds = getHorizontalInsideSliceRect({ slice, measured, padding });\n      }\n      break;\n    case 'inside':\n      s = {\n        start,\n        end,\n        innerRadius: 0,\n        outerRadius: innerRadius\n      };\n      if (direction === 'rotate') {\n        bounds = getRotatedInsideSliceRect({ slice: s, measured, padding });\n      } else {\n        bounds = getHorizontalInsideSliceRect({ slice: s, measured, padding });\n      }\n      break;\n    case 'outside':\n      if (direction === 'rotate') {\n        bounds = getRotatedOusideSliceRect({\n          slice, measured, padding, view\n        });\n      } else {\n        bounds = getHorizontalOusideSliceRect({\n          slice, measured, padding, view\n        });\n      }\n      break;\n    default:\n      throw new Error('not implemented');\n  }\n  if (bounds) {\n    bounds.x += offset.x;\n    bounds.y += offset.y;\n  }\n  return bounds;\n}\n\nfunction findBestPlacement({\n  direction,\n  measured,\n  node,\n  placementSettings,\n  rect\n}, sliceRect = getSliceRect) {\n  for (let p = 0; p < placementSettings.length; p++) {\n    let placement = placementSettings[p];\n    let bounds = sliceRect({\n      slice: node.desc.slice,\n      view: rect,\n      direction,\n      position: placement.position,\n      measured,\n      padding: placement.padding\n    });\n\n    if (!bounds) {\n      continue;\n    }\n\n    return { bounds, placement };\n  }\n  return { bounds: null, placement: null };\n}\n\n/**\n * @typedef {object} component--labels~slices-label-strategy\n *\n */\n\n/**\n * @typedef {object} component--labels~slices-label-strategy.settings\n * @property {string|function} [direction='horizontal'] - The direction of the text: 'horizontal' or 'rotated'.\n * @property {string} [fontFamily='Arial']\n * @property {number} [fontSize=12]\n * @property {Array<object>} labels\n * @property {string|function} labels[].label - The text value\n * @property {Array<object>} labels[].placements\n * @property {string} [labels[].placements[].position='into'] - 'inside' | 'into' | 'outside' (outside is not implmented yet)\n * @property {string} [labels[].placements[].fill='#333'] - Color of the label\n */\n\nexport function slices(\n  {\n    settings,\n    chart,\n    nodes,\n    rect,\n    renderer,\n    style\n  }, findPlacement = findBestPlacement,\n  placer = placeTextOnPoint\n) {\n  const defaults = extend({\n    fontSize: 12,\n    fontFamily: 'Arial',\n    fill: '#333',\n    padding: 4,\n    position: 'into'\n  }, style.label);\n\n  defaults.fontSize = parseInt(defaults.fontSize, 10);\n\n  const labelSettings = settings.labels.map(labelSetting =>\n    extend({}, defaults, settings, labelSetting));\n\n  const placementSettings = settings.labels.map(labelSetting =>\n    labelSetting.placements.map(placement =>\n      extend({}, defaults, settings, labelSetting, placement)));\n\n  const labelStruct = {};\n  const labels = [];\n  let firstOutsideBounds = null;\n  let previousOutsideBounds = null;\n\n  for (let i = 0, len = nodes.length; i < len; i++) {\n    let node = nodes[i];\n    let arg = cbContext(node, chart);\n\n    for (let j = 0; j < labelSettings.length; j++) {\n      let lblStngs = labelSettings[j];\n      let text = typeof lblStngs.label === 'function' ? lblStngs.label(arg, i) : '';\n      if (!text) {\n        continue;\n      }\n      let direction = typeof lblStngs.direction === 'function' ? lblStngs.direction(arg, i) : lblStngs.direction || 'horizontal';\n\n      labelStruct.fontFamily = lblStngs.fontFamily;\n      labelStruct.fontSize = `${lblStngs.fontSize}px`;\n      labelStruct.text = text;\n\n      let measured = renderer.measureText(labelStruct);\n\n      const bestPlacement = findPlacement({\n        direction,\n        lblStngs,\n        measured,\n        node,\n        placementSettings: placementSettings[j],\n        rect\n      });\n\n      let bounds = bestPlacement.bounds;\n      let placement = bestPlacement.placement;\n\n      if (bounds && placement) {\n        if (placement.position === 'outside') {\n          if (!firstOutsideBounds) {\n            firstOutsideBounds = bounds;\n          } else if (firstOutsideBounds.anchor === bounds.anchor && collisions.testRectRect(firstOutsideBounds, bounds)) {\n            continue;\n          }\n          if (previousOutsideBounds && previousOutsideBounds.anchor === bounds.anchor && collisions.testRectRect(previousOutsideBounds, bounds)) {\n            continue;\n          }\n          previousOutsideBounds = bounds;\n        }\n\n        let fill = typeof placement.fill === 'function' ? placement.fill(arg, i) : placement.fill;\n\n        let label = placer(bounds, text, {\n          fill,\n          fontSize: lblStngs.fontSize,\n          fontFamily: lblStngs.fontFamily,\n          textMetrics: measured\n        });\n\n        if (label) {\n          labels.push(label);\n        }\n      }\n    }\n  }\n\n  return labels;\n}\n","import extend from 'extend';\n\nconst LINE_HEIGHT = 1.2;\nconst CIRCLE_FACTOR = 0.9;\n\nfunction cbContext(node, chart) {\n  return {\n    node,\n    data: node.data,\n    scale: chart.scale,\n    formatter: chart.formatter,\n    dataset: chart.dataset\n  };\n}\n\nexport function placeTextInRect(rect, text, opts) {\n  const label = {\n    type: 'text',\n    text,\n    maxWidth: rect.width,\n    x: 0,\n    y: rect.y,\n    dx: 0,\n    dy: 0,\n    fill: opts.fill,\n    anchor: 'start',\n    baseline: 'alphabetical',\n    fontSize: `${opts.fontSize}px`,\n    fontFamily: opts.fontFamily\n  };\n\n  const textMetrics = opts.textMetrics;\n\n  if (rect.width < opts.fontSize) {\n    return false;\n  }\n\n  const wiggleWidth = Math.max(0, rect.width - textMetrics.width);\n  label.x = rect.x + (opts.align * wiggleWidth);\n  label.y = rect.y + (textMetrics.height / LINE_HEIGHT);\n\n  return label;\n}\n\nfunction getRectFromCircle({ cx, cy, r }) {\n  return {\n    type: 'circle',\n    bounds: { cx, cy, r }\n  };\n}\nfunction getSliceBounds(slice) {\n  const EPSILON = 1e-12;\n  let {\n    start,\n    end,\n    innerRadius,\n    outerRadius,\n    offset\n  } = slice;\n  if (Math.abs((start + (2 * Math.PI)) - end) > EPSILON) {\n    return { type: null, bounds: null };\n  }\n  let r = innerRadius !== 0 ? innerRadius : outerRadius;\n  return getRectFromCircle({ cx: offset.x, cy: offset.y, r });\n}\n\nfunction getBounds(node) {\n  if (node.desc && node.desc.slice) {\n    return getSliceBounds(node.desc.slice);\n  }\n  if (node.type === 'circle') {\n    return getRectFromCircle(node.attrs);\n  }\n  if (node.type === 'rect') {\n    return { type: 'rect', bounds: node.bounds };\n  }\n  // defualt to node.bounds ?\n  return { type: null, bounds: null };\n}\n\n/**\n * @typedef {object} component--labels~rows-label-strategy\n *\n */\n\n/**\n * @typedef {object} component--labels~rows-label-strategy.settings\n * @property {string} [fontFamily='Arial']\n * @property {number} [fontSize=12]\n * @property {number} [justify=0.5]\n * @property {number} [padding=4]\n * @property {Array<object>} labels\n * @property {string|function} labels[].label - The text value\n * @property {number} [labels[].align=0.5]\n * @property {string|function} [labels[].fill='#333']\n */\n\nexport function rows({\n  settings,\n  chart,\n  nodes,\n  renderer,\n  style\n}, placer = placeTextInRect) {\n  const defaults = extend({\n    fontSize: 12,\n    fontFamily: 'Arial',\n    fill: '#333',\n    padding: 4,\n    align: 0.5,\n    justify: 0.5\n  }, style.label);\n\n  defaults.fontSize = parseInt(defaults.fontSize, 10);\n\n  const rowSettings = extend({}, defaults, settings);\n\n  const labelSettings = settings.labels.map(labelSetting =>\n    extend({}, rowSettings, labelSetting));\n\n  const labelStruct = {};\n  const labels = [];\n\n  for (let i = 0, len = nodes.length; i < len; i++) {\n    let node = nodes[i];\n    let arg = cbContext(node, chart);\n\n    let { type, bounds } = getBounds(node);\n    if (!bounds) {\n      continue;\n    }\n\n    let totalHeight = 0;\n    let measurements = [];\n    let texts = [];\n\n    let maxHeight = type === 'circle' ? 2 * bounds.r * CIRCLE_FACTOR : bounds.height;\n    totalHeight += rowSettings.padding;\n    let j;\n    for (j = 0; j < labelSettings.length; j++) {\n      let lblStngs = labelSettings[j];\n      let text = typeof lblStngs.label === 'function' ? lblStngs.label(arg, i) : '';\n      if (!text) {\n        continue;\n      }\n\n      labelStruct.fontFamily = lblStngs.fontFamily;\n      labelStruct.fontSize = `${lblStngs.fontSize}px`;\n      labelStruct.text = text;\n      let measured = renderer.measureText(labelStruct);\n      totalHeight += measured.height + lblStngs.padding;\n      if (totalHeight > maxHeight) { break; }\n      texts.push(text);\n      measurements.push(measured);\n    }\n\n    const labelCount = j;\n    const wiggleHeight = Math.max(0, maxHeight - totalHeight);\n    let currentY;\n    if (type === 'circle') {\n      currentY = bounds.cy - (bounds.r * CIRCLE_FACTOR);\n    } else {\n      currentY = bounds.y;\n    }\n    currentY += (rowSettings.justify * wiggleHeight) + rowSettings.padding;\n\n    for (j = 0; j < labelCount; j++) {\n      let lblStngs = labelSettings[j];\n      let rect;\n      if (type === 'circle') {\n        let maxYDistToCenter = Math.max(Math.abs(currentY - bounds.cy), Math.abs((currentY + measurements[j].height) - bounds.cy));\n        let halfWidth = Math.sqrt((bounds.r * bounds.r) - (maxYDistToCenter * maxYDistToCenter));\n        rect = {\n          x: (bounds.cx - halfWidth) + rowSettings.padding,\n          y: currentY,\n          width: (2 * halfWidth) - (2 * rowSettings.padding),\n          height: measurements[j].height\n        };\n      } else {\n        rect = {\n          x: bounds.x + rowSettings.padding,\n          y: currentY,\n          width: bounds.width - (2 * rowSettings.padding),\n          height: measurements[j].height\n        };\n      }\n\n      currentY += measurements[j].height + rowSettings.padding;\n      let fill = typeof lblStngs.fill === 'function' ? lblStngs.fill(arg, i) : lblStngs.fill;\n      let label = placer(rect, texts[j], {\n        fill,\n        align: lblStngs.align,\n        fontSize: lblStngs.fontSize,\n        fontFamily: lblStngs.fontFamily,\n        textMetrics: measurements[j]\n      });\n      if (label) {\n        labels.push(label);\n      }\n    }\n  }\n\n  return labels;\n}\n","\nimport { bars } from './bars';\nimport { slices } from './slices';\nimport { rows } from './rows';\n\nexport default {\n  bar: bars,\n  slice: slices,\n  rows\n};\n","import strategies from './strategies';\n\n/**\n * @typedef {object} component--labels\n * @property {string} [type='labels']\n */\n\n/**\n * @typedef {object} component--labels.settings\n * @property {Array<object>} sources\n * @property {string} sources[].component\n * @property {string} sources[].selector\n * @property {component--labels~label-strategy} sources[].strategy\n */\n\nexport function strategy({\n  chart,\n  source,\n  rect,\n  renderer,\n  style\n}, fn) {\n  const component = chart.component(source.component);\n  if (!component) {\n    return [];\n  }\n  const nodes = chart.findShapes(source.selector).filter(n => n.key === source.component);\n\n  return fn({\n    chart,\n    settings: source.strategy.settings,\n    nodes,\n    rect: {\n      x: 0,\n      y: 0,\n      width: rect.width,\n      height: rect.height\n    },\n    renderer,\n    style\n  });\n}\n\nconst labelsComponent = {\n  require: ['chart', 'renderer', 'settings'],\n  defaultSettings: {\n    settings: {},\n    style: {\n      label: '$label'\n    }\n  },\n  created() {\n    this.rect = {\n      x: 0, y: 0, width: 0, height: 0\n    };\n  },\n  beforeRender(opts) {\n    this.rect = opts.size;\n  },\n  render() {\n    const stngs = this.settings.settings;\n    const labels = [];\n\n    (stngs.sources || []).forEach((source) => {\n      if (source.strategy && strategies[source.strategy.type] && source.component) {\n        labels.push(...strategy({\n          chart: this.chart,\n          rect: this.rect,\n          renderer: this.renderer,\n          source,\n          style: this.style\n        }, strategies[source.strategy.type]));\n      }\n    });\n\n    return labels;\n  }\n};\n\nexport default labelsComponent;\n","import labelsComponent from './labels';\n\nexport default function labels(picasso) {\n  picasso.component('labels', labelsComponent);\n}\n\n","import extend from 'extend';\n\n/**\n * @typedef {object}\n * @alias component--legend-cat.settings\n */\nconst DEFAULT_SETTINGS = {\n  /**\n   * @typedef {object=}\n   */\n  layout: {\n    /**\n     * Maximum number of columns (vertical) or rows (horizontal)\n     * @type {number=}\n     */\n    size: 1,\n    /**\n     * Layout direction. Either `'ltr'` or `'rtl'`\n     * @type {string=}\n     */\n    direction: 'ltr',\n    /** Initial scroll offset\n     * @type {number=} */\n    scrollOffset: 0\n  },\n  /**\n   * Settings applied per item\n   * @typedef {object=}\n   */\n  item: {\n    /** Whether to show the current item\n     * @type {boolean=} */\n    show: true,\n    justify: 0.5,\n    align: 0.5,\n    /**\n     * @typedef {object=} */\n    label: {\n      fontSize: '12px',\n      fontFamily: 'Arial',\n      fill: '#595959',\n      /** Word break rule, how to apply line break if label text overflows its maxWidth property. Either `'break-word'` or `'break-all'`\n       * @type {string=} */\n      wordBreak: 'none',\n      /** Max number of lines allowed if label is broken into multiple lines (only applicable with wordBreak)\n       * @type {number=} */\n      maxLines: 2,\n      /** Maximum width of label, in px\n       * @type {number=} */\n      maxWidth: 136,\n      lineHeight: 1.2\n    },\n    /**\n     * @typedef {object=} */\n    shape: {\n      /**\n       * @type {string=} */\n      type: 'square',\n      /**\n       * @type {number=} */\n      size: 12\n    }\n  },\n  /**\n   * @typedef {object=} */\n  title: {\n    /** Whether to show the title\n     * @type {boolean=} */\n    show: true,\n    /** Title text. Defaults to the title of the provided data field\n     * @type {string=} */\n    text: undefined,\n    /** Horizontal alignment of the text. Allowed values are `'start'`, `'middle'` and `'end'`\n     * @type {string}\n     */\n    anchor: 'start',\n    fontSize: '16px',\n    fontFamily: 'Arial',\n    fill: '#595959',\n    /** Word break rule, how to apply line break if label text overflows its maxWidth property. Either `'break-word'` or `'break-all'`\n     * @type {string=} */\n    wordBreak: 'none',\n    /** Max number of lines allowed if label is broken into multiple lines, is only appled when `wordBreak` is not set to `'none'`\n     * @type {number=} */\n    maxLines: 2,\n    /** Maximum width of title, in px\n     * @type {number=} */\n    maxWidth: 156,\n    lineHeight: 1.25\n  },\n  /**\n   * @typedef {object=} */\n  navigation: {\n    /**\n     * @typedef {object=} */\n    button: {\n      /**\n       * @type {object<string, boolean>=} */\n      class: undefined,\n      /**\n       * @type {function} */\n      content: undefined\n    }\n  }\n};\n\n/**\n * Resolve settings based on input, defaults, and data\n *\n * @ignore\n * @param {legendComponent} comp - The component instance\n */\nexport default function resolveSettings(comp) {\n  const domain = comp.scale.domain();\n  let data = { items: [] };\n  if (comp.scale.type === 'threshold-color') {\n    const fields = comp.scale.data().fields;\n    const sourceField = fields[0];\n    let formatter = v => String(v);\n\n    if (comp.settings.formatter) {\n      formatter = comp.chart.formatter(comp.settings.formatter);\n    } else if (sourceField) {\n      formatter = sourceField.formatter();\n    }\n\n    for (let i = 0; i < domain.length - 1; i++) {\n      const it = {\n        value: domain[i],\n        label: `${formatter(domain[i])} - < ${formatter(domain[i + 1])}`\n      };\n      if (sourceField) {\n        it.source = {\n          field: sourceField.id()\n        };\n      }\n      data.items.push(it);\n    }\n\n    const orientation = comp.settings.dock === 'top' || comp.settings.dock === 'bottom' ? 'horizontal' : 'vertical';\n\n    if (orientation === 'vertical') {\n      data.items.reverse();\n    }\n  } else {\n    const labels = comp.scale.labels ? comp.scale.labels() : null;\n    data.items = domain.map((d, idx) => {\n      let datum = comp.scale.datum ? extend({}, comp.scale.datum(d)) : { value: d };\n      if (comp.scale.datum) {\n        datum = extend({}, comp.scale.datum(d));\n        datum.value = d;\n      }\n\n      if (comp.scale.label) {\n        datum.label = comp.scale.label(d);\n      } else if (labels) {\n        datum.label = labels[idx];\n      }\n\n      return datum;\n    });\n  }\n\n  const title = comp.resolver.resolve({\n    data: {\n      fields: comp.scale.data().fields\n    },\n    defaults: extend(true, {}, DEFAULT_SETTINGS.title, comp.style.title),\n    settings: comp.settings.settings.title\n  });\n\n  const layout = comp.resolver.resolve({\n    data: {\n      fields: comp.scale.data().fields\n    },\n    defaults: DEFAULT_SETTINGS.layout,\n    settings: comp.settings.settings.layout\n  });\n\n  const labels = comp.resolver.resolve({\n    data,\n    defaults: extend(true, {}, DEFAULT_SETTINGS.item.label, comp.style.item.label),\n    settings: (comp.settings.settings.item || {}).label\n  });\n\n  const shapeSettings = extend(true, {}, (comp.settings.settings.item || {}).shape);\n\n  if (typeof shapeSettings.fill === 'undefined' && comp.settings.scale) {\n    shapeSettings.fill = {\n      scale: comp.settings.scale\n    };\n  }\n\n  const symbols = comp.resolver.resolve({\n    data,\n    defaults: extend(true, {}, DEFAULT_SETTINGS.item.shape, comp.style.item.shape),\n    settings: shapeSettings\n  });\n\n  const items = comp.resolver.resolve({\n    data,\n    defaults: extend(true, {}, {\n      show: DEFAULT_SETTINGS.item.show\n    }),\n    settings: {\n      show: (comp.settings.settings.item || {}).show\n    }\n  });\n\n  function range(item, i) {\n    let v = item.data.value;\n    let next = domain[i + 1];\n    item.data.value = [v, next];\n  }\n\n  if (comp.scale.type === 'threshold-color') {\n    const orientation = comp.settings.dock === 'top' || comp.settings.dock === 'bottom' ? 'horizontal' : 'vertical';\n\n    if (orientation === 'vertical') {\n      items.items.reverse().forEach(range);\n      items.items.reverse();\n    } else {\n      items.items.forEach(range);\n    }\n  }\n\n  return {\n    title,\n    labels,\n    symbols,\n    items,\n    layout\n  };\n}\n","import extend from 'extend';\nimport symbolFactory from '../../symbols';\n\n/* eslint no-mixed-operators:0 */\n\nfunction placeTextInRect(rect, label, opts) {\n  const textMetrics = opts.textMetrics;\n\n  if (rect.height < textMetrics.height) {\n    return false;\n  }\n\n  const wiggleWidth = Math.max(0, rect.width - textMetrics.width);\n  label.baseline = 'hanging';\n  const wiggleHeight = Math.max(0, rect.height - (textMetrics.height));\n  label.x = rect.x + (opts.align * wiggleWidth);\n  label.y = rect.y + (opts.justify * wiggleHeight);\n\n  return label;\n}\n\nfunction wiggleSymbol(container, size, opts) {\n  const wiggleWidth = Math.max(0, container.width - size);\n  const wiggleHeight = Math.max(0, container.height - size);\n\n  return {\n    x: container.x + (size / 2) + (opts.align * wiggleWidth),\n    y: container.y + (size / 2) + (opts.justify * wiggleHeight)\n  };\n}\n\nexport function createRenderItem({\n  x = 0,\n  y,\n  item,\n  globalMetrics,\n  symbolFn = symbolFactory,\n  direction = 'ltr'\n}) {\n  let label = item.label.displayObject;\n  let labelBounds = item.label.bounds;\n  let symbolItem = item.symbol.meta;\n  const rtl = direction === 'rtl';\n\n  let labelRect = {\n    x: rtl ? x + globalMetrics.maxLabelBounds.width : x + globalMetrics.maxSymbolSize + globalMetrics.spacing,\n    y,\n    width: globalMetrics.maxLabelBounds.width,\n    height: Math.max(globalMetrics.maxSymbolSize, globalMetrics.maxLabelBounds.height)\n  };\n\n  let wiggled = wiggleSymbol({\n    x: rtl ? x + globalMetrics.maxLabelBounds.width + globalMetrics.spacing : x,\n    y,\n    width: globalMetrics.maxSymbolSize,\n    height: labelRect.height\n  }, symbolItem.size, {\n    align: typeof symbolItem.align === 'undefined' ? 0.5 : symbolItem.align,\n    justify: typeof symbolItem.justify === 'undefined' ? 0.5 : symbolItem.justify\n  });\n\n  const symbol = symbolFn(extend({}, symbolItem, wiggled));\n\n  delete symbol.collider;\n\n  label.anchor = rtl ? 'end' : 'start';\n\n  placeTextInRect(labelRect, label, {\n    textMetrics: labelBounds,\n    fontSize: parseInt(label.fontSize, 10),\n    align: 0.0,\n    justify: 0.5\n  });\n\n  let container = {\n    type: 'container',\n    data: item.label.displayObject.data,\n    children: [symbol, label],\n    collider: {\n      type: 'rect',\n      x,\n      y,\n      width: globalMetrics.maxItemBounds.width,\n      height: globalMetrics.maxItemBounds.height\n    }\n  };\n\n  return {\n    item: container,\n    metrics: labelRect\n  };\n}\n\nexport function getItemsToRender({\n  viewRect\n}, rect, {\n  itemized,\n  create = createRenderItem,\n  parallels\n}) {\n  const direction = itemized.layout.direction;\n  const globalMetrics = itemized.globalMetrics;\n  const legendItems = itemized.items;\n  const isHorizontal = itemized.layout.orientation === 'horizontal';\n  let s = 0;\n\n  const renderItems = [];\n  const fixedHeight = globalMetrics.maxItemBounds.height;\n  const fixedWidth = globalMetrics.maxItemBounds.width;\n  const rowHeight = itemized.layout.margin.vertical + fixedHeight;\n  const columnWidth = itemized.layout.margin.horizontal + fixedWidth;\n  let x = rect.x;\n  let y = rect.y;\n\n  let shift = viewRect.x - rect.x;\n\n  for (let i = 0; i < legendItems.length; i++) {\n    let renderItem = create({\n      y,\n      x: direction === 'rtl' ? viewRect.x + shift + viewRect.width - fixedWidth - (x - rect.x) : x,\n      item: legendItems[i],\n      globalMetrics,\n      direction\n    });\n\n    if ((isHorizontal && x >= viewRect.x - fixedWidth) || (!isHorizontal && y >= viewRect.y - fixedHeight)) {\n      renderItems.push(renderItem.item);\n    }\n\n    s++;\n    if (s >= parallels) {\n      s = 0;\n      if (isHorizontal) {\n        x += columnWidth; // next column\n        y = rect.y; // reset y to first row\n      } else {\n        y += rowHeight; // next row\n        x = rect.x; // reset x to first column\n      }\n    } else if (isHorizontal) {\n      y += rowHeight; // next row\n    } else {\n      x += columnWidth; // next column\n    }\n\n    if (!isHorizontal && (y > viewRect.y + viewRect.height)) {\n      break;\n    } else if (isHorizontal && x > viewRect.x + viewRect.width) {\n      break;\n    }\n  }\n  return renderItems;\n}\n\n\nexport function itemize({\n  resolved,\n  dock\n}, renderer) {\n  let label;\n  let items = [];\n  let item;\n  let sourceItems = resolved.items.items;\n  let sourceSymbols = resolved.symbols.items;\n  let sourceLabels = resolved.labels.items;\n\n  let maxSymbolSize = 0;\n  let maxLabelWidth = 0;\n  let maxLabelHeight = 0;\n\n  for (let i = 0; i < sourceItems.length; i++) {\n    if (sourceItems[i].show === false) {\n      continue;\n    }\n\n    label = extend({}, sourceLabels[i], { // create the displayObject here in order to measure it\n      type: 'text',\n      fontSize: `${parseInt(sourceLabels[i].fontSize, 10)}px`,\n      text: typeof sourceLabels[i].text !== 'undefined' ? sourceLabels[i].text : sourceLabels[i].data.label || ''\n    });\n\n    item = {\n      symbol: {\n        // can't create a displayObject here due to need to wiggle the center position of the symbol later on,\n        // just store the object needed later on\n        meta: sourceSymbols[i]\n      },\n      label: {\n        displayObject: label,\n        bounds: renderer.textBounds(label)\n      }\n    };\n\n    items.push(item);\n\n    maxSymbolSize = Math.max(sourceSymbols[i].size, maxSymbolSize);\n    maxLabelWidth = Math.max(item.label.bounds.width, maxLabelWidth);\n    maxLabelHeight = Math.max(item.label.bounds.height, maxLabelHeight);\n  }\n\n  return {\n    items,\n    globalMetrics: {\n      spacing: 8,\n      maxSymbolSize,\n      maxItemBounds: {\n        height: Math.max(maxSymbolSize, maxLabelHeight),\n        width: maxSymbolSize + 8 + maxLabelWidth\n      },\n      maxLabelBounds: {\n        width: maxLabelWidth,\n        height: maxLabelHeight\n      }\n    },\n    layout: {\n      margin: {\n        vertical: typeof resolved.layout.item.vertical !== 'undefined' ? resolved.layout.item.vertical : 8,\n        horizontal: typeof resolved.layout.item.horizontal !== 'undefined' ? resolved.layout.item.horizontal : 8\n      },\n      mode: resolved.layout.item.mode,\n      size: resolved.layout.item.size,\n      orientation: dock === 'top' || dock === 'bottom' ? 'horizontal' : 'vertical',\n      direction: resolved.layout.item.direction,\n      scrollOffset: resolved.layout.item.scrollOffset\n    }\n  };\n}\n\nexport function extent(itemized, parallels) {\n  const count = itemized.items.length;\n  const size = Math.ceil(count / parallels);\n  const property = itemized.layout.orientation === 'horizontal' ? 'width' : 'height';\n  const margin = property === 'width' ? 'horizontal' : 'vertical';\n  return (itemized.globalMetrics.maxItemBounds[property] * size) +\n    ((size - 1) * itemized.layout.margin[margin]);\n}\n\nexport function spread(itemized, parallels) {\n  const size = parallels;\n  const property = itemized.layout.orientation === 'horizontal' ? 'height' : 'width';\n  const margin = property === 'width' ? 'horizontal' : 'vertical';\n  return (itemized.globalMetrics.maxItemBounds[property] * size) + // expected vertical size of items\n    ((size - 1) * itemized.layout.margin[margin]); // expected spacing between items\n}\n\nexport function parallelize(availableExtent, availableSpread, itemized) {\n  const count = itemized.items.length;\n  const extentProperty = itemized.layout.orientation === 'horizontal' ? 'width' : 'height';\n  const margin = extentProperty === 'width' ? 'horizontal' : 'vertical';\n  const extentInPx = (itemized.globalMetrics.maxItemBounds[extentProperty] * count) +\n    ((count - 1) * itemized.layout.margin[margin]);\n  let numNeeded = Math.ceil(extentInPx / availableExtent);\n\n  if (availableSpread != null) {\n    const spreadProperty = itemized.layout.orientation === 'horizontal' ? 'height' : 'width';\n    const numAllowed = Math.floor(availableSpread / (4 + itemized.globalMetrics.maxItemBounds[spreadProperty]));\n    numNeeded = Math.min(numNeeded, numAllowed);\n  }\n\n  const numInput = isNaN(itemized.layout.size) ? 1 : itemized.layout.size;\n  return Math.max(1, Math.min(numNeeded, numInput));\n}\n\nexport default function (legend, {\n  onScroll = () => {}\n}) {\n  let itemized;\n  let parallels;\n  let viewRect;\n  let containerRect;\n  let offset = null;\n  let overflow = 0;\n\n  const api = {\n    itemize: (obj) => {\n      itemized = itemize(obj, legend.renderer);\n      offset = offset === null && !isNaN(itemized.layout.scrollOffset) ? itemized.layout.scrollOffset : offset; // Set the initial offset\n    },\n    getItemsToRender: (obj) => {\n      viewRect = obj.viewRect;\n      overflow = api.getContentOverflow(viewRect);\n      const ext = api.extent();\n      offset = Math.max(0, Math.min(offset, overflow));\n\n      containerRect = extend({}, viewRect);\n\n      const offsetProperty = api.orientation() === 'horizontal' ? 'x' : 'y';\n      containerRect[offsetProperty] -= offset;\n      containerRect[offsetProperty === 'x' ? 'width' : 'height'] = ext;\n\n      return getItemsToRender(obj, containerRect, { itemized, parallels });\n    },\n    parallelize: (availableExtent, availableSpread) => {\n      parallels = parallelize(availableExtent, availableSpread, itemized);\n      return parallels;\n    },\n    hasContentOverflow: () => {\n      const property = itemized.layout.orientation === 'horizontal' ? 'width' : 'height';\n      return extent(itemized, parallels) > viewRect[property];\n    },\n    getContentOverflow: (rect = viewRect) => {\n      const property = itemized.layout.orientation === 'horizontal' ? 'width' : 'height';\n      return Math.max(0, extent(itemized, parallels) - rect[property]);\n    },\n    getNextSize: () => {\n      // TODO - calculate the actual size to next item to ensure alignment\n      const property = itemized.layout.orientation === 'horizontal' ? 'width' : 'height';\n      const margin = property === 'width' ? 'horizontal' : 'vertical';\n      return itemized.globalMetrics.maxItemBounds[property] + itemized.layout.margin[margin];\n    },\n    getPrevSize: () => {\n      // TODO - calculate the actual size to next item to ensure alignment\n      const property = itemized.layout.orientation === 'horizontal' ? 'width' : 'height';\n      const margin = property === 'width' ? 'horizontal' : 'vertical';\n      return itemized.globalMetrics.maxItemBounds[property] + itemized.layout.margin[margin];\n    },\n    hasNext: () => {\n      if (api.orientation() === 'horizontal') {\n        return viewRect.x + viewRect.width < containerRect.x + containerRect.width;\n      }\n      return viewRect.y + viewRect.height < containerRect.y + containerRect.height;\n    },\n    hasPrev: () => {\n      if (api.orientation() === 'horizontal') {\n        return containerRect.x < viewRect.x;\n      }\n      return containerRect.y < viewRect.y;\n    },\n    next: () => {\n      api.scroll(-api.getNextSize());\n    },\n    prev: () => {\n      api.scroll(api.getPrevSize());\n    },\n    scroll: (delta) => {\n      const current = Math.max(0, Math.min(overflow, (offset - delta)));\n      if (current === offset) {\n        return;\n      }\n      offset = current;\n      onScroll();\n    },\n    offset: () => offset,\n    orientation: () => itemized.layout.orientation,\n    direction: () => itemized.layout.direction,\n    extent: () => extent(itemized, parallels), // total amount of space along orientation\n    spread: () => spread(itemized, parallels) // total amount of space perpendicular to orientation\n  };\n\n  return api;\n}\n","const DIR = {\n  up: '\\u25B2',\n  right: '\\u25B6',\n  down: '\\u25BC',\n  left: '\\u25C0'\n};\n\nfunction itemize({\n  // resolved,\n  dock,\n  navigation\n}) {\n  return {\n    layout: {\n      orientation: dock === 'top' || dock === 'bottom' ? 'vertical' : 'horizontal'\n    },\n    navigation\n  };\n}\n\nfunction btn(h, {\n  size,\n  isActive,\n  direction,\n  nav,\n  attrs\n}) {\n  let c = {};\n  let content = '';\n  if (nav && nav.button) {\n    if (typeof nav.button.class === 'function') {\n      c = nav.button.class({ direction });\n    } else if (nav.button.class) {\n      c = nav.button.class;\n    }\n    if (typeof nav.button.content === 'function') {\n      content = nav.button.content(h, { direction });\n    }\n  }\n  const style = {\n    width: `${size}px`,\n    minWidth: `${size}px`,\n    height: `${size}px`\n  };\n\n  if (!Object.keys(c).length) { // if no classes are set, add some basic styling\n    style.border = '0';\n    style.background = 'none';\n  }\n  const attrsMerged = attrs;\n  attrsMerged.disabled = !isActive ? 'disabled' : undefined;\n\n  return h('button', {\n    class: c,\n    style,\n    attrs: attrsMerged\n  }, [content || h('span', {\n    style: {\n      pointerEvents: 'none'\n    }\n  }, [DIR[direction]])]);\n}\n\nfunction render(renderer, {\n  rect,\n  itemRenderer\n}, itemized, legend) {\n  if (!renderer || !renderer.renderArgs) {\n    return;\n  }\n  renderer.size(rect);\n  const h = renderer.renderArgs[0];\n\n  const isVertical = itemized.layout.orientation === 'vertical'; // orientation of the navigation (not the legend)\n  const isRtl = itemRenderer.direction() === 'rtl';\n\n  const hasNext = itemRenderer.hasNext();\n  const hasPrev = itemRenderer.hasPrev();\n\n  if (!hasPrev && !hasNext) {\n    renderer.render([]);\n    return;\n  }\n\n  const buttonSize = 32;\n\n  const order = isVertical ? ['right', 'left'] : ['down', 'up'];\n  if (isRtl) {\n    order.reverse();\n  }\n\n  const nodes = [h('div', {\n    style: {\n      position: 'relative',\n      display: 'flex',\n      'flex-direction': isVertical ? 'column' : 'row',\n      'justify-content': 'center',\n      height: '100%',\n      pointerEvents: 'auto'\n    }\n  }, [btn(h, {\n    size: buttonSize,\n    isActive: hasNext,\n    direction: order[0],\n    attrs: {\n      'data-action': 'next',\n      'data-component-key': legend.settings.key\n    },\n    nav: itemized.navigation\n  }), btn(h, {\n    size: buttonSize,\n    isActive: hasPrev,\n    direction: order[1],\n    attrs: {\n      'data-action': 'prev',\n      'data-component-key': legend.settings.key\n    },\n    nav: itemized.navigation\n  })])];\n  renderer.render(nodes);\n}\n\nexport default function (legend) {\n  let itemized;\n\n  const nav = {\n    itemize: (obj) => {\n      itemized = itemize(obj);\n    },\n    render: obj => render(nav.renderer, obj, itemized, legend),\n    extent: () => 32,\n    spread: () => 64\n  };\n\n  return nav;\n}\n","import extend from 'extend';\n\nfunction itemize({\n  resolved\n}, legend) {\n  if (resolved.title.item.show === false) {\n    return null;\n  }\n  const t = extend({}, resolved.title.item, {\n    type: 'text'\n  });\n\n  if (resolved.layout.item.direction === 'rtl') {\n    if (!t.anchor || t.anchor === 'start') {\n      t.anchor = 'end';\n    } else if (t.anchor === 'end') {\n      t.anchor = 'start';\n    }\n  }\n\n  if (typeof resolved.title.settings.text === 'undefined') {\n    const fields = legend.scale.data().fields;\n    t.text = fields && fields[0] ? fields[0].title() : '';\n  }\n\n  return {\n    displayObject: t,\n    bounds: legend.renderer.textBounds(t)\n  };\n}\n\nfunction render({\n  rect\n}, renderer, itemized) {\n  if (!renderer) {\n    return;\n  }\n  const nodes = [];\n  renderer.size(rect);\n  if (itemized) {\n    const align = {\n      start: 0,\n      end: rect.width,\n      middle: rect.width / 2\n    };\n    nodes.push(extend({}, itemized.displayObject, {\n      x: align[itemized.displayObject.anchor] || 0,\n      y: 0,\n      baseline: 'hanging'\n    }));\n  }\n  renderer.render(nodes);\n}\n\nexport default function (legend) {\n  let itemized;\n\n  const api = {\n    itemize: (obj) => {\n      itemized = itemize(obj, legend);\n    },\n    render: (obj) => {\n      render(obj, api.renderer, itemized);\n    },\n    spread: () => (itemized ? itemized.bounds.height * 1.25 : 0),\n    extent: () => (itemized ? itemized.bounds.width : 0)\n  };\n\n  return api;\n}\n\n","import extend from 'extend';\n/* eslint no-mixed-operators:0 */\n\nexport default function layout(rect, display, orientation, {\n  itemRenderer,\n  navigationRenderer,\n  titleRenderer,\n  isPreliminary = false\n}) {\n  let title;\n  let content;\n  let navigation;\n  let preferredSize = 0;\n\n  const paddedRect = {\n    x: display.spacing,\n    y: display.spacing,\n    width: rect.width - (2 * display.spacing),\n    height: rect.height - (2 * display.spacing)\n  };\n\n  title = {\n    x: paddedRect.x,\n    y: paddedRect.y,\n    width: paddedRect.width,\n    height: titleRenderer.spread()\n  };\n\n  if (orientation === 'horizontal') {\n    // const titleAtTop = false;\n    // if (titleAtTop) { // this might be a nicer layout sometimes\n    //   // |------------------|\n    //   // |title             |\n    //   // |------------|-----|\n    //   // |content     | nav |\n    //   // |------------|-----|\n\n    //   // available space for items without navigation UI\n    //   const availableExtentForItems = paddedRect.width;\n    //   const availableSpreadForItems = paddedRect.height - (title.y + title.height) + 8;\n    //   const isRtl = itemRenderer.direction() === 'rtl';\n    //   itemRenderer.parallelize(availableExtentForItems, isPreliminary ? undefined : availableSpreadForItems);\n\n    //   const navigationSize = itemRenderer.extent() > availableExtentForItems ? navigationRenderer.extent() : 0;\n    //   content = {\n    //     x: paddedRect.x,\n    //     y: title.y + title.height,\n    //     width: paddedRect.width - navigationSize,\n    //     height: availableSpreadForItems\n    //   };\n    //   navigation = {\n    //     x: content.x + content.width,\n    //     y: title.y + title.height,\n    //     width: navigationSize,\n    //     height: paddedRect.height - (title.y + title.height) + 8\n    //   };\n\n    //   if (isRtl) { // switch navigation and content\n    //     navigation.x = content.x;\n    //     content.x = navigation.x + navigation.width;\n    //     // totalContent.x = navigation.x;\n    //   }\n    //   preferredSize = title.height + Math.max(navigationRenderer.spread(), itemRenderer.spread());\n    // } else {\n    // |-----|------------|-----|\n    // |title|content     | nav |\n    // |-----|------------|-----|\n\n    title = {\n      x: paddedRect.x,\n      y: paddedRect.y,\n      width: titleRenderer.extent(),\n      height: titleRenderer.spread()\n    };\n\n    // available space for items without navigation UI\n    const availableExtentForItems = paddedRect.width - title.width - (title.width ? display.spacing : 0);\n    const availableSpreadForItems = paddedRect.height;\n    itemRenderer.parallelize(availableExtentForItems, isPreliminary ? undefined : availableSpreadForItems);\n\n    const navigationSize = itemRenderer.extent() > availableExtentForItems ? navigationRenderer.extent() : 0;\n    const spread = itemRenderer.spread();\n    const navigationSpread = navigationSize ? navigationRenderer.spread() : 0;\n    content = {\n      x: title.x + title.width + (title.width ? display.spacing : 0),\n      y: paddedRect.y + Math.max(0, (navigationSpread - spread) / 2),\n      width: paddedRect.width - navigationSize - title.width - (navigationSize ? display.spacing : 0) - (title.width ? display.spacing : 0),\n      height: availableSpreadForItems\n    };\n    navigation = {\n      x: content.x + content.width + (navigationSize ? display.spacing : 0),\n      y: paddedRect.y,\n      width: navigationSize,\n      height: paddedRect.height\n    };\n\n    title.y = content.y;\n\n    const isRtl = itemRenderer.direction() === 'rtl';\n    if (isRtl) { // switch title, content and navigation\n      navigation.x = paddedRect.x;\n      content.x = navigation.x + navigation.width + (navigation.width ? display.spacing : 0);\n      title.x = content.x + content.width + (title.width ? display.spacing : 0);\n    }\n    preferredSize = Math.max(title.height, navigationSpread, itemRenderer.spread());\n    // }\n  } else {\n    // |------------|\n    // |title       |\n    // |------------|\n    // |content     |\n    // |------------|\n    // |navigation  |\n    // |------------|\n\n    const availableExtentForItems = paddedRect.height - title.height - (title.height ? display.spacing : 0);\n    const availableSpreadForItems = paddedRect.width;\n    itemRenderer.parallelize(availableExtentForItems, isPreliminary ? undefined : availableSpreadForItems);\n\n    const navigationSize = itemRenderer.extent() > availableExtentForItems ? navigationRenderer.extent() : 0;\n    navigation = {\n      x: paddedRect.x,\n      y: paddedRect.y + paddedRect.height - navigationSize,\n      width: paddedRect.width,\n      height: navigationSize\n    };\n\n    content = {\n      x: paddedRect.x,\n      y: title.y + title.height + (title.height ? display.spacing : 0),\n      width: paddedRect.width,\n      height: paddedRect.height - title.height - (title.height ? display.spacing : 0) - navigation.height - (navigation.height ? display.spacing : 0)\n    };\n\n    preferredSize = Math.max(titleRenderer.extent(), navigationSize ? navigationRenderer.spread() : 0, itemRenderer.spread());\n  }\n\n  content = extend({}, rect, {\n    x: rect.x + content.x,\n    y: rect.y + content.y,\n    width: content.width,\n    height: content.height\n  });\n\n  navigation.x += rect.x;\n  navigation.y += rect.y;\n\n  title.x += rect.x;\n  title.y += rect.y;\n\n  return {\n    title: extend({}, rect, title),\n    content: extend({}, rect, content),\n    navigation: extend({}, rect, navigation),\n    orientation,\n    preferredSize\n  };\n}\n","import extend from 'extend';\nimport resolveSettings from './legend-resolver';\nimport itemRendererFactory from './item-renderer';\nimport navigationRendererFactory from './navigation-renderer';\nimport titleRendererFactory from './title-renderer';\nimport layout from './legend-layout';\n\nfunction update(comp) {\n  comp.state.resolved = resolveSettings(comp);\n  comp.titleRenderer.itemize({\n    resolved: comp.state.resolved,\n    dock: comp.settings.dock || 'center'\n  });\n  comp.itemRenderer.itemize({\n    resolved: comp.state.resolved,\n    dock: comp.settings.dock || 'center'\n  });\n  comp.navigationRenderer.itemize({\n    resolved: comp.state.resolved,\n    dock: comp.settings.dock || 'center',\n    navigation: comp.settings.settings.navigation\n  });\n\n  comp.state.display = {\n    spacing: 8\n  };\n}\n\nfunction preferredSize(comp, size) {\n  let s = 0;\n  const dock = comp.settings.dock || 'center';\n  const orientation = dock === 'top' || dock === 'bottom' ? 'horizontal' : 'vertical';\n  const d = comp.state.display;\n  const tempLayout = layout(size.inner, d, orientation, {\n    itemRenderer: comp.itemRenderer,\n    navigationRenderer: comp.navigationRenderer,\n    titleRenderer: comp.titleRenderer,\n    isPreliminary: true\n  });\n  s += d.spacing; // start padding in both vertical and horizontal mode\n  s += tempLayout.preferredSize;\n  s += d.spacing; // end padding in both vertical and horizontal mode\n  return s;\n}\n\nfunction render(legend) {\n  const {\n    rect,\n    settings,\n    state,\n    itemRenderer,\n    navigationRenderer,\n    titleRenderer\n  } = legend;\n  const orientation = settings.dock === 'top' || settings.dock === 'bottom' ? 'horizontal' : 'vertical';\n  const l = layout(rect, state.display, orientation, {\n    itemRenderer,\n    navigationRenderer,\n    titleRenderer\n  });\n\n  legend.renderer.size(l.content);\n\n  // l.content.x = 0;\n  // l.content.y = 0;\n\n  // l.navigation.x += rect.x;\n  // l.navigation.y += rect.y;\n\n  // l.title.x += rect.x;\n  // l.title.y += rect.y;\n\n  let contentItems = itemRenderer.getItemsToRender({\n    viewRect: extend({}, l.content, { x: 0, y: 0 })\n  });\n\n  navigationRenderer.render({\n    rect: l.navigation,\n    itemRenderer\n  });\n\n  titleRenderer.render({\n    rect: l.title\n  });\n\n  legend.state.views = {\n    layout: l\n  };\n\n  return contentItems;\n}\n\nconst component = {\n  require: ['chart', 'settings', 'renderer', 'update', 'resolver', 'registries'],\n  defaultSettings: {\n    settings: {},\n    style: {\n      item: {\n        label: '$label',\n        shape: '$shape'\n      },\n      title: '$title'\n    }\n  },\n  mounted(renderElement) {\n    if (renderElement && renderElement.parentElement) {\n      this.navigationRenderer.renderer.appendTo(renderElement.parentElement);\n      this.titleRenderer.renderer.appendTo(renderElement.parentElement);\n    }\n    this.navigationRenderer.render({\n      rect: this.state.views.layout.navigation,\n      itemRenderer: this.itemRenderer\n    });\n\n    this.titleRenderer.render({\n      rect: this.state.views.layout.title\n    });\n  },\n  beforeUnmount() {\n    this.navigationRenderer.renderer.clear();\n    this.titleRenderer.renderer.clear();\n  },\n  on: {\n    panstart() {\n      if (this.state.interaction.started) {\n        return;\n      }\n      const contentOverflow = this.itemRenderer.getContentOverflow();\n      if (!contentOverflow) {\n        return;\n      }\n      this.state.interaction.started = true;\n      this.state.interaction.delta = 0;\n    },\n    panmove(e) {\n      if (!this.state.interaction.started) {\n        return;\n      }\n      const delta = this.itemRenderer.orientation() === 'horizontal' ? (this.itemRenderer.direction() === 'rtl' ? -1 : 1) * e.deltaX : e.deltaY;\n      this.itemRenderer.scroll(delta - this.state.interaction.delta);\n      this.state.interaction.delta = delta;\n    },\n    panend() {\n      this.state.interaction.started = false;\n    },\n    scroll(delta) {\n      this.itemRenderer.scroll(-delta);\n    },\n    next() {\n      this.itemRenderer.next();\n    },\n    prev() {\n      this.itemRenderer.prev();\n    }\n  },\n  created() {\n    this.rect = {\n      x: 0, y: 0, width: 0, height: 0\n    };\n    this.state = {\n      interaction: {}\n    };\n    this.onScroll = () => {\n      const items = render(this);\n      this.update(items);\n    };\n    this.itemRenderer = itemRendererFactory(this, {\n      onScroll: this.onScroll\n    });\n    this.navigationRenderer = navigationRendererFactory(this);\n    this.titleRenderer = titleRendererFactory(this);\n    this.navigationRenderer.renderer = this.registries.renderer('dom')();\n    this.titleRenderer.renderer = this.registries.renderer()();\n    update(this);\n  },\n  preferredSize(obj) {\n    return preferredSize(this, obj);\n  },\n  beforeUpdate() {\n    update(this);\n  },\n  beforeRender(opts) {\n    this.rect = opts.size;\n  },\n  render() {\n    return render(this);\n  },\n  beforeDestroy() {\n    this.navigationRenderer.renderer.destroy();\n    this.titleRenderer.renderer.destroy();\n  },\n  _DO_NOT_USE_getInfo() {\n    return {\n      offset: this.itemRenderer.offset()\n    };\n  }\n};\n\nexport default component;\n","import component from './legend-cat';\n\n/**\n * @typedef {object} component--legend-cat\n * @property {string} scale\n */\n\n/**\n * @type {string}\n * @memberof component--legend-cat\n */\nconst type = 'legend-cat';\n\nexport default function categoricalLegend(picasso) {\n  picasso.component(type, component);\n}\n","function applyAlignJustify(ctx, node) {\n  let wiggle = 0;\n  const cmd = {\n    type: ctx.state.isVertical ? 'justify' : 'align',\n    coord: ctx.state.isVertical ? 'y' : 'x',\n    pos: ctx.state.isVertical ? 'height' : 'width',\n    fn: ctx.state.isVertical ? 'requiredHeight' : 'requiredWidth'\n  };\n\n  wiggle = ctx.state.rect[cmd.pos] - ctx.state.legend.length() - ctx.state.title[cmd.fn]();\n  wiggle *= Math.min(1, Math.max(ctx.stgns[cmd.type], 0));\n  node[cmd.coord] += wiggle;\n}\n\nexport function generateStopNodes(ctx) {\n  const fillScale = ctx.state.legend.fillScale;\n  const majorScale = ctx.state.legend.majorScale;\n  const stops = fillScale.domain().map(d => ({\n    type: 'stop',\n    color: fillScale(d),\n    offset: Math.min(1, Math.max(0, majorScale.norm(d)))\n  }));\n\n  return stops.sort((a, b) => a.offset - b.offset);\n}\n\nexport function createTitleNode(ctx) {\n  const state = ctx.state;\n  const settings = ctx.stgns;\n  const isTickLeft = state.ticks.anchor === 'left';\n  const isTickTop = state.ticks.anchor === 'top';\n  let x = state.rect.x;\n  let y = state.rect.y;\n  let textAnchor = 'start';\n\n  if (state.title.anchor === 'left') {\n    x += state.title.requiredWidth() - settings.title.padding;\n    y += state.title.textMetrics.height;\n    y += isTickTop ? state.rect.height - state.title.textBounds.height : 0;\n    textAnchor = 'end';\n  } else if (state.title.anchor === 'right') {\n    x += state.legend.length();\n    x += settings.title.padding;\n    y += state.title.textMetrics.height;\n    y += isTickTop ? state.rect.height - state.title.textBounds.height : 0;\n  } else if (state.title.anchor === 'top') {\n    x += isTickLeft ? state.rect.width : 0;\n    y += state.title.textMetrics.height;\n    textAnchor = isTickLeft ? 'end' : 'start';\n  }\n\n  const node = {\n    tag: 'legend-title',\n    type: 'text',\n    x,\n    y: Math.min(y, state.rect.y + state.rect.height),\n    text: settings.title.text,\n    fill: settings.title.fill,\n    fontSize: settings.title.fontSize,\n    fontFamily: settings.title.fontFamily,\n    maxWidth: settings.title.maxLengthPx,\n    maxLines: settings.title.maxLines,\n    wordBreak: settings.title.wordBreak,\n    hyphens: settings.title.hyphens,\n    lineHeight: settings.title.lineHeight,\n    anchor: textAnchor\n  };\n\n  applyAlignJustify(ctx, node);\n  return node;\n}\n\nexport function createLegendRectNode(ctx, stops) {\n  const state = ctx.state;\n  const settings = ctx.stgns;\n  const container = state.rect;\n  let x = container.x;\n  let y = container.y;\n  let width = state.isVertical ? settings.size : state.legend.length();\n  let height = state.isVertical ? state.legend.length() : settings.size;\n\n  if (state.ticks.anchor === 'left') {\n    x += state.rect.width - settings.size;\n  } else if (state.ticks.anchor === 'top') {\n    y += state.rect.height - settings.size;\n  }\n\n  if (state.title.anchor === 'top') {\n    y += state.title.requiredHeight();\n  } else if (state.title.anchor === 'left') {\n    x += state.title.requiredWidth();\n  }\n\n  const node = {\n    type: 'rect',\n    x,\n    y,\n    width,\n    height,\n    fill: {\n      type: 'gradient',\n      stops,\n      degree: state.isVertical ? 90 : 180\n    }\n  };\n\n  applyAlignJustify(ctx, node);\n  return node;\n}\n\nexport function createTickNodes(ctx, legendNode) {\n  const state = ctx.state;\n  const settings = ctx.stgns;\n  let anchor = 'start';\n  const rangeSelectorRect = {\n    type: 'rect',\n    x: legendNode.x,\n    y: legendNode.y,\n    width: state.isVertical ? 0 : legendNode.width,\n    height: state.isVertical ? legendNode.height : 0,\n    fill: 'transparent'\n  };\n\n  const nodes = state.ticks.values.map((tick) => {\n    let x = 0;\n    let y = 0;\n    let dx = 0;\n    let dy = 0;\n\n    if (state.isVertical) {\n      y = legendNode.y + (legendNode.height * tick.pos);\n      dy = tick.pos === 1 ? -(tick.textMetrics.height / 5) : tick.textMetrics.height;\n    } else {\n      x = legendNode.x + (legendNode.width * tick.pos);\n    }\n\n    if (state.ticks.anchor === 'right') {\n      x = legendNode.x + settings.size + settings.tick.padding;\n\n      rangeSelectorRect.x = legendNode.x + legendNode.width;\n    } else if (state.ticks.anchor === 'left') {\n      x = legendNode.x - settings.tick.padding;\n      anchor = 'end';\n    } else if (state.ticks.anchor === 'top') {\n      y = legendNode.y - settings.tick.padding;\n      dy -= tick.textMetrics.height * 0.25;\n      anchor = tick.pos === 0 ? 'start' : 'end';\n    } else if (state.ticks.anchor === 'bottom') {\n      y = legendNode.y + legendNode.height + settings.tick.padding;\n      dy = tick.textMetrics.height * 0.8;\n      anchor = tick.pos === 0 ? 'start' : 'end';\n\n      rangeSelectorRect.y = legendNode.y + legendNode.height;\n    }\n\n    const node = {\n      type: 'text',\n      x,\n      y,\n      dx,\n      dy,\n      text: tick.label,\n      fontSize: settings.tick.fontSize,\n      fontFamily: settings.tick.fontFamily,\n      fill: settings.tick.fill,\n      maxWidth: state.isVertical ? settings.tick.maxLengthPx : Math.min(settings.tick.maxLengthPx, state.legend.length() / 2),\n      anchor,\n      textBoundsFn: ctx.renderer.textBounds\n    };\n\n    return node;\n  });\n\n  return {\n    type: 'container',\n    id: 'legend-seq-ticks',\n    children: [...nodes, rangeSelectorRect]\n  };\n}\n","import {\n  createTitleNode,\n  generateStopNodes,\n  createLegendRectNode,\n  createTickNodes\n} from './node-builder';\n\n\nfunction resolveAnchor(dock, anchor, map) {\n  const mapped = map[dock];\n  if (typeof mapped === 'object') {\n    if (mapped.valid.indexOf(anchor) !== -1) {\n      return anchor;\n    }\n    return mapped.default;\n  }\n\n  return map.default;\n}\n\nfunction resolveTickAnchor(settings) {\n  const dock = settings.dock;\n  const anchor = settings.settings.tick.anchor;\n\n  const dockAnchorMap = {\n    left: { valid: ['left', 'right'], default: 'left' },\n    right: { valid: ['left', 'right'], default: 'right' },\n    top: { valid: ['top', 'bottom'], default: 'top' },\n    bottom: { valid: ['top', 'bottom'], default: 'bottom' },\n    default: 'right'\n  };\n\n  return resolveAnchor(dock, anchor, dockAnchorMap);\n}\n\nfunction resolveTitleAnchor(settings) {\n  const dockAnchorMap = {\n    left: { valid: ['top'], default: 'top' },\n    right: { valid: ['top'], default: 'top' },\n    top: { valid: ['left', 'right'], default: 'left' },\n    bottom: { valid: ['left', 'right'], default: 'left' },\n    default: 'top'\n  };\n\n  const dock = settings.dock;\n  const anchor = settings.settings.title.anchor;\n\n  return resolveAnchor(dock, anchor, dockAnchorMap);\n}\n\nfunction initRect(ctx, size) {\n  const rect = {\n    x: 0, y: 0, width: 0, height: 0\n  };\n  const padding = ctx.stgns.padding;\n  rect.x = padding.left;\n  rect.y = padding.top;\n  rect.width = size.width - padding.left - padding.right;\n  rect.height = size.height - padding.top - padding.bottom;\n\n  return rect;\n}\n\nfunction getTicks(ctx, majorScale) {\n  const values = majorScale.domain();\n  let labels = values;\n  let labelFn = ctx.stgns.tick.label;\n  if (!labelFn && ctx.formatter) {\n    labelFn = ctx.formatter;\n  } else if (!labelFn && majorScale.data().fields) {\n    labelFn = majorScale.data().fields[0].formatter();\n  }\n  if (typeof labelFn === 'function') {\n    labels = values.map(labelFn).map(String);\n  }\n\n  const ticks = values.map((value, i) => {\n    const label = labels[i];\n    return {\n      value,\n      label,\n      pos: majorScale.norm(parseFloat(value, 10)),\n      textMetrics: ctx.renderer.measureText({\n        text: label,\n        fontSize: ctx.stgns.tick.fontSize,\n        fontFamily: ctx.stgns.tick.fontFamily\n      })\n    };\n  });\n\n  return ticks;\n}\n\nfunction initState(ctx) {\n  const isVertical = ctx.settings.dock !== 'top' && ctx.settings.dock !== 'bottom';\n  const titleStgns = ctx.stgns.title;\n\n  const fillScale = ctx.chart.scale(ctx.stgns.fill);\n  const majorScale = ctx.chart.scale(ctx.stgns.major);\n  const tickValues = getTicks(ctx, majorScale);\n  const tickAnchor = resolveTickAnchor(ctx.settings);\n\n  if (typeof titleStgns.text === 'undefined') {\n    const fields = majorScale.data().fields;\n    titleStgns.text = fields && fields[0] ? fields[0].title() : '';\n  }\n\n  const titleTextMetrics = ctx.renderer.measureText({\n    text: titleStgns.text,\n    fontSize: titleStgns.fontSize,\n    fontFamily: titleStgns.fontFamily\n  });\n\n  const titleTextBounds = ctx.renderer.textBounds({\n    text: titleStgns.text,\n    fontSize: titleStgns.fontSize,\n    fontFamily: titleStgns.fontFamily,\n    maxLines: titleStgns.maxLines,\n    maxWidth: titleStgns.maxLengthPx,\n    wordBreak: titleStgns.wordBreak,\n    hyphens: titleStgns.hyphens,\n    lineHeight: titleStgns.lineHeight\n  });\n\n  const state = {\n    isVertical,\n    nodes: [],\n    title: {\n      anchor: resolveTitleAnchor(ctx.settings),\n      textMetrics: titleTextMetrics,\n      textBounds: titleTextBounds,\n      requiredWidth: () => {\n        if (!titleStgns.show) {\n          return 0;\n        }\n        let w = titleTextBounds.width;\n        let mw = titleStgns.maxLengthPx;\n        if (!isVertical) {\n          w += titleStgns.padding;\n          mw += titleStgns.padding;\n        }\n        return Math.min(w, mw, state.rect.width);\n      },\n      requiredHeight: () => {\n        if (!titleStgns.show) {\n          return 0;\n        }\n        let h = titleTextBounds.height;\n        if (isVertical) {\n          h += titleStgns.padding;\n        }\n        return Math.min(h, state.rect.height);\n      }\n    },\n    ticks: {\n      values: tickValues,\n      anchor: tickAnchor,\n      length: Math.min(Math.max(...tickValues.map(t => t.textMetrics.width)), ctx.stgns.tick.maxLengthPx),\n      requiredHeight: () => (tickAnchor === 'top' ? Math.max(...state.ticks.values.map(t => t.textMetrics.height)) + ctx.stgns.tick.padding : 0),\n      height: Math.max(...tickValues.map(t => t.textMetrics.height))\n    },\n    legend: {\n      fillScale,\n      majorScale,\n      length: () => {\n        const pos = isVertical ? 'height' : 'width';\n        const fnPos = isVertical ? 'requiredHeight' : 'requiredWidth';\n        const len = Math.min(state.rect[pos], state.rect[pos] * ctx.stgns.length) - state.title[fnPos]();\n        return Math.max(0, Math.min(len, ctx.stgns.maxLengthPx));\n      }\n    }\n  };\n\n  return state;\n}\n\n/**\n * @typedef {object} component--legend-seq\n * @property {string} fill - Reference to definition of sequential color scale\n * @property {string} major - Reference to definition of linear scale\n * @property {number} [size=15] - Size in pixels of the legend, if vertical is the width and height otherwise\n * @property {number} [length=1] - A value in the range 0-1 indicating the length of the legend node\n * @property {number} [maxLengthPx=250] - Max length in pixels\n * @property {number} [align=0.5] - A value in the range 0-1 indicating horizontal alignment of the legend's content. 0 aligns to the left, 1 to the right.\n * @property {number} [justify=0] - A value in the range 0-1 indicating vertical alignment of the legend's content. 0 aligns to the top, 1 to the bottom.\n * @property {object} [padding]\n * @property {number} [padding.left=5]\n * @property {number} [padding.right=5]\n * @property {number} [padding.top=5]\n * @property {number} [padding.bottom=5]\n * @property {object} [tick]\n * @property {function} [tick.label] - Function applied to all tick values, returned values are used as labels\n * @property {string} [tick.fill='#595959']\n * @property {string} [tick.fontSize='12px']\n * @property {string} [tick.fontFamily='Arial']\n * @property {number} [tick.maxLengthPx=150] - Max length in pixels\n * @property {string} [tick.anchor='right'] - Where to anchor the tick in relation to the legend node, supported values are [top, bottom, left and right]\n * @property {number} [tick.padding=5] - padding in pixels to the legend node\n * @property {object} [title] - Title settings\n * @property {boolean} [title.show=true] - Toggle title on/off\n * @property {string} [title.text=''] - Title text. Defaults to the title of the provided data field\n * @property {string} [title.fill='#595959']\n * @property {string} [title.fontSize='12px']\n * @property {string} [title.fontFamily='Arial']\n * @property {number} [title.maxLengthPx=100] - Max length in pixels\n * @property {number} [title.padding=5] - padding in pixels to the legend node\n * @property {string} [title.anchor='top'] - Where to anchor the title in relation to the legend node, supported values are [top, left and right]\n * @property {string} [title.wordBreak='none'] - How overflowing title is handled, if it should insert line breaks at word boundries (break-word) or character boundries (break-all)\n * @property {string} [title.hyphens='auto'] - How words should be hyphenated when text wraps across multiple lines (only applicable with wordBreak)\n * @property {number} [title.maxLines=2] - Number of allowed lines if title contains line breaks (only applicable with wordBreak)\n * @property {number} [title.lineHeight=1.2] - A multiplier defining the distance between lines (only applicable with wordBreak)\n */\n\nconst legendDef = {\n  require: ['chart', 'settings', 'renderer'],\n  defaultSettings: {\n    displayOrder: 0,\n    dock: 'right',\n    settings: {\n      size: 15,\n      length: 0.5,\n      maxLengthPx: 250,\n      align: 0.5,\n      justify: 0,\n      padding: {\n        left: 5,\n        right: 5,\n        top: 5,\n        bottom: 5\n      },\n      tick: {\n        label: null,\n        fill: '#595959',\n        fontSize: '12px',\n        fontFamily: 'Arial',\n        maxLengthPx: 100,\n        anchor: null, // Use default based on dock\n        padding: 5\n      },\n      title: {\n        show: true,\n        text: undefined,\n        fill: '#595959',\n        fontSize: '12px',\n        fontFamily: 'Arial',\n        maxLengthPx: 100,\n        padding: 5,\n        maxLines: 2,\n        wordBreak: 'none',\n        lineHeight: 1.2,\n        hyphens: 'auto',\n        anchor: null // Use default based on dock\n      }\n    }\n  },\n  preferredSize(opts) {\n    const state = this.state;\n    state.rect = initRect(this, opts.inner);\n\n    // Init with size of legend\n    let prefSize = this.stgns.size;\n\n    // Append paddings\n    const paddings = state.isVertical ? this.stgns.padding.left + this.stgns.padding.right : this.stgns.padding.top + this.stgns.padding.bottom;\n    prefSize += paddings;\n\n    // Append tick size\n    const maxSize = Math.max(opts.inner.width, opts.inner.height);\n    if ((state.ticks.anchor === 'left' || state.ticks.anchor === 'right')) {\n      const tHeight = state.ticks.values.reduce((sum, t) => sum + t.textMetrics.height, 0);\n      if (tHeight > this.state.legend.length()) {\n        return maxSize;\n      }\n      prefSize += state.ticks.length;\n    } else {\n      const tWidth = state.ticks.length;\n      if (tWidth > this.state.legend.length()) {\n        return maxSize;\n      }\n      prefSize += Math.max(...state.ticks.values.map(t => t.textMetrics.height));\n    }\n    prefSize += this.stgns.tick.padding;\n\n    // Append or use title size\n    if (this.stgns.title.show) {\n      if (state.title.anchor === 'left' || state.title.anchor === 'right') {\n        prefSize = Math.max(state.title.textBounds.height + paddings, prefSize);\n      } else {\n        prefSize = Math.max(prefSize, state.title.requiredWidth() + paddings);\n      }\n    }\n\n    this.state.preferredSize = prefSize;\n    return prefSize;\n  },\n  created() {\n    this.stgns = this.settings.settings;\n\n    this.state = initState(this);\n  },\n  beforeUpdate(opts) {\n    this.stgns = opts.settings.settings;\n\n    this.state = initState(this);\n  },\n  beforeRender(opts) {\n    this.state.nodes = [];\n    this.state.rect = initRect(this, opts.size);\n\n    if (this.stgns.title.show) {\n      const titleNode = createTitleNode(this);\n      this.state.nodes.push(titleNode);\n    }\n\n    const stopNodes = generateStopNodes(this);\n    const rectNode = createLegendRectNode(this, stopNodes);\n    const tickNodes = createTickNodes(this, rectNode);\n\n    const targetNode = { // The target node enables range selection component to limit its range to a specific area\n      id: 'legend-seq-target',\n      type: 'container',\n      children: [rectNode, tickNodes]\n    };\n\n    this.state.nodes.push(targetNode);\n  },\n  render() {\n    return this.state.nodes;\n  }\n};\n\nexport default legendDef;\n","import legendSeq from './legend-seq';\n\nexport default function sequentialLegend(picasso) {\n  picasso.component('legend-seq', legendSeq);\n}\n","import extend from 'extend';\nimport {\n  area,\n  curveLinear,\n  curveStep,\n  curveStepAfter,\n  curveStepBefore,\n  curveBasis,\n  curveCardinal,\n  curveCatmullRom,\n  curveMonotoneX,\n  curveMonotoneY,\n  curveNatural\n} from 'd3-shape';\n\nconst CURVES = {\n  step: curveStep,\n  stepAfter: curveStepAfter,\n  stepBefore: curveStepBefore,\n  linear: curveLinear,\n  basis: curveBasis,\n  cardinal: curveCardinal.tension(0),\n  catmullRom: curveCatmullRom,\n  monotonex: curveMonotoneX,\n  monotoney: curveMonotoneY,\n  natural: curveNatural\n};\n\n/**\n * @typedef {object}\n * @alias component--line-settings\n */\nconst SETTINGS = {\n  /**\n   * @typedef {object}\n   */\n  coordinates: {\n    /**\n     * @type {number} */\n    minor: 0.5,\n    /**\n     * @type {number} */\n    major: 0.5,\n    /**\n     * @type {number=} */\n    layerId: 0\n  },\n  /**\n   * @type {string=} */\n  orientation: 'horizontal',\n  /**\n   * @typedef {object} */\n  layers: {\n    /**\n     * @type {string=} */\n    curve: 'linear',\n    /**\n     * @type {boolean=} */\n    show: true,\n    /**\n     * @typedef {object} */\n    line: {\n      /**\n       * @type {string=} */\n      stroke: '#ccc',\n      /**\n       * @type {number=} */\n      strokeWidth: 1,\n      /**\n       * @type {string=} */\n      strokeDasharray: undefined,\n      /**\n       * @type {number=} */\n      opacity: 1,\n      /**\n       * @type {boolean=} */\n      show: true\n    },\n    /**\n     * @typedef {object} */\n    area: {\n      /**\n       * @type {string=} */\n      fill: '#ccc',\n      /**\n       * @type {number=} */\n      opacity: 0.8,\n      /**\n       * @type {boolean=} */\n      show: true\n    }\n  }\n};\n\nfunction createDisplayLayer(points, {\n  generator,\n  item,\n  data\n}, fill = '') {\n  const path = generator(points);\n  const d = {\n    type: 'path',\n    d: path,\n    opacity: item.opacity,\n    stroke: item.stroke,\n    strokeWidth: item.strokeWidth,\n    fill: fill || item.fill,\n    data\n  };\n\n  if (item.strokeDasharray) {\n    d.strokeDasharray = item.strokeDasharray;\n  }\n\n  return d;\n}\n\nfunction createDisplayLayers(layers, {\n  width,\n  height,\n  missingMinor0,\n  stngs\n}) {\n  const nodes = [];\n  const layerStngs = stngs.layers || {};\n  layers.forEach((layer) => {\n    const {\n      lineObj, layerObj, areaObj, points\n    } = layer;\n\n    const areaGenerator = area();\n    let lineGenerator;\n    let secondaryLineGenerator;\n    let minor = { size: height, p: 'y' };\n    let major = { size: width, p: 'x' };\n    if (stngs.orientation === 'vertical') {\n      const temp = extend(true, {}, major);\n      major = extend(true, {}, minor);\n      minor = extend(true, {}, temp);\n    }\n\n    areaGenerator\n      [major.p](d => d.major * major.size) // eslint-disable-line no-unexpected-multiline\n      [`${minor.p}1`](d => d.minor * minor.size) // eslint-disable-line no-unexpected-multiline\n      [`${minor.p}0`](d => d.minor0 * minor.size) // eslint-disable-line no-unexpected-multiline\n      .defined(d => typeof d.minor === 'number' && !isNaN(d.minor))\n      .curve(CURVES[layerObj.curve === 'monotone' ? `monotone${major.p}` : layerObj.curve]);\n    lineGenerator = areaGenerator[`line${minor.p.toUpperCase()}1`]();\n    secondaryLineGenerator = areaGenerator[`line${minor.p.toUpperCase()}0`]();\n\n    // area layer\n    if (layerStngs.area && areaObj.show !== false) {\n      nodes.push(createDisplayLayer(points, {\n        data: layer.firstPoint,\n        item: areaObj,\n        generator: areaGenerator\n      }));\n    }\n\n    // main line layer\n    if (lineObj && lineObj.show !== false) {\n      nodes.push(createDisplayLayer(points, {\n        data: layer.firstPoint,\n        item: lineObj,\n        generator: lineGenerator\n      }, 'none'));\n\n      // secondary line layer, used only when rendering area\n      if (!missingMinor0 && layerStngs.area && areaObj.show !== false) {\n        nodes.push(createDisplayLayer(points, {\n          data: layer.firstPoint,\n          item: lineObj,\n          generator: secondaryLineGenerator\n        }, 'none'));\n      }\n    }\n  });\n\n  return nodes;\n}\n\nfunction resolve({\n  data,\n  stngs,\n  rect,\n  resolver,\n  style\n}) {\n  const { width, height } = rect;\n  const coordinates = resolver.resolve({\n    data,\n    defaults: SETTINGS.coordinates,\n    settings: stngs.coordinates || {},\n    scaled: {\n      major: stngs.orientation === 'vertical' ? height : width,\n      minor: stngs.orientation === 'vertical' ? width : height\n    }\n  });\n\n  // collect points into layers\n  const layerIds = {};\n  let numLines = 0;\n  for (let i = 0; i < coordinates.items.length; i++) {\n    let p = coordinates.items[i];\n    let lid = p.layerId;\n    layerIds[lid] = layerIds[lid] || {\n      order: numLines++, id: lid, items: [], firstPoint: p.data\n    };\n    layerIds[lid].items.push(p);\n  }\n\n  const metaLayers = Object.keys(layerIds).map(lid => layerIds[lid]);\n  const layersData = { items: metaLayers.map(layer => layer.firstPoint) };\n  const layerStngs = stngs.layers || {};\n\n  const layersResolved = resolver.resolve({\n    data: layersData,\n    defaults: {\n      curve: SETTINGS.layers.curve, show: SETTINGS.layers.show\n    },\n    settings: {\n      curve: layerStngs.curve,\n      show: layerStngs.show\n    }\n  });\n\n  const linesResolved = resolver.resolve({\n    data: layersData,\n    defaults: extend({}, SETTINGS.layers.line, style.line),\n    settings: layerStngs.line\n  });\n\n  const areasResolved = resolver.resolve({\n    data: layersData,\n    defaults: extend({}, SETTINGS.layers.area, style.area),\n    settings: layerStngs.area\n  });\n\n  return {\n    coordinates,\n    metaLayers,\n    layers: layersResolved,\n    lines: linesResolved,\n    areas: areasResolved\n  };\n}\n\nfunction calculateVisibleLayers(opts) {\n  const {\n    metaLayers,\n    coordinates,\n    layers,\n    lines,\n    areas\n  } = resolve(opts);\n\n  const visibleLayers = [];\n  metaLayers.forEach((layer, ix) => {\n    const layerObj = layers.items[ix];\n    if (layerObj.show === false) {\n      return;\n    }\n\n    const values = [];\n    const points = [];\n    let point;\n    let pData;\n    for (let i = 0; i < layer.items.length; i++) {\n      point = layer.items[i];\n      pData = point.data;\n      if (isNaN(point.major)) {\n        continue;\n      }\n      if (opts.missingMinor0) {\n        point.minor0 = coordinates.settings.minor.scale ? coordinates.settings.minor.scale(pData.minor0 ? pData.minor0.value : 0) : 0;\n      }\n      if (!isNaN(point.minor)) {\n        values.push(point.minor);\n      }\n      points.push(point);\n    }\n\n    const median = values.sort((a, b) => a - b)[Math.floor((values.length - 1) / 2)];\n\n    visibleLayers.push({\n      layerObj,\n      lineObj: lines.items[ix],\n      areaObj: areas.items[ix],\n      median,\n      points,\n      firstPoint: layer.firstPoint\n    });\n  });\n\n  return visibleLayers;\n}\n\nconst lineMarkerComponent = {\n  require: ['chart', 'resolver'],\n  defaultSettings: {\n    style: {\n      area: '$shape',\n      line: '$shape-outline'\n    }\n  },\n  created() {\n    this.stngs = this.settings.settings || {};\n  },\n  beforeRender({ size }) {\n    this.rect = size;\n  },\n  render({ data }) {\n    const { width, height } = this.rect;\n    const missingMinor0 = !this.stngs.coordinates || typeof this.stngs.coordinates.minor0 === 'undefined';\n\n    const visibleLayers = calculateVisibleLayers({\n      data,\n      stngs: this.stngs,\n      rect: this.rect,\n      resolver: this.resolver,\n      style: this.style,\n      missingMinor0\n    });\n\n    visibleLayers.sort((a, b) => a.median - b.median);\n\n    // generate visuals\n    return createDisplayLayers(visibleLayers, {\n      width,\n      height,\n      missingMinor0,\n      stngs: this.stngs\n    });\n  }\n};\n\nexport default lineMarkerComponent;\n","import component from './line';\n\n/**\n * @typedef {object} component--line\n */\n\n/**\n * @type {string}\n * @memberof component--line\n */\nconst type = 'line';\n\nexport default function pointMarker(picasso) {\n  picasso.component(type, component);\n}\n\n","import extend from 'extend';\nimport NarrowPhaseCollision from '../../../core/math/narrow-phase-collision';\n\n/**\n * @typedef {object} component--brush-area-brush\n * @property {string} key - Component key\n * @property {string[]} [contexts] - Name of the brushing contexts to affect\n * @property {string[]} [data] - The mapped data properties to add to the brush\n * @property {string} [action='set'] - Type of action to respond with\n */\n\n/**\n  * @typedef {object}\n  * @alias component--brush-area-settings\n  */\nconst DEFAULT_SETTINGS = {\n  /**\n   * @type {object}\n   */\n  brush: {\n    /**\n   * @type {Array<component--brush-area-brush>}\n   */\n    components: []\n  }\n};\n\n/**\n * Transform the incoming event into point in the local coordinate system. That is the coordinate system of the component.\n * @private\n * @param {object} ctx - Context\n * @param {object} event - Incoming event, either native event or hammer event\n * @param {boolean} clamp - True to clamp the point inside the component bounds\n * @returns {point}\n */\nfunction getLocalPoint(ctx, event, clamp = true) {\n  let x;\n  let y;\n\n  if (typeof event.center === 'object') {\n    x = event.center.x;\n    y = event.center.y;\n  } else {\n    x = event.clientX;\n    y = event.clientY;\n  }\n\n  const localX = x - ctx.state.boundingRect.left;\n  const localY = y - ctx.state.boundingRect.top;\n\n  return {\n    x: clamp ? Math.max(0, Math.min(localX, ctx.rect.width)) : localX,\n    y: clamp ? Math.max(0, Math.min(localY, ctx.rect.height)) : localY\n  };\n}\n\n/**\n * Transform a local point into a point in the chart coordinate system.\n * @private\n * @param {object} ctx - Context\n * @param {object} p - Point to transform\n * @returns {point}\n */\nfunction localToChartPoint(ctx, p) {\n  return {\n    x: p.x + ctx.rect.x,\n    y: p.y + ctx.rect.y\n  };\n}\n\n/**\n * Extract and apply default brush configuration.\n * @private\n * @param {object} settings\n * @returns {object[]} An Array of brush configurations\n */\nfunction getBrushConfig(settings) {\n  return settings.settings.brush.components.map(b => (\n    {\n      key: b.key,\n      contexts: b.contexts,\n      data: b.data,\n      action: b.action || 'set'\n    }));\n}\n\n/**\n * End all active brush contexts.\n * @private\n * @param {oject} state\n * @param {object} chart - Chart instance\n */\nfunction doEndBrush(state, chart) {\n  state.brushConfig.forEach((config) => {\n    if (Array.isArray(config.contexts)) {\n      config.contexts.forEach((context) => {\n        chart.brush(context).end();\n      });\n    }\n  });\n}\n\n/**\n * Convert two points into a rectangle.\n * @private\n * @param {point} p0\n * @param {point} p1\n * @returns {rect}\n */\nfunction toRect(p0, p1) {\n  const xMin = Math.min(p0.x, p1.x);\n  const yMin = Math.min(p0.y, p1.y);\n  const xMax = Math.max(p0.x, p1.x);\n  const yMax = Math.max(p0.y, p1.y);\n\n  return {\n    x: xMin,\n    y: yMin,\n    width: xMax - xMin,\n    height: yMax - yMin\n  };\n}\n\n/**\n * Perform a brush on the given area.\n * @private\n * @param {object} ctx\n */\nfunction doAreaBrush(ctx) {\n  if (ctx.state.active) {\n    const start = localToChartPoint(ctx, ctx.state.start);\n    const end = localToChartPoint(ctx, ctx.state.end);\n\n    const shapes = ctx.chart.shapesAt(toRect(start, end), { components: ctx.state.brushConfig });\n    ctx.chart.brushFromShapes(shapes, { components: ctx.state.brushConfig });\n  }\n}\n\nfunction render(ctx) {\n  ctx.renderer.render([\n    extend({ type: 'rect' }, toRect(ctx.state.start, ctx.state.end), ctx.style.area)\n  ]);\n}\n\nfunction resetState() {\n  return {\n    start: { x: 0, y: 0 },\n    end: { x: 0, y: 0 },\n    active: false\n  };\n}\n\nconst definition = {\n  require: ['chart', 'renderer'],\n  defaultSettings: {\n    displayOrder: 99,\n    settings: DEFAULT_SETTINGS,\n    style: {\n      area: '$selection-area-target'\n    }\n  },\n  on: {\n    areaStart(e) {\n      this.start(e);\n    },\n    areaMove(e) {\n      this.move(e);\n    },\n    areaEnd(e) {\n      this.end(e);\n    },\n    areaCancel() {\n      this.cancel();\n    }\n  },\n  created() {\n    this.state = resetState();\n  },\n  preferredSize() {\n    return 0;\n  },\n  render() {},\n  beforeRender({ size }) {\n    this.rect = size;\n  },\n  start(e) {\n    this.state.boundingRect = this.renderer.element().getBoundingClientRect();\n    const p = getLocalPoint(this, e, false);\n\n    // Require event to be inside the component bounds\n    if (!NarrowPhaseCollision.testRectPoint({\n      x: 0, y: 0, width: this.rect.width, height: this.rect.height\n    }, p)) {\n      return;\n    }\n\n    this.state.brushConfig = getBrushConfig(this.settings);\n    this.state.start = getLocalPoint(this, e);\n    this.state.active = true;\n  },\n  move(e) {\n    if (!this.state.active) {\n      return;\n    }\n\n    this.state.end = getLocalPoint(this, e);\n\n    doAreaBrush(this);\n    render(this);\n  },\n  end() {\n    if (!this.state.active) {\n      return;\n    }\n\n    this.state = resetState();\n    this.renderer.render([]);\n  },\n  cancel() {\n    if (!this.state.active) {\n      return;\n    }\n    doEndBrush(this.state, this.chart);\n    this.state = resetState();\n    this.renderer.render([]);\n  }\n\n};\n\nexport default definition;\n","import definition from './brush-area';\n\nexport default function areaBrush(picasso) {\n  picasso.component('brush-area', definition);\n}\n","import boxComponent from '../core/chart-components/box';\nimport pointComponent from '../core/chart-components/point';\nimport pieComponent from '../core/chart-components/pie';\nimport gridLineComponent from '../core/chart-components/grid';\nimport refLineComponent from '../core/chart-components/ref-line';\nimport axisComponent from '../core/chart-components/axis';\nimport textComponent from '../core/chart-components/text';\nimport scrollbarComponent from '../core/chart-components/scrollbar';\nimport brushRangeComponent from '../web/components/brush-range';\nimport rangeComponent from '../core/chart-components/range';\nimport brushLassoComponent from '../core/chart-components/brush-lasso';\nimport labelsComponent from '../core/chart-components/labels';\nimport categoricalLegend from '../core/chart-components/legend-cat';\nimport sequentialLegend from '../core/chart-components/legend-seq';\nimport lineComponent from '../core/chart-components/line';\nimport brushAreaComponent from '../web/components/brush-area';\n\nexport default [\n  boxComponent,\n  pointComponent,\n  pieComponent,\n  gridLineComponent,\n  refLineComponent,\n  axisComponent,\n  textComponent,\n  scrollbarComponent,\n  brushRangeComponent,\n  rangeComponent,\n  brushLassoComponent,\n  labelsComponent,\n  categoricalLegend,\n  sequentialLegend,\n  lineComponent,\n  brushAreaComponent\n];\n","class Node {\n  /**\n   * @private\n   */\n  constructor(type) {\n    this._parent = null;\n    this._children = [];\n    this._ancestors = null;\n    this.type = type;\n    this.data = null;\n  }\n\n  /**\n   * Detaches this node from its parent, if such exists.\n   * @returns {Node}\n   */\n  detach() {\n    if (this._parent) {\n      this._parent.removeChild(this);\n    }\n    return this;\n  }\n\n  /**\n   * Parent of this node.\n   * @readonly\n   * @type {Node}\n   */\n  get parent() {\n    return this._parent;\n  }\n\n  /**\n   * Checks whether this node is a branch.\n   *\n   * True if this node has children, false otherwise.\n   * @readonly\n   * @type {Boolean}\n   */\n  get isBranch() {\n    return this._children && this._children.length;\n  }\n\n  /**\n   * Children of this node.\n   * @readonly\n   * @type {Node[]}\n   */\n  get children() {\n    return this._children;\n  }\n\n  /**\n   * Ancestors of this node, including parent.\n   * @readonly\n   * @type {Node[]}\n   */\n  get ancestors() {\n    if (!this._ancestors) {\n      const p = this._parent;\n      this._ancestors = p ? [p].concat(p.ancestors) : [];\n    }\n\n    return this._ancestors;\n  }\n\n  /**\n   * Descendants of this node.\n   * @readonly\n   * @type {Node[]}\n   */\n  get descendants() {\n    let r = [],\n      i,\n      len,\n      c;\n\n    for (i = 0, len = this._children.length; i < len; i++) {\n      c = this._children[i];\n      r.push(c);\n\n      if (c._children.length) {\n        r = r.concat(c.descendants);\n      }\n    }\n    return r;\n  }\n\n  /**\n   *\n   * @returns {Boolean}\n   */\n  equals(n) {\n    const children = this.children;\n    const nChildren = n.children;\n    if (children.length !== nChildren.length) {\n      return false;\n    }\n    // Requires deterministic child order\n    for (let i = 0; i < children.length; i++) {\n      if (!children[i].equals(nChildren[i])) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  toJSON() {\n    return {\n      type: this.type,\n      children: this.children.map(ch => ch.toJSON())\n    };\n  }\n}\n\nexport default Node;\n","import {\n  pointsToLine,\n  pointsToRect\n} from '../geometry/util';\nimport NarrowPhaseCollision from '../math/narrow-phase-collision';\n\n/**\n * Construct a new GeoRect instance\n * @private\n */\nclass GeoRect {\n  constructor({\n    x = 0, y = 0, width = 0, height = 0, minWidth = 0, minHeight = 0\n  } = {}) {\n    this.set({\n      x, y, width, height, minWidth, minHeight\n    });\n  }\n\n  set({\n    x = 0, y = 0, width = 0, height = 0, minWidth = 0, minHeight = 0\n  } = {}) {\n    this.type = 'rect';\n\n    if (width >= 0) {\n      this.x = x;\n      this.width = Math.max(width, minWidth);\n    } else {\n      this.x = x + Math.min(width, -minWidth);\n      this.width = -Math.min(width, -minWidth);\n    }\n\n    if (height >= 0) {\n      this.y = y;\n      this.height = Math.max(height, minHeight);\n    } else {\n      this.y = y + Math.min(height, -minHeight);\n      this.height = -Math.min(height, -minHeight);\n    }\n  }\n\n  /**\n   * @param {point} p\n   * @returns {boolean} True if there is an intersection, false otherwise\n   */\n  containsPoint(p) {\n    return NarrowPhaseCollision.testRectPoint(this, p);\n  }\n\n  /**\n   * @param {point[]} points - Line start and end point as an array of points\n   * @returns {boolean} True if there is an intersection, false otherwise\n   */\n  intersectsLine(points) {\n    const line = pointsToLine(points);\n    return NarrowPhaseCollision.testRectLine(this, line);\n  }\n\n  /**\n   * @param {point[]} points - Rect vertices as an array of points\n   * @returns {boolean} True if there is an intersection, false otherwise\n   */\n  intersectsRect(points) {\n    const rect = pointsToRect(points);\n    return NarrowPhaseCollision.testRectRect(this, rect);\n  }\n\n  /**\n   * @param {circle} c\n   * @returns {boolean} True if there is an intersection, false otherwise\n   */\n  intersectsCircle(c) {\n    return NarrowPhaseCollision.testCircleRect(c, this);\n  }\n\n  /**\n   * @param {GeoPolygon} polygon\n   * @returns {boolean} True if there is an intersection, false otherwise\n   */\n  intersectsPolygon(polygon) {\n    return NarrowPhaseCollision.testPolygonRect(polygon, this);\n  }\n\n  /**\n   * Get the points\n   * @returns {point[]}\n   */\n  points() {\n    return [\n      { x: this.x, y: this.y },\n      { x: this.x + this.width, y: this.y },\n      { x: this.x + this.width, y: this.y + this.height },\n      { x: this.x, y: this.y + this.height }\n    ];\n  }\n}\n\nfunction create(...args) {\n  return new GeoRect(...args);\n}\n\nexport {\n  GeoRect as default,\n  create\n};\n","import { pointsToLine, pointsToRect } from '../geometry/util';\nimport NarrowPhaseCollision from '../math/narrow-phase-collision';\n\n/**\n * Construct a new GeoCircle instance\n * @private\n */\nclass GeoCircle {\n  constructor({\n    cx = 0, cy = 0, r = 0, minRadius = 0\n  } = {}) {\n    this.set({\n      cx, cy, r, minRadius\n    });\n  }\n\n  set({\n    cx = 0, cy = 0, r = 0, minRadius = 0\n  } = {}) {\n    this.type = 'circle';\n    this.cx = cx;\n    this.cy = cy;\n    this.r = Math.max(r, minRadius);\n    this.vector = { x: this.cx, y: this.cy };\n  }\n\n  /**\n   * @param {point} p\n   * @returns {boolean} True if there is an intersection, false otherwise\n   */\n  containsPoint(p) {\n    return NarrowPhaseCollision.testCirclePoint(this, p);\n  }\n\n  /**\n   * @param {point[]} points - Line start and end point as an array of points\n   * @returns {boolean} True if there is an intersection, false otherwise\n   */\n  intersectsLine(points) {\n    const line = pointsToLine(points);\n\n    return NarrowPhaseCollision.testCircleLine(this, line);\n  }\n\n  /**\n   * @param {point[]} points - Rect vertices as an array of points\n   * @returns {boolean} True if there is an intersection, false otherwise\n   */\n  intersectsRect(points) {\n    const rect = pointsToRect(points);\n\n    return NarrowPhaseCollision.testCircleRect(this, rect);\n  }\n\n  /**\n   * @param {circle} c\n   * @returns {boolean} True if there is an intersection, false otherwise\n   */\n  intersectsCircle(c) {\n    return NarrowPhaseCollision.testCircleCircle(this, c);\n  }\n\n  /**\n   * @param {GeoPolygon} polygon\n   * @returns {boolean} True if there is an intersection, false otherwise\n   */\n  intersectsPolygon(polygon) {\n    return NarrowPhaseCollision.testCirclePolygon(this, polygon);\n  }\n\n  /**\n   * Get the points\n   * @returns {point[]}\n   */\n  points() {\n    return [\n      {\n        x: this.cx,\n        y: this.cy\n      }\n    ];\n  }\n}\n\nfunction create(...args) {\n  return new GeoCircle(...args);\n}\n\nexport {\n  GeoCircle as default,\n  create\n};\n","import { pointsToLine, pointsToRect } from '../geometry/util';\nimport NarrowPhaseCollision from '../math/narrow-phase-collision';\n\n/**\n * Construct a new GeoLine instance\n * @private\n */\nclass GeoLine {\n  constructor({\n    x1 = 0, y1 = 0, x2 = 0, y2 = 0, tolerance = 0\n  } = {}) {\n    this.set({\n      x1, y1, x2, y2, tolerance\n    });\n  }\n\n  set({\n    x1 = 0, y1 = 0, x2 = 0, y2 = 0, tolerance = 0\n  } = {}) {\n    this.type = 'line';\n    this.x1 = x1;\n    this.y1 = y1;\n    this.x2 = x2;\n    this.y2 = y2;\n    this.tolerance = Math.max(0, Math.round(tolerance));\n\n    this.vectors = this.points();\n    this.zeroSize = x1 === x2 && y1 === y2;\n  }\n\n  /**\n   * @param {point} p\n   * @returns {boolean} True if there is an intersection, false otherwise\n   */\n  containsPoint(p) {\n    if (this.tolerance > 0) {\n      const c = { cx: p.x, cy: p.y, r: this.tolerance };\n      return NarrowPhaseCollision.testCircleLine(c, this);\n    }\n    return NarrowPhaseCollision.testLinePoint(this, p);\n  }\n\n  /**\n   * @param {point[]} points - Line start and end point as an array of points\n   * @returns {boolean} True if there is an intersection, false otherwise\n   */\n  intersectsLine(points) {\n    const line = pointsToLine(points);\n    return NarrowPhaseCollision.testLineLine(this, line);\n  }\n\n  /**\n   * @param {point[]} points - Rect vertices as an array of points\n   * @returns {boolean} True if there is an intersection, false otherwise\n   */\n  intersectsRect(points) {\n    const rect = pointsToRect(points);\n    return NarrowPhaseCollision.testRectLine(rect, this);\n  }\n\n  /**\n   * @param {circle} c\n   * @returns {boolean} True if there is an intersection, false otherwise\n   */\n  intersectsCircle(c) {\n    return NarrowPhaseCollision.testCircleLine(c, this);\n  }\n\n  /**\n   * @param {GeoPolygon} polygon\n   * @returns {boolean} True if there is an intersection, false otherwise\n   */\n  intersectsPolygon(polygon) {\n    return NarrowPhaseCollision.testPolygonLine(polygon, this);\n  }\n\n  /**\n   * Get the points\n   * @returns {point[]}\n   */\n  points() {\n    return [\n      { x: this.x1, y: this.y1 },\n      { x: this.x2, y: this.y2 }\n    ];\n  }\n}\n\nfunction create(...args) {\n  return new GeoLine(...args);\n}\n\nexport {\n  GeoLine as default,\n  create\n};\n","import {\n  pointsToLine,\n  pointsToRect\n} from './util';\nimport NarrowPhaseCollision from '../math/narrow-phase-collision';\n\nfunction close(vertices) {\n  const first = vertices[0];\n  const last = vertices[vertices.length - 1];\n\n  if (first.x !== last.x || first.y !== last.y) {\n    vertices.push(first);\n  }\n}\n\nfunction removeDuplicates(vertices) {\n  for (let i = 0; i < vertices.length - 1; i++) {\n    const v0 = vertices[i];\n    const v1 = vertices[i + 1];\n    if (v0.x === v1.x && v0.y === v1.y) {\n      vertices.splice(i, 1);\n      i--;\n    }\n  }\n}\n\n/**\n * Construct a new GeoPolygon instance\n * @private\n */\nclass GeoPolygon {\n  constructor({ vertices = [] } = {}) {\n    this.set({ vertices });\n  }\n\n  /**\n   * Set the vertices.\n   * If vertices doesn't close the polygon, a closing vertice is appended.\n   * @param {object} input An object with a vertices property\n   * @param {point[]} [input.vertices=[]] Vertices are represented as an array of points.\n   */\n  set({ vertices = [] } = {}) {\n    this.type = 'polygon';\n    this.vertices = vertices.slice();\n    this.edges = [];\n\n    removeDuplicates(this.vertices);\n\n    if (this.vertices.length <= 2) {\n      return;\n    }\n\n    close(this.vertices);\n\n    this.xMin = NaN;\n    this.yMin = NaN;\n    this.xMax = NaN;\n    this.yMax = NaN;\n\n    for (let i = 0; i < this.vertices.length; i++) {\n      if (i < this.vertices.length - 1) {\n        this.edges.push([this.vertices[i], this.vertices[i + 1]]);\n      }\n\n      this.xMin = isNaN(this.xMin) ? this.vertices[i].x : Math.min(this.xMin, this.vertices[i].x);\n      this.xMax = isNaN(this.xMax) ? this.vertices[i].x : Math.max(this.xMax, this.vertices[i].x);\n      this.yMin = isNaN(this.yMin) ? this.vertices[i].y : Math.min(this.yMin, this.vertices[i].y);\n      this.yMax = isNaN(this.yMax) ? this.vertices[i].y : Math.max(this.yMax, this.vertices[i].y);\n    }\n\n    this._bounds = null;\n    this._boundingRect = null;\n  }\n\n  /**\n   * Check if a point is inside the area of the polygon.\n   * Supports convex, concave and self-intersecting polygons (filled area).\n   * @param {point} point\n   * @returns {boolean} True if there is an intersection, false otherwise\n   */\n  containsPoint(point) {\n    return NarrowPhaseCollision.testPolygonPoint(this, point);\n  }\n\n  /**\n   * Check if circle is inside the area of the polygon.\n   * Supports convex, concave and self-intersecting polygons (filled area).\n   * @param {circle} circle\n   * @returns {boolean} True if there is an intersection, false otherwise\n   */\n  intersectsCircle(circle) {\n    return NarrowPhaseCollision.testCirclePolygon(circle, this);\n  }\n\n  /**\n   * @param {point[]} points - Line start and end point as an array of points\n   * @returns {boolean} True if there is an intersection, false otherwise\n   */\n  intersectsLine(points) {\n    return NarrowPhaseCollision.testPolygonLine(this, pointsToLine((points)));\n  }\n\n  /**\n   * @param {point[]} points - Rect vertices as an array of points\n   * @returns {boolean} True if there is an intersection, false otherwise\n   */\n  intersectsRect(points) {\n    return NarrowPhaseCollision.testPolygonRect(this, pointsToRect(points));\n  }\n\n  /**\n   * Check if polygon intersects another polygon.\n   * Supports convex, concave and self-intersecting polygons (filled area).\n   * @param {GeoPolygon} polygon\n   * @returns {boolean} True if there is an intersection, false otherwise\n   */\n  intersectsPolygon(polygon) {\n    // This is a unoptimized solution and should be replaced by a more efficient algorithm.\n    if (!NarrowPhaseCollision.testRectRect(this.boundingRect(), polygon.boundingRect())) {\n      return false;\n    }\n\n    let intersects = false;\n    for (let i = 0, len = this.edges.length; i < len; i++) {\n      intersects = NarrowPhaseCollision.testPolygonLine(polygon, pointsToLine(this.edges[i]));\n      if (intersects === true) {\n        break;\n      }\n    }\n    return intersects;\n  }\n\n  /**\n   * Get the points\n   * @returns {point[]}\n   */\n  points() {\n    return this.vertices;\n  }\n\n  /**\n   * Get the bounds of the polygon, as an array of points\n   * @returns {point[]}\n   */\n  bounds() {\n    if (!this._bounds) {\n      this._bounds = [\n        { x: this.xMin, y: this.yMin },\n        { x: this.xMax, y: this.yMin },\n        { x: this.xMax, y: this.yMax },\n        { x: this.xMin, y: this.yMax }\n      ];\n    }\n\n    return this._bounds;\n  }\n\n  /**\n   * Get the bounding rect of the polygon\n   * @returns {rect}\n   */\n  boundingRect() {\n    if (!this._boundingRect) {\n      this._boundingRect = {\n        x: this.xMin,\n        y: this.yMin,\n        width: this.xMax - this.xMin,\n        height: this.yMax - this.yMin\n      };\n    }\n    return this._boundingRect;\n  }\n}\n\n\n/**\n* Construct a new GeoPolygon instance\n* @param {object} input An object with a vertices property\n* @param {point[]} [input.vertices=[]] Vertices are represented as an array of points.\n* @returns {GeoPolygon} GeoPolygon instance\n* @private\n*/\nfunction create(...a) {\n  return new GeoPolygon(...a);\n}\n\nexport {\n  create,\n  GeoPolygon as default\n};\n","import {\n  pointsToLine,\n  pointsToRect\n} from './util';\nimport NarrowPhaseCollision from '../math/narrow-phase-collision';\n\nfunction pointsAreNotEqual(p0, p1) {\n  return p0.x !== p1.x || p0.y !== p1.y;\n}\n\n/**\n * Construct a new GeoPolyline instance\n * @private\n */\nclass GeoPolyline {\n  constructor({ points = [] } = {}) {\n    this.set({ points });\n  }\n\n  set({ points = [] } = {}) {\n    this.type = 'polyline';\n    this.segments = [];\n    this._points = points.slice();\n\n    if (this._points.length > 1) {\n      for (let i = 0, len = this._points.length - 1; i < len; i++) {\n        if (pointsAreNotEqual(this._points[i], this._points[i + 1])) {\n          this.segments.push({\n            x1: this._points[i].x,\n            y1: this._points[i].y,\n            x2: this._points[i + 1].x,\n            y2: this._points[i + 1].y\n          });\n        }\n      }\n    }\n  }\n\n  /**\n   * @param {point} point\n   * @returns {boolean} True if there is an intersection, false otherwise\n   */\n  containsPoint(point) {\n    return this.segments.some(line => NarrowPhaseCollision.testLinePoint(line, point));\n  }\n\n  /**\n   * @param {circle} circle\n   * @returns {boolean} True if there is an intersection, false otherwise\n   */\n  intersectsCircle(circle) {\n    return this.segments.some(line => NarrowPhaseCollision.testCircleLine(circle, line));\n  }\n\n  /**\n   * @param {point[]} points - Line start and end point as an array of points\n   * @returns {boolean} True if there is an intersection, false otherwise\n   */\n  intersectsLine(points) {\n    const testLine = pointsToLine(points);\n    return this.segments.some(line => NarrowPhaseCollision.testLineLine(line, testLine));\n  }\n\n  /**\n   * @param {point[]} points - Rect vertices as an array of points\n   * @returns {boolean} True if there is an intersection, false otherwise\n   */\n  intersectsRect(points) {\n    const rect = pointsToRect(points);\n    return this.segments.some(line => NarrowPhaseCollision.testRectLine(rect, line));\n  }\n\n  /**\n   * @param {GeoPolygon} polygon\n   * @returns {boolean} True if there is an intersection, false otherwise\n   */\n  intersectsPolygon(polygon) {\n    // This is a unoptimized solution and should be replaced by a more efficient algorithm.\n    return this.segments.some(line => NarrowPhaseCollision.testPolygonLine(polygon, line));\n  }\n\n  /**\n   * Get the points\n   * @returns {point[]}\n   */\n  points() {\n    return this._points;\n  }\n}\n\nfunction create(...a) {\n  return new GeoPolyline(...a);\n}\n\nexport {\n  create,\n  GeoPolyline as default\n};\n","import { create as rect } from './rect';\nimport { create as circle } from './circle';\nimport { create as line } from './line';\nimport { create as polygon } from './polygon';\nimport { create as polyline } from './polyline';\nimport registry from '../utils/registry';\n\nconst reg = registry();\n\nreg.add('rect', rect);\nreg.add('circle', circle);\nreg.add('line', line);\nreg.add('polygon', polygon);\nreg.add('polyline', polyline);\n\nexport function create(type, input) { // eslint-disable-line import/prefer-default-export\n  return reg.get(type)(input);\n}\n\n/**\n * @typedef {object} rect\n * @property {number} x - X-coordinate\n * @property {number} y - Y-coordinate\n * @property {number} width - Width\n * @property {number} height - Height\n */\n\n/**\n * @typedef {object} line\n * @property {number} x1 - Start x-coordinate\n * @property {number} y1 - Start y-coordinate\n * @property {number} x2 - End x-coordinate\n * @property {number} y2 - End y-coordinate\n */\n\n/**\n * @typedef {object} point\n * @property {number} x - X-coordinate\n * @property {number} y - Y-coordinate\n */\n\n/**\n * @typedef {object} circle\n * @property {number} cx - Center x-coordinate\n * @property {number} cy - Center y-coordinate\n * @property {number} r - Circle radius\n */\n\n/**\n * @typedef {object} polygon\n * @property {Array<point>} points - Array of connected points\n */\n\n/**\n * @typedef {object} polyline\n * @property {Array<point>} points - Array of connected points\n */\n\n/**\n * @typedef {object} path\n * @property {string} d - Path definition\n */\n","import { create as factory } from './index';\n\n/**\n * Construct a new GeometryCollection instance\n * @private\n  */\nclass GeometryCollection {\n  constructor(collection = []) {\n    this.set(collection);\n  }\n\n  set(collection = []) {\n    this.geometries = [];\n    collection.forEach((geo) => {\n      const geoInstance = factory(geo.type, geo);\n      if (geoInstance) {\n        this.geometries.push(geoInstance);\n      }\n    });\n  }\n\n  /**\n   * @param {point} p\n   * @returns {boolean} True if there is an intersection, false otherwise\n   */\n  containsPoint(p) {\n    return this.geometries.some(geo => geo.containsPoint(p));\n  }\n\n  /**\n   * @param {point[]} points - Line start and end point as an array of points\n   * @returns {boolean} True if there is an intersection, false otherwise\n   */\n  intersectsLine(points) {\n    return this.geometries.some(geo => geo.intersectsLine(points));\n  }\n\n  /**\n   * @param {point[]} points - Rect vertices as an array of points\n   * @returns {boolean} True if there is an intersection, false otherwise\n   */\n  intersectsRect(points) {\n    return this.geometries.some(geo => geo.intersectsRect(points));\n  }\n\n  /**\n   * @param {circle} c\n   * @returns {boolean} True if there is an intersection, false otherwise\n   */\n  intersectsCircle(c) {\n    return this.geometries.some(geo => geo.intersectsCircle(c));\n  }\n\n  /**\n   * @param {GeoPolygon} polygon\n   * @returns {boolean} True if there is an intersection, false otherwise\n   */\n  intersectsPolygon(polygon) {\n    return this.geometries.some(geo => geo.intersectsPolygon(polygon));\n  }\n}\n\nfunction create(...args) {\n  return new GeometryCollection(...args);\n}\n\nexport {\n  GeometryCollection as default,\n  create\n};\n","class Matrix {\n  /**\n   * Creates a matrix with identity values.\n   * @private\n   */\n  constructor() {\n    this._elements = [\n      [1, 0, 0],\n      [0, 1, 0],\n      [0, 0, 1]\n    ];\n\n    this._stack = [];\n  }\n\n  /**\n   * Creates a new matrix with a copy of the current values.\n   */\n  clone() {\n    const mt = new Matrix();\n    return mt.multiply(this);\n  }\n\n  /**\n  * Sets the matrix values\n  * @param {Number[][]} arr A 3x3 array.\n  */\n  set(arr) {\n    this._elements = arr;\n    return this;\n  }\n\n  /**\n  * Saves the current matrix values to a stack.\n  */\n  save() {\n    this._stack.push(this.elements);\n    return this;\n  }\n\n  /**\n  * Sets the current matrix values to the last ones saved on to the stack.\n  */\n  restore() {\n    if (this._stack.length) {\n      this._elements = this._stack.pop(); // TODO - use a copy instead\n    }\n    return this;\n  }\n\n  /**\n  * Adds a scalar value to each element in the matrix.\n  * @param {Number} value\n  */\n  add(value) { // assume scalar\n    let i,\n      j;\n    for (i = 0; i < this._elements.length; i++) {\n      for (j = 0; j < this._elements[i].length; j++) {\n        this._elements[i][j] += value;\n      }\n    }\n    return this;\n  }\n\n  /**\n  * Translates the current matrix along the x and y axis.\n  * @param {Number} x\n  * @param {Number} y\n  */\n  translate(x, y) {\n    this.multiply([[1, 0, x], [0, 1, y], [0, 0, 1]]);\n    return this;\n  }\n\n  /**\n  * Rotates the current matrix.\n  * @param {Number} radianAngle Angle in radians.\n  */\n  rotate(radianAngle) {\n    let cos = Math.cos(-radianAngle),\n      sin = Math.sin(-radianAngle);\n    this.multiply([[cos, sin, 0], [-sin, cos, 0], [0, 0, 1]]);\n    return this;\n  }\n\n  /**\n  *\n  * If value is a number; multiplies each element in the matrix by the given value.\n  * If value is a matrix; multiplies the two matrices.\n  * @param {Number|Array|Matrix} value\n  */\n  multiply(value) {\n    let i,\n      j,\n      m,\n      k;\n    if (value instanceof Matrix) {\n      value = value._elements;\n    }\n    if (Array.isArray(value)) { // matrix multiplication\n      m = [\n        [0, 0, 0],\n        [0, 0, 0],\n        [0, 0, 0]\n      ];\n      for (i = 0; i < this._elements.length; i++) { // row\n        for (j = 0; j < this._elements[i].length; j++) { // column\n          for (k = 0; k < 3; k++) { // row\n            m[i][j] += this._elements[i][k] * value[k][j];\n          }\n        }\n      }\n      this._elements = m;\n    } else { // scalar multiplication\n      for (i = 0; i < this._elements.length; i++) {\n        for (j = 0; j < this._elements[i].length; j++) {\n          this._elements[i][j] *= value;\n        }\n      }\n    }\n    return this;\n  }\n\n  /**\n  * Scales the matrix along x and y axis.\n  * @param {Number} x The value to scale the matrix with along the x direction\n  * @param {Number} [y=x] The value to scale the matrix with along the y direction.\n  */\n  scale(x, y = x) {\n    // if ( arguments.length < 2 || typeof y === \"undefined\" ) {\n    //  y = x;\n    // }\n\n    this.multiply([[x, 0, 0], [0, y, 0], [0, 0, 1]]);\n    return this;\n  }\n\n  /**\n   * Multiples the matrix with the supplied transformation values\n   * @param {Number} a Horizontal scaling\n   * @param {Number} b Horizontal skewing\n   * @param {Number} c Vertical skewing\n   * @param {Number} d Vertical scaling\n   * @param {Number} e Horizontal moving\n   * @param {Number} f Vertical scaling\n   */\n  transform(a, b, c, d, e, f) {\n    this.multiply([[a, c, e], [b, d, f], [0, 0, 1]]);\n\n    return this;\n  }\n\n  /**\n  * Gets the value of the determinant.\n  * @return {Number}\n  */\n  determinant() {\n    let a = this._elements[0][0],\n      b = this._elements[0][1],\n      c = this._elements[0][2],\n      d = this._elements[1][0],\n      e = this._elements[1][1],\n      f = this._elements[1][2],\n      g = this._elements[2][0],\n      h = this._elements[2][1],\n      i = this._elements[2][2],\n      p = 0;\n\n    p = ((a * e * i) + (b * f * g) + (c * d * h)) - (c * e * g) - (b * d * i) - (a * f * h);\n\n    return p;\n  }\n\n  /**\n  * Inverts the matrix.\n  */\n  invert() {\n    let dt = this.determinant(),\n      a = this._elements[0][0],\n      b = this._elements[0][1],\n      c = this._elements[0][2],\n      d = this._elements[1][0],\n      e = this._elements[1][1],\n      f = this._elements[1][2],\n      g = this._elements[2][0],\n      h = this._elements[2][1],\n      k = this._elements[2][2];\n\n    this._elements = [\n      [(e * k) - (f * h), (c * h) - (b * k), (b * f) - (c * e)],\n      [(f * g) - (d * k), (a * k) - (c * g), (c * d) - (a * f)],\n      [(d * h) - (e * g), (g * b) - (a * h), (a * e) - (b * d)]\n    ];\n\n    this.multiply(1 / dt); // TODO - handle when dt === 0 ?\n    return this;\n  }\n\n  /**\n  * Transposes the elements of the matrix.\n  */\n  transpose() {\n    const m = Object.create(this._elements); // ?\n    this._elements = [\n      [m[0][0], m[1][0], m[2][0]],\n      [m[0][1], m[1][1], m[2][1]],\n      [m[0][2], m[1][2], m[2][2]]\n    ];\n    return this;\n  }\n\n  /**\n  * Resets the inner elements of the matrix to identity values.\n  */\n  identity() {\n    this._elements = [\n      [1, 0, 0],\n      [0, 1, 0],\n      [0, 0, 1]\n    ];\n    return this;\n  }\n\n  toString() {\n    return `${this._elements.map(r => r.join('\\t')).join('\\n')}`;\n  }\n\n  isIdentity() {\n    const m = this._elements;\n    return m[0][0] === 1 && m[0][1] === 0 && m[0][2] === 0\n      && m[1][0] === 0 && m[1][1] === 1 && m[1][2] === 0\n      && m[2][0] === 0 && m[2][1] === 0 && m[2][2] === 1;\n  }\n\n  /**\n   * Transforms the given point by this matrix and returns a new point\n   */\n  transformPoint(p) {\n    let vec = [p.x, p.y, 1],\n      i,\n      j,\n      e = this._elements,\n      m = [0, 0, 0];\n    for (i = 0; i < this._elements.length; i++) { // row\n      for (j = 0; j < this._elements[i].length; j++) { // column\n        m[i] += vec[j] * e[i][j];\n      }\n    }\n\n    return { x: m[0], y: m[1] };\n  }\n\n  /**\n   * Transforms the given points by this matrix and returns the new points\n   */\n  transformPoints(array) {\n    let vec,\n      i,\n      j,\n      k,\n      m,\n      e = this._elements,\n      ret = [];\n\n    for (k = 0; k < array.length; k++) {\n      vec = [array[k].x, array[k].y, 1];\n      m = [0, 0, 0];\n\n      for (i = 0; i < this._elements.length; i++) { // row\n        for (j = 0; j < this._elements[i].length; j++) { // column\n          m[i] += vec[j] * e[i][j];\n        }\n      }\n      ret.push({ x: m[0], y: m[1] });\n    }\n    return ret;\n  }\n\n  get elements() {\n    const m = this._elements;\n    return [\n      [m[0][0], m[0][1], m[0][2]],\n      [m[1][0], m[1][1], m[1][2]],\n      [m[2][0], m[2][1], m[2][2]]\n    ];\n  }\n}\n\nexport default Matrix;\n","const transformRegEx = /(translate|scale|rotate|matrix)\\(([0-9,.eE+-\\s]+)(?:,|\\s?)+\\)/g;\n\nfunction parseTransform(transform) {\n  let m,\n    commands = [];\n  while ((m = transformRegEx.exec(transform)) !== null) { // eslint-disable-line no-cond-assign\n    const argsStr = m[2].trim();\n    const args = argsStr.indexOf(',') === -1 ? argsStr.split(' ') : argsStr.split(',');\n\n    commands.push({\n      cmd: m[1],\n      args: args.filter(a => a.trim().length > 0).map(a => Number(a))\n    });\n  }\n\n  return commands;\n}\n\nfunction resolveRotateCmd(matrix, transform) {\n  const radians = transform.args[0] * (Math.PI / 180);\n\n  if (transform.args.length > 2) {\n    const x = transform.args[1];\n    const y = transform.args[2];\n    matrix.translate(x, y);\n    matrix.rotate(radians);\n    matrix.translate(-x, -y);\n  } else if (transform.args.length === 1) {\n    matrix.rotate(radians);\n  }\n}\n\nfunction resolveScaleCmd(matrix, transform) {\n  const x = transform.args[0];\n  const y = isNaN(transform.args[1]) ? transform.args[0] : transform.args[1];\n  matrix.scale(x, y);\n}\n\nfunction resolveTranslateCmd(matrix, transform) {\n  const x = transform.args[0];\n  const y = isNaN(transform.args[1]) ? 0 : transform.args[1];\n  matrix.translate(x, y);\n}\n\nfunction resolveMatrixCmd(matrix, transform) {\n  if (transform.args.length >= 6) {\n    matrix.transform(...transform.args);\n  }\n}\n\nexport default function resolveTransform(t, matrix) {\n  const transforms = parseTransform(t);\n  let transform;\n\n  for (let i = 0, len = transforms.length; i < len; i++) {\n    transform = transforms[i];\n\n    if (transform.cmd === 'rotate') {\n      resolveRotateCmd(matrix, transform);\n    } else if (transform.cmd === 'scale') {\n      resolveScaleCmd(matrix, transform);\n    } else if (transform.cmd === 'matrix') {\n      resolveMatrixCmd(matrix, transform);\n    } else if (transform.cmd === 'translate') {\n      resolveTranslateCmd(matrix, transform);\n    }\n  }\n}\n","/* eslint-disable no-useless-escape */\n\nconst SELECTOR_MAPS = {\n  type: /^\\w[\\w-]+/,\n  attr: /^\\[\\w(?:[\\w\\._-]+)?(?:[!]?=['\\\"][\\w\\s*#_-]*['\\\"])?\\]/,\n  universal: /^(\\*)/,\n  tag: /^\\.(\\w+)/\n};\n\nconst FILTERS = {\n  type: (c, objects) => { // eslint-disable-line arrow-body-style\n    return objects.filter((o) => {\n      const type = o.type;\n\n      if (type) {\n        return type.toLowerCase() === c.toLowerCase();\n      }\n      return false;\n    });\n  },\n\n  attr: (attr, operator, value, objects) => { // eslint-disable-line arrow-body-style\n    return objects.filter((o) => {\n      const v = o.attrs[attr];\n\n      if (!operator) { // TODO handle undefined differently for != operator? As display object may very well have a default rendering color\n        return typeof v !== 'undefined';\n      } else if (typeof v === 'undefined') {\n        return false;\n      }\n\n      switch (operator) {\n        case '=':\n          return value === String(v);\n        case '!=':\n          return value !== String(v);\n        default:\n          return false;\n      }\n    });\n  },\n\n  universal: objects => objects,\n\n  tag: (c, objects) => { // eslint-disable-line arrow-body-style\n    return objects.filter((o) => {\n      const tag = o.tag;\n      if (tag) {\n        return tag.indexOf(c.replace('.', '')) !== -1;\n      }\n      return false;\n    });\n  }\n};\n\n/**\n* Filters out objects of given type and value\n* @ignore\n* @example\n* filter(\n*   {type:'type', value:'Circle'},\n*   [new Circle(), new Rectangle()]\n* )\n* // [Circle]\n* @param {Object} token\n* @param {Array} objects\n* @returns {Object[]} Objects that fulfill the type and value\n*/\nexport function filter(token, objects) {\n  if (!objects || !objects.length || !token || (typeof FILTERS[token.type] !== 'function')) {\n    return [];\n  }\n\n  switch (token.type) {\n    case 'type':\n      return FILTERS[token.type](token.value, objects);\n    case 'attr':\n      return FILTERS[token.type](token.attribute, token.operator, token.attributeValue, objects);\n    case 'universal':\n      return FILTERS[token.type](objects);\n    case 'tag':\n      return FILTERS[token.type](token.value, objects);\n    default:\n      return [];\n  }\n}\n\n/**\n* Tokenizes a string into supported selectors\n* @ignore\n*\n* @example\n* tokenize(\"Circle[color='red']\")\n*\n* @param {String} s\n*/\nexport function tokenize(s) {\n  const groups = [];\n  let sub;\n  let info;\n  let match;\n  let validSelector;\n\n  s.split(/\\s*,\\s*/).forEach((group) => {\n    group = group.trim();\n    sub = [];\n    const selectorMapsIterator = (key) => {\n      match = group.match(SELECTOR_MAPS[key]);\n      if (match) {\n        validSelector = true;\n        group = group.slice(match[0].length);\n        info = {\n          type: key,\n          value: match[0]\n        };\n\n        if (key === 'attr') {\n          // extract parts of attribute from e.g. [color='red'] => (color, =, red)\n          match = match[0].match(/\\[(\\w[\\w\\._-]+)?(?:([!]?=)['\\\"]([\\w\\s#_-]*)['\\\"])?\\]/);\n          info.attribute = match[1];\n          info.operator = match[2];\n          info.attributeValue = match[3];\n        }\n        sub.push(info);\n      }\n    };\n    while (group) {\n      validSelector = false;\n\n      match = group.match(/^\\s*([>+~]|\\s)\\s*/);\n      if (match) {\n        validSelector = true;\n        sub.push({\n          type: ' ',\n          value: match[0]\n        });\n        group = group.slice(match[0].length);\n      }\n\n      Object.keys(SELECTOR_MAPS).forEach(selectorMapsIterator);\n\n      if (sub && sub.length && groups.indexOf(sub) < 0) {\n        groups.push(sub);\n      }\n\n      if (!validSelector) {\n        break;\n      }\n    }\n  });\n  return groups;\n}\n\nfunction find(s, object) {\n  const result = [];\n  const groupResults = [];\n  let groups;\n  let descendants;\n\n  if (object.isBranch) {\n    groups = tokenize(s);\n    descendants = object.descendants;\n\n    let tokens;\n\n    for (let gi = 0, glen = groups.length; gi < glen; gi++) {\n      tokens = groups[gi];\n\n      const levels = [];\n      let filtered = descendants.slice();\n      let hasRemainder = false;\n      tokens.reverse().forEach((token) => {\n        if (token.type === ' ') {\n          levels.push(filtered);\n          filtered = descendants.slice();\n          hasRemainder = false;\n          return;\n        }\n\n        filtered = filter(token, filtered);\n        hasRemainder = true;\n      });\n\n      if (hasRemainder) {\n        levels.push(filtered);\n      }\n\n      const selected = levels[0].filter((node) => {\n        let ancestor = node.parent;\n        let idx;\n\n        for (let i = 1; i < levels.length; i++) {\n          idx = levels[i].indexOf(ancestor);\n          while (ancestor && idx < 0) {\n            ancestor = ancestor.parent;\n            idx = levels[i].indexOf(ancestor);\n          }\n          if (idx < 0) {\n            return false;\n          }\n        }\n        return true;\n      });\n\n      groupResults.push(selected);\n    }\n\n    for (let i = 0, len = groupResults.length; i < len; i++) {\n      for (let ni = 0, nlen = groupResults[i].length; ni < nlen; ni++) {\n        if (result.indexOf(groupResults[i][ni]) < 0) {\n          result.push(groupResults[i][ni]);\n        }\n      }\n    }\n  }\n\n  return result || [];\n}\n\nexport default {\n  find\n};\n","import { pointsToRect, pointsToCircle, pointsToLine } from '../geometry/util';\nimport pointsToPath from '../utils/points-to-path';\n\nfunction appendDpi(points, dpi) {\n  for (let i = 0, len = points.length; i < len; i++) {\n    points[i].x /= dpi;\n    points[i].y /= dpi;\n  }\n}\n\nfunction geometryToDef(geometry, dpi, mvm) {\n  const type = geometry.type;\n  const points = mvm ? mvm.transformPoints(geometry.points()) : geometry.points();\n  appendDpi(points, dpi);\n  let def = null;\n\n  if (type === 'rect' || type === 'bounds') {\n    def = pointsToRect(points);\n    def.type = type;\n  } else if (type === 'circle') {\n    def = pointsToCircle(points, geometry.r);\n    def.type = type;\n  } else if (type === 'line') {\n    def = pointsToLine(points);\n    def.type = type;\n  } else if (type === 'polygon' || type === 'polyline') {\n    const path = pointsToPath(points, type === 'polygon');\n    def = {\n      type: 'path',\n      d: path\n    };\n  }\n\n  return def;\n}\n\n/**\n * @ignore\n * @returns {object} Returns a node definition of the collider\n */\nfunction colliderToShape(node, dpi) {\n  const collider = node.collider();\n\n  if (collider && collider.fn) {\n    const mvm = node.modelViewMatrix;\n    const isCollection = collider.type === 'collection';\n\n    if (isCollection) {\n      const children = collider.fn.geometries.map(geometry => geometryToDef(geometry, dpi, mvm));\n\n      return {\n        type: 'container',\n        children\n      };\n    }\n\n    return geometryToDef(collider.fn, dpi, mvm);\n  }\n\n  return null;\n}\n\n/**\n * Read-only object representing a node on the scene.\n */\nclass SceneNode {\n  constructor(node) {\n    this._bounds = node.boundingRect ? (withTransform = true) => node.boundingRect(withTransform) : () => ({\n      x: 0, y: 0, width: 0, height: 0\n    });\n    this._attrs = node.attrs;\n    this._type = node.type;\n    this._data = node.data;\n    this._dpi = node.stage ? node.stage.dpi : 1;\n    this._collider = () => colliderToShape(node, this._dpi);\n    this._desc = node.desc;\n    this._tag = node.tag;\n  }\n\n  /**\n   * Node type\n   * @type {string}\n   */\n  get type() {\n    return this._type;\n  }\n\n  /**\n   * Get the associated data\n   * @type {any}\n   */\n  get data() {\n    return this._data;\n  }\n\n  /**\n   * Node attributes\n   * @type {object}\n   */\n  get attrs() {\n    return this._attrs;\n  }\n\n  /**\n   * Element the scene is attached to\n   * @type {HTMLElement}\n   * @private\n   */\n  set element(e) {\n    this._element = e;\n  }\n\n  /**\n   * Element the scene is attached to\n   * @type {HTMLElement}\n   */\n  get element() {\n    return this._element;\n  }\n\n  /**\n  * Key of the component this shape belongs to\n  * @type {string}\n  * @private\n  */\n  set key(k) {\n    this._key = k;\n  }\n\n  /**\n  * Key of the component this shape belongs to\n  * @type {string}\n  */\n  get key() {\n    return this._key;\n  }\n\n  /**\n   * Bounding rectangle of the node. After any transform has been applied, if any, but excluding scaling transform related to devicePixelRatio.\n   * Origin is in the top-left corner of the scene element.\n   * @type {rect}\n   */\n  get bounds() {\n    const bounds = this._bounds();\n    bounds.x /= this._dpi;\n    bounds.y /= this._dpi;\n    bounds.width /= this._dpi;\n    bounds.height /= this._dpi;\n    return bounds;\n  }\n\n  /**\n   * Bounding rectangle of the node withing it's local coordinate system.\n   * Origin is in the top-left corner of the scene element.\n   * @type {rect}\n   */\n  get localBounds() {\n    const bounds = this._bounds(false);\n    return bounds;\n  }\n\n  /**\n   * Collider of the node. Transform on the node has been applied to the collider shape, if any, but excluding scaling transform related to devicePixelRatio.\n   * Origin is in the top-left corner of the scene element.\n   *\n   * If node has no collider, null is returned.\n   * @type {line|rect|circle|path}\n   */\n  get collider() {\n    return this._collider();\n  }\n\n  /**\n   * Node description\n   * @type {object}\n   */\n  get desc() {\n    return this._desc;\n  }\n\n  /**\n   * Node tag\n   * @type {string}\n   */\n  get tag() {\n    return this._tag;\n  }\n}\n\nfunction create(...a) {\n  return new SceneNode(...a);\n}\n\nexport {\n  create as default,\n  SceneNode\n};\n","import createSceneNode from './scene-node';\n\nexport class Collision {\n  constructor(node) {\n    this._node = createSceneNode(node);\n    this._parent = null;\n    this._input = null;\n  }\n\n  get node() {\n    return this._node;\n  }\n\n  set parent(p) {\n    this._parent = p;\n  }\n\n  get parent() {\n    return this._parent;\n  }\n\n  set input(i) {\n    this._input = i;\n  }\n\n  get input() {\n    return this._input;\n  }\n}\n\nexport default function create(...a) {\n  return new Collision(...a);\n}\n","import createCollision from './collision';\nimport { scalarMultiply } from '../math/vector';\nimport { create as createPolygon } from '../geometry/polygon';\nimport {\n  lineToPoints,\n  rectToPoints,\n  getShapeType\n} from '../geometry/util';\n\nfunction appendParentNode(node, collision) {\n  const p = node.parent;\n\n  if (p && p.type !== 'stage') {\n    collision.parent = createCollision(p);\n\n    const pp = p.parent;\n    if (pp && pp.type !== 'stage') {\n      appendParentNode(pp, collision.parent);\n    }\n  }\n}\n\nfunction appendInputShape(shape, collisions) {\n  for (let i = 0, len = collisions.length; i < len; i++) {\n    collisions[i].input = shape;\n  }\n}\n\nfunction resolveFrontChildCollision(node, type, input) {\n  const num = node.descendants.length;\n\n  for (let i = num - 1; i >= 0; i--) {\n    const desc = node.descendants[i];\n    const collider = desc._collider;\n\n    if (collider && collider.fn[type](input)) {\n      const collision = createCollision(desc);\n\n      appendParentNode(desc, collision);\n\n      return collision;\n    }\n  }\n  return null;\n}\n\nfunction resolveBoundsCollision(node, type, input) {\n  const collider = node._collider.fn;\n  let transformedInput = input;\n\n  if (Array.isArray(input.vertices)) {\n    transformedInput = createPolygon(input); // TODO Shouldn't have to do this here, currently its beacause a collision algorithm optimization, i.e. caching of polygon bounds\n  }\n\n  if (collider[type](transformedInput)) {\n    const c = createCollision(node);\n\n    appendParentNode(node, c);\n\n    return c;\n  }\n  return null;\n}\n\nfunction resolveGeometryCollision(node, type, input) {\n  let transformedInput = {};\n  if (node.modelViewMatrix) {\n    if (Array.isArray(input)) { // Rect or Line\n      transformedInput = node.inverseModelViewMatrix.transformPoints(input);\n    } else if (!isNaN(input.r)) { // Circle\n      const p = { x: input.cx, y: input.cy };\n      ({ x: transformedInput.cx, y: transformedInput.cy } = node.inverseModelViewMatrix.transformPoint(p));\n      transformedInput.r = input.r;\n    } else if (Array.isArray(input.vertices)) { // Polygon\n      transformedInput.vertices = node.inverseModelViewMatrix.transformPoints(input.vertices);\n    } else { // Point\n      transformedInput = node.inverseModelViewMatrix.transformPoint(input);\n    }\n  } else {\n    transformedInput = input;\n  }\n\n  if (Array.isArray(transformedInput.vertices)) {\n    transformedInput = createPolygon(transformedInput); // TODO Shouldn't have to do this here, currently its beacause a collision algorithm optimization, i.e. caching of polygon bounds\n  }\n\n  const collider = node._collider.fn;\n  if (collider[type](transformedInput)) {\n    const c = createCollision(node);\n\n    appendParentNode(node, c);\n\n    return c;\n  }\n\n  return null;\n}\n\nfunction resolveCollision(node, intersectionType, input) {\n  const collider = node._collider;\n  if (collider === null) { return null; }\n\n  if (collider.type === 'frontChild') {\n    return resolveFrontChildCollision(node, intersectionType, input);\n  } else if (collider.type === 'bounds') {\n    return resolveBoundsCollision(node, intersectionType, input);\n  }\n\n  return resolveGeometryCollision(node, intersectionType, input);\n}\n\nfunction findAllCollisions(nodes, intersectionType, ary, input) {\n  const num = nodes.length;\n  for (let i = 0; i < num; i++) {\n    const node = nodes[i];\n\n    const collision = resolveCollision(node, intersectionType, input);\n\n    if (collision) { ary.push(collision); }\n\n    // Only traverse children if no match is found on parent and it doesnt have any custom collider\n    if (node.children && !collision && !node._collider) {\n      findAllCollisions(node.children, intersectionType, ary, input);\n    }\n  }\n}\n\nfunction hasCollision(nodes, intersectionType, input) {\n  const num = nodes.length;\n  for (let i = 0; i < num; i++) {\n    const node = nodes[i];\n\n    const collision = resolveCollision(node, intersectionType, input);\n\n    if (collision !== null) { return true; }\n\n    if (node.children && !node._collider) {\n      return hasCollision(node.children, intersectionType, input);\n    }\n  }\n  return false;\n}\n\nfunction resolveShape(shape, ratio = 1) {\n  const type = getShapeType(shape);\n  let _shape = {};\n\n  switch (type) {\n    case 'circle':\n      _shape.cx = shape.cx * ratio;\n      _shape.cy = shape.cy * ratio;\n      _shape.r = shape.r;\n      return ['intersectsCircle', _shape];\n    case 'rect':\n      _shape = rectToPoints(shape).map(p => scalarMultiply(p, ratio));\n      return ['intersectsRect', _shape];\n    case 'line':\n      _shape = lineToPoints(shape).map(p => scalarMultiply(p, ratio));\n      return ['intersectsLine', _shape];\n    case 'point':\n      _shape = scalarMultiply(shape, ratio);\n      return ['containsPoint', _shape];\n    case 'polygon':\n      _shape.vertices = shape.vertices.map(vertex => scalarMultiply(vertex, ratio));\n      return ['intersectsPolygon', _shape];\n    default:\n      return [];\n  }\n}\n\nexport function resolveCollionsOnNode(node, shape) {\n  const [intersectionType, _shape] = resolveShape(shape, node.dpi);\n  const collisions = [];\n\n  if (intersectionType) {\n    findAllCollisions([node], intersectionType, collisions, _shape);\n    appendInputShape(shape, collisions);\n  }\n  return collisions;\n}\n\nexport function hasCollisionOnNode(node, shape) {\n  const [intersectionType, _shape] = resolveShape(shape, node.dpi);\n\n  return hasCollision([node], intersectionType, _shape);\n}\n","import extend from 'extend';\nimport Node from '../node';\nimport { create as geometry } from '../../geometry';\nimport { create as geometryCollection } from '../../geometry/geometry-collection';\nimport Matrix from '../../math/matrix';\nimport resolveTransform from './../transform-resolver';\nimport nodeSelector from './../node-selector';\nimport createSceneNode from './../scene-node';\nimport { resolveCollionsOnNode, hasCollisionOnNode } from '../collision-resolver';\nimport { assignMappedAttribute } from '../attributes';\n\n/**\n * @typedef {object} node-def\n * @property {string} type\n * @property {string|gradient-def} [fill] - {@link https://www.w3.org/TR/fill-stroke-3/#fill-shorthand}\n * @property {string|gradient-def} [stroke] - {@link https://www.w3.org/TR/fill-stroke-3/#propdef-stroke}\n * @property {number} [strokeWidth] - {@link https://www.w3.org/TR/fill-stroke-3/#propdef-stroke-width}\n * @property {string|number[]} [strokeDasharray] - {@link https://www.w3.org/TR/fill-stroke-3/#propdef-stroke-dasharray}\n * @property {number} [opacity] - {@link https://www.w3.org/TR/css-color-4/#propdef-opacity}\n * @property {string} [transform] - {@link https://www.w3.org/TR/SVG/coords.html#TransformAttribute}\n * @property {object} [data] - Data object, may contain any properties\n * @property {object} [desc] - Meta-data object, may contain any properties\n * @property {string} [tag] - White-space seperated list of tags\n * @property {string} [id] - Unique identifier of the node\n * @property {object} [collider]\n */\n\nclass DisplayObject extends Node {\n  constructor(type) {\n    super(type);\n    this._stage = null;\n    this._collider = null;\n    this._attrs = {};\n    this._node = null;\n  }\n\n  set(v = {}) {\n    this.node = v;\n\n    const {\n      data,\n      desc,\n      tag\n    } = v;\n\n    assignMappedAttribute(this.attrs, v);\n\n    if (typeof data !== 'undefined') {\n      this.data = data;\n    }\n\n    if (typeof desc === 'object') {\n      this.desc = extend(true, {}, desc);\n    }\n\n    if (typeof tag === 'string') {\n      this.tag = tag;\n    }\n  }\n\n  collider(opts) {\n    if (typeof opts === 'undefined') {\n      return this._collider;\n    }\n\n    if (Array.isArray(opts)) {\n      this._collider = {\n        fn: geometryCollection(opts),\n        type: 'collection'\n      };\n      return this._collider;\n    }\n\n    const { type = null } = opts;\n    const c = { type };\n\n    if (!type) {\n      this._collider = null;\n    } else if (this._collider && this._collider.type === type) {\n      this._collider.fn.set(opts);\n    } else if (type === 'frontChild') {\n      this._collider = c;\n    } else if (type === 'bounds') {\n      c.fn = geometry('rect', opts);\n      this._collider = c;\n    } else if (['line', 'rect', 'circle', 'polygon', 'polyline'].indexOf(type) !== -1) {\n      c.fn = geometry(type, opts);\n      this._collider = c;\n    }\n\n    return this._collider;\n  }\n\n  findShapes(selector) {\n    return nodeSelector.find(selector, this).map(node => createSceneNode(node));\n  }\n\n  getItemsFrom(shape) {\n    return resolveCollionsOnNode(this, shape);\n  }\n\n  containsPoint(p) {\n    return hasCollisionOnNode(this, p);\n  }\n\n  intersectsLine(line) {\n    return hasCollisionOnNode(this, line);\n  }\n\n  intersectsRect(rect) {\n    return hasCollisionOnNode(this, rect);\n  }\n\n  intersectsCircle(circle) {\n    return hasCollisionOnNode(this, circle);\n  }\n\n  intersectsPolygon(polygon) {\n    return hasCollisionOnNode(this, polygon);\n  }\n\n  resolveLocalTransform(m = new Matrix()) {\n    if (typeof this.attrs.transform !== 'undefined') { resolveTransform(this.attrs.transform, m); }\n    this.modelViewMatrix = m.clone();\n  }\n\n  resolveGlobalTransform(m = new Matrix()) {\n    const a = this.ancestors;\n\n    if (a.length > 0) {\n      for (let i = a.length - 1; i >= 0; i--) {\n        a[i].resolveLocalTransform(m);\n        m = a[i].modelViewMatrix;\n      }\n    }\n\n    this.resolveLocalTransform(m);\n  }\n\n  /**\n   * Returns the value of attribute a.\n   * @private\n   * @param a\n   * @returns {*} The value of attribute a.\n   */\n  attr(a) {\n    return this.attrs[a];\n  }\n\n  equals(d) {\n    const attrs = this.attrs;\n    const attrKeys = Object.keys(attrs);\n    const dAttrs = d.attrs;\n    const dAttrKeys = Object.keys(dAttrs);\n    if (attrKeys.length !== dAttrKeys.length) {\n      return false;\n    }\n    for (let i = 0; i < attrKeys.length; i++) {\n      const key = attrKeys[i];\n      if (!Object.hasOwnProperty.call(dAttrs, key)) {\n        return false;\n      }\n      if (attrs[key] !== dAttrs[key]) {\n        return false;\n      }\n    }\n\n    return super.equals(d);\n  }\n\n  toJSON() {\n    const json = super.toJSON();\n    json.attrs = this.attrs;\n    return json;\n  }\n\n  get attrs() {\n    return this._attrs;\n  }\n\n  get stage() {\n    if (this._parent && !this._stage) { // lazy evaluation\n      this._stage = this._parent.stage;\n    } else if (!this._parent && this._stage !== this) {\n      this._stage = null;\n    }\n    return this._stage;\n  }\n\n  set modelViewMatrix(m) {\n    this._mvm = m;\n    this._imvm = null;\n  }\n\n  get modelViewMatrix() {\n    return this._mvm;\n  }\n\n  get inverseModelViewMatrix() {\n    this._imvm = this._imvm ? this._imvm : this._mvm.clone().invert();\n    return this._imvm;\n  }\n\n  set node(n) {\n    this._node = n;\n  }\n\n  get node() {\n    return this._node;\n  }\n}\n\nexport default DisplayObject;\n","import Node from './node';\n\nclass NodeContainer extends Node {\n  addChild(c) {\n    if (!c || !(c instanceof Node)) {\n      throw new TypeError(`Expecting a Node as argument, but got ${c}`);\n    }\n\n    if (c === this) {\n      throw new Error('Can not add itself as child!');\n    }\n\n    if (c._children && c._children.length && this.ancestors.indexOf(c) >= 0) {\n      throw new Error('Can not add an ancestor as child!');\n    }\n\n    if (c._parent && c._parent !== this) {\n      c._parent.removeChild(c);\n    }\n\n    // *\n    // really expensive for large arrays\n    const indx = this._children.indexOf(c); // if child already exists -> remove it, and the push it in last\n    if (indx >= 0) {\n      this._children.splice(indx, 1);\n    }\n    // * /\n\n    this._children.push(c);\n    c._parent = this;\n    c._ancestors = null;\n\n    return this;\n  }\n\n  addChildren(children) {\n    let i,\n      num = children ? children.length : 0;\n    for (i = 0; i < num; i++) {\n      this.addChild(children[i]);\n    }\n    return this;\n  }\n\n  /**\n   * Removes given child node from this node.\n   * @private\n   * @param {Node} c\n   * @returns {Node} This object, for chaining purposes.\n   */\n  removeChild(c) {\n    const indx = this._children.indexOf(c);\n    if (indx >= 0) {\n      this._children.splice(indx, 1);\n      c._parent = null;\n      c._ancestors = null;\n    }\n    return this;\n  }\n\n  removeChildren(children) {\n    let i,\n      num;\n    if (!this._children) {\n      return this;\n    }\n    if (children) {\n      num = children.length;\n      for (i = 0; i < num; i++) {\n        this.removeChild(children[i]);\n      }\n    } else {\n      while (this._children.length) {\n        this.removeChild(this._children[0]);\n      }\n    }\n    return this;\n  }\n}\n\nexport default NodeContainer;\n","import extend from 'extend';\nimport DisplayObject from './display-object';\nimport NodeContainer from '../node-container';\n\n/**\n * @extends node-def\n * @typedef {object} node--container-def\n * @property {node-def[]} children - Array of child nodes\n */\n\nconst NC = NodeContainer.prototype;\n\nfunction reCalcBoundingRect(c, child, includeTransform = false) {\n  if (typeof child.bounds !== 'undefined') {\n    const [p0, , p2] = child.bounds(includeTransform);\n    const { x: xMin, y: yMin } = p0;\n    const { x: xMax, y: yMax } = p2;\n\n    const _xMax = isNaN(c._boundingRect.width) ? xMax : Math.max(xMax, c._boundingRect.width + c._boundingRect.x);\n    const _yMax = isNaN(c._boundingRect.height) ? yMax : Math.max(yMax, c._boundingRect.height + c._boundingRect.y);\n\n    c._boundingRect.x = isNaN(c._boundingRect.x) ? xMin : Math.min(xMin, c._boundingRect.x);\n    c._boundingRect.y = isNaN(c._boundingRect.y) ? yMin : Math.min(yMin, c._boundingRect.y);\n    c._boundingRect.width = _xMax - c._boundingRect.x;\n    c._boundingRect.height = _yMax - c._boundingRect.y;\n  }\n}\n\nexport default class Container extends DisplayObject {\n  constructor(s = {}) {\n    const { type = 'container' } = s;\n    super(type);\n    this.set(s);\n    this._boundingRect = {};\n  }\n\n  set(v = {}) {\n    super.set(v);\n\n    const { collider } = v;\n    const opts = extend({\n      type: null\n    }, collider);\n\n    super.collider(opts);\n  }\n\n  boundingRect(includeTransform = false) {\n    const num = this.children.length;\n    this._boundingRect = {};\n\n    for (let i = 0; i < num; i++) {\n      reCalcBoundingRect(this, this.children[i], includeTransform);\n    }\n    return extend({\n      x: 0, y: 0, width: 0, height: 0\n    }, this._boundingRect);\n  }\n\n  bounds(includeTransform = false) {\n    const rect = this.boundingRect(includeTransform);\n\n    return [\n      { x: rect.x, y: rect.y },\n      { x: rect.x + rect.width, y: rect.y },\n      { x: rect.x + rect.width, y: rect.y + rect.height },\n      { x: rect.x, y: rect.y + rect.height }\n    ];\n  }\n\n  addChild(c) {\n    const r = NC.addChild.call(this, c);\n\n    if (this._collider && this._collider.type === 'bounds') {\n      reCalcBoundingRect(this, c, true);\n      const opts = extend({\n        type: 'bounds', x: 0, y: 0, width: 0, height: 0\n      }, this._boundingRect);\n      super.collider(opts);\n    }\n\n    return r;\n  }\n\n  addChildren(children) {\n    const r = NC.addChildren.call(this, children);\n    const num = children.length;\n\n    if (this._collider && this._collider.type === 'bounds' && num > 0) {\n      for (let i = 0; i < num; i++) {\n        reCalcBoundingRect(this, children[i], true);\n      }\n      const opts = extend({\n        type: 'bounds', x: 0, y: 0, width: 0, height: 0\n      }, this._boundingRect);\n      super.collider(opts);\n    }\n\n    return r;\n  }\n\n  removeChild(c) {\n    c._stage = null;\n    let desc = c.descendants,\n      num = desc ? desc.length : 0,\n      i;\n    // remove reference to stage from all descendants\n    for (i = 0; i < num; i++) {\n      desc[i]._stage = null;\n    }\n\n    NC.removeChild.call(this, c);\n\n    if (this._collider && this._collider.type === 'bounds') {\n      const opts = extend(this.boundingRect(true), { type: 'bounds' });\n      super.collider(opts);\n    }\n\n    return this;\n  }\n\n  removeChildren(children) {\n    NC.removeChildren.call(this, children);\n\n    if (this._collider && this._collider.type === 'bounds') {\n      const opts = extend(this.boundingRect(true), { type: 'bounds' });\n      super.collider(opts);\n    }\n\n    return this;\n  }\n}\n\nexport function create(...s) {\n  return new Container(...s);\n}\n","import Container from './container';\n\nexport default class Stage extends Container {\n  constructor(dpi) {\n    super('stage');\n    this._stage = this;\n    this._dpiRatio = dpi || 1;\n  }\n\n  get dpi() {\n    return this._dpiRatio;\n  }\n}\n\nexport function create(...a) {\n  return new Stage(...a);\n}\n","import DisplayObject from './display-object';\nimport NodeContainer from '../node-container';\n\n/**\n * @typedef {object} gradient-def\n * @property {string} type\n * @property {object[]} stops\n * @property {string} [stops[].type=linearGradient] - radialGradient|linearGradient\n * @property {string} stops[].color - {@link https://www.w3.org/TR/SVG/types.html#DataTypeColor}\n * @property {string} [stops[].opacity=1] - {@link https://www.w3.org/TR/css-color-4/#propdef-opacity}\n * @property {number} stops[].offset - {@link https://www.w3.org/TR/SVG/pservers.html#StopElementOffsetAttribute}\n * @property {number} [degree] - Gradient rotation angle\n */\n\n/**\n * @typedef {object} node--gradient-item-def\n * @property {string} id - Gradient identifier\n * @property {number} x1 - {@link https://www.w3.org/TR/SVG/pservers.html#LinearGradientElementX1Attribute}\n * @property {number} y1 - {@link https://www.w3.org/TR/SVG/pservers.html#LinearGradientElementY1Attribute}\n * @property {number} x2 - {@link https://www.w3.org/TR/SVG/pservers.html#LinearGradientElementX2Attribute}\n * @property {number} y2 - {@link https://www.w3.org/TR/SVG/pservers.html#LinearGradientElementY2Attribute}\n * @property {number} offset - {@link https://www.w3.org/TR/SVG/pservers.html#StopElementOffsetAttribute}\n * @property {object} style - {@link https://www.w3.org/TR/SVG/styling.html#StyleAttribute}\n */\n\nconst NC = NodeContainer.prototype;\n\nconst allowedAttrs = [\n  'x1',\n  'x2',\n  'y1',\n  'y2',\n  'id',\n  'offset',\n  'style'\n];\n\nexport default class GradientItem extends DisplayObject {\n  constructor(s = {}) {\n    const { type = 'container' } = s;\n    super(type);\n    this.set(s);\n    this._boundingRect = {};\n  }\n\n  set(v = {}) {\n    super.set(v);\n\n    const attrs = this.attrs;\n\n    let attrKey = '';\n\n    for (let i = 0, len = allowedAttrs.length; i !== len; i++) {\n      attrKey = allowedAttrs[i];\n\n      if (v[attrKey]) {\n        attrs[attrKey] = v[attrKey];\n      }\n    }\n  }\n\n  addChild(c) {\n    const r = NC.addChild.call(this, c);\n\n    return r;\n  }\n\n  addChildren(children) {\n    const r = NC.addChildren.call(this, children);\n\n    return r;\n  }\n\n  removeChild(c) {\n    c._stage = null;\n    let desc = c.descendants,\n      num = desc ? desc.length : 0,\n      i;\n    // remove reference to stage from all descendants\n    for (i = 0; i < num; i++) {\n      desc[i]._stage = null;\n    }\n\n    NC.removeChild.call(this, c);\n\n    return this;\n  }\n\n  removeChildren(children) {\n    NC.removeChildren.call(this, children);\n\n    return this;\n  }\n}\n\nexport function create(...s) {\n  return new GradientItem(...s);\n}\n","import extend from 'extend';\nimport DisplayObject from './display-object';\nimport {\n  rectToPoints,\n  getMinMax\n} from '../../geometry/util';\n\n/**\n * @extends node-def\n * @typedef {object} node--rect-def\n * @property {number} x - {@link https://www.w3.org/TR/SVG/shapes.html#RectElementXAttribute}\n * @property {number} y - {@link https://www.w3.org/TR/SVG/shapes.html#RectElementYAttribute}\n * @property {number} width - {@link https://www.w3.org/TR/SVG/shapes.html#RectElementWidthAttribute}\n * @property {number} height- {@link https://www.w3.org/TR/SVG/shapes.html#RectElementHeightAttribute}\n */\n\nexport default class Rect extends DisplayObject {\n  constructor(...s) {\n    super('rect');\n    this.set(...s);\n  }\n\n  set(v = {}) {\n    const {\n      x = 0, y = 0, width = 0, height = 0, collider\n    } = v;\n    const opts = extend({\n      type: 'rect', x, y, width, height\n    }, collider);\n\n    super.set(v);\n    super.collider(opts);\n\n    if (width >= 0) {\n      this.attrs.x = x;\n      this.attrs.width = width;\n    } else {\n      this.attrs.x = x + width;\n      this.attrs.width = -width;\n    }\n\n    if (height >= 0) {\n      this.attrs.y = y;\n      this.attrs.height = height;\n    } else {\n      this.attrs.y = y + height;\n      this.attrs.height = -height;\n    }\n  }\n\n  boundingRect(includeTransform = false) {\n    const p = rectToPoints(this.attrs);\n    const pt = includeTransform && this.modelViewMatrix ? this.modelViewMatrix.transformPoints(p) : p;\n    const [xMin, yMin, xMax, yMax] = getMinMax(pt);\n\n    return {\n      x: xMin,\n      y: yMin,\n      width: xMax - xMin,\n      height: yMax - yMin\n    };\n  }\n\n  bounds(includeTransform = false) {\n    const rect = this.boundingRect(includeTransform);\n\n    return [\n      { x: rect.x, y: rect.y },\n      { x: rect.x + rect.width, y: rect.y },\n      { x: rect.x + rect.width, y: rect.y + rect.height },\n      { x: rect.x, y: rect.y + rect.height }\n    ];\n  }\n}\n\nexport function create(...s) {\n  return new Rect(...s);\n}\n","import extend from 'extend';\nimport DisplayObject from './display-object';\nimport { getMinMax } from '../../geometry/util';\n\n/**\n * @extends node-def\n * @typedef {object} node--circle-def\n * @property {number} cx - {@link https://www.w3.org/TR/SVG/shapes.html#CircleElementCXAttribute}\n * @property {number} cy - {@link https://www.w3.org/TR/SVG/shapes.html#CircleElementCYAttribute}\n * @property {number} r - {@link https://www.w3.org/TR/SVG/shapes.html#CircleElementRAttribute}\n */\n\nexport default class Circle extends DisplayObject {\n  constructor(...s) {\n    super('circle');\n    this.set(...s);\n  }\n\n  set(v = {}) {\n    const {\n      cx = 0, cy = 0, r = 0, collider\n    } = v;\n    const opts = extend({\n      type: 'circle', cx, cy, r\n    }, collider);\n\n    super.set(v);\n    super.collider(opts);\n\n    this.attrs.cx = cx;\n    this.attrs.cy = cy;\n    this.attrs.r = r;\n  }\n\n  boundingRect(includeTransform = false) {\n    // TODO Handle Circle bounds correctly for a circle transformed to an non axis aligned ellipse/circle\n    // Current solution only rotate the bounds, giving a larger boundingRect if rotated\n    const p = this.bounds(includeTransform);\n\n    return {\n      x: p[0].x,\n      y: p[0].y,\n      width: p[2].x - p[0].x,\n      height: p[2].y - p[0].y\n    };\n  }\n\n  bounds(includeTransform = false) {\n    // TODO Handle Circle bounds correctly for a circle transformed to an non axis aligned ellipse/circle\n    const {\n      cx, cy, r: rX, r: rY\n    } = this.attrs;\n    const x = cx - rX;\n    const y = cy - rY;\n    let w = rX * 2;\n    let h = rY * 2;\n    let p = [\n      { x, y },\n      { x: x + w, y },\n      { x: x + w, y: y + h },\n      { x, y: y + h }\n    ];\n\n    if (includeTransform && this.modelViewMatrix) {\n      p = this.modelViewMatrix.transformPoints(p);\n      const [xMin, yMin, xMax, yMax] = getMinMax(p);\n      w = xMax - xMin;\n      h = yMax - yMin;\n\n      return [\n        { x: xMin, y: yMin },\n        { x: xMin + w, y: yMin },\n        { x: xMin + w, y: yMin + h },\n        { x: xMin, y: yMin + h }\n      ];\n    }\n\n    return p;\n  }\n}\n\nexport function create(...s) {\n  return new Circle(...s);\n}\n","import extend from 'extend';\nimport DisplayObject from './display-object';\nimport {\n  lineToPoints,\n  getMinMax\n} from '../../geometry/util';\n\n/**\n * @extends node-def\n * @typedef {object} node--line-def\n * @property {number} x1 - {@link https://www.w3.org/TR/SVG/shapes.html#LineElementX1Attribute}\n * @property {number} y1 - {@link https://www.w3.org/TR/SVG/shapes.html#LineElementY1Attribute}\n * @property {number} x2 - {@link https://www.w3.org/TR/SVG/shapes.html#LineElementX2Attribute}\n * @property {number} y2 - {@link https://www.w3.org/TR/SVG/shapes.html#LineElementY2Attribute}\n */\n\nexport default class Line extends DisplayObject {\n  constructor(...s) {\n    super('line');\n    this.set(...s);\n  }\n\n  set(v = {}) {\n    const {\n      x1 = 0, y1 = 0, x2 = 0, y2 = 0, collider\n    } = v;\n    super.set(v);\n    this.attrs.x1 = x1;\n    this.attrs.y1 = y1;\n    this.attrs.x2 = x2;\n    this.attrs.y2 = y2;\n\n    const defaultCollider = {\n      type: 'line',\n      x1,\n      y1,\n      x2,\n      y2\n    };\n    super.collider(extend(defaultCollider, collider));\n  }\n\n  boundingRect(includeTransform = false) {\n    let p = lineToPoints(this.attrs);\n\n    if (includeTransform && this.modelViewMatrix) {\n      p = this.modelViewMatrix.transformPoints(p);\n    }\n\n    const [xMin, yMin, xMax, yMax] = getMinMax(p);\n    const hasSize = xMin !== xMax || yMin !== yMax;\n\n    return {\n      x: xMin,\n      y: yMin,\n      width: hasSize ? Math.max(1, xMax - xMin) : 0,\n      height: hasSize ? Math.max(1, yMax - yMin) : 0\n    };\n  }\n\n  bounds(includeTransform = false) {\n    const rect = this.boundingRect(includeTransform);\n    return [\n      { x: rect.x, y: rect.y },\n      { x: rect.x + rect.width, y: rect.y },\n      { x: rect.x + rect.width, y: rect.y + rect.height },\n      { x: rect.x, y: rect.y + rect.height }\n    ];\n  }\n}\n\nexport function create(...s) {\n  return new Line(...s);\n}\n","import { toRadians } from '../math/angles';\n\nconst PI_X2 = Math.PI * 2;\n\n/**\n * Implementation of F.6.5 https://www.w3.org/TR/SVG/implnote.html#ArcImplementationNotes\n * @ignore\n * @param {number} rx - Arc x-radius\n * @param {number} ry - Arc y-radius\n * @param {number} rotation - Arc rotation in degrees (0-360)\n * @param {boolean} largeArcFlag\n * @param {boolean} sweepFlag\n * @param {number} endX - X-coordinate for end of arc\n * @param {number} endY - Y-coordinate for end of arc\n * @param {number} startX - X-coordinate for start of arc\n * @param {number} startY - Y-coordinate for start of arc\n * @returns {object}\n */\nfunction arcToCenter(rx, ry, rotation, largeArcFlag, sweepFlag, endX, endY, startX, startY) {\n  let startAngle;\n  let endAngle;\n  let sweepAngle;\n  let cx;\n  let cy;\n  let radiusRatio;\n\n  const rad = toRadians(rotation % 360);\n\n  // F.6.5.1\n  const cos = Math.cos(rad);\n  const sin = Math.sin(rad);\n  const hdx = (startX - endX) / 2;\n  const hdy = (startY - endY) / 2;\n\n  const x1d = (cos * hdx) + (sin * hdy);\n  const y1d = (cos * hdy) - (sin * hdx);\n\n  // F.6.6\n  rx = Math.abs(rx);\n  ry = Math.abs(ry);\n\n  radiusRatio = (Math.pow(x1d, 2) / Math.pow(rx, 2)) + (Math.pow(y1d, 2) / Math.pow(ry, 2));\n  if (radiusRatio > 1) {\n    radiusRatio = Math.sqrt(radiusRatio);\n    rx *= radiusRatio;\n    ry *= radiusRatio;\n  }\n\n  // F.6.5.2\n  const rxry = rx * ry;\n  const rxy1d = rx * y1d;\n  const ryx1d = ry * x1d;\n  const den = Math.pow(rxy1d, 2) + Math.pow(ryx1d, 2);\n  const num = Math.pow(rxry, 2) - den;\n\n  let frac = Math.sqrt(Math.max(num / den, 0));\n\n  if (largeArcFlag === sweepFlag) {\n    frac = -frac;\n  }\n\n  const cxd = frac * (rxy1d / ry);\n  const cyd = frac * -(ryx1d / rx);\n\n  // F.6.5.3\n  const mx = (startX + endX) / 2;\n  const my = (startY + endY) / 2;\n  cx = ((cos * cxd) - (sin * cyd)) + mx;\n  cy = (sin * cxd) + (cos * cyd) + my;\n\n  // F.6.5.6 clockwise angle\n  const ux = (x1d - cxd) / rx;\n  const uy = (y1d - cyd) / ry;\n  const vx = (-x1d - cxd) / rx;\n  const vy = (-y1d - cyd) / ry;\n  startAngle = Math.atan2(uy, ux);\n  startAngle += startAngle < 0 ? PI_X2 : 0;\n  endAngle = Math.atan2(vy, vx);\n  endAngle += endAngle < 0 ? PI_X2 : 0;\n\n  sweepAngle = endAngle - startAngle;\n\n  if (!sweepFlag && startAngle < endAngle) {\n    sweepAngle -= PI_X2;\n  } else if (sweepFlag && endAngle < startAngle) {\n    sweepAngle += PI_X2;\n  }\n\n  sweepAngle %= PI_X2;\n\n  return {\n    startAngle,\n    sweepAngle,\n    cx,\n    cy,\n    rx,\n    ry\n  };\n}\n\nexport {\n  arcToCenter as default,\n  PI_X2\n};\n","/**\n * Measure the flatnass of a cubic bezier curve\n * @ignore\n * @param {point} s - Start point\n * @param {point} cp1 - First control point\n * @param {point} cp2 - Second control point\n * @param {point} e - End point\n */\nexport default function flatness(s, cp1, cp2, e) {\n  const ux = Math.abs((s.x + cp2.x) - (cp1.x + cp1.x));\n  const uy = Math.abs((s.y + cp2.y) - (cp1.y + cp1.y));\n  const vx = Math.abs((cp1.x + e.x) - (cp2.x + cp2.x));\n  const vy = Math.abs((cp1.y + e.y) - (cp2.y + cp2.y));\n\n  return ux + uy + vx + vy;\n}\n","import flatness from './curve-flattness';\n\nfunction mid(p0, p1) {\n  return {\n    x: (p0.x + p1.x) / 2,\n    y: (p0.y + p1.y) / 2\n  };\n}\n\nfunction interpolate(t, s, cp1, cp2, e) {\n  const td = 1 - t;\n  const t0 = Math.pow(td, 3) * s;\n  const t1 = 3 * Math.pow(td, 2) * t * cp1;\n  const t2 = 3 * td * Math.pow(t, 2) * cp2;\n  const t3 = Math.pow(t, 3) * e;\n\n  return t0 + t1 + t2 + t3;\n}\n\n/**\n * Recursive subdivision of a curve using de Casteljau algorithm.\n * Splits the curve into multiple line segments where each segments is choosen based on a level of flatness.\n * @ignore\n * @param {point} s - Start point\n * @param {point} cp1 - First control point\n * @param {point} cp2 - Second control point\n * @param {point} e - End point\n * @param {array} points - Initial set of points\n * @returns {point[]} Array of points\n */\nfunction toPoints(s, cp1, cp2, e, points = []) {\n  if (flatness(s, cp1, cp2, e) <= 10) {\n    // Poor man's Set\n    if (points.indexOf(s) === -1) {\n      points.push(s);\n    }\n    if (points.indexOf(e) === -1) {\n      points.push(e);\n    }\n    return points;\n  }\n\n  const t = 0.5;\n\n  const m0 = mid(s, cp1);\n  const m1 = mid(cp1, cp2);\n  const m2 = mid(cp2, e);\n\n  const b = { // Split curve at point\n    x: interpolate(t, s.x, cp1.x, cp2.x, e.x),\n    y: interpolate(t, s.y, cp1.y, cp2.y, e.y)\n  };\n\n  const q0 = mid(m0, m1); // New cp2 for left curve\n  const q1 = mid(m1, m2); // New cp1 for right curve\n\n  toPoints(s, m0, q0, b, points); // left curve\n  toPoints(b, q1, m2, e, points); // Right curve\n\n  return points;\n}\n\nexport {\n  toPoints as default,\n  interpolate\n};\n","import cubicToPoints from './cubic-bezier-curve-interpolation';\n\nfunction interpolate(t, s, cp, e) {\n  const td = (1 - t);\n\n  return (Math.pow(td, 2) * s) +\n    (2 * td * t * cp) +\n    (Math.pow(t, 2) * e);\n}\n\nfunction toCubic(s, cp, e) {\n  const cp1x = s.x + ((2 / 3) * (cp.x - s.x));\n  const cp1y = s.y + ((2 / 3) * (cp.y - s.y));\n  const cp2x = e.x + ((2 / 3) * (cp.x - e.x));\n  const cp2y = e.y + ((2 / 3) * (cp.y - e.y));\n  const cp1 = { x: cp1x, y: cp1y };\n  const cp2 = { x: cp2x, y: cp2y };\n\n  return { cp1, cp2 };\n}\n\n/**\n * Recursive subdivision of a curve using de Casteljau algorithm.\n * Splits the curve into multiple line segments where each segments is choosen based on a level of flatness.\n * @ignore\n * @param {point} s - Start point\n * @param {point} cp - Control point\n * @param {point} e - End point\n * @returns {point[]} Array of points\n */\nfunction toPoints(s, cp, e) {\n  const { cp1, cp2 } = toCubic(s, cp, e);\n\n  return cubicToPoints(s, cp1, cp2, e);\n}\n\nexport {\n  interpolate,\n  toPoints as default\n};\n","import { parsePath } from 'path2d-polyfill';\nimport arcToCenter, { PI_X2 } from '../math/arc-to-center';\nimport cubicCurveToPoints from '../math/cubic-bezier-curve-interpolation';\nimport quadCurveToPoints from '../math/quad-bezier-curve-interpolation';\n\n/**\n * Transform an arc to a set of points a long the arc.\n * Specifiction F.6 (https://www.w3.org/TR/SVG/implnote.html#ArcImplementationNotes)\n * @ignore\n * @param {array} s - Segments\n * @param {number} startX - X-coordinate for start of arc\n * @param {number} startY - Y-coordinate for start of arc\n */\nfunction arcToPoints(s, startX, startY) {\n  const points = [];\n  const largeArcFlag = !!s[4]; // F.6.3\n  const sweepFlag = !!s[5]; // F.6.3\n  const rotation = s[3];\n  let endX = s[6];\n  let endY = s[7];\n  let rx = s[1];\n  let ry = s[2];\n  let cx;\n  let cy;\n  let sweepAngle;\n  let startAngle;\n\n  if (s[0] === 'a') {\n    endX += startX;\n    endY += startY;\n  }\n\n  // F.6.2\n  if (startX === endY && startY === endY) {\n    return points;\n  }\n\n  // Given no radius, threat as lineTo command\n  if (!rx || !ry) {\n    points.push({ x: endX, y: endY });\n    return points;\n  }\n\n  ({\n    cx, cy, rx, ry, sweepAngle, startAngle\n  } = arcToCenter(rx, ry, rotation, largeArcFlag, sweepFlag, endX, endY, startX, startY));\n\n  // Approximation of perimeter\n  const p = Math.abs(sweepAngle * Math.sqrt((Math.pow(rx, 2) + Math.pow(ry, 2)) / 2));\n\n  // Generate a point every 10th pixel. Scaling of the node should probably be included in this calculation\n  const res = Math.ceil(p / 10);\n  const resAngle = sweepAngle / res;\n\n  for (let k = 1; k <= res; k++) {\n    const deltaAngle = resAngle * k;\n    const radians = (startAngle + deltaAngle) % PI_X2;\n    const cos = Math.cos(radians);\n    const sin = Math.sin(radians);\n    // F.6.3 https://www.w3.org/TR/SVG/implnote.html#ArcImplementationNotes\n    points.push({\n      x: cx + (cos * rx) + (-sin * cos),\n      y: cy + (sin * ry) + (cos * sin)\n    });\n  }\n\n  // points.push({ x: cx, y: cy });\n\n  return points;\n}\n\n/**\n * Converts a SVG path data string into a set of points.\n * @ignore\n * @param {string} path\n * @returns {Array<point[]>} Array of points\n */\nfunction pathToPoints(path) {\n  const commands = parsePath(path);\n  const segments = [];\n  const points = [];\n  let x = 0; // Current point\n  let y = 0;\n  let cpx = null; // Last control point on a cubic curve\n  let cpy = null;\n  let qcpx = null; // Last control point on a quad curve\n  let qcpy = null;\n\n  for (let i = 0; i < commands.length; ++i) {\n    const cmd = commands[i];\n    const pathType = cmd[0];\n\n    // Reset control point if command is not cubic\n    if (pathType !== 'S' && pathType !== 's' && pathType !== 'C' && pathType !== 'c') {\n      cpx = null;\n      cpy = null;\n    }\n\n    if (pathType !== 'T' && pathType !== 't' && pathType !== 'Q' && pathType !== 'q') {\n      qcpx = null;\n      qcpy = null;\n    }\n\n    switch (pathType) {\n      case 'm':\n        if (points.length) {\n          segments.push(points.splice(0));\n        }\n        // Fall through\n      case 'l': // eslint-disable-line no-fallthrough\n        x += cmd[1];\n        y += cmd[2];\n        points.push({ x, y });\n        break;\n      case 'M':\n        if (points.length) {\n          segments.push(points.splice(0));\n        }\n        // Fall through\n      case 'L': // eslint-disable-line no-fallthrough\n        x = cmd[1];\n        y = cmd[2];\n        points.push({ x, y });\n        break;\n      case 'H':\n        x = cmd[1];\n        points.push({ x, y });\n        break;\n      case 'h':\n        x += cmd[1];\n        points.push({ x, y });\n        break;\n      case 'V':\n        y = cmd[1];\n        points.push({ x, y });\n        break;\n      case 'v':\n        y += cmd[1];\n        points.push({ x, y });\n        break;\n      case 'a':\n        points.push(...arcToPoints(cmd, x, y));\n        x += cmd[6];\n        y += cmd[7];\n        break;\n      case 'A':\n        points.push(...arcToPoints(cmd, x, y));\n        x = cmd[6];\n        y = cmd[7];\n        break;\n      case 'c':\n        points.push(...cubicCurveToPoints(\n          { x, y },\n          { x: cmd[1] + x, y: cmd[2] + y },\n          { x: cmd[3] + x, y: cmd[4] + y },\n          { x: cmd[5] + x, y: cmd[6] + y }\n        ));\n        cpx = cmd[3] + x; // Last control point\n        cpy = cmd[4] + y;\n        x += cmd[5];\n        y += cmd[6];\n        break;\n      case 'C':\n        points.push(...cubicCurveToPoints(\n          { x, y },\n          { x: cmd[1], y: cmd[2] },\n          { x: cmd[3], y: cmd[4] },\n          { x: cmd[5], y: cmd[6] }\n        ));\n        cpx = cmd[3]; // Last control point\n        cpy = cmd[4];\n        x = cmd[5];\n        y = cmd[6];\n        break;\n      case 's':\n        if (cpx === null || cpx === null) {\n          cpx = x;\n          cpy = y;\n        }\n\n        points.push(...cubicCurveToPoints(\n          { x, y },\n          { x: (2 * x) - cpx, y: (2 * y) - cpy },\n          { x: cmd[1] + x, y: cmd[2] + y },\n          { x: cmd[3] + x, y: cmd[4] + y }\n        ));\n        cpx = cmd[1] + x; // last control point\n        cpy = cmd[2] + y;\n        x += cmd[3];\n        y += cmd[4];\n        break;\n      case 'S':\n        if (cpx === null || cpx === null) {\n          cpx = x;\n          cpy = y;\n        }\n\n        points.push(...cubicCurveToPoints(\n          { x, y },\n          { x: (2 * x) - cpx, y: (2 * y) - cpy },\n          { x: cmd[1], y: cmd[2] },\n          { x: cmd[3], y: cmd[4] }\n        ));\n        cpx = cmd[1]; // last control point\n        cpy = cmd[2];\n        x = cmd[3];\n        y = cmd[4];\n        break;\n      case 'Q':\n        points.push(...quadCurveToPoints(\n          { x, y },\n          { x: cmd[1], y: cmd[2] },\n          { x: cmd[3], y: cmd[4] }\n        ));\n\n        qcpx = cmd[1]; // last control point\n        qcpy = cmd[2];\n        x = cmd[3];\n        y = cmd[4];\n        break;\n      case 'q':\n        points.push(...quadCurveToPoints(\n          { x, y },\n          { x: cmd[1] + x, y: cmd[2] + y },\n          { x: cmd[3] + x, y: cmd[4] + y }\n        ));\n\n        qcpx = cmd[1] + x; // last control point\n        qcpy = cmd[2] + y;\n        x += cmd[3];\n        y += cmd[4];\n        break;\n      case 'T':\n        if (qcpx === null || qcpx === null) {\n          qcpx = x;\n          qcpy = y;\n        }\n\n        qcpx = (2 * x) - qcpx; // last control point\n        qcpy = (2 * y) - qcpy;\n        points.push(...quadCurveToPoints(\n          { x, y },\n          { x: qcpx, y: qcpy },\n          { x: cmd[1], y: cmd[2] }\n        ));\n\n        x = cmd[1];\n        y = cmd[2];\n        break;\n      case 't':\n        if (qcpx === null || qcpx === null) {\n          qcpx = x;\n          qcpy = y;\n        }\n\n        qcpx = (2 * x) - qcpx; // last control point\n        qcpy = (2 * y) - qcpy;\n        points.push(...quadCurveToPoints(\n          { x, y },\n          { x: qcpx, y: qcpy },\n          { x: cmd[1] + x, y: cmd[2] + y }\n        ));\n        x += cmd[1];\n        y += cmd[2];\n        break;\n      case 'z':\n      case 'Z':\n        points.push({ x: points[0].x, y: points[0].y });\n        break;\n      default:\n        // Do nothing\n    }\n  }\n\n  segments.push(points.splice(0));\n\n  return segments;\n}\n\nexport { pathToPoints as default };\n","export default function flatten2d(ary) {\n  const newAry = [];\n  let a;\n  let len = ary.length;\n  for (let i = 0; i < len; i++) {\n    a = ary[i];\n    for (let k = 0; k < a.length; k++) {\n      newAry.push(a[k]);\n    }\n  }\n\n  return newAry;\n}\n","import DisplayObject from './display-object';\nimport { getMinMax } from '../../geometry/util';\nimport pathToSegments from '../parse-path-d';\nimport flatten from '../../utils/flatten-array';\n\n/**\n * @extends node-def\n * @typedef {object} node--path-def\n * @property {string} d - {@link https://www.w3.org/TR/SVG/paths.html#DAttribute}\n */\n\nfunction isClosed(points) {\n  if (points.length < 2) {\n    return false;\n  }\n  const p0 = points[0];\n  const p1 = points[points.length - 1];\n\n  return p0.x === p1.x && p0.y === p1.y;\n}\n\nexport default class Path extends DisplayObject {\n  constructor(...s) {\n    super('path');\n    this.set(...s);\n  }\n\n  set(v = {}) {\n    super.set(v);\n    this.segments = [];\n    this.points = [];\n    this.attrs.d = v.d;\n\n    if (v.collider) {\n      super.collider(v.collider);\n    } else if (v.d) {\n      const col = [];\n      this.segments = pathToSegments(v.d);\n      this.segments.forEach((segment) => {\n        if (segment.length <= 1) {\n          // Omit empty and single point segments\n        } else if (isClosed(segment)) {\n          col.push({\n            type: 'polygon',\n            vertices: segment\n          });\n        } else {\n          col.push({\n            type: 'polyline',\n            points: segment\n          });\n        }\n      });\n\n      super.collider(col);\n    }\n  }\n\n  boundingRect(includeTransform = false) {\n    if (!this.points.length) {\n      this.segments = this.segments.length ? this.segments : pathToSegments(this.attrs.d);\n      this.points = flatten(this.segments);\n    }\n\n    const pt = includeTransform && this.modelViewMatrix ? this.modelViewMatrix.transformPoints(this.points) : this.points;\n    const [xMin, yMin, xMax, yMax] = getMinMax(pt);\n\n    return {\n      x: xMin || 0,\n      y: yMin || 0,\n      width: (xMax - xMin) || 0,\n      height: (yMax - yMin) || 0\n    };\n  }\n\n  bounds(includeTransform = false) {\n    const rect = this.boundingRect(includeTransform);\n\n    return [\n      { x: rect.x, y: rect.y },\n      { x: rect.x + rect.width, y: rect.y },\n      { x: rect.x + rect.width, y: rect.y + rect.height },\n      { x: rect.x, y: rect.y + rect.height }\n    ];\n  }\n}\n\nexport function create(...s) {\n  return new Path(...s);\n}\n","import DisplayObject from './display-object';\nimport {\n  rectToPoints,\n  getMinMax\n} from '../../geometry/util';\n\n/**\n * @extends node-def\n * @typedef {object} node--text-def\n * @property {string} text\n * @property {number} x - {@link https://www.w3.org/TR/SVG/text.html#TextElementXAttribute}\n * @property {number} y - {@link https://www.w3.org/TR/SVG/text.html#TextElementYAttribute}\n * @property {number} [dx] - {@link https://www.w3.org/TR/SVG/text.html#TextElementDXAttribute}\n * @property {number} [dy] - {@link https://www.w3.org/TR/SVG/text.html#TextElementDYAttribute}\n * @property {string} [fontSize] - {@link https://www.w3.org/TR/SVG/text.html#FontPropertiesUsedBySVG}\n * @property {string} [fontFamily] - {@link https://www.w3.org/TR/SVG/text.html#FontPropertiesUsedBySVG}\n * @property {rect} [boundingRect] - Explicitly set the bounding rectangle of the node. Has predence over textBoundsFn\n * @property {function} [textBoundsFn] - Implicitly set the bounding rectangle of the node, the function must return an object with x, y, width and height attributes\n * @property {string} [baseline] - Alias for dominantBaseline\n * @property {string} [dominantBaseline] - {@link https://www.w3.org/TR/SVG/text.html#BaselineAlignmentProperties}\n * @property {string} [anchor] - Alias for textAnchor\n * @property {string} [textAnchor] - {@link https://www.w3.org/TR/SVG/text.html#TextAnchorProperty}\n * @property {string} [wordBreak] - Word-break option\n * @property {number} [maxWidth] - Maximum allowed text width\n * @property {number} [maxHeight] - Maximum allowed text height. If both maxLines and maxHeight are set, the property that results in the fewest number of lines is used\n * @property {number} [maxLines] - Maximum number of lines allowed\n * @property {number} [lineHeight=1.2] - Line height\n */\n\nexport default class Text extends DisplayObject {\n  constructor(...s) {\n    super('text');\n    this.set(...s);\n  }\n\n  set(v = {}) {\n    const {\n      x = 0,\n      y = 0,\n      dx = 0,\n      dy = 0,\n      textBoundsFn,\n      text,\n      collider,\n      boundingRect\n    } = v;\n\n    super.set(v);\n    super.collider(collider);\n    this.attrs.x = x;\n    this.attrs.y = y;\n    this.attrs.dx = dx;\n    this.attrs.dy = dy;\n    this.attrs.text = text;\n    if (boundingRect) {\n      this._boundingRect = boundingRect;\n    } else if (typeof textBoundsFn === 'function') {\n      this._boundingRect = textBoundsFn(this.attrs);\n    }\n  }\n\n  boundingRect(includeTransform = false) {\n    if (!this._boundingRect) {\n      return {\n        x: 0,\n        y: 0,\n        width: 0,\n        height: 0\n      };\n    }\n\n    const p = rectToPoints(this._boundingRect);\n    const pt = includeTransform && this.modelViewMatrix ? this.modelViewMatrix.transformPoints(p) : p;\n    const [xMin, yMin, xMax, yMax] = getMinMax(pt);\n\n    return {\n      x: xMin,\n      y: yMin,\n      width: xMax - xMin,\n      height: yMax - yMin\n    };\n  }\n\n  bounds(includeTransform = false) {\n    const rect = this.boundingRect(includeTransform);\n\n    return [\n      { x: rect.x, y: rect.y },\n      { x: rect.x + rect.width, y: rect.y },\n      { x: rect.x + rect.width, y: rect.y + rect.height },\n      { x: rect.x, y: rect.y + rect.height }\n    ];\n  }\n}\n\nexport function create(...s) {\n  return new Text(...s);\n}\n","import { create as stage } from './stage';\nimport { create as container } from './container';\nimport { create as gradientitem } from './gradient-item';\nimport { create as rect } from './rect';\nimport { create as circle } from './circle';\nimport { create as line } from './line';\nimport { create as path } from './path';\nimport { create as text } from './text';\nimport registry from '../../utils/registry';\n\nconst reg = registry();\n\nreg.add('rect', rect);\nreg.add('circle', circle);\nreg.add('text', text);\nreg.add('line', line);\nreg.add('path', path);\nreg.add('stage', stage);\nreg.add('container', container);\nreg.add('defs', gradientitem);\nreg.add('linearGradient', gradientitem);\nreg.add('radialGradient', gradientitem);\nreg.add('stop', gradientitem);\n\nexport function create(type, input) { // eslint-disable-line import/prefer-default-export\n  return reg.get(type)(input);\n}\n","import extend from 'extend';\n\n/**\n * Creates a context. Input an array of strings that should be inherited by the context.\n * @private\n *\n * @param  {Array}  [whitelist=[]]  An array of whitelisted string keys to inherit\n * @return {Function}               A context function\n */\nfunction contextFactory(whitelist = []) {\n  const states = [{}];\n\n  /**\n   * Returns the current context as an object. The object is mutable.\n   * @private\n   *\n   * @return {Object}   Current context\n   */\n  function context() {\n    // Returns the current context, the last in the stack.\n    const item = states[states.length - 1];\n    return item;\n  }\n\n  /**\n   * Call context.save() to save the current context and move down the stack.\n   *\n   * @param  {Object} [item={}]   Optional item to save.\n   * @return {Object}             The current context, just as context()\n   */\n  context.save = function save(item = {}) {\n    const current = context();\n    const obj = {};\n    let key = '';\n\n    // Only inherit whitelisted properties\n    for (let i = 0; i < whitelist.length; i++) {\n      key = whitelist[i];\n      if (typeof current[key] !== 'undefined') { obj[key] = current[key]; }\n    }\n\n    // Extend the new object with the saved item\n    extend(obj, item);\n\n    // Push it to the stack\n    states.push(obj);\n\n    // Return the new current context\n    return context();\n  };\n\n  /**\n   * Restore the previous context. Returns the context.\n   *\n   * @return {Undefined}   Returns nothing\n   */\n  context.restore = function restore() {\n    // Remove the last element from the stack\n    states.splice(states.length - 1, 1);\n  };\n\n  return context;\n}\n\nexport { contextFactory as default };\n","import { create } from './display-objects';\nimport Matrix from '../math/matrix';\nimport resolveTransform from './transform-resolver';\nimport contextFactory from './context';\n\nconst styleContext = contextFactory([\n  'stroke',\n  'fill',\n  'strokeWidth',\n  'opacity',\n  'fontFamily',\n  'fontSize',\n  'baseline'\n]);\n\nfunction doEvent(state, listeners) {\n  if (!Array.isArray(listeners)) {\n    return;\n  }\n\n  for (let i = 0, len = listeners.length; i < len; i++) {\n    listeners[i](state);\n  }\n}\n\nfunction updateState(state, index, nodes) {\n  state.node = nodes[index];\n  state.index = index;\n}\n\nfunction traverse(items, parent, matrix, on) {\n  let disabled = false;\n  const state = {\n    siblings: items,\n    node: null,\n    index: 0\n  };\n  for (let i = 0, len = items.length; i < len; i++) {\n    updateState(state, i, items);\n    doEvent(state, on.create);\n\n    disabled = typeof state.node.disabled === 'function' ? state.node.disabled() : state.node.disabled;\n    if (disabled) {\n      continue;\n    }\n\n    // Save the current style context to be able to inherit styles\n    state.node = styleContext.save(state.node);\n\n    const displayNode = create(state.node.type, state.node);\n    if (displayNode) {\n      if (state.node.transform) {\n        matrix.save();\n        resolveTransform(state.node.transform, matrix);\n      }\n\n      if (!matrix.isIdentity()) {\n        displayNode.modelViewMatrix = matrix.clone();\n      }\n\n      parent.addChild(displayNode);\n      if (state.node.children) {\n        traverse(state.node.children, displayNode, matrix, on);\n      }\n\n      if (state.node.transform) {\n        matrix.restore();\n      }\n    }\n\n    // Revert to previous style context\n    styleContext.restore();\n  }\n}\n\nexport default function scene({\n  items,\n  stage,\n  dpi,\n  on = {}\n}) {\n  if (!stage) {\n    stage = create('stage', dpi);\n  }\n\n  traverse(items, stage, new Matrix(), on);\n\n  return stage;\n}\n","const LINEBREAK_REGEX = /\\n+|\\r+|\\r\\n/;\nconst WHITESPACE_REGEX = /\\s/;\nconst HYPHEN_REGEX = /[a-zA-Z\\u00C0-\\u00F6\\u00F8-\\u00FF\\u00AD]/;\nexport const NO_BREAK = 0;\nexport const MANDATORY = 1;\nexport const BREAK_ALLOWED = 2;\n\nexport function includesLineBreak(c) {\n  if (typeof c === 'string') {\n    return c.search(LINEBREAK_REGEX) !== -1;\n  }\n  return String(c).search(LINEBREAK_REGEX) !== -1;\n}\n\nfunction includesWhiteSpace(c) {\n  return c.search(WHITESPACE_REGEX) !== -1;\n}\n\nfunction hyphenationAllowed(c) {\n  /* Latin character set. Excluding numbers, sign and symbol characters, but including soft hyphen */\n  return c.search(HYPHEN_REGEX) !== -1;\n}\n\nfunction resolveBreakOpportunity(chunk, i, chunks, mandatory, noBreakAllowed) {\n  if (mandatory.some(fn => fn(chunk, i, chunks))) {\n    return MANDATORY;\n  }\n  if (noBreakAllowed.some(fn => fn(chunk, i, chunks))) {\n    return NO_BREAK;\n  }\n\n  return BREAK_ALLOWED;\n}\n\nfunction cleanEmptyChunks(chunks) {\n  if (chunks[0] === '') {\n    chunks.shift();\n  }\n  if (chunks[chunks.length - 1] === '') {\n    chunks.pop();\n  }\n}\n\nfunction clamp(val, min, max) {\n  return Math.max(min, Math.min(max, val));\n}\n\nfunction condition(reverse, index, length) {\n  if (reverse) {\n    return index >= 0;\n  }\n  return index < length;\n}\n\nexport default function stringTokenizer({\n  string,\n  separator = '',\n  reverse = false,\n  measureText = text => ({ width: text.length, height: 1 }),\n  mandatoryBreakIdentifiers = [includesLineBreak],\n  noBreakAllowedIdentifiers = [],\n  suppressIdentifier = [includesWhiteSpace, includesLineBreak, chunk => chunk === ''],\n  hyphenationIdentifiers = [hyphenationAllowed]\n} = {}) {\n  const chunks = String(string).split(separator);\n  cleanEmptyChunks(chunks);\n  const length = chunks.length;\n  let position = reverse ? length : -1; // Set init position 1 step before or after to make first next call go to first position\n\n  function peek(peekAt) {\n    const i = clamp(peekAt, 0, length - 1);\n    const chunk = chunks[i];\n    const textMeasure = measureText(chunk);\n    const opportunity = resolveBreakOpportunity(\n      chunk,\n      i,\n      chunks,\n      mandatoryBreakIdentifiers,\n      noBreakAllowedIdentifiers\n    );\n\n    return {\n      index: i,\n      value: chunk,\n      breakOpportunity: opportunity,\n      suppress: suppressIdentifier.some(fn => fn(chunk, i, chunks)),\n      hyphenation: hyphenationIdentifiers.some(fn => fn(chunk, i, chunks)),\n      width: textMeasure.width,\n      height: textMeasure.height,\n      done: false\n    };\n  }\n\n  function next(jumpToPosition) {\n    if (isNaN(jumpToPosition)) {\n      if (reverse) {\n        position--;\n      } else {\n        position++;\n      }\n    } else {\n      position = clamp(jumpToPosition, 0, length - 1);\n    }\n\n    if (condition(reverse, position, length)) {\n      return peek(position);\n    }\n    return { done: true };\n  }\n\n  return {\n    next,\n    peek,\n    length\n  };\n}\n","const DEFAULT_LINE_HEIGHT = 1.2;\nconst HYPHENS_CHAR = '\\u2010';\nconst ELLIPSIS_CHAR = '';\n\nexport {\n  DEFAULT_LINE_HEIGHT,\n  HYPHENS_CHAR,\n  ELLIPSIS_CHAR\n};\n","import stringTokenizer, {\n  MANDATORY,\n  BREAK_ALLOWED\n} from './string-tokenizer';\nimport {\n  DEFAULT_LINE_HEIGHT,\n  HYPHENS_CHAR\n} from './text-const';\n\nfunction resolveMaxAllowedLines(node, measuredLineHeight) {\n  const maxHeight = node.maxHeight;\n  let maxLines = Math.max(node.maxLines, 1) || Infinity;\n\n  if (isNaN(maxHeight)) {\n    return maxLines;\n  }\n\n  const lineHeight = node.lineHeight || DEFAULT_LINE_HEIGHT;\n  const calcLineHeight = measuredLineHeight * lineHeight;\n\n  return Math.max(1, Math.min(Math.floor(maxHeight / calcLineHeight), maxLines));\n}\n\nfunction initState(node, measureText) {\n  return {\n    lines: [],\n    line: '',\n    width: 0,\n    maxLines: resolveMaxAllowedLines(node, measureText(node.text).height),\n    maxWidth: node.maxWidth,\n    hyphens: {\n      enabled: node.hyphens === 'auto',\n      char: HYPHENS_CHAR,\n      metrics: measureText(HYPHENS_CHAR)\n    }\n  };\n}\n\nfunction newLine(state) {\n  state.lines.push(state.line);\n  state.line = '';\n  state.width = 0;\n}\n\nfunction appendToLine(state, token) {\n  state.line += token.value;\n  state.width += token.width;\n}\n\nfunction insertHyphenAndJump(state, token, iterator) {\n  if (token.width > state.maxWidth) {\n    return token;\n  }\n\n  const startIndex = token.index;\n\n  for (let i = 1; i < 5; i++) {\n    const pairToken = iterator.peek(token.index - 1);\n\n    if (!token.hyphenation || !pairToken.hyphenation || token.index === 0) {\n      return token;\n    } else if (state.width + state.hyphens.metrics.width <= state.maxWidth) {\n      state.line += state.hyphens.char;\n      return token;\n    } else if (state.line.length === 1) {\n      return token;\n    }\n\n    token = iterator.next(startIndex - i);\n    state.line = state.line.slice(0, -1);\n    state.width -= token.width;\n  }\n\n  return token;\n}\n\nfunction breakSequence(state, token, measureText) {\n  const charTokenIterator = stringTokenizer({\n    string: token.value,\n    measureText\n  });\n\n  while (state.lines.length < state.maxLines) {\n    let charToken = charTokenIterator.next();\n    if (charToken.done) {\n      break;\n    } else if (state.width + charToken.width > state.maxWidth && charToken.breakOpportunity === BREAK_ALLOWED && state.line.length > 0) {\n      charToken = state.hyphens.enabled ? insertHyphenAndJump(state, charToken, charTokenIterator) : charToken;\n      newLine(state);\n      appendToLine(state, charToken);\n    } else {\n      appendToLine(state, charToken);\n    }\n  }\n}\n\nexport function breakAll(node, measureText) {\n  const text = node.text;\n  const iterator = stringTokenizer({\n    string: text,\n    separator: '',\n    measureText,\n    noBreakAllowedIdentifiers: [(chunk, i) => i === 0]\n  });\n  const state = initState(node, measureText);\n  let reduced = true;\n\n  while (state.lines.length < state.maxLines) {\n    let token = iterator.next();\n\n    if (token.done) {\n      newLine(state);\n      reduced = false;\n      break;\n    } else if (token.breakOpportunity === MANDATORY) {\n      newLine(state);\n    } else if (state.width + token.width > state.maxWidth && token.breakOpportunity === BREAK_ALLOWED) {\n      if (token.suppress) { // Token is suppressable and can be ignored\n        state.width += token.width;\n      } else {\n        token = state.hyphens.enabled ? insertHyphenAndJump(state, token, iterator) : token;\n        newLine(state);\n        appendToLine(state, token);\n      }\n    } else {\n      appendToLine(state, token);\n    }\n  }\n\n  return {\n    lines: state.lines,\n    reduced\n  };\n}\n\nexport function breakWord(node, measureText) {\n  const text = node.text;\n  const iterator = stringTokenizer({\n    string: text,\n    separator: /(\\s|-|\\u2010)/,\n    measureText\n  });\n  const state = initState(node, measureText);\n  let reduced = true;\n\n  while (state.lines.length < state.maxLines) {\n    let token = iterator.next();\n\n    if (token.done) {\n      newLine(state);\n      reduced = false;\n      break;\n    } else if (token.breakOpportunity === MANDATORY) {\n      newLine(state);\n    } else if (state.width + token.width > state.maxWidth && token.breakOpportunity === BREAK_ALLOWED) {\n      if (token.suppress) { // Token is suppressable and can be ignored\n        newLine(state);\n      } else if (token.width > state.maxWidth) { // Single sequence is wider then maxWidth, break sequence into multiple lines\n        breakSequence(state, token, measureText);\n      } else {\n        newLine(state);\n        appendToLine(state, token);\n      }\n    } else {\n      appendToLine(state, token);\n    }\n  }\n\n  return {\n    lines: state.lines,\n    reduced\n  };\n}\n","import extend from 'extend';\nimport { breakAll, breakWord } from './word-break';\nimport { DEFAULT_LINE_HEIGHT, ELLIPSIS_CHAR } from './text-const';\nimport { includesLineBreak } from './string-tokenizer';\n\nfunction generateLineNodes(result, item, lineHeight) {\n  const container = { type: 'container', children: [] };\n\n  if (typeof item.id !== 'undefined') { // TODO also inherit data attribute and more?\n    container.id = item.id;\n  }\n\n  let currentY = 0;\n\n  result.lines.forEach((line, i) => {\n    const node = extend({}, item);\n    node.text = line;\n    node._lineBreak = true; // Flag node as processed to avoid duplicate linebreak run\n\n    if (result.reduced && i === result.lines.length - 1) {\n      node.text += ELLIPSIS_CHAR;\n    } else {\n      delete node.maxWidth;\n    }\n    node.dy = isNaN(node.dy) ? currentY : node.dy + currentY;\n    currentY += lineHeight;\n    container.children.push(node);\n  });\n\n  return container;\n}\n\nfunction shouldLineBreak(item) {\n  // If type text and not already broken into lines\n  return item.type === 'text' && !item._lineBreak;\n}\n\nfunction wrappedMeasureText(node, measureText) {\n  return text => measureText({\n    text,\n    fontSize: node.fontSize,\n    fontFamily: node.fontFamily\n  });\n}\n\nexport function resolveLineBreakAlgorithm(node) {\n  const WORDBREAK = {\n    'break-all': breakAll,\n    'break-word': breakWord\n  };\n\n  return WORDBREAK[node.wordBreak];\n}\n\n/**\n * Apply wordBreak rules to text nodes.\n * @ignore\n * @param {function} measureText\n * @returns {function} Event function to convert a text node into multiple nodes\n */\nexport function onLineBreak(measureText) {\n  return (state) => {\n    const item = state.node;\n    if (shouldLineBreak(item)) {\n      const wordBreakFn = resolveLineBreakAlgorithm(item);\n      if (!wordBreakFn) {\n        return;\n      }\n\n      const tm = measureText(item);\n      if (tm.width <= item.maxWidth && !includesLineBreak(item.text)) {\n        return;\n      }\n\n      const lineHeight = tm.height * (item.lineHeight || DEFAULT_LINE_HEIGHT);\n      const result = wordBreakFn(item, wrappedMeasureText(item, measureText));\n\n      state.node = generateLineNodes(result, item, lineHeight); // Convert node to container\n    }\n  };\n}\n","import { ELLIPSIS_CHAR } from './text-const';\n\nexport default function ellipsText({\n  text, 'font-size': fontSize, 'font-family': fontFamily, maxWidth\n}, measureText) { // eslint-disable-line import/prefer-default-export\n  text = typeof text === 'string' ? text : `${text}`;\n  if (maxWidth === undefined) {\n    return text;\n  }\n  let textWidth = measureText({ text, fontSize, fontFamily }).width;\n  if (textWidth <= maxWidth) {\n    return text;\n  }\n\n  let min = 0;\n  let max = text.length - 1;\n  while (min <= max) {\n    let reduceIndex = Math.floor((min + max) / 2);\n    let reduceText = text.substr(0, reduceIndex) + ELLIPSIS_CHAR;\n    textWidth = measureText({ text: reduceText, fontSize, fontFamily }).width;\n    if (textWidth <= maxWidth) {\n      min = reduceIndex + 1;\n    } else { // textWidth > maxWidth\n      max = reduceIndex - 1;\n    }\n  }\n  return text.substr(0, max) + ELLIPSIS_CHAR;\n}\n","/**\n * Currently some browsers, IE11 and Edge confirmed, doesn't support the dominant-baseline svg-attribute and\n * the browser that does, have different implementations. Thus giving an unpredictable result when rendering'\n * text and predicting it's position (ex. in collision detection).\n *\n * To supplement and the aid in aligning/positioning text with various items, this function can be used\n * to follow a common heuristic across supported renderers.\n * @ignore\n * @param {object} textNode\n * @param {string|number} [textNode['font-size']=0] - String in px format or number\n * @param {string} [textNode['dominant-baseline']] - If baseline is omitted dominant-baseline is used\n * @param {string} [textNode.baseline]\n * @returns {number} Delta-y required to adjust for baseline\n */\nexport default function baselineHeuristic(textNode) {\n  const baseline = textNode.baseline || textNode['dominant-baseline'];\n  let dy = 0;\n\n  const fontSize = parseInt(textNode.fontSize || textNode['font-size'], 10) || 0;\n\n  switch (baseline) {\n    case 'hanging':\n      dy = fontSize * 0.75;\n      break;\n    case 'text-before-edge':\n      dy = fontSize * 0.85;\n      break;\n    case 'middle':\n      dy = fontSize * 0.25;\n      break;\n    case 'central':\n      dy = fontSize * 0.35;\n      break;\n    case 'mathemetical':\n      dy = fontSize / 2;\n      break;\n    case 'text-after-edge':\n    case 'ideographic':\n      dy = -fontSize * 0.2;\n      break;\n    default:\n      dy = 0;\n      break;\n  }\n\n  return dy;\n}\n","import extend from 'extend';\nimport { resolveLineBreakAlgorithm } from './line-break-resolver';\nimport baselineHeuristic from './baseline-heuristic';\nimport {\n  DEFAULT_LINE_HEIGHT,\n  ELLIPSIS_CHAR\n} from './text-const';\n\nlet heightMeasureCache = {},\n  widthMeasureCache = {},\n  canvasCache;\n\nfunction measureTextWidth({ text, fontSize, fontFamily }) {\n  const match = widthMeasureCache[text + fontSize + fontFamily];\n  if (match !== undefined) {\n    return match;\n  }\n  canvasCache = canvasCache || document.createElement('canvas');\n  const g = canvasCache.getContext('2d');\n  g.font = `${fontSize} ${fontFamily}`;\n  const w = g.measureText(text).width;\n  widthMeasureCache[text + fontSize + fontFamily] = w;\n  return w;\n}\n\nfunction measureTextHeight({ fontSize, fontFamily }) {\n  const match = heightMeasureCache[fontSize + fontFamily];\n\n  if (match !== undefined) {\n    return match;\n  }\n  const text = 'M';\n  const height = measureTextWidth({ text, fontSize, fontFamily }) * 1.2;\n  heightMeasureCache[fontSize + fontFamily] = height;\n  return height;\n}\n\n/**\n * @private\n * @param {object} opts\n * @param {string} opts.text - Text to measure\n * @param {string} opts.fontSize - Font size with a unit definition, ex. 'px' or 'em'\n * @param {string} opts.fontFamily - Font family\n * @return {object} Width and height of text in pixels\n * @example\n * measureText({\n *  text: 'my text',\n *  fontSize: '12px',\n *  fontFamily: 'Arial'\n * }); // returns { width: 20, height: 12 }\n */\nexport function measureText({ text, fontSize, fontFamily }) { // eslint-disable-line import/prefer-default-export\n  const w = measureTextWidth({ text, fontSize, fontFamily });\n  const h = measureTextHeight({ fontSize, fontFamily });\n  return { width: w, height: h };\n}\n\n/**\n * Calculates the bounding rectangle of a text node.\n * The bounding rectangle is a approximate of the \"em square\" seen here (http://www.w3resource.com/html5-canvas/html5-canvas-text.php)\n * @ignore\n * @param {object} attrs - Text node definition\n * @param {number} [attrs.x] - X-coordinate\n * @param {number} [attrs.y] - Y-coordinate\n * @param {number} [attrs.dx] - Delta x-coordinate\n * @param {number} [attrs.dy] - Delta y-coordinate\n * @param {string} [attrs.anchor] - Text anchor\n * @param {number} [attrs.maxWidth] - Maximum allowed text width\n * @return {object} The bounding rectangle\n */\nfunction calcTextBounds(attrs, measureFn = measureText) {\n  const fontSize = attrs['font-size'] || attrs.fontSize;\n  const fontFamily = attrs['font-family'] || attrs.fontFamily;\n  const textMeasure = measureFn({ text: attrs.text, fontFamily, fontSize });\n  const calWidth = Math.min(attrs.maxWidth || textMeasure.width, textMeasure.width); // Use actual value if max is not set\n  const x = attrs.x || 0;\n  const y = attrs.y || 0;\n  const dx = attrs.dx || 0;\n  const dy = (attrs.dy || 0) + baselineHeuristic(attrs);\n\n  const boundingRect = {\n    x: 0,\n    y: (y + dy) - (textMeasure.height * 0.75), // Magic number for alphabetical baseline\n    width: calWidth,\n    height: textMeasure.height\n  };\n\n  const anchor = attrs['text-anchor'] || attrs.anchor;\n\n  if (anchor === 'middle') {\n    boundingRect.x = (x + dx) - (calWidth / 2);\n  } else if (anchor === 'end') {\n    boundingRect.x = (x + dx) - calWidth;\n  } else {\n    boundingRect.x = x + dx;\n  }\n\n  return boundingRect;\n}\n\n/**\n * Calculates the bounding rectangle of a text node. Including any line breaks.\n * @ignore\n * @param {object} node\n * @param {string} node.text - Text to measure\n * @param {number} [node.x=0] - X-coordinate\n * @param {number} [node.y=0] - Y-coordinate\n * @param {number} [node.dx=0] - Delta x-coordinate\n * @param {number} [node.dy=0] - Delta y-coordinate\n * @param {string} [node.anchor='start'] - Text anchor\n * @param {string} [node.fontSize] - Font size\n * @param {string} [node.fontFamily] - Font family\n * @param {string} [node['font-size']] - Font size\n * @param {string} [node['font-family']] - Font family\n * @param {string} [node.wordBreak] - Word-break option\n * @param {number} [node.maxWidth] - Maximum allowed text width\n * @param {number} [node.maxHeight] - Maximum allowed text height. If both maxLines and maxHeight are set, the property that results in the fewest number of lines is used\n * @param {number} [node.maxLines] - Maximum number of lines allowed.\n * @param {number} [node.lineHeight=1.2] - Line height\n * @param {function} [measureFn] - Optional text measure function\n * @return {object} The bounding rectangle\n */\nexport function textBounds(node, measureFn = measureText) {\n  const lineBreakFn = resolveLineBreakAlgorithm(node);\n  if (lineBreakFn) {\n    const fontSize = node['font-size'] || node.fontSize;\n    const fontFamily = node['font-family'] || node.fontFamily;\n    const resolvedLineBreaks = lineBreakFn(node, text => measureFn({ text, fontFamily, fontSize }));\n    const nodeCopy = extend({}, node);\n    let maxWidth = 0;\n    let widestLine = '';\n    for (let i = 0, len = resolvedLineBreaks.lines.length; i < len; i++) {\n      let line = resolvedLineBreaks.lines[i];\n      line += i === len - 1 && resolvedLineBreaks.reduced ? ELLIPSIS_CHAR : '';\n      const width = measureFn({ text: line, fontSize, fontFamily }).width;\n      if (width >= maxWidth) {\n        maxWidth = width;\n        widestLine = line;\n      }\n    }\n    nodeCopy.text = widestLine;\n    const bounds = calcTextBounds(nodeCopy, measureFn);\n    const lineHeight = node.lineHeight || DEFAULT_LINE_HEIGHT;\n    bounds.height = bounds.height * resolvedLineBreaks.lines.length * lineHeight;\n\n    return bounds;\n  }\n\n  return calcTextBounds(node, measureFn);\n}\n","import { degreesToPoints } from '../../../core/math/angles';\n\n/**\n * Get or create a gradient\n * @ignore\n * @param  {Object} g        Canvas 2d context\n * @param  {Object} shape    Current shape (for width/height properties)\n * @param  {Object} gradient The gradient properties\n * @return {Object}          A canvas compatible radial or linear gradient object\n */\nexport default function createCanvasGradient(g, shape, gradient) {\n  const { orientation, degree, stops = [] } = gradient;\n\n  let newGradient = null;\n\n  if (orientation === 'radial') {\n    const width = (shape.width || 0);\n    const height = (shape.height || 0);\n\n    const theX = (shape.x !== undefined ? shape.x : shape.cx);\n    const theY = (shape.y !== undefined ? shape.y : shape.cy);\n\n    newGradient = g.createRadialGradient(\n      theX + (width / 2),\n      theY + (height / 2),\n      1,\n      theX + (width / 2),\n      theY + (height / 2),\n      (shape.r || Math.max(shape.width, shape.height) / 2)\n    );\n  } else {\n    const points = degreesToPoints(degree);\n\n    const width = (shape.width || (shape.r * 2));\n    const height = (shape.height || (shape.r * 2));\n\n    const theX = (shape.x !== undefined ? shape.x : (shape.cx - shape.r));\n    const theY = (shape.y !== undefined ? shape.y : (shape.cy - shape.r));\n\n    newGradient = g.createLinearGradient(\n      theX + (points.x1 * width),\n      theY + (points.y1 * height),\n      theX + (points.x2 * width),\n      theY + (points.y2 * height)\n    );\n  }\n\n  for (let i = 0, len = stops.length; i < len; i++) {\n    let stop = stops[i];\n    newGradient.addColorStop(stop.offset, stop.color);\n  }\n\n  return newGradient;\n}\n","/**\n * @typedef {object} renderer-container-def\n * @property {number} [x] - x-coordinate\n * @property {number} [y] - y-coordinate\n * @property {number} [width] - Width\n * @property {number} [height] - Height\n * @property {object} [scaleRatio]\n * @property {number} [scaleRatio.x] - Scale ratio on x-axis\n * @property {number} [scaleRatio.y] - Scale ratio on y-axis\n * @property {object} [margin]\n * @property {number} [margin.left] - Left margin\n * @property {number} [margin.top] - Top margin\n */\n\n/**\n * Create the renderer box\n * @private\n * @param {renderer-container-def} [opts]\n * @returns {renderer-container-def} A svg renderer instance\n */\nexport default function createRendererBox({\n  x, y, width, height, scaleRatio, margin\n} = {}) {\n  const box = {\n    x: 0,\n    y: 0,\n    width: 0,\n    height: 0,\n    scaleRatio: {\n      x: 1,\n      y: 1\n    },\n    margin: {\n      left: 0,\n      top: 0\n    }\n  };\n\n  box.x = isNaN(x) ? box.x : x;\n  box.y = isNaN(y) ? box.y : y;\n  box.width = isNaN(width) ? box.width : width;\n  box.height = isNaN(height) ? box.height : height;\n  if (typeof scaleRatio !== 'undefined') {\n    box.scaleRatio.x = isNaN(scaleRatio.x) ? box.scaleRatio.x : scaleRatio.x;\n    box.scaleRatio.y = isNaN(scaleRatio.y) ? box.scaleRatio.y : scaleRatio.y;\n  }\n  if (typeof margin !== 'undefined') {\n    box.margin.left = isNaN(margin.left) ? 0 : margin.left;\n    box.margin.top = isNaN(margin.top) ? 0 : margin.top;\n  }\n\n  return box;\n}\n","import {\n  measureText,\n  textBounds\n} from '../text-manipulation';\n\n/**\n * Base renderer factory\n * @private\n */\nfunction create() {\n  /**\n * @interface\n * @alias renderer\n */\n  const renderer = {\n    /**\n   * Get the element this renderer is attached to\n   * @returns {HTMLElement}\n   */\n    element: () => {},\n\n    /**\n     * Get the root element of the renderer\n     * @returns {HTMLElement}\n     */\n    root: () => {},\n\n    /**\n    * @param {HTMLElement} element - Element to attach renderer to\n    * @returns {HTMLElement} Root element of the renderer\n    */\n    appendTo: () => {},\n\n    /**\n     * @param {node-def[]} nodes - Nodes to render\n     * @returns {boolean} True if the nodes where rendered, otherwise false\n     */\n    render: () => false,\n\n    /**\n     * Get nodes renderer at area\n     * @param {point|circle|rect|line|polygon} geometry - Get nodes that intersects with geometry\n     * @returns {SceneNode[]}\n     */\n    itemsAt: () => [],\n\n    /**\n     * Get all nodes matching the provided selector\n     * @param {string} selector CSS selector [type, attribute, universal, class]\n     * @returns {SceneNode[]} Array of objects containing matching nodes\n     */\n    findShapes: () => [],\n\n    /**\n     * Clear all child elements from the renderer root element\n     * @returns {renderer} The renderer instance\n     */\n    clear: () => {},\n\n    /**\n     * Remove the renderer root element from its parent element\n     */\n    destory: () => {},\n\n    /**\n     * Set or Get the size definition of the renderer container.\n     * @param {renderer-container-def} [opts] - Size definition\n     * @returns {renderer-container-def} The current size definition\n     */\n    size: () => {},\n\n    /**\n     * @function\n     * @param {object} opts\n     * @param {string} opts.text - Text to measure\n     * @param {string} opts.fontSize - {@link https://www.w3.org/TR/SVG/text.html#FontPropertiesUsedBySVG}\n     * @param {string} opts.fontFamily - {@link https://www.w3.org/TR/SVG/text.html#FontPropertiesUsedBySVG}\n     * @returns {object} Width and height of text\n     * @example\n     * measureText({\n     *  text: 'my text',\n     *  fontSize: '12px',\n     *  fontFamily: 'Arial'\n     * }); // returns { width: 20, height: 12 }\n     */\n    measureText,\n\n    /**\n     * Calculates the bounding rectangle of a text node. Including any potential line breaks.\n     * @function\n     * @param {node--text-def} node\n     * @return {rect} The bounding rectangle\n     */\n    textBounds\n  };\n\n  return renderer;\n}\n\nexport { create as default };\n","import sceneFactory from '../../../core/scene-graph/scene';\nimport registry from '../../../core/utils/registry';\nimport { onLineBreak } from '../../text-manipulation';\nimport createCanvasGradient from './canvas-gradient';\nimport createRendererBox from '../renderer-box';\nimport create from '../index';\n\nconst reg = registry();\n\nfunction toLineDash(p) {\n  if (Array.isArray(p)) {\n    return p;\n  } else if (typeof p === 'string') {\n    if (p.indexOf(',') !== -1) {\n      return p.split(',');\n    }\n    return p.split(' ');\n  }\n  return [];\n}\n\nfunction dpiScale(g) {\n  const dpr = typeof window === 'undefined' ? 1 : window.devicePixelRatio || 1;\n  const backingStorePixelRatio = g.webkitBackingStorePixelRatio ||\n    g.mozBackingStorePixelRatio ||\n    g.msBackingStorePixelRatio ||\n    g.oBackingStorePixelRatio ||\n    g.backingStorePixelRatio || 1;\n  return dpr / backingStorePixelRatio;\n}\n\nfunction resolveMatrix(p, g) {\n  g.setTransform(p[0][0], p[1][0], p[0][1], p[1][1], p[0][2], p[1][2]);\n}\n\nfunction applyContext(g, s, shapeToCanvasMap, computed = {}) {\n  const computedKeys = Object.keys(computed);\n\n  for (let i = 0, len = shapeToCanvasMap.length; i < len; i++) {\n    let cmd = shapeToCanvasMap[i];\n\n    const shapeCmd = cmd[0];\n    const canvasCmd = cmd[1];\n    const convertCmd = cmd[2];\n\n    if ((shapeCmd in s.attrs && !(canvasCmd in computed)) && g[canvasCmd] !== s.attrs[shapeCmd]) {\n      const val = convertCmd ? convertCmd(s.attrs[shapeCmd]) : s.attrs[shapeCmd];\n      if (typeof g[canvasCmd] === 'function') {\n        g[canvasCmd](val);\n      } else {\n        g[canvasCmd] = val;\n      }\n    }\n  }\n\n  for (let i = 0, len = computedKeys.length; i < len; i++) {\n    const key = computedKeys[i];\n    g[key] = computed[key];\n  }\n}\n\nfunction renderShapes(shapes, g, shapeToCanvasMap) {\n  for (let i = 0, len = shapes.length; i < len; i++) {\n    let shape = shapes[i];\n    let computed = {};\n    g.save();\n\n    // Gradient check\n    if (shape.attrs && (shape.attrs.fill || shape.attrs.stroke)) {\n      if (shape.attrs.fill && typeof shape.attrs.fill === 'object' && shape.attrs.fill.type === 'gradient') {\n        computed.fillStyle = createCanvasGradient(g, shape.attrs, shape.attrs.fill);\n      }\n      if (shape.attrs.stroke && typeof shape.attrs.stroke === 'object' && shape.attrs.stroke.type === 'gradient') {\n        computed.strokeStyle = createCanvasGradient(g, shape.attrs, shape.attrs.stroke);\n      }\n    }\n\n    applyContext(g, shape, shapeToCanvasMap, computed);\n\n    if (shape.modelViewMatrix) {\n      resolveMatrix(shape.modelViewMatrix.elements, g);\n    }\n\n    if (reg.has(shape.type)) {\n      reg.get(shape.type)(shape.attrs, {\n        g,\n        doFill: 'fill' in shape.attrs && shape.attrs.fill !== 'none',\n        doStroke: 'stroke' in shape.attrs && shape.attrs['stroke-width'] !== 0\n      });\n    }\n    if (shape.children) {\n      renderShapes(shape.children, g, shapeToCanvasMap);\n    }\n    g.restore();\n  }\n}\n\n/**\n * Create a new canvas renderer\n * @typedef {function} canvasRendererFactory\n * @param {function} sceneFn - Scene factory\n * @returns {renderer} A canvas renderer instance\n */\nexport function renderer(sceneFn = sceneFactory) {\n  let el;\n  let scene;\n  let hasChangedRect = false;\n  let rect = createRendererBox();\n  const shapeToCanvasMap = [\n    ['fill', 'fillStyle'],\n    ['stroke', 'strokeStyle'],\n    ['opacity', 'globalAlpha'],\n    ['globalAlpha', 'globalAlpha'],\n    ['stroke-width', 'lineWidth'],\n    ['stroke-dasharray', 'setLineDash', toLineDash]\n  ];\n\n  const canvasRenderer = create();\n\n  canvasRenderer.element = () => el;\n\n  canvasRenderer.root = () => el;\n\n  canvasRenderer.appendTo = (element) => {\n    if (!el) {\n      el = element.ownerDocument.createElement('canvas');\n      el.style.position = 'absolute';\n      el.style['-webkit-font-smoothing'] = 'antialiased';\n      el.style['-moz-osx-font-smoothing'] = 'antialiased';\n      el.style.pointerEvents = 'none';\n    }\n\n    element.appendChild(el);\n\n    return el;\n  };\n\n  canvasRenderer.render = (shapes) => {\n    if (!el) {\n      return false;\n    }\n\n    const g = el.getContext('2d');\n    const dpiRatio = dpiScale(g);\n    const scaleX = rect.scaleRatio.x;\n    const scaleY = rect.scaleRatio.y;\n\n    if (hasChangedRect) {\n      el.style.left = `${Math.round(rect.margin.left + (rect.x * scaleX))}px`;\n      el.style.top = `${Math.round(rect.margin.top + (rect.y * scaleY))}px`;\n      el.style.width = `${Math.round(rect.width * scaleX)}px`;\n      el.style.height = `${Math.round(rect.height * scaleY)}px`;\n      el.width = Math.round(rect.width * dpiRatio * scaleX);\n      el.height = Math.round(rect.height * dpiRatio * scaleY);\n    }\n\n    const sceneContainer = {\n      type: 'container',\n      children: shapes\n    };\n\n    if (dpiRatio !== 1 || scaleX !== 1 || scaleY !== 1) {\n      sceneContainer.transform = `scale(${dpiRatio * scaleX}, ${dpiRatio * scaleY})`;\n    }\n\n    const newScene = sceneFn({\n      items: [sceneContainer],\n      dpi: dpiRatio,\n      on: {\n        create: [onLineBreak(canvasRenderer.measureText)]\n      }\n    });\n    const hasChangedScene = scene ? !newScene.equals(scene) : true;\n\n    const doRender = hasChangedRect || hasChangedScene;\n    if (doRender) {\n      canvasRenderer.clear();\n      renderShapes(newScene.children, g, shapeToCanvasMap);\n    }\n\n    hasChangedRect = false;\n    scene = newScene;\n    return doRender;\n  };\n\n  canvasRenderer.itemsAt = input => (scene ? scene.getItemsFrom(input) : []);\n\n  canvasRenderer.findShapes = selector => (scene ? scene.findShapes(selector) : []);\n\n  canvasRenderer.clear = () => {\n    if (el) {\n      el.width = el.width;\n    }\n    scene = null;\n\n    return canvasRenderer;\n  };\n\n  canvasRenderer.size = (opts) => {\n    if (opts) {\n      const newRect = createRendererBox(opts);\n\n      if (JSON.stringify(rect) !== JSON.stringify(newRect)) {\n        hasChangedRect = true;\n        rect = newRect;\n      }\n    }\n\n    return rect;\n  };\n\n  canvasRenderer.destroy = () => {\n    if (el) {\n      if (el.parentElement) {\n        el.parentElement.removeChild(el);\n      }\n      el = null;\n    }\n    scene = null;\n  };\n\n  return canvasRenderer;\n}\n\nexport function register(type, renderFn) {\n  reg.add(type, renderFn);\n}\n","export default function render(rect, { g, doFill, doStroke }) {\n  g.beginPath();\n  g.rect(rect.x, rect.y, rect.width, rect.height);\n  if (doFill) {\n    g.fill();\n  }\n  if (doStroke) {\n    g.stroke();\n  }\n}\n","export default function render(circle, { g, doFill, doStroke }) {\n  g.beginPath();\n  g.moveTo(circle.cx + circle.r, circle.cy);\n  g.arc(circle.cx, circle.cy, circle.r, 0, Math.PI * 2, false);\n  if (doFill) {\n    g.fill();\n  }\n  if (doStroke) {\n    g.stroke();\n  }\n}\n","export default function render(line, { g, doStroke }) {\n  g.beginPath();\n  g.moveTo(line.x1, line.y1);\n  g.lineTo(line.x2, line.y2);\n  if (doStroke) {\n    g.stroke();\n  }\n}\n","\n// Source: https://en.wikipedia.org/wiki/Bi-directional_text and http://www.unicode.org/Public/6.0.0/ucd/UnicodeData.txt\n// 3 types of strong direction characters: L (strong left-to-right), R(strong right-to-left, Hebrew) and AL(strong right-to-left, Arabic language)\nconst rangesOfLChars = '[\\u0041-\\u005A\\u0061-\\u007A\\u00AA\\u00B5\\u00BA\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02B8\\u02BB-\\u02C1\\u02D0-\\u02D1\\u02E0-\\u02E4\\u02EE\\u0370-\\u0373\\u0376-\\u037D\\u0386\\u0388-\\u03F5\\u03F7-\\u0482\\u048A-\\u0589\\u0903-\\u0939\\u093B\\u093D-\\u0940\\u0949-\\u094C\\u094E-\\u0950\\u0958-\\u0961\\u0964-\\u097F\\u0982-\\u09B9\\u09BD-\\u09C0\\u09C7-\\u09CC\\u09CE-\\u09E1\\u09E6-\\u09F1\\u09F4-\\u09FA\\u0A03-\\u0A39\\u0A3E-\\u0A40\\u0A59-\\u0A6F\\u0A72-\\u0A74\\u0A83-\\u0AB9\\u0ABD-\\u0AC0\\u0AC9-\\u0ACC\\u0AD0-\\u0AE1\\u0AE6-\\u0AEF\\u0B02-\\u0B39\\u0B3D-\\u0B3E\\u0B40\\u0B47-\\u0B4C\\u0B57-\\u0B61\\u0B66-\\u0B77\\u0B83-\\u0BBF\\u0BC1-\\u0BCC\\u0BD0-\\u0BF2\\u0C01-\\u0C3D\\u0C41-\\u0C44\\u0C58-\\u0C61\\u0C66-\\u0C6F\\u0C7F-\\u0CB9\\u0CBD-\\u0CCB\\u0CD5-\\u0CE1\\u0CE6-\\u0D40\\u0D46-\\u0D4C\\u0D4E-\\u0D61\\u0D66-\\u0DC6\\u0DCF-\\u0DD1\\u0DD8-\\u0E30\\u0E32-\\u0E33\\u0E40-\\u0E46\\u0E4F-\\u0EB0\\u0EB2-\\u0EB3\\u0EBD-\\u0EC6\\u0ED0-\\u0F17\\u0F1A-\\u0F34\\u0F36\\u0F38\\u0F3E-\\u0F6C\\u0F7F\\u0F85\\u0F88-\\u0F8C\\u0FBE-\\u0FC5\\u0FC7-\\u102C\\u1031\\u1038\\u103B-\\u103C\\u103F-\\u1057\\u105A-\\u105D\\u1061-\\u1070\\u1075-\\u1081\\u1083-\\u1084\\u1087-\\u108C\\u108E-\\u109C\\u109E-\\u135A\\u1360-\\u138F\\u13A0-\\u13F4\\u1401-\\u167F\\u1681-\\u169A\\u16A0-\\u1711\\u1720-\\u1731\\u1735-\\u1751\\u1760-\\u1770\\u1780-\\u17B6\\u17BE-\\u17C5\\u17C7-\\u17C8\\u17D4-\\u17DA\\u17DC\\u17E0-\\u17E9\\u1810-\\u18A8\\u18AA-\\u191C\\u1923-\\u1926\\u1929-\\u1931\\u1933-\\u1938\\u1946-\\u19DA\\u1A00-\\u1A16\\u1A19-\\u1A55\\u1A57\\u1A61\\u1A63-\\u1A64\\u1A6D-\\u1A72\\u1A80-\\u1AAD\\u1B04-\\u1B33\\u1B35\\u1B3B\\u1B3D-\\u1B41\\u1B43-\\u1B6A\\u1B74-\\u1B7C\\u1B82-\\u1BA1\\u1BA6-\\u1BA7\\u1BAA-\\u1BE5\\u1BE7\\u1BEA-\\u1BEC\\u1BEE\\u1BF2-\\u1C2B\\u1C34-\\u1C35\\u1C3B-\\u1C7F\\u1CD3\\u1CE1\\u1CE9-\\u1CEC\\u1CEE-\\u1DBF\\u1E00-\\u1FBC\\u1FBE\\u1FC2-\\u1FCC\\u1FD0-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FFC\\u200E\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E-\\u214F\\u2160-\\u2188\\u2336-\\u237A\\u2395\\u249C-\\u24E9\\u26AC\\u2800-\\u28FF\\u2C00-\\u2CE4\\u2CEB-\\u2CEE\\u2D00-\\u2D70\\u2D80-\\u2DDE\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u31BA\\u31F0-\\u321C\\u3220-\\u324F\\u3260-\\u327B\\u327F-\\u32B0\\u32C0-\\u32CB\\u32D0-\\u3376\\u337B-\\u33DD\\u33E0-\\u33FE\\u3400-\\u4DB5\\u4E00-\\uA48C\\uA4D0-\\uA60C\\uA610-\\uA66E\\uA680-\\uA6EF\\uA6F2-\\uA6F7\\uA722-\\uA787\\uA789-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA824\\uA827\\uA830-\\uA837\\uA840-\\uA873\\uA880-\\uA8C3\\uA8CE-\\uA8D9\\uA8F2-\\uA925\\uA92E-\\uA946\\uA952-\\uA97C\\uA983-\\uA9B2\\uA9B4-\\uA9B5\\uA9BA-\\uA9BB\\uA9BD-\\uAA28\\uAA2F-\\uAA30\\uAA33-\\uAA34\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA4D-\\uAAAF\\uAAB1\\uAAB5-\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2-\\uABE4\\uABE6-\\uABE7\\uABE9-\\uABEC\\uABF0-\\uFB17\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFDC]';\nconst rangesOfRChars = '[\\u05BE\\u05C0\\u05C3\\u05C6\\u05D0-\\u05F4\\u07C0-\\u07EA\\u07F4-\\u07F5\\u07FA-\\u0815\\u081A\\u0824\\u0828\\u0830-\\u0858\\u085E\\u200F\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB4F]';\nconst rangesOfALChars = '[\\u0608\\u060B\\u060D\\u061B-\\u064A\\u066D-\\u066F\\u0671-\\u06D5\\u06E5-\\u06E6\\u06EE-\\u06EF\\u06FA-\\u070D\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\uFB50-\\uFD3D\\uFD50-\\uFDFC\\uFE70-\\uFEFC]';\n// let rangesOfNChars = '[\\u0009-\\u000D\\u001C-\\u0022\\u0026-\\u002A\\u003B-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u0085\\u00A1\\u00A6-\\u00A9\\u00AB-\\u00AC\\u00AE-\\u00AF\\u00B4\\u00B6-\\u00B8\\u00BB-\\u00BF\\u00D7\\u00F7\\u02B9-\\u02BA\\u02C2-\\u02CF\\u02D2-\\u02DF\\u02E5-\\u02ED\\u02EF-\\u02FF\\u0374-\\u0375\\u037E-\\u0385\\u0387\\u03F6\\u058A\\u0606-\\u0607\\u060E-\\u060F\\u06DE\\u06E9\\u07F6-\\u07F9\\u0BF3-\\u0BF8\\u0BFA\\u0C78-\\u0C7E\\u0F3A-\\u0F3D\\u1390-\\u1399\\u1400\\u1680\\u169B-\\u169C\\u17F0-\\u180A\\u180E\\u1940-\\u1945\\u19DE-\\u19FF\\u1FBD\\u1FBF-\\u1FC1\\u1FCD-\\u1FCF\\u1FDD-\\u1FDF\\u1FED-\\u1FEF\\u1FFD-\\u200A\\u2010-\\u2029\\u2035-\\u2043\\u2045-\\u205F\\u207C-\\u207E\\u208C-\\u208E\\u2100-\\u2101\\u2103-\\u2106\\u2108-\\u2109\\u2114\\u2116-\\u2118\\u211E-\\u2123\\u2125\\u2127\\u2129\\u213A-\\u213B\\u2140-\\u2144\\u214A-\\u214D\\u2150-\\u215F\\u2189-\\u2211\\u2214-\\u2335\\u237B-\\u2394\\u2396-\\u2487\\u24EA-\\u26AB\\u26AD-\\u27FF\\u2900-\\u2B59\\u2CE5-\\u2CEA\\u2CF9-\\u2CFF\\u2E00-\\u3004\\u3008-\\u3020\\u3030\\u3036-\\u3037\\u303D-\\u303F\\u309B-\\u309C\\u30A0\\u30FB\\u31C0-\\u31E3\\u321D-\\u321E\\u3250-\\u325F\\u327C-\\u327E\\u32B1-\\u32BF\\u32CC-\\u32CF\\u3377-\\u337A\\u33DE-\\u33DF\\u33FF\\u4DC0-\\u4DFF\\uA490-\\uA4C6\\uA60D-\\uA60F\\uA673\\uA67E-\\uA67F\\uA700-\\uA721\\uA788\\uA828-\\uA82B\\uA874-\\uA877\\uFD3E-\\uFD3F\\uFDFD\\uFE10-\\uFE19\\uFE30-\\uFE4F\\uFE51\\uFE54\\uFE56-\\uFE5E\\uFE60-\\uFE61\\uFE64-\\uFE68\\uFE6B\\uFF01-\\uFF02\\uFF06-\\uFF0A\\uFF1B-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF65\\uFFE2-\\uFFE4\\uFFE8-\\uFFFD]';\nconst rangesOfLRgExp = new RegExp(rangesOfLChars);\nconst rangesOfRRgExp = new RegExp(rangesOfRChars);\nconst rangesOfALRgExp = new RegExp(rangesOfALChars);\n// let rangesOfNRgExp = new RegExp(rangesOfNChars);\n// let lrm = String.fromCharCode(8206); // left-to-right marker\n// let rlm = String.fromCharCode(8207); // right-to-left marker\n\nfunction isLtrChar(c) {\n  return rangesOfLRgExp.test(c);\n}\n\nfunction isRtlChar(c) {\n  return rangesOfRRgExp.test(c) || rangesOfALRgExp.test(c);\n}\n\nexport function detectTextDirection(s) {\n  let n = s ? s.length : 0,\n    i,\n    c;\n  for (i = 0; i < n; i++) {\n    c = s[i];\n    if (isLtrChar(c)) {\n      return 'ltr';\n    }\n    if (isRtlChar(c)) {\n      return 'rtl';\n    }\n  }\n  return 'ltr';\n}\n\nconst textAnchorRTLMap = {\n  start: 'end',\n  end: 'start',\n  center: 'center',\n  middle: 'middle'\n};\n\n/* let flippedTextAnchor = true;\nlet detected = false;\nexport function detectRtlSvgSupport(ns, ownerDoc) {\n  if (!detected) {\n    const body = ownerDoc.body;\n    if (body) {\n      const rtlTestSVG = ownerDoc.createElementNS(ns, 'svg');\n      const textNode = ownerDoc.createElementNS(ns, 'text');\n      const group = ownerDoc.createElementNS(ns, 'g');\n\n      rtlTestSVG.setAttribute('xmlns', ns);\n      rtlTestSVG.setAttribute('style', 'position: absolute; width: 100px; height: 100px; top: -100px; left: 0px');\n\n      textNode.setAttribute('text-anchor', 'start');\n      textNode.setAttribute('direction', 'rtl');\n      textNode.setAttribute('font-size', '14px');\n      textNode.setAttribute('x', 50);\n      textNode.setAttribute('y', 50);\n      textNode.textContent = '';\n\n      group.appendChild(textNode);\n      rtlTestSVG.appendChild(group);\n      body.appendChild(rtlTestSVG);\n\n      flippedTextAnchor = textNode.getBoundingClientRect().left < 50;\n      body.removeChild(rtlTestSVG);\n    }\n  }\n  detected = true;\n} */\n\nexport function flipTextAnchor(value, dir) {\n  if (dir === 'rtl') {\n    return textAnchorRTLMap[value];\n  }\n  return value;\n}\n","import { ellipsText, measureText } from '../../../text-manipulation';\nimport baselineHeuristic from '../../../text-manipulation/baseline-heuristic';\nimport { detectTextDirection, flipTextAnchor } from '../../../../core/utils/rtl-util';\n\nexport default function render(t, { g }) {\n  const text = ellipsText(t, measureText);\n\n  g.font = `${t['font-size']} ${t['font-family']}`;\n  g.canvas.dir = detectTextDirection(t.text);\n  const textAlign = t['text-anchor'] === 'middle' ? 'center' : t['text-anchor'];\n  g.textAlign = flipTextAnchor(textAlign, g.canvas.dir);\n\n  const bdy = baselineHeuristic(t);\n\n  g.fillText(text, t.x + t.dx, t.y + t.dy + bdy);\n}\n","export default function render(path, { g, doStroke, doFill }) {\n  const p = new Path2D(path.d);\n  if (doFill) {\n    g.fill(p);\n  }\n  if (doStroke) {\n    g.stroke(p);\n  }\n}\n","import { renderer, register } from './canvas-renderer';\nimport rect from './shapes/rect';\nimport circle from './shapes/circle';\nimport line from './shapes/line';\nimport text from './shapes/text';\nimport path from './shapes/path';\n\nregister('rect', rect);\nregister('circle', circle);\nregister('line', line);\nregister('path', path);\nregister('text', text);\n\nexport default renderer;\n\nexport function rendererComponent(picasso) {\n  picasso.renderer('canvas', renderer);\n}\n","function diff(from, to) {\n  const added = [];\n  let items;\n  const removed = [];\n  const updatedNew = [];\n  const updatedOld = [];\n  let fromIds;\n  let toIds;\n  const idMapper = a => a.id;\n  const nodeMapper = (node, i) => {\n    let id;\n    if (typeof node === 'object') {\n      if ('id' in node) {\n        id = node.id;\n      } else {\n        id = i;\n      }\n    } else {\n      id = node;\n    }\n    return {\n      content: node,\n      id: `${id}__${node.type || ''}`\n    };\n  };\n\n  if (!from.isTree) {\n    from = from.map(nodeMapper);\n  }\n\n  to = to.map(nodeMapper);\n\n  fromIds = from.map(idMapper);\n  toIds = to.map(idMapper);\n  // TODO - handle duplicate values\n\n  // added = to.filter( v => fromIds.indexOf( v.id ) < 0 );\n  // updatedNew = to.filter( v => fromIds.indexOf( v.id ) >= 0 );\n  // removed = from.filter( v => toIds.indexOf( v.id ) < 0 );\n  // updatedOld = from.filter( v => toIds.indexOf( v.id ) >= 0 );\n\n  for (let i = 0, len = to.length; i < len; i++) {\n    const idx = fromIds.indexOf(to[i].id);\n    if (idx === -1) {\n      added.push(to[i]);\n    } else {\n      updatedNew.push(to[i]);\n    }\n  }\n\n  for (let i = 0, len = from.length; i < len; i++) {\n    const idx = toIds.indexOf(from[i].id);\n    if (idx === -1) {\n      removed.push(from[i]);\n    } else {\n      updatedOld.push(from[i]);\n    }\n  }\n\n  for (let i = 0, len = added.length; i < len; i++) {\n    if (added[i].content.children) {\n      added[i].diff = diff([], added[i].content.children);\n      added[i].children = added[i].diff.updatedNew.concat(added[i].diff.added);\n      added[i].children.isTree = true;\n    }\n  }\n\n  for (let i = 0, len = updatedNew.length; i < len; i++) {\n    updatedNew[i].diff = diff(updatedOld[i].children || [], updatedNew[i].content.children || []);\n    updatedNew[i].object = updatedOld[i].object;\n    updatedNew[i].children = updatedNew[i].diff.items;\n  }\n\n  items = updatedNew.concat(added);\n\n  added.isTree = true;\n  removed.isTree = true;\n  updatedNew.isTree = true;\n  updatedOld.isTree = true;\n  items.isTree = true;\n\n  return {\n    added,\n    updatedNew,\n    updatedOld,\n    removed,\n    items\n  };\n}\n\nfunction createNodes(nodes, parent, create) {\n  for (let i = 0, len = nodes.length; i < len; i++) {\n    nodes[i].object = create(nodes[i].content.type, parent);\n  }\n}\n\nfunction destroyNodes(nodes, destroy) {\n  for (let i = 0, len = nodes.length; i < len; i++) {\n    if (nodes[i].object !== null && typeof nodes[i].object !== 'undefined') {\n      destroy(nodes[i].object);\n      nodes[i].object = null;\n    }\n  }\n}\n\nfunction updateNodes(nodes, creator, maintainer, destroyer) {\n  let item;\n  for (let i = 0, len = nodes.length; i < len; i++) {\n    item = nodes[i];\n    if (item.object !== null && typeof item.object !== 'undefined') {\n      maintainer(item.object, item.content);\n      if (item.diff) {\n        createNodes(item.diff.added, item.object, creator);\n        destroyNodes(item.diff.removed, destroyer);\n        updateNodes(item.diff.items, creator, maintainer, destroyer);\n      }\n    }\n  }\n}\n\nfunction createTree(oldItems, newItems, root, creator, maintainer, destroyer) {\n  const d = diff(oldItems, newItems);\n\n  createNodes(d.added, root, creator);\n  destroyNodes(d.removed, destroyer);\n  updateNodes(d.items, creator, maintainer, destroyer);\n\n  return d.items;\n}\n\nexport {\n  diff,\n  createTree,\n  destroyNodes,\n  createNodes,\n  updateNodes\n};\n","import { ellipsText, measureText } from '../../text-manipulation';\nimport baselineHeuristic from '../../text-manipulation/baseline-heuristic';\nimport { detectTextDirection, flipTextAnchor } from '../../../core/utils/rtl-util';\n\nconst svgNs = 'http://www.w3.org/2000/svg';\n\nconst creator = (type, parent) => {\n  if (!type || typeof type !== 'string') {\n    throw new Error(`Invalid type: ${type}`);\n  }\n\n  const el = parent.ownerDocument.createElementNS(svgNs, type === 'container' ? 'g' : type);\n\n  parent.appendChild(el);\n  return el;\n};\n\nconst destroyer = (el) => {\n  if (el.parentNode) {\n    el.parentNode.removeChild(el);\n  }\n};\n\nconst maintainer = (element, item) => {\n  for (const attr in item.attrs) {\n    if (attr === 'text') {\n      element.setAttribute('style', 'white-space: pre');\n      element.textContent = ellipsText(item.attrs, measureText);\n      const dir = detectTextDirection(item.attrs.text);\n      if (dir === 'rtl') {\n        element.setAttribute('direction', 'rtl');\n        element.setAttribute('dir', 'rtl');\n        element.setAttribute('text-anchor', flipTextAnchor(element.getAttribute('text-anchor'), dir));\n      }\n    } else if (item.type === 'text' && (attr === 'dy' || attr === 'dominant-baseline')) {\n      const dy = +element.getAttribute(attr) || 0;\n      let val = 0;\n      if (attr === 'dominant-baseline') {\n        val = baselineHeuristic(item.attrs);\n      } else {\n        val = item.attrs[attr];\n      }\n      element.setAttribute('dy', val + dy);\n    } else {\n      element.setAttribute(attr, item.attrs[attr]);\n    }\n  }\n\n  if (typeof item.data === 'string' || typeof item.data === 'number' || typeof item.data === 'boolean') {\n    element.setAttribute('data', item.data);\n  } else if (typeof item.data === 'object' && item.data !== null) {\n    for (const d in item.data) {\n      if (typeof item.data[d] === 'string' || typeof item.data[d] === 'number' || typeof item.data[d] === 'boolean') {\n        element.setAttribute(`data-${d}`, item.data[d]);\n      }\n    }\n  }\n};\n\nexport {\n  svgNs,\n  creator,\n  maintainer,\n  destroyer\n};\n","import { createTree } from '../node-tree';\nimport { creator, maintainer, destroyer } from './svg-nodes';\n\nclass TreeItemRenderer {\n  /**\n   * Constructor\n   * @private\n   * @param  {TreeCreator} treeCreator - Function used to create the DOM tree..\n   * @param  {SVGCreator} nodeCreator - Function used to create nodes.\n   * @param  {SVGMaintainer} nodeMaintainer - Function used to update nodes.\n   * @param  {SVGDestroyer} nodeDestroyer - Function used to destroy nodes.\n   */\n  constructor(treeCreator, nodeCreator, nodeMaintainer, nodeDestroyer) {\n    this.create = treeCreator;\n    this.nodeCreator = nodeCreator;\n    this.nodeMaintainer = nodeMaintainer;\n    this.nodeDestroyer = nodeDestroyer;\n  }\n\n  render(newItems, root) {\n    return this.create([], newItems, root, this.nodeCreator, this.nodeMaintainer, this.nodeDestroyer);\n  }\n}\n\nfunction tree() {\n  return new TreeItemRenderer(createTree, creator, maintainer, destroyer);\n}\n\nexport {\n  TreeItemRenderer as default,\n  tree\n};\n\n/**\n * Create an SVGElement and attach to parent.\n * @private\n * @callback SVGCreator\n * @param {String} type - The type of element to create.\n * @param {SVGElement} parent - The parent element to append the new element to.\n * @return {SVGElement} The created element\n */\n\n/**\n * Update the element with content from item.\n * @private\n * @callback SVGMaintainer\n * @param {SVGElement} el - The element to update\n * @param {Object} item - The object to use as input for the update\n */\n\n/**\n * Detach element from its parent.\n * @private\n * @callback SVGDestroyer\n * @param {SVGElement} el - Element to destroy.\n */\n\n/**\n * Create, update and destroy nodes.\n * @private\n * @callback TreeCreator\n * @param {Object[]} existing - The existing items in the tree.\n * @param {Object[]} active - The new items to create the tree from.\n * @param {SVGCreator} creator - Function used to create nodes.\n * @param {SVGMaintainer} maintainer - Function used to update nodes.\n * @param {SVGDestroyer} destroyer - Function used to destroy nodes.\n */\n","/* eslint import/prefer-default-export: 0 */\n\n/**\n * Hash an object\n * Modified version of Java's HashCode function\n * Source: {@link http://werxltd.com/wp/2010/05/13/javascript-implementation-of-javas-string-hashcode-method/}\n * @ignore\n *\n * @param  {Object} item Item to hash\n * @return {String}      Unique hash id\n */\nexport function hashObject(item) {\n  let hash = 0;\n  let i;\n  let chr;\n  let len;\n\n  item = JSON.stringify(item);\n\n  if (item.length === 0) {\n    return hash;\n  }\n\n  for (i = 0, len = item.length; i < len; i++) {\n    chr = item.charCodeAt(i);\n    hash = ((hash << 5) - hash) + chr;\n    hash &= hash; // Convert to 32bit integer\n  }\n\n  return hash;\n}\n","import { degreesToPoints } from '../../../core/math/angles';\nimport { hashObject } from '../../../core/utils/crypto';\n\nlet gradients = [];\nlet gradientHashMap = {};\n\n/**\n * If this attr (fill or stroke) has a gradient, apply it.\n * @ignore\n * @param  {Object} item Item with item[attr]\n * @param  {String} attr The attribute to search for gradient (fill or stroke)\n * @param  {String} url  URL for handling base href\n */\nfunction checkGradient(item = {}, attr = 'fill', url = '') {\n  let gradientHash = hashObject(item[attr]);\n  let gradientId = '';\n\n  if (gradientHashMap[gradientHash] !== undefined) {\n    gradientId = gradientHashMap[gradientHash];\n  } else {\n    let { orientation, degree, stops = [] } = item[attr];\n    let gradient = {};\n\n    if (degree === undefined) {\n      degree = 90;\n    }\n\n    // Default to linear\n    if (orientation === 'radial') {\n      gradient.type = 'radialGradient';\n    } else {\n      gradient = degreesToPoints(degree);\n      gradient.type = 'linearGradient';\n    }\n\n    gradient.id = `picasso-gradient-${gradientHash}`;\n    gradient.children = stops.map(({ offset, color, opacity }) => ({\n      type: 'stop',\n      offset: `${offset * 100}%`,\n      style: `stop-color:${color};stop-opacity:${opacity || 1}`\n    }));\n\n    gradients.push(gradient);\n    gradientHashMap[gradientHash] = gradient.id;\n    gradientId = gradient.id;\n  }\n\n  return `url(${url}#${gradientId})`;\n}\n\n/**\n * Reset the gradients between rendering\n * @ignore\n */\nexport function resetGradients() {\n  gradients = [];\n  gradientHashMap = {};\n}\n\nexport function onGradient(state) {\n  let url = '';\n  if (typeof window !== 'undefined') {\n    url = window.location.href.split('#')[0];\n  }\n\n  const item = state.node;\n  if (item.fill && typeof item.fill === 'object' && item.fill.type === 'gradient') {\n    item.fill = checkGradient(item, 'fill', url);\n  }\n\n  if (item.stroke && typeof item.stroke === 'object' && item.stroke.type === 'gradient') {\n    item.stroke = checkGradient(item, 'stroke', url);\n  }\n}\n\nexport function createDefsNode() {\n  return {\n    type: 'defs',\n    children: gradients,\n    disabled: () => gradients.length === 0\n  };\n}\n","import { tree as treeFactory } from './svg-tree';\nimport { svgNs } from './svg-nodes';\nimport sceneFactory from '../../../core/scene-graph/scene';\nimport { onLineBreak } from '../../text-manipulation';\nimport {\n  resetGradients,\n  onGradient,\n  createDefsNode\n} from './svg-gradient';\nimport createRendererBox from '../renderer-box';\nimport create from '../index';\n\n/**\n * Create a new svg renderer\n * @typedef {function} svgRendererFactory\n * @param {function} treeFactory - Node tree factory\n * @param {string} ns - Namespace definition\n * @param {function} sceneFn - Scene factory\n * @returns {renderer} A svg renderer instance\n */\nexport default function renderer(treeFn = treeFactory, ns = svgNs, sceneFn = sceneFactory) {\n  const tree = treeFn();\n  let el;\n  let group;\n  let hasChangedRect = false;\n  let rect = createRendererBox();\n  let scene;\n\n  const svg = create();\n\n  svg.element = () => el;\n\n  svg.root = () => group;\n\n  svg.appendTo = (element) => {\n    if (!el) {\n      el = element.ownerDocument.createElementNS(ns, 'svg');\n      el.style.position = 'absolute';\n      el.style['-webkit-font-smoothing'] = 'antialiased';\n      el.style['-moz-osx-font-smoothing'] = 'antialiased';\n      el.style.pointerEvents = 'none';\n      el.setAttribute('xmlns', ns);\n      group = element.ownerDocument.createElementNS(ns, 'g');\n      group.style.pointerEvents = 'auto';\n      el.appendChild(group);\n    }\n\n    element.appendChild(el);\n\n    return el;\n  };\n\n  svg.render = (nodes) => {\n    if (!el) {\n      return false;\n    }\n\n    const scaleX = rect.scaleRatio.x;\n    const scaleY = rect.scaleRatio.y;\n\n    if (hasChangedRect) {\n      el.style.left = `${Math.round(rect.margin.left + (rect.x * scaleX))}px`;\n      el.style.top = `${Math.round(rect.margin.top + (rect.y * scaleY))}px`;\n      el.setAttribute('width', Math.round(rect.width * scaleX));\n      el.setAttribute('height', Math.round(rect.height * scaleY));\n    }\n\n    resetGradients();\n\n    const sceneContainer = {\n      type: 'container',\n      children: Array.isArray(nodes) ? [...nodes, createDefsNode()] : nodes\n    };\n\n    if (scaleX !== 1 || scaleY !== 1) {\n      sceneContainer.transform = `scale(${scaleX}, ${scaleY})`;\n    }\n\n    const newScene = sceneFn({\n      items: [sceneContainer],\n      on: {\n        create: [\n          onGradient,\n          onLineBreak(svg.measureText)\n        ]\n      }\n    });\n    const hasChangedScene = scene ? !newScene.equals(scene) : true;\n\n    const doRender = hasChangedRect || hasChangedScene;\n    if (doRender) {\n      svg.clear();\n      tree.render(newScene.children, group);\n    }\n\n    hasChangedRect = false;\n    scene = newScene;\n    return doRender;\n  };\n\n  svg.itemsAt = input => (scene ? scene.getItemsFrom(input) : []);\n\n  svg.findShapes = selector => (scene ? scene.findShapes(selector) : []);\n\n  svg.clear = () => {\n    if (!group) {\n      return svg;\n    }\n    scene = null;\n    const g = group.cloneNode(false);\n    el.replaceChild(g, group);\n    group = g;\n    return svg;\n  };\n\n  svg.destroy = () => {\n    if (el && el.parentElement) {\n      el.parentElement.removeChild(el);\n    }\n    el = null;\n    group = null;\n  };\n\n  svg.size = (opts) => {\n    if (opts) {\n      const newRect = createRendererBox(opts);\n\n      if (JSON.stringify(rect) !== JSON.stringify(newRect)) {\n        hasChangedRect = true;\n        rect = newRect;\n      }\n    }\n\n    return rect;\n  };\n\n  return svg;\n}\n\nexport function rendererComponent(picasso) {\n  picasso.renderer('svg', renderer);\n}\n","export function vnode(sel, data, children, text, elm) {\n    var key = data === undefined ? undefined : data.key;\n    return { sel: sel, data: data, children: children,\n        text: text, elm: elm, key: key };\n}\nexport default vnode;\n//# sourceMappingURL=vnode.js.map","export var array = Array.isArray;\nexport function primitive(s) {\n    return typeof s === 'string' || typeof s === 'number';\n}\n//# sourceMappingURL=is.js.map","function createElement(tagName) {\n    return document.createElement(tagName);\n}\nfunction createElementNS(namespaceURI, qualifiedName) {\n    return document.createElementNS(namespaceURI, qualifiedName);\n}\nfunction createTextNode(text) {\n    return document.createTextNode(text);\n}\nfunction createComment(text) {\n    return document.createComment(text);\n}\nfunction insertBefore(parentNode, newNode, referenceNode) {\n    parentNode.insertBefore(newNode, referenceNode);\n}\nfunction removeChild(node, child) {\n    node.removeChild(child);\n}\nfunction appendChild(node, child) {\n    node.appendChild(child);\n}\nfunction parentNode(node) {\n    return node.parentNode;\n}\nfunction nextSibling(node) {\n    return node.nextSibling;\n}\nfunction tagName(elm) {\n    return elm.tagName;\n}\nfunction setTextContent(node, text) {\n    node.textContent = text;\n}\nfunction getTextContent(node) {\n    return node.textContent;\n}\nfunction isElement(node) {\n    return node.nodeType === 1;\n}\nfunction isText(node) {\n    return node.nodeType === 3;\n}\nfunction isComment(node) {\n    return node.nodeType === 8;\n}\nexport var htmlDomApi = {\n    createElement: createElement,\n    createElementNS: createElementNS,\n    createTextNode: createTextNode,\n    createComment: createComment,\n    insertBefore: insertBefore,\n    removeChild: removeChild,\n    appendChild: appendChild,\n    parentNode: parentNode,\n    nextSibling: nextSibling,\n    tagName: tagName,\n    setTextContent: setTextContent,\n    getTextContent: getTextContent,\n    isElement: isElement,\n    isText: isText,\n    isComment: isComment,\n};\nexport default htmlDomApi;\n//# sourceMappingURL=htmldomapi.js.map","import vnode from './vnode';\nimport * as is from './is';\nimport htmlDomApi from './htmldomapi';\nfunction isUndef(s) { return s === undefined; }\nfunction isDef(s) { return s !== undefined; }\nvar emptyNode = vnode('', {}, [], undefined, undefined);\nfunction sameVnode(vnode1, vnode2) {\n    return vnode1.key === vnode2.key && vnode1.sel === vnode2.sel;\n}\nfunction isVnode(vnode) {\n    return vnode.sel !== undefined;\n}\nfunction createKeyToOldIdx(children, beginIdx, endIdx) {\n    var i, map = {}, key, ch;\n    for (i = beginIdx; i <= endIdx; ++i) {\n        ch = children[i];\n        if (ch != null) {\n            key = ch.key;\n            if (key !== undefined)\n                map[key] = i;\n        }\n    }\n    return map;\n}\nvar hooks = ['create', 'update', 'remove', 'destroy', 'pre', 'post'];\nexport { h } from './h';\nexport { thunk } from './thunk';\nexport function init(modules, domApi) {\n    var i, j, cbs = {};\n    var api = domApi !== undefined ? domApi : htmlDomApi;\n    for (i = 0; i < hooks.length; ++i) {\n        cbs[hooks[i]] = [];\n        for (j = 0; j < modules.length; ++j) {\n            var hook = modules[j][hooks[i]];\n            if (hook !== undefined) {\n                cbs[hooks[i]].push(hook);\n            }\n        }\n    }\n    function emptyNodeAt(elm) {\n        var id = elm.id ? '#' + elm.id : '';\n        var c = elm.className ? '.' + elm.className.split(' ').join('.') : '';\n        return vnode(api.tagName(elm).toLowerCase() + id + c, {}, [], undefined, elm);\n    }\n    function createRmCb(childElm, listeners) {\n        return function rmCb() {\n            if (--listeners === 0) {\n                var parent_1 = api.parentNode(childElm);\n                api.removeChild(parent_1, childElm);\n            }\n        };\n    }\n    function createElm(vnode, insertedVnodeQueue) {\n        var i, data = vnode.data;\n        if (data !== undefined) {\n            if (isDef(i = data.hook) && isDef(i = i.init)) {\n                i(vnode);\n                data = vnode.data;\n            }\n        }\n        var children = vnode.children, sel = vnode.sel;\n        if (sel === '!') {\n            if (isUndef(vnode.text)) {\n                vnode.text = '';\n            }\n            vnode.elm = api.createComment(vnode.text);\n        }\n        else if (sel !== undefined) {\n            // Parse selector\n            var hashIdx = sel.indexOf('#');\n            var dotIdx = sel.indexOf('.', hashIdx);\n            var hash = hashIdx > 0 ? hashIdx : sel.length;\n            var dot = dotIdx > 0 ? dotIdx : sel.length;\n            var tag = hashIdx !== -1 || dotIdx !== -1 ? sel.slice(0, Math.min(hash, dot)) : sel;\n            var elm = vnode.elm = isDef(data) && isDef(i = data.ns) ? api.createElementNS(i, tag)\n                : api.createElement(tag);\n            if (hash < dot)\n                elm.setAttribute('id', sel.slice(hash + 1, dot));\n            if (dotIdx > 0)\n                elm.setAttribute('class', sel.slice(dot + 1).replace(/\\./g, ' '));\n            for (i = 0; i < cbs.create.length; ++i)\n                cbs.create[i](emptyNode, vnode);\n            if (is.array(children)) {\n                for (i = 0; i < children.length; ++i) {\n                    var ch = children[i];\n                    if (ch != null) {\n                        api.appendChild(elm, createElm(ch, insertedVnodeQueue));\n                    }\n                }\n            }\n            else if (is.primitive(vnode.text)) {\n                api.appendChild(elm, api.createTextNode(vnode.text));\n            }\n            i = vnode.data.hook; // Reuse variable\n            if (isDef(i)) {\n                if (i.create)\n                    i.create(emptyNode, vnode);\n                if (i.insert)\n                    insertedVnodeQueue.push(vnode);\n            }\n        }\n        else {\n            vnode.elm = api.createTextNode(vnode.text);\n        }\n        return vnode.elm;\n    }\n    function addVnodes(parentElm, before, vnodes, startIdx, endIdx, insertedVnodeQueue) {\n        for (; startIdx <= endIdx; ++startIdx) {\n            var ch = vnodes[startIdx];\n            if (ch != null) {\n                api.insertBefore(parentElm, createElm(ch, insertedVnodeQueue), before);\n            }\n        }\n    }\n    function invokeDestroyHook(vnode) {\n        var i, j, data = vnode.data;\n        if (data !== undefined) {\n            if (isDef(i = data.hook) && isDef(i = i.destroy))\n                i(vnode);\n            for (i = 0; i < cbs.destroy.length; ++i)\n                cbs.destroy[i](vnode);\n            if (vnode.children !== undefined) {\n                for (j = 0; j < vnode.children.length; ++j) {\n                    i = vnode.children[j];\n                    if (i != null && typeof i !== \"string\") {\n                        invokeDestroyHook(i);\n                    }\n                }\n            }\n        }\n    }\n    function removeVnodes(parentElm, vnodes, startIdx, endIdx) {\n        for (; startIdx <= endIdx; ++startIdx) {\n            var i_1 = void 0, listeners = void 0, rm = void 0, ch = vnodes[startIdx];\n            if (ch != null) {\n                if (isDef(ch.sel)) {\n                    invokeDestroyHook(ch);\n                    listeners = cbs.remove.length + 1;\n                    rm = createRmCb(ch.elm, listeners);\n                    for (i_1 = 0; i_1 < cbs.remove.length; ++i_1)\n                        cbs.remove[i_1](ch, rm);\n                    if (isDef(i_1 = ch.data) && isDef(i_1 = i_1.hook) && isDef(i_1 = i_1.remove)) {\n                        i_1(ch, rm);\n                    }\n                    else {\n                        rm();\n                    }\n                }\n                else {\n                    api.removeChild(parentElm, ch.elm);\n                }\n            }\n        }\n    }\n    function updateChildren(parentElm, oldCh, newCh, insertedVnodeQueue) {\n        var oldStartIdx = 0, newStartIdx = 0;\n        var oldEndIdx = oldCh.length - 1;\n        var oldStartVnode = oldCh[0];\n        var oldEndVnode = oldCh[oldEndIdx];\n        var newEndIdx = newCh.length - 1;\n        var newStartVnode = newCh[0];\n        var newEndVnode = newCh[newEndIdx];\n        var oldKeyToIdx;\n        var idxInOld;\n        var elmToMove;\n        var before;\n        while (oldStartIdx <= oldEndIdx && newStartIdx <= newEndIdx) {\n            if (oldStartVnode == null) {\n                oldStartVnode = oldCh[++oldStartIdx]; // Vnode might have been moved left\n            }\n            else if (oldEndVnode == null) {\n                oldEndVnode = oldCh[--oldEndIdx];\n            }\n            else if (newStartVnode == null) {\n                newStartVnode = newCh[++newStartIdx];\n            }\n            else if (newEndVnode == null) {\n                newEndVnode = newCh[--newEndIdx];\n            }\n            else if (sameVnode(oldStartVnode, newStartVnode)) {\n                patchVnode(oldStartVnode, newStartVnode, insertedVnodeQueue);\n                oldStartVnode = oldCh[++oldStartIdx];\n                newStartVnode = newCh[++newStartIdx];\n            }\n            else if (sameVnode(oldEndVnode, newEndVnode)) {\n                patchVnode(oldEndVnode, newEndVnode, insertedVnodeQueue);\n                oldEndVnode = oldCh[--oldEndIdx];\n                newEndVnode = newCh[--newEndIdx];\n            }\n            else if (sameVnode(oldStartVnode, newEndVnode)) {\n                patchVnode(oldStartVnode, newEndVnode, insertedVnodeQueue);\n                api.insertBefore(parentElm, oldStartVnode.elm, api.nextSibling(oldEndVnode.elm));\n                oldStartVnode = oldCh[++oldStartIdx];\n                newEndVnode = newCh[--newEndIdx];\n            }\n            else if (sameVnode(oldEndVnode, newStartVnode)) {\n                patchVnode(oldEndVnode, newStartVnode, insertedVnodeQueue);\n                api.insertBefore(parentElm, oldEndVnode.elm, oldStartVnode.elm);\n                oldEndVnode = oldCh[--oldEndIdx];\n                newStartVnode = newCh[++newStartIdx];\n            }\n            else {\n                if (oldKeyToIdx === undefined) {\n                    oldKeyToIdx = createKeyToOldIdx(oldCh, oldStartIdx, oldEndIdx);\n                }\n                idxInOld = oldKeyToIdx[newStartVnode.key];\n                if (isUndef(idxInOld)) {\n                    api.insertBefore(parentElm, createElm(newStartVnode, insertedVnodeQueue), oldStartVnode.elm);\n                    newStartVnode = newCh[++newStartIdx];\n                }\n                else {\n                    elmToMove = oldCh[idxInOld];\n                    if (elmToMove.sel !== newStartVnode.sel) {\n                        api.insertBefore(parentElm, createElm(newStartVnode, insertedVnodeQueue), oldStartVnode.elm);\n                    }\n                    else {\n                        patchVnode(elmToMove, newStartVnode, insertedVnodeQueue);\n                        oldCh[idxInOld] = undefined;\n                        api.insertBefore(parentElm, elmToMove.elm, oldStartVnode.elm);\n                    }\n                    newStartVnode = newCh[++newStartIdx];\n                }\n            }\n        }\n        if (oldStartIdx <= oldEndIdx || newStartIdx <= newEndIdx) {\n            if (oldStartIdx > oldEndIdx) {\n                before = newCh[newEndIdx + 1] == null ? null : newCh[newEndIdx + 1].elm;\n                addVnodes(parentElm, before, newCh, newStartIdx, newEndIdx, insertedVnodeQueue);\n            }\n            else {\n                removeVnodes(parentElm, oldCh, oldStartIdx, oldEndIdx);\n            }\n        }\n    }\n    function patchVnode(oldVnode, vnode, insertedVnodeQueue) {\n        var i, hook;\n        if (isDef(i = vnode.data) && isDef(hook = i.hook) && isDef(i = hook.prepatch)) {\n            i(oldVnode, vnode);\n        }\n        var elm = vnode.elm = oldVnode.elm;\n        var oldCh = oldVnode.children;\n        var ch = vnode.children;\n        if (oldVnode === vnode)\n            return;\n        if (vnode.data !== undefined) {\n            for (i = 0; i < cbs.update.length; ++i)\n                cbs.update[i](oldVnode, vnode);\n            i = vnode.data.hook;\n            if (isDef(i) && isDef(i = i.update))\n                i(oldVnode, vnode);\n        }\n        if (isUndef(vnode.text)) {\n            if (isDef(oldCh) && isDef(ch)) {\n                if (oldCh !== ch)\n                    updateChildren(elm, oldCh, ch, insertedVnodeQueue);\n            }\n            else if (isDef(ch)) {\n                if (isDef(oldVnode.text))\n                    api.setTextContent(elm, '');\n                addVnodes(elm, null, ch, 0, ch.length - 1, insertedVnodeQueue);\n            }\n            else if (isDef(oldCh)) {\n                removeVnodes(elm, oldCh, 0, oldCh.length - 1);\n            }\n            else if (isDef(oldVnode.text)) {\n                api.setTextContent(elm, '');\n            }\n        }\n        else if (oldVnode.text !== vnode.text) {\n            api.setTextContent(elm, vnode.text);\n        }\n        if (isDef(hook) && isDef(i = hook.postpatch)) {\n            i(oldVnode, vnode);\n        }\n    }\n    return function patch(oldVnode, vnode) {\n        var i, elm, parent;\n        var insertedVnodeQueue = [];\n        for (i = 0; i < cbs.pre.length; ++i)\n            cbs.pre[i]();\n        if (!isVnode(oldVnode)) {\n            oldVnode = emptyNodeAt(oldVnode);\n        }\n        if (sameVnode(oldVnode, vnode)) {\n            patchVnode(oldVnode, vnode, insertedVnodeQueue);\n        }\n        else {\n            elm = oldVnode.elm;\n            parent = api.parentNode(elm);\n            createElm(vnode, insertedVnodeQueue);\n            if (parent !== null) {\n                api.insertBefore(parent, vnode.elm, api.nextSibling(elm));\n                removeVnodes(parent, [oldVnode], 0, 0);\n            }\n        }\n        for (i = 0; i < insertedVnodeQueue.length; ++i) {\n            insertedVnodeQueue[i].data.hook.insert(insertedVnodeQueue[i]);\n        }\n        for (i = 0; i < cbs.post.length; ++i)\n            cbs.post[i]();\n        return vnode;\n    };\n}\n//# sourceMappingURL=snabbdom.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar xlinkNS = 'http://www.w3.org/1999/xlink';\nvar xmlNS = 'http://www.w3.org/XML/1998/namespace';\nvar colonChar = 58;\nvar xChar = 120;\nfunction updateAttrs(oldVnode, vnode) {\n    var key, elm = vnode.elm, oldAttrs = oldVnode.data.attrs, attrs = vnode.data.attrs;\n    if (!oldAttrs && !attrs)\n        return;\n    if (oldAttrs === attrs)\n        return;\n    oldAttrs = oldAttrs || {};\n    attrs = attrs || {};\n    // update modified attributes, add new attributes\n    for (key in attrs) {\n        var cur = attrs[key];\n        var old = oldAttrs[key];\n        if (old !== cur) {\n            if (cur === true) {\n                elm.setAttribute(key, \"\");\n            }\n            else if (cur === false) {\n                elm.removeAttribute(key);\n            }\n            else {\n                if (key.charCodeAt(0) !== xChar) {\n                    elm.setAttribute(key, cur);\n                }\n                else if (key.charCodeAt(3) === colonChar) {\n                    // Assume xml namespace\n                    elm.setAttributeNS(xmlNS, key, cur);\n                }\n                else if (key.charCodeAt(5) === colonChar) {\n                    // Assume xlink namespace\n                    elm.setAttributeNS(xlinkNS, key, cur);\n                }\n                else {\n                    elm.setAttribute(key, cur);\n                }\n            }\n        }\n    }\n    // remove removed attributes\n    // use `in` operator since the previous `for` iteration uses it (.i.e. add even attributes with undefined value)\n    // the other option is to remove all attributes with value == undefined\n    for (key in oldAttrs) {\n        if (!(key in attrs)) {\n            elm.removeAttribute(key);\n        }\n    }\n}\nexports.attributesModule = { create: updateAttrs, update: updateAttrs };\nexports.default = exports.attributesModule;\n//# sourceMappingURL=attributes.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction updateClass(oldVnode, vnode) {\n    var cur, name, elm = vnode.elm, oldClass = oldVnode.data.class, klass = vnode.data.class;\n    if (!oldClass && !klass)\n        return;\n    if (oldClass === klass)\n        return;\n    oldClass = oldClass || {};\n    klass = klass || {};\n    for (name in oldClass) {\n        if (!klass[name]) {\n            elm.classList.remove(name);\n        }\n    }\n    for (name in klass) {\n        cur = klass[name];\n        if (cur !== oldClass[name]) {\n            elm.classList[cur ? 'add' : 'remove'](name);\n        }\n    }\n}\nexports.classModule = { create: updateClass, update: updateClass };\nexports.default = exports.classModule;\n//# sourceMappingURL=class.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar raf = (typeof window !== 'undefined' && window.requestAnimationFrame) || setTimeout;\nvar nextFrame = function (fn) { raf(function () { raf(fn); }); };\nfunction setNextFrame(obj, prop, val) {\n    nextFrame(function () { obj[prop] = val; });\n}\nfunction updateStyle(oldVnode, vnode) {\n    var cur, name, elm = vnode.elm, oldStyle = oldVnode.data.style, style = vnode.data.style;\n    if (!oldStyle && !style)\n        return;\n    if (oldStyle === style)\n        return;\n    oldStyle = oldStyle || {};\n    style = style || {};\n    var oldHasDel = 'delayed' in oldStyle;\n    for (name in oldStyle) {\n        if (!style[name]) {\n            if (name[0] === '-' && name[1] === '-') {\n                elm.style.removeProperty(name);\n            }\n            else {\n                elm.style[name] = '';\n            }\n        }\n    }\n    for (name in style) {\n        cur = style[name];\n        if (name === 'delayed' && style.delayed) {\n            for (var name2 in style.delayed) {\n                cur = style.delayed[name2];\n                if (!oldHasDel || cur !== oldStyle.delayed[name2]) {\n                    setNextFrame(elm.style, name2, cur);\n                }\n            }\n        }\n        else if (name !== 'remove' && cur !== oldStyle[name]) {\n            if (name[0] === '-' && name[1] === '-') {\n                elm.style.setProperty(name, cur);\n            }\n            else {\n                elm.style[name] = cur;\n            }\n        }\n    }\n}\nfunction applyDestroyStyle(vnode) {\n    var style, name, elm = vnode.elm, s = vnode.data.style;\n    if (!s || !(style = s.destroy))\n        return;\n    for (name in style) {\n        elm.style[name] = style[name];\n    }\n}\nfunction applyRemoveStyle(vnode, rm) {\n    var s = vnode.data.style;\n    if (!s || !s.remove) {\n        rm();\n        return;\n    }\n    var name, elm = vnode.elm, i = 0, compStyle, style = s.remove, amount = 0, applied = [];\n    for (name in style) {\n        applied.push(name);\n        elm.style[name] = style[name];\n    }\n    compStyle = getComputedStyle(elm);\n    var props = compStyle['transition-property'].split(', ');\n    for (; i < props.length; ++i) {\n        if (applied.indexOf(props[i]) !== -1)\n            amount++;\n    }\n    elm.addEventListener('transitionend', function (ev) {\n        if (ev.target === elm)\n            --amount;\n        if (amount === 0)\n            rm();\n    });\n}\nexports.styleModule = {\n    create: updateStyle,\n    update: updateStyle,\n    destroy: applyDestroyStyle,\n    remove: applyRemoveStyle\n};\nexports.default = exports.styleModule;\n//# sourceMappingURL=style.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction invokeHandler(handler, vnode, event) {\n    if (typeof handler === \"function\") {\n        // call function handler\n        handler.call(vnode, event, vnode);\n    }\n    else if (typeof handler === \"object\") {\n        // call handler with arguments\n        if (typeof handler[0] === \"function\") {\n            // special case for single argument for performance\n            if (handler.length === 2) {\n                handler[0].call(vnode, handler[1], event, vnode);\n            }\n            else {\n                var args = handler.slice(1);\n                args.push(event);\n                args.push(vnode);\n                handler[0].apply(vnode, args);\n            }\n        }\n        else {\n            // call multiple handlers\n            for (var i = 0; i < handler.length; i++) {\n                invokeHandler(handler[i]);\n            }\n        }\n    }\n}\nfunction handleEvent(event, vnode) {\n    var name = event.type, on = vnode.data.on;\n    // call event handler(s) if exists\n    if (on && on[name]) {\n        invokeHandler(on[name], vnode, event);\n    }\n}\nfunction createListener() {\n    return function handler(event) {\n        handleEvent(event, handler.vnode);\n    };\n}\nfunction updateEventListeners(oldVnode, vnode) {\n    var oldOn = oldVnode.data.on, oldListener = oldVnode.listener, oldElm = oldVnode.elm, on = vnode && vnode.data.on, elm = (vnode && vnode.elm), name;\n    // optimization for reused immutable handlers\n    if (oldOn === on) {\n        return;\n    }\n    // remove existing listeners which no longer used\n    if (oldOn && oldListener) {\n        // if element changed or deleted we remove all existing listeners unconditionally\n        if (!on) {\n            for (name in oldOn) {\n                // remove listener if element was changed or existing listeners removed\n                oldElm.removeEventListener(name, oldListener, false);\n            }\n        }\n        else {\n            for (name in oldOn) {\n                // remove listener if existing listener removed\n                if (!on[name]) {\n                    oldElm.removeEventListener(name, oldListener, false);\n                }\n            }\n        }\n    }\n    // add new listeners which has not already attached\n    if (on) {\n        // reuse existing listener or create new\n        var listener = vnode.listener = oldVnode.listener || createListener();\n        // update vnode for listener\n        listener.vnode = vnode;\n        // if element changed or added we add all needed listeners unconditionally\n        if (!oldOn) {\n            for (name in on) {\n                // add listener if element was changed or new listeners added\n                elm.addEventListener(name, listener, false);\n            }\n        }\n        else {\n            for (name in on) {\n                // add listener if new listener added\n                if (!oldOn[name]) {\n                    elm.addEventListener(name, listener, false);\n                }\n            }\n        }\n    }\n}\nexports.eventListenersModule = {\n    create: updateEventListeners,\n    update: updateEventListeners,\n    destroy: updateEventListeners\n};\nexports.default = exports.eventListenersModule;\n//# sourceMappingURL=eventlisteners.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction vnode(sel, data, children, text, elm) {\n    var key = data === undefined ? undefined : data.key;\n    return { sel: sel, data: data, children: children,\n        text: text, elm: elm, key: key };\n}\nexports.vnode = vnode;\nexports.default = vnode;\n//# sourceMappingURL=vnode.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.array = Array.isArray;\nfunction primitive(s) {\n    return typeof s === 'string' || typeof s === 'number';\n}\nexports.primitive = primitive;\n//# sourceMappingURL=is.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar vnode_1 = require(\"./vnode\");\nvar is = require(\"./is\");\nfunction addNS(data, children, sel) {\n    data.ns = 'http://www.w3.org/2000/svg';\n    if (sel !== 'foreignObject' && children !== undefined) {\n        for (var i = 0; i < children.length; ++i) {\n            var childData = children[i].data;\n            if (childData !== undefined) {\n                addNS(childData, children[i].children, children[i].sel);\n            }\n        }\n    }\n}\nfunction h(sel, b, c) {\n    var data = {}, children, text, i;\n    if (c !== undefined) {\n        data = b;\n        if (is.array(c)) {\n            children = c;\n        }\n        else if (is.primitive(c)) {\n            text = c;\n        }\n        else if (c && c.sel) {\n            children = [c];\n        }\n    }\n    else if (b !== undefined) {\n        if (is.array(b)) {\n            children = b;\n        }\n        else if (is.primitive(b)) {\n            text = b;\n        }\n        else if (b && b.sel) {\n            children = [b];\n        }\n        else {\n            data = b;\n        }\n    }\n    if (is.array(children)) {\n        for (i = 0; i < children.length; ++i) {\n            if (is.primitive(children[i]))\n                children[i] = vnode_1.vnode(undefined, undefined, undefined, children[i], undefined);\n        }\n    }\n    if (sel[0] === 's' && sel[1] === 'v' && sel[2] === 'g' &&\n        (sel.length === 3 || sel[3] === '.' || sel[3] === '#')) {\n        addNS(data, children, sel);\n    }\n    return vnode_1.vnode(sel, data, children, text, undefined);\n}\nexports.h = h;\n;\nexports.default = h;\n//# sourceMappingURL=h.js.map","import { init } from 'snabbdom';\nimport snabbdomAttributes from 'snabbdom/modules/attributes';\nimport snabbdomClass from 'snabbdom/modules/class';\nimport snabbdomStyle from 'snabbdom/modules/style';\nimport snabbdomEventlisteners from 'snabbdom/modules/eventlisteners';\nimport h from 'snabbdom/h';\n\nconst patch = init([\n  snabbdomAttributes,\n  snabbdomClass,\n  snabbdomStyle,\n  snabbdomEventlisteners\n]);\n\nexport {\n  h,\n  patch\n};\n","import { h, patch } from './vdom';\nimport createRendererBox from '../renderer-box';\nimport create from '../index';\n\nexport default function renderer(opts = {}) {\n  const {\n    createElement = document.createElement.bind(document)\n  } = opts;\n\n  let el;\n  let rect = createRendererBox();\n  let vnode;\n\n  const dom = create();\n\n  dom.element = () => el;\n\n  dom.root = () => el;\n\n  dom.appendTo = (element) => {\n    if (!el) {\n      el = createElement('div');\n      el.style.position = 'absolute';\n      el.style['-webkit-font-smoothing'] = 'antialiased';\n      el.style['-moz-osx-font-smoothing'] = 'antialiased';\n      el.style.pointerEvents = 'none';\n    }\n\n    element.appendChild(el);\n\n    return el;\n  };\n\n  dom.render = (nodes) => {\n    if (!el) {\n      return false;\n    }\n\n    const scaleX = rect.scaleRatio.x;\n    const scaleY = rect.scaleRatio.y;\n\n    el.style.left = `${Math.round(rect.margin.left + (rect.x * scaleX))}px`;\n    el.style.top = `${Math.round(rect.margin.left + (rect.y * scaleY))}px`;\n    el.style.width = `${Math.round(rect.width * scaleX)}px`;\n    el.style.height = `${Math.round(rect.height * scaleY)}px`;\n\n    const node = h('div', {}, Array.isArray(nodes) ? nodes : [nodes]);\n\n    if (vnode) {\n      patch(vnode, node);\n    } else {\n      patch(el, node);\n    }\n    vnode = node;\n\n    return true;\n  };\n\n  dom.renderArgs = [h]; // Arguments to render functions using the DOM renderer\n\n  dom.clear = () => {\n    if (el) {\n      let first = el.firstChild;\n\n      while (first) {\n        el.removeChild(first);\n        first = el.firstChild;\n      }\n      vnode = null;\n    }\n\n    return dom;\n  };\n\n  dom.destroy = () => {\n    if (el && el.parentElement) {\n      el.parentElement.removeChild(el);\n    }\n    el = null;\n    vnode = null;\n  };\n\n  dom.size = (inner) => {\n    if (inner) {\n      rect = createRendererBox(inner);\n    }\n    return rect;\n  };\n\n  return dom;\n}\n","import renderer from './dom-renderer';\n\nexport default renderer;\n\nexport function rendererComponent(picasso) {\n  picasso.renderer('dom', renderer);\n}\n\n","import { rendererComponent as canvas } from '../web/renderer/canvas-renderer';\nimport { rendererComponent as svg } from '../web/renderer/svg-renderer/svg-renderer';\nimport { rendererComponent as dom } from '../web/renderer/dom-renderer';\n\nexport default [\n  svg,\n  canvas,\n  dom\n];\n","export default [];\n","const LOG_LEVEL = {\n  OFF: 0,\n  ERROR: 1,\n  WARN: 2,\n  INFO: 3,\n  DEBUG: 4\n};\n\nconst loggerFn = ({\n  level = LOG_LEVEL.OFF,\n  pipe = console\n} = {}) => {\n  let currentlevel = level;\n\n  const LOG_FN = {\n    [LOG_LEVEL.OFF]: () => {},\n    [LOG_LEVEL.ERROR]: (...args) => pipe.error(...args),\n    [LOG_LEVEL.WARN]: (...args) => pipe.warn(...args),\n    [LOG_LEVEL.INFO]: (...args) => pipe.info(...args),\n    [LOG_LEVEL.DEBUG]: (...args) => pipe.log(...args)\n  };\n\n  const log = (lev, ...args) => {\n    if (!lev || currentlevel < lev) { return; }\n\n    (LOG_FN[lev] || LOG_FN[LOG_LEVEL.DEBUG])(...args);\n  };\n\n  /**\n   * @typedef {object} logger\n   * @private\n   */\n\n  return /** @lends logger */ {\n    /**\n     * Log a message\n     * @param {number} lev - The log level\n     * @param {...any} args\n     * @kind function\n     */\n    log,\n\n    /**\n     * Log an error message\n     * @param {...any} args\n     */\n    error: (...args) => log(LOG_LEVEL.ERROR, ...args),\n\n    /**\n     * Log a warning message\n     * @param {...any} args\n     */\n    warn: (...args) => log(LOG_LEVEL.WARN, ...args),\n\n    /**\n     * Log an info message\n     * @param {...any} args\n     */\n    info: (...args) => log(LOG_LEVEL.INFO, ...args),\n\n    /**\n     * Log a debug message\n     * @param {...any} args\n     */\n    debug: (...args) => log(LOG_LEVEL.DEBUG, ...args),\n\n    /**\n     * Set the current log level\n     * @param {number} lev - The log level\n     */\n    level: (lev) => {\n      if (typeof lev === 'number') {\n        currentlevel = lev;\n      }\n      return currentlevel;\n    },\n\n    LOG_LEVEL\n  };\n};\n\nexport { loggerFn as default };\n","const palettes = [\n  {\n    key: 'categorical',\n    colors: [\n      ['#a54343', '#d76c6c', '#ec983d', '#ecc43d', '#f9ec86', '#cbe989', '#70ba6e', '#578b60', '#79d69f', '#26a0a7', '#138185', '#65d3da'] // breeze colors\n    ]\n  },\n  {\n    key: 'diverging',\n    colors: [\n      ['#3d52a1', '#3a89c9', '#77b7e5', '#b4ddf7', '#e6f5fe', '#ffe3aa', '#f9bd7e', '#ed875e', '#d24d3e', '#ae1c3e']\n    ]\n  },\n  {\n    key: 'sequential',\n    colors: [\n      ['rgb(180,221,212)', 'rgb(34, 83, 90)']\n    ]\n  }\n];\n\n/* eslint quote-props: 0 */\nconst style = {\n  // -- FOUNDATION --\n  // fonts\n  '$font-family': \"'Source Sans Pro', Arial, sans-serif\",\n  '$font-size': '12px',\n  '$line-height': '16px',\n  '$font-size--l': '16px',\n\n  // base grays\n  '$gray-100': '#ffffff',\n  '$gray-98': '#f9f9f9',\n  '$gray-95': '#f2f2f2',\n  '$gray-90': '#e6e6e6',\n  '$gray-35': '#595959',\n  '$gray-30': '#4d4d4d',\n  '$gray-25': '#404040',\n  '$gray-20': '#333333',\n\n  // borders\n  '$border-95': 'rgba(255, 255, 255, 0.05)',\n  '$border-90': 'rgba(255, 255, 255, 0.1)',\n  '$border-80': 'rgba(255, 255, 255, 0.2)',\n  '$border-20': 'rgba(0, 0, 0, 0.2)',\n  '$border-10': 'rgba(0, 0, 0, 0.1)',\n  '$border-5': 'rgba(0, 0, 0, 0.05)',\n\n  // primary colors\n  '$primary-blue': '#3F8AB3',\n  '$primary-green': '#6CB33F',\n  '$primary-red': '#DC423F',\n  '$primary-orange': '#EF960F',\n\n  // spacing\n  '$spacing--s': 4,\n  '$spacing': 8,\n  '$spacing--l': 12,\n  // -------------------------\n\n  // -- ALIASES --\n  '$font-color': '$gray-35',\n  '$font-color--inverted': '$gray-90',\n  '$guide-color': '$gray-90',\n  '$guide-color--inverted': '$gray-35',\n  '$border': '$border-80',\n  '$border--inverted': '$border-10',\n  // -------------------------\n\n  // -- MIXINS --\n  // data points\n  '$shape': { // data shape\n    fill: '$primary-blue',\n    strokeWidth: 1,\n    stroke: '$border'\n  },\n\n  '$shape-outline': { // data shape which usually does not have a fill, e.g. the line in a linechart\n    stroke: '$primary-blue',\n    strokeWidth: 2\n  },\n\n  '$shape-guide': { // lines that somehow belongs to a data shape, e.g. whiskers in a boxplot\n    stroke: '$guide-color',\n    strokeWidth: 1\n  },\n\n  '$shape-guide--inverted': {\n    '@extend': '$shape-guide',\n    stroke: '$guide-color--inverted'\n  },\n\n  '$label': {\n    fontSize: '$font-size',\n    fontFamily: '$font-family',\n    fill: '$font-color'\n  },\n\n  '$label--inverted': {\n    '$extend': '$label',\n    fill: '$font-color--inverted'\n  },\n\n  // user interface\n  '$label-overlay': { // e.g. selection range bubble\n    fontSize: '$font-size--l',\n    fontFamily: '$font-family',\n    fill: '$gray-100', // background fill\n    color: '$font-color',\n    stroke: '$guide-color--inverted',\n    strokeWidth: 1,\n    borderRadius: 4\n  },\n\n  '$title': {\n    '@extend': '$label',\n    fontSize: '$font-size--l'\n  },\n\n  '$guide-line': {\n    strokeWidth: 1,\n    stroke: '$guide-color'\n  },\n\n  '$guide-line--minor': {\n    strokeWidth: 1,\n    stroke: '$gray-95' // needs alias\n  },\n\n  '$padding--s': {\n    left: '$spacing--s',\n    right: '$spacing--s',\n    top: '$spacing--s',\n    bottom: '$spacing--s'\n  },\n\n  '$padding': {\n    left: '$spacing',\n    right: '$spacing',\n    top: '$spacing',\n    bottom: '$spacing'\n  },\n\n  '$selection-area-target': {\n    fill: '$primary-green',\n    strokeWidth: 0,\n    opacity: 0.2\n  }\n};\n\nexport {\n  style,\n  palettes\n};\n","import 'path2d-polyfill';\nimport extend from 'extend';\nimport about from './about';\n\nimport {\n  chart,\n  renderer\n} from './core';\n\n\nimport {\n  components,\n  scales,\n  renderers\n} from './api';\n\nimport componentRegistry from './core/component';\nimport dataRegistry from './core/data';\nimport formatterRegistry from './core/formatter';\nimport interactionRegistry from './core/interaction';\nimport scaleRegistry from './core/charts/scales';\n\nimport loggerFn from './core/utils/logger';\nimport registry from './core/utils/registry';\n\nimport { style, palettes } from './core/theme/light';\n\nfunction usePlugin(plugin, options = {}, api) {\n  plugin(api, options);\n}\n\nfunction pic(config = {}, registries = {}) {\n  const logger = loggerFn(config.logger);\n\n  /**\n   * @lends picassojs\n   */\n  const regis = {\n    // -- registries --\n    /**\n     * Component registry\n     * @type {registry}\n     */\n    component: registry(registries.component),\n    /**\n     * Data registry\n     * @type {registry}\n     */\n    data: registry(registries.data),\n    /**\n     * Formatter registry\n     * @type {registry}\n     */\n    formatter: registry(registries.formatter),\n    /**\n     * Interaction registry\n     * @type {registry}\n     */\n    interaction: registry(registries.interaction),\n    /**\n     * Renderer registry\n     * @type {registry}\n     */\n    renderer: renderer(registries.renderer),\n    /**\n     * Scale registry\n     * @type {registry}\n     */\n    scale: registry(registries.scale),\n    /**\n     * Symbol registry\n     * @type {registry}\n     * @private\n     */\n    symbol: registry(registries.symbol),\n    // -- misc --\n    /**\n     * log some some stuff\n     * @type {logger}\n     * @private\n     */\n    logger\n  };\n\n  if (config.renderer && config.renderer.prio) {\n    regis.renderer.default(config.renderer.prio[0]);\n  }\n\n  /**\n   * picasso.js entry point\n   * @experimental\n   * @entry\n   * @alias picassojs\n   * @param {object} cfg\n   * @param {object} cfg.renderer\n   * @param {Array<string>} cfg.renderer.prio\n   * @param {object} cfg.logger\n   * @param {number} cfg.logger.level\n   * @param {object} cfg.style\n   * @param {Array<object>} cfg.palettes\n   * @returns {picassojs}\n   */\n  function picassojs(cfg = {}) {\n    let cc = {\n      palettes: config.palettes.concat(cfg.palettes || []),\n      style: extend({}, config.style, cfg.style),\n      logger: cfg.logger || config.logger,\n      renderer: cfg.renderer || config.renderer\n    };\n    return pic(cc, regis);\n  }\n\n  /**\n   * @callback picassojs~plugin\n   * @param {picassojs~registries} registries\n   * @param {object} options\n   */\n\n  /**\n   * @param {picassojs~plugin} plugin\n   * @param {object} [options]\n   */\n  picassojs.use = (plugin, options = {}) => usePlugin(plugin, options, regis);\n\n  /**\n   * @param {chart-definition} definition\n   * @returns {chart}\n   */\n  picassojs.chart = definition => chart(definition, {\n    registries: regis,\n    logger,\n    style: config.style,\n    palettes: config.palettes\n  });\n  picassojs.config = () => config;\n\n  Object.keys(regis).forEach((key) => {\n    picassojs[key] = regis[key];\n  });\n\n  /**\n   * picasso.js version\n   * @type {string}\n   */\n  picassojs.version = about.version;\n\n  return picassojs;\n}\n\nconst p = pic({\n  renderer: {\n    prio: ['svg', 'canvas']\n  },\n  logger: {\n    level: 0\n  },\n  style,\n  palettes\n}, {\n  component: componentRegistry,\n  data: dataRegistry,\n  formatter: formatterRegistry,\n  interaction: interactionRegistry,\n  renderer: renderer(),\n  scale: scaleRegistry\n});\n\ncomponents.forEach(p.use);\nrenderers.forEach(p.use);\nscales.forEach(p.use);\n\nexport { p as default };\n"],"names":["ARG_LENGTH","a","c","h","l","m","q","s","t","v","z","SEGMENT_PATTERN","NUMBER","parseValues","args","numbers","match","map","Number","parse","path","data","p","trim","replace","_","command","type","toLowerCase","length","push","concat","splice","supportsSvgPathArgument","window","canvas","document","createElement","g","getContext","Path2D","strokeStyle","lineWidth","stroke","imgData","getImageData","rotatePoint","point","angle","nx","x","Math","cos","y","sin","ny","translatePoint","dx","dy","polyFillPath2D","segments","parsePath","r","start","end","ccw","x1","y1","x2","y2","cp1x","cp1y","cp2x","cp2y","cpx","cpy","width","height","cFill","CanvasRenderingContext2D","prototype","fill","cStroke","buildPath","endAngle","startAngle","largeArcFlag","sweepFlag","endPoint","b","w","pathType","centerPoint","qcpx","qcpy","currentPoint","beginPath","i","moveTo","lineTo","atan2","sqrt","arc","bezierCurveTo","quadraticCurveTo","closePath","arcTo","rect","fillRule","apply","arguments","call","path2dPolyfill","hasOwn","Object","hasOwnProperty","toStr","toString","isArray","arr","Array","isPlainObject","obj","hasOwnConstructor","hasIsPrototypeOf","constructor","key","extend","options","name","src","copy","copyIsArray","clone","target","deep","version","mixins","add","mixin","list","dockConfig","settings","dock","displayOrder","prioOrder","requiredSize","minimumLayoutMode","show","fn","requiredSizeFn","calcFn","dockFn","d","displayOrderFn","order","prioOrderFn","minimumLayoutModeFn","showFn","roundRect","ceil","getRect","container","containerRect","logicalContainerRect","getBoundingClientRect","boundingRect","size","isNaN","logicalSize","align","min","max","preserveAspectRatio","resolveLayout","resolveSettings","center","minWidthRatio","minHeightRatio","minWidth","minHeight","isNumber","notNumber","value","getMinMax","points","num","xMin","NaN","xMax","yMin","yMax","lineToPoints","line","rectToPoints","pointsToRect","pointsToCircle","cx","cy","pointsToLine","getShapeType","shape","vertices","validateComponent","component","expectedProperties","forEach","Error","cacheSize","reducedRect","cachedSize","config","edgeBleed","validateReduceRect","minReduceWidth","minReduceHeight","reduceDocRect","addEdgeBleed","currentEdgeBleed","left","right","top","bottom","reduceEdgeBleed","reducedRectRightBoundary","reducedRectBottomBoundary","reduceSingleLayoutRect","newReduceRect","newEdgeBeed","isValid","reduceLayoutRect","components","hiddenComponents","sortedComponents","slice","sort","instance","filteredUnsortedComps","filter","indexOf","appendScaleRatio","outerRect","scaleRatio","margin","xLessThenY","minRatio","area","spread","boundingBox","rects","positionComponents","vRect","hRect","referencedComponents","test","refs","split","resize","undefined","checkShowSettings","layoutModes","dockLayout","initialSettings","docker","addComponent","removeComponent","idx","layout","reduced","visible","hidden","settingsFn","detectTouchSupport","e","isTouchEvent","changedTouches","isValidTapEvent","eventInfo","isTouch","ee","dt","Date","now","time","abs","clientX","clientY","button","multiTouch","datasets","dataSources","types","logger","sets","warn","datasetFactory","dataset","keys","pi","PI","tau","epsilon","tauEpsilon","Path","_x0","_y0","_x1","_y1","x0","y0","x21","y21","x01","y01","l01_2","x20","y20","l21_2","l20_2","l21","l01","tan","acos","t01","t21","a0","a1","cw","da","constant","halfPi","asin","arcInnerRadius","innerRadius","arcOuterRadius","outerRadius","arcStartAngle","arcEndAngle","arcPadAngle","padAngle","intersect","x3","y3","x10","y10","x32","y32","cornerTangents","r1","rc","lo","ox","oy","x11","y11","x00","y00","d2","D","cx0","cy0","cx1","cy1","dx0","dy0","dx1","dy1","cornerRadius","padRadius","context","buffer","r0","a01","a11","a00","a10","da0","da1","ap","rp","rc0","rc1","t0","t1","p0","p1","oc","ax","ay","bx","by","kc","lc","centroid","Linear","_context","areaStart","_line","areaEnd","lineStart","_point","lineEnd","pointX","pointY","defined","curve","curveLinear","output","n","defined0","j","k","x0z","y0z","arealine","lineX0","lineY0","lineY1","lineX1","identity","sortValues","descending","pie","sum","index","arcs","pa","that","Basis","_k","_x2","_y2","Cardinal","tension","custom","cardinal","_l01_a","_l01_2a","_l12_a","_l12_2a","_l23_a","_l23_2a","CatmullRom","alpha","_alpha","x23","y23","pow","catmullRom","sign","slope3","h0","h1","s0","s1","slope2","MonotoneX","_t0","MonotoneY","ReflectContext","create","monotoneX","monotoneY","Natural","_x","_y","px","controlPoints","py","i0","i1","Step","_t","stepBefore","stepAfter","series","o","stackValue","orderNone","offset","offsetNone","stack","kz","sz","oz","ki","si","sij","none","yp","yn","s2","sij0","sij1","s3","sk","skj0","skj1","sums","tops","bottoms","reverse","registryFactory","parentRegistry","defaultValue","reg","parent","get","has","default","TypeError","remove","getKeys","getValues","deflt","registry","register","toExponential","coefficient","formatDecimal","grouping","thousands","substring","join","numerals","re","formatSpecifier","specifier","FormatSpecifier","exec","symbol","zero","comma","precision","out","prefixExponent","exponent","floor","toFixed","round","toPrecision","formatRounded","formatPrefixAuto","toUpperCase","prefixes","locale","group","formatGroup","currency","decimal","formatNumerals","percent","newFormat","formatTypes","prefix","suffix","formatType","maybeSuffix","format","valuePrefix","valueSuffix","valueNegative","formatTrim","charCodeAt","Infinity","padding","formatPrefix","f","defaultLocale","definition","formatLocale","step","formatter","pattern","thousand","d3format","localeFn","reset","formatFn","patternFn","newInterval","floori","offseti","count","field","interval","date","d0","d1","range","stop","previous","setTime","every","isFinite","millisecond","durationSecond","durationMinute","durationHour","durationDay","durationWeek","second","getUTCSeconds","minute","getMinutes","hour","getTimezoneOffset","getHours","day","setHours","setDate","getDate","weekday","getDay","sunday","monday","tuesday","wednesday","thursday","friday","saturday","month","setMonth","getMonth","getFullYear","year","setFullYear","utcMinute","setUTCSeconds","getUTCMinutes","utcHour","setUTCMinutes","getUTCHours","utcDay","setUTCHours","setUTCDate","getUTCDate","utcWeekday","getUTCDay","utcSunday","utcMonday","utcTuesday","utcWednesday","utcThursday","utcFriday","utcSaturday","utcMonth","setUTCMonth","getUTCMonth","getUTCFullYear","utcYear","setUTCFullYear","localDate","H","M","S","L","utcDate","UTC","newYear","locale_dateTime","dateTime","locale_date","locale_time","locale_periods","periods","locale_weekdays","days","locale_shortWeekdays","shortDays","locale_months","months","locale_shortMonths","shortMonths","periodRe","formatRe","periodLookup","formatLookup","weekdayRe","weekdayLookup","shortWeekdayRe","shortWeekdayLookup","monthRe","monthLookup","shortMonthRe","shortMonthLookup","formats","formatShortWeekday","formatWeekday","formatShortMonth","formatMonth","formatDayOfMonth","formatMicroseconds","formatHour24","formatHour12","formatDayOfYear","formatMilliseconds","formatMonthNumber","formatMinutes","formatPeriod","formatUnixTimestamp","formatUnixTimestampSeconds","formatSeconds","formatWeekdayNumberMonday","formatWeekNumberSunday","formatWeekNumberISO","formatWeekdayNumberSunday","formatWeekNumberMonday","formatYear","formatFullYear","formatZone","formatLiteralPercent","utcFormats","formatUTCShortWeekday","formatUTCWeekday","formatUTCShortMonth","formatUTCMonth","formatUTCDayOfMonth","formatUTCMicroseconds","formatUTCHour24","formatUTCHour12","formatUTCDayOfYear","formatUTCMilliseconds","formatUTCMonthNumber","formatUTCMinutes","formatUTCPeriod","formatUTCSeconds","formatUTCWeekdayNumberMonday","formatUTCWeekNumberSunday","formatUTCWeekNumberISO","formatUTCWeekdayNumberSunday","formatUTCWeekNumberMonday","formatUTCYear","formatUTCFullYear","formatUTCZone","parses","parseShortWeekday","parseWeekday","parseShortMonth","parseMonth","parseLocaleDateTime","parseDayOfMonth","parseMicroseconds","parseHour24","parseDayOfYear","parseMilliseconds","parseMonthNumber","parseMinutes","parsePeriod","parseUnixTimestamp","parseUnixTimestampSeconds","parseSeconds","parseWeekdayNumberMonday","parseWeekNumberSunday","parseWeekNumberISO","parseWeekdayNumberSunday","parseWeekNumberMonday","parseLocaleDate","parseLocaleTime","parseYear","parseFullYear","parseZone","parseLiteralPercent","X","string","pad","pads","charAt","newParse","newDate","parseSpecifier","week","Q","V","timeMonday","timeDay","u","W","U","Z","utcFormat","utcParse","numberRe","percentRe","requoteRe","requote","names","RegExp","timeYear","getMilliseconds","getSeconds","timeSunday","timeThursday","getUTCMilliseconds","dow","timeFormat","timeParse","isoSpecifier","formatIsoNative","toISOString","formatIso","parseIsoNative","parseIso","timeFormatLocale","parsePattern","formatterRegistry","d3NumberFormatter","d3TimeFormatter","getFormatter","formatterFn","accessors","id","source","title","String","tags","values","label","raw","items","OFFSETS","diverging","stackOffsetDiverging","stackOffsetNone","silhouette","stackOffsetSilhouette","expand","stackOffsetExpand","wiggle","stackOffsetWiggle","ORDERS","ascending","stackOrderAscending","insideout","stackOrderInsideOut","stackOrderNone","stackOrderReverse","stacked","ds","stackIds","stackFn","stackKey","valueFn","startProp","endProp","valueRef","maxStackCount","valueFields","sourceField","ff","sid","matrix","d3Stack","serie","item","stackedFields","dSource","fieldFn","fields","extract","dataConfig","opts","extracted","collection","labelFn","groupBy","mapTo","hierarchy","root","extractionsConfigs","sourceFields","cfg","amend","extractor","collections","babelHelpers.typeof","coll","filtered","deps","extractData","formatterType","builder","formatters","getOrCreateFormatter","compare","ascendingComparator","hi","mid","ascendingBisect","bisector","bisectRight","e10","e5","e2","ticks","tickIncrement","power","log","LN10","error","tickStep","step0","step1","Map","set","property","clear","entries","empty","each","object","Set","proto","array","implicit","ordinal","domain","unknown","scale","band","ordinalRange","bandwidth","paddingInner","paddingOuter","rescale","sequence","rangeRound","factory","Color","darker","brighter","reI","reN","reP","reHex3","reHex6","reRgbInteger","reRgbPercent","reRgbaInteger","reRgbaPercent","reHslPercent","reHslaPercent","named","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","define","color","displayable","rgb","hex","parseInt","Rgb","rgbn","rgba","hsla","rgbConvert","opacity","Hsl","hslConvert","hsl","m2","m1","hsl2rgb","deg2rad","rad2deg","K","Xn","Yn","Zn","t2","t3","labConvert","Lab","Hcl","rgb2lrgb","xyz2lab","lab","lab2xyz","lrgb2rgb","hclConvert","hcl","A","B","C","E","ED","EB","BC_DA","cubehelixConvert","Cubehelix","bl","cubehelix","cosh","sinh","linear","exponential","gamma","nogamma","rgbGamma","colorRgb","nb","na","reA","reB","one","bi","lastIndex","am","bm","bs","number","valueOf","degrees","rho","SQRT2","unit","deinterpolateLinear","deinterpolateClamp","deinterpolate","reinterpolateClamp","reinterpolate","bimap","polymap","bisect","interpolate","clamp","continuous","interpolateValue","piecewise","input","invert","interpolateRound","precisionPrefix","precisionRound","precisionFixed","linearish","tickFormat","nice","threshold","invertExtent","applyFormat","val","isObject","minorTicksGenerator","appendMinorTicks","majorTicks","minorCount","looseDistanceBasedGenerator","distance","unitDivider","ticksFormatted","tick","position","isMinor","tightDistanceBasedGenerator","ticksByCount","ticksByValue","ary","forceTicksAtBounds","ticksP","lastTick","generateContinuousTicks","minorTicks","tickGen","tight","forceBounds","generateDiscreteTicks","dataItems","labels","defaultSettings","stngs","DEFAULT_SETTINGS","include","DEFAULT_TICKS_SETTINGS","DEFAULT_MINORTICKS_SETTINGS","fieldMin","fieldMax","minValues","maxValues","mini","maxi","initNormScale","normScale","scaleLinear","resources","d3Scale","d3ScaleLinear","ctx","stgns","tickCache","cachedTicks","fnCachedTicks","clearTicksCache","fnClearTicks","func","classify","valueRange","samplePos","lastVal","calIntervalPos","calSamplePos","sampleColValue","pop","cop","norm","normInvert","maxPxStep","scaleBand","d3ScaleBand","domainToDataMapping","augmentScaleBand","datum","domainValue","trackBy","pxScale","sizeRelativeToStep","newBand","arg","depth","keyGen","node","ancestors","flattenTree","rootNode","ticksDepth","expando","eachAfter","leaves","isBranch","children","leftEdge","rightEdge","spill","scaleHierarchicalBand","bandInstance","bandScale","hBand","strVal","bw","isLeaf","leafCount","stepSize","orgPxScale","minAccessor","maxAccessor","minmax","definedMin","definedMax","arrMin","numericFilter","arrMax","generateDomain","len","part","scaleSequentialColor","interpolateRgb","isDomain","isRange","DEFAULT_COLORS","theme","palette","getBreaks","ret","generateRange","colors","seq","sequential","generateNiceDomain","numPoints","lin","shift","scaleThresholdColor","scaleThreshold","scaleOrdinal","DEFAULT_EXPLICIT_SETTINGS","override","scaleCategorical","explicit","un","explicitDomain","explicitRange","numCopies","scaleRegistry","categorical","getTypeFromMeta","deduceScaleTypeFromData","dataSourceConfig","getOrCreateScale","scales","util","isUndefined","isFunction","EventEmitter","init","_events","_maxListeners","defaultMaxListeners","setMaxListeners","emit","er","handler","listeners","addListener","listener","newListener","warned","console","trace","on","once","fired","removeListener","removeAllListeners","listenerCount","emitter","scrollApi","viewSize","move","newStart","update","triggerUpdate","getState","createOrUpdate","oldApi","oldScrollApis","scrollApis","getOrCreateScrollApi","boundaries","after","contains","rangeCollection","before","containsValue","containsRange","toggle","ranges","valueCollection","vc","changedMap","changed","vi","collectUnique","filteredSet","createValueCollection","addedMap","removedMap","added","removed","fs","setKeys","addedKeys","removedKeys","diff","old","current","changedValues","filterFn","vCollection","oldMap","vcKeys","createValueCollectionFn","fsKeys","applyAliases","aliases","its","intercept","handlers","reduce","interceptor","toCamelCase","$1","toSnakeCase","updateRange","action","interceptors","inter","rangeValues","brush","activated","addValues","removeValues","toggleValues","setValues","addRanges","setRanges","removeRanges","toggleRanges","state","links","ls","_state","updateValues","updateRanges","link","isActive","brushes","hasChanged","result","addValue","removeValue","addAndRemoveValues","addItems","removeItems","addIts","removeIts","toggleValue","toggled","addRange","removeRange","setRange","toggleRange","containsRangeValue","containsMappedData","props","mode","status","bool","some","ic","removeInterceptor","removeAllInterceptors","toRemove","interceptorHandlers","addKeyAlias","alias","removeKeyAlias","typeMixins","cubicInOut","amplitude","period","elasticOut","nodeId","text","tween","renderer","ticker","toBeUpdated","entered","nodes","ips","exited","updated","stages","tweener","ids","interpolateObject","easing","easeCubic","duration","tweens","easeElasticOut","started","requestAnimationFrame","currentStage","currentNodes","tweenedNodes","ip","render","cancelAnimationFrame","GLOBAL_DEFAULTS","fontFamily","fontSize","backgroundColor","strokeWidth","$fill","REF_RX","isPrimitive","normalizeSettings","defaults","chart","composition","defs","vType","defaultType","ref","resolveForItem","normalized","fallbackData","dataContext","normalizedProp","exists","hasExplicitDataProp","hasImplicitDataProp","propData","updateScaleSize","scaleWithSize","externals","cache","resolve","scaled","res","resolved","reduceToLeafNodes","styler","style","brusher","dataProps","active","inactive","styleProps","activeNodes","globalActivation","nodeData","globalChanged","__style","activeIdx","ss","onStart","onEnd","onUpdate","externalUpdate","cleanUp","brushDataPoints","dataPoints","trigger","rangeBrush","actionFn","valueBrush","dataPoint","it","contexts","brushFromSceneNodes","resolveEvent","collisions","brushCollisions","propagation","touchSingleContactPoint","singleContactPoint","resolveCollisions","element","touchRadius","itemsAt","resolveAction","def","resolveTapEvent","resolveOverEvent","isReservedProperty","prop","prepareContext","require","mediatorSettings","mediator","registries","resolver","_DO_NOT_USE_getInfo","defineProperty","bind","req","eventName","updateDockConfig","setUpEmitter","event","eventListeners","componentFactory","settingsResolver","brushArgs","brushTriggers","tap","over","brushStylers","componentMixins","listMixins","definitionContext","instanceContext","mixinName","createCallback","method","defaultMethod","cb","inDefinition","inConfig","returnValue","preferredSize","inner","created","beforeMount","mounted","beforeUnmount","beforeUpdate","beforeRender","beforeDestroy","destroyed","addBrushStylers","consume","brushStyler","addBrushTriggers","rendString","rend","outer","appendComponentMeta","dataCollection","newSize","getRenderArgs","renderArgs","hide","unmount","currentTween","animations","enabled","destroy","updateNodes","getBrushedShapes","shapes","sceneNodes","findShapes","selector","shapesAt","brushFromShapes","mount","appendTo","onBrushTap","globalPropagation","toggleBrushing","onBrushOver","v1","v2","sub","scalarMultiply","distanceX","distanceY","sqrDistance","dot","projectOnto","rotate","radians","origin","EPSILON","closestPointToLine","startToPoint","startToEnd","pointOnLine","isPointOnLine","lineHasNoLength","rectHasNoSize","circleHasNoSize","circle","toFewEdges","polygon","edges","NarrowPhaseCollision","sqrDist","rX","rY","rcX","rcY","dX","dY","p2","testCirclePoint","dist","circle1","circle2","testPolygonPoint","edge","testCircleLine","testRectPoint","even","rayStart","testLineLine","testRectLine","p3","p4","rect1","rect2","rectEdges","line1","line2","dx2","dy2","dx3","dy3","ub","uat","ubt","ua","VARIABLE_RX","EXTEND","throwCyclical","references","computed","extendFrom","pext","themeFn","palettes","pals","setPalettes","pal","sizes","getPalette","styleResolver","addComponentDelta","containerBounds","componentBounds","deltaShape","chartFn","chartMixins","mediatorFactory","currentComponents","visibleComponents","currentScales","currentFormatters","currentScrollApis","currentInteractions","stopBrushing","createComponent","compSettings","componentDefinition","compInstance","hasKey","findComponent","componentInstance","findComponentIndexByKey","currComp","createDockLayout","moveToPosition","comp","el","childNodes","insertBefore","_data","_settings","partialData","scroll","datasources","dataCollections","buildScales","buildFormatters","buildScroll","setInteractions","interactions","newKeys","cit","intSettings","intDefinition","interaction","componentsFromPoint","br","tp","innerHTML","addEventListener","onTapDown","touches","comps","disableTriggers","preventDefault","brushEventList","removeEventListener","newProps","updateWith","toUpdate","toRender","getAffectedShapes","compKeys","stopPropagation","configKeys","conf","configIndex","compShapes","brushFn","instances","off","rendererRegistry","prio","componentRegistry","findField","query","filters","numeric","unfilteredReducers","reducers","first","last","avg","normalizeProperties","dataProperties","main","mainField","pConfig","getPropsInfo","collect","trackedItems","propsArr","mainFormatter","propsFormatters","mainValues","mainReduce","track","itemData","tracker","trackType","trackId","trackedItem","datumExtract","propCfg","cell","cfgs","sourceKey","mapped","mainCell","exclude","propCell","storeTracked","createFields","headers","content","rowFn","row","flds","fieldValues","fv","numericValues","isMeasure","dsv","rows","row0","row1","delimiter","guesses","parseData","dd","normalizeConfig","dataRegistry","native","nativeEvents","itKey","isOn","setDefaultSettings","newSettings","events","enable","addEvents","removeAddedEvents","cap","resolveDiff","minPx","maxPx","high","low","highModified","lowModified","wantedDiff","actualDiff","startModifier","actualLow","box","boxWidth","boxPadding","rendwidth","rendheight","flipXY","calcwidth","calcheight","minHeightPx","major","verticalLine","from","to","boxCenter","horizontalLine","halfWidth","buildShapes","majorVal","majorEndVal","binStart","binEnd","majorEnd","minor","maxMajorWidth","maxWidthPx","median","med","whisker","whiskerWidth","collider","complexResolver","orientation","majorSettings","majorResolved","minorSettings","minorResolved","ext","DEFAULT_DATA_SETTINGS","minWidthPx","dataKeys","picasso","mappedAttributes","baseline","dominantBaseline","anchor","textAnchor","maxWidth","transform","strokeDasharray","assignMappedAttribute","sourceValue","mappedKey","pointsToPath","close","diamond","generateCrossPoints","barWidth","innerLeft","innerTop","cross","angleToPoints","segment","diagonal","op","toRadians","degreesToPoints","saltire","adjustedSize","square","DIRECTION_TO_ANGLE","up","down","triangle","directionAngle","direction","halfSize","pp","isVertical","star","drawPoints","pAngle","innerRadians","iy","ix","nPolygon","radius","sides","bar","createRectCollider","applyOpts","DEFAULT_ERROR_SETTINGS","errorShape","SIZE_LIMITS","maxRelExtent","minRelExtent","maxRelDiscrete","minRelDiscrete","getPxSpaceFromScale","space","isBandwidth","getPointSizeLimits","limits","xSpacePx","ySpacePx","maxSizePx","minSizePx","maxGlobal","minGlobal","createDisplayPoints","pointSize","shapeFn","shapeSpec","sizeLimits","shapeFactory","pointMarker","pointMarkerComponent","offsetSlice","vx","vy","vlen","createDisplayPies","arcData","slices","arcGen","or","ir","desc","share","arcValue","pieComponent","arcValues","pieGen","crispifierFactory","crispMap","append","condition","conditionAppend","self","toAppend","crispItem","doAppend","rounded","multiple","crispifier","Transposer","coordinate","firstChar","storage","newItem","crisp","objectKeys","kl","nkey","evaluateKey","nval","transposeCoordinate","crispify","processItem","rest","transposer","lineGen","gridLineComponent","blueprint","lines","gridLine","directionMarker","directionTriangle","oobManager","oob","oobKeys","xPadding","yPadding","indicator","refLabelDefaultSettings","background","alignmentToNumber","createLineWithLabel","doesNotCollide","measuredValue","valueString","scaleData","measureText","measuredLabel","measured","labelPadding","vAlign","calcWidth","calcHeight","rectWidth","rectHeight","curItem","Collision","testRectRect","createOobData","filterUndefinedValue","refLineComponent","refLine","appendStyle","struct","buildOpts","buildLine","innerRect","checkText","clampEnds","tilted","outerBoundaryMultipler","leftBoundary","rightBoundary","textWidth","textRect","leftTextBoundary","rightTextBoundary","topBoundary","bottomBoundary","textHeight","maxHeight","topTextBoundary","bottomTextBoundary","appendPadding","appendTilting","paddingEnd","bandwidthCollider","tickCenter","widthClip","heightClip","boundsCollider","tiltedCollider","startAnchor","em","sp","rotateVector","leftPoint","rightPoint","orderedPoints","appendCollider","layered","appendBounds","textBounds","buildNode","adjustForEnds","tickSize","isMajorTick","isVerticalLabelOverlapping","isHorizontalLabelOverlapping","activeMode","shouldAutoTilt","measure","glyphCount","maxGlyphCount","magicSizeRatioMultipler","ellipsCharSize","maxLabelWidth","minBandwidth","prev","curr","isTiltedLabelOverlapping","bleedSize","absAngle","reciprocal","distanceBetweenLabels","isToLarge","horizontal","getClampedValue","maxValue","minValue","modifier","getSize","isDiscrete","maxLengthPx","minLengthPx","toLargeSize","sizeFromTextRect","tiltAngle","tickMeasures","labelSizes","textSize","extendLeft","labelWidth","adjustByPosition","pos","maxEdgeBleed","bleedDir","tickSpacing","spacing","paddingStart","tickMinorSpacing","labelsSpacing","calcActualTextRect","tickBuilder","buildTick","tickBandwidth","labelBuilder","tickFn","buildLabel","layeredLabelBuilder","padding2","layer","filterOverlappingLabels","isOverlapping","l1","l2","discreteCalcMaxTextRect","continuousCalcMaxTextRect","getStepSizeFn","nodeBuilder","calcMaxTextRectFn","filterLabels","discrete","build","majorTickNodes","maxSize","labelNodes","DEFAULT_DISCRETE_SETTINGS","DEFAULT_CONTINUOUS_SETTINGS","calcRequiredSize","getLabelSize","labelSize","minorTicksSize","alignTransform","resolveAlign","vertical","resolveLocalSettings","defaultStgns","localStgns","defaultDock","updateActiveMode","isHorizontal","axisComponent","concreteNodeBuilder","setState","reqSize","extendedInner","finalOuter","axis","parseTitle","titles","getTextAnchor","generateTitle","definitionSettings","paddingLeft","paddingRight","rotation","textComponent","_scrollbar","lengthAttr","currentMove","scrollState","startOffset","startScroll","swipe","scrollPoint","scrollMove","scrollStart","scrollCenter","getLocalPos","scrollbarComponent","panStart","startPos","deltaX","deltaY","panMove","panEnd","panCancel","thumbColor","_rect","thumbStart","thumbRange","pointerEvents","class","scroller","scrollbar","TARGET_SIZE","VERTICAL","HORIZONTAL","borderHit","isAlignStart","alignStart","alignEnd","alignStyle","targetRect","bubbles","mouseover","elm","mouseout","attrs","cursor","buildBubble","otherValue","isOutside","placement","outside","bubbleDock","borderRadius","bubble","border","textAlign","overflow","textOverflow","whiteSpace","buildArea","buildRange","els","vStart","vEnd","targetOffset","hasScale","targetFillRect","targetSize","targetStart","targetEnd","targetHeight","targetTop","targetArea","getMoveDelta","posDelta","limitHigh","negDelta","limitLow","delta","rangelimits","areaLimits","findActive","rs","activeRange","startArea","elementFromPoint","tempState","relX","relY","startPoint","cssCoord","coord","relStart","hasAttribute","getAttribute","multi","parseFloat","pxStart","pxEnd","Collisions","fauxBrushInstance","brushInstance","endArea","rel","moveArea","sourceData","sources","ordRS","oldValues","findValues","addedValues","removedValues","findClosest","minDist","halfBandwidth","findClosestLabel","rangesOverlap","r2","rangesValues","scaleRange","startIdx","endIdx","resolveNodeBounds","targetNodes","bounds","resolveTarget","targetFillNodes","fillSelector","fillBounds","brushRangeComponent","rangeStart","rangeMove","rangeEnd","rangeClear","brushFactory","valueRanges","shapesFromRange","brushRange","shapeAt","brushFromShape","newShapes","getBubbleLabel","labelShape","bounds0","bounds1","compConfig","c0","c1","brushAreaDirectionalComponent","areaMove","areaClear","getFormat","rangeBrushComponent","FILL","OPACITY","otherSize","setup","teardown","rangeComponent","getPoint","rendererBounds","eventOffsetX","eventOffsetY","withinThreshold","snapIndicator","appendToPath","setSnapIndictor","showSnapIndicator","setStartPoint","getComponentDelta","chartBounds","doLineBrush","lineBrushShape","componentDelta","brushConfig","doPolygonBrush","initPath","initSnapIndicator","initStartPoint","getBrushConfig","endBrush","resetState","brushLassoComponent","lasso","lassoStart","lassoEnd","lassoMove","lassoCancel","cancel","shouldSnap","lassoBrush","lassoBrushComponent","LINE_HEIGHT","PADDING","cbContext","placeTextInRect","textMetrics","wiggleHor","wiggleVert","justify","wiggleWidth","wiggleHeight","limitBounds","view","minY","maxY","minX","maxX","getBarRect","findBestPlacement","fitsHorizontally","placementSettings","barRect","largest","testBounds","localBounds","placeInBars","collectiveOrientation","findPlacement","placer","lblStngs","placements","texts","labelSettings","measurements","bestPlacement","precalculate","labelStruct","hasHorizontalDirection","lblStng","bars","labelSetting","getLineCircleIntersection","sqrtD","getRectFromCircleIntersection","lineOffset","section","intersection","getHorizontalInsideSliceRect","middle","PI2","startLine","endLine","testCircleRect","getRotatedInsideSliceRect","getRotatedOusideSliceRect","minR","getHorizontalOusideSliceRect","placeTextOnPoint","getSliceRect","sliceRect","firstOutsideBounds","previousOutsideBounds","CIRCLE_FACTOR","getRectFromCircle","getSliceBounds","getBounds","rowSettings","totalHeight","labelCount","currentY","maxYDistToCenter","strategy","labelsComponent","strategies","scrollOffset","wordBreak","maxLines","lineHeight","navigation","shapeSettings","symbols","next","wiggleSymbol","createRenderItem","globalMetrics","symbolFn","symbolFactory","displayObject","labelBounds","symbolItem","meta","rtl","labelRect","maxLabelBounds","maxSymbolSize","wiggled","maxItemBounds","metrics","getItemsToRender","viewRect","itemized","parallels","legendItems","renderItems","fixedHeight","fixedWidth","rowHeight","columnWidth","renderItem","itemize","sourceItems","sourceSymbols","sourceLabels","maxLabelHeight","extent","parallelize","availableExtent","availableSpread","extentProperty","extentInPx","numNeeded","spreadProperty","numAllowed","numInput","legend","onScroll","api","getContentOverflow","offsetProperty","hasContentOverflow","getNextSize","getPrevSize","hasNext","hasPrev","DIR","btn","nav","attrsMerged","disabled","itemRenderer","isRtl","buttonSize","display","navigationRenderer","titleRenderer","isPreliminary","paddedRect","availableExtentForItems","availableSpreadForItems","navigationSize","navigationSpread","tempLayout","contentItems","views","renderElement","parentElement","panstart","contentOverflow","panmove","panend","itemRendererFactory","navigationRendererFactory","titleRendererFactory","categoricalLegend","applyAlignJustify","cmd","generateStopNodes","fillScale","majorScale","stops","createTitleNode","isTickLeft","isTickTop","requiredWidth","tag","hyphens","createLegendRectNode","requiredHeight","degree","createTickNodes","legendNode","rangeSelectorRect","textBoundsFn","resolveAnchor","valid","resolveTickAnchor","dockAnchorMap","resolveTitleAnchor","initRect","getTicks","initState","titleStgns","tickValues","tickAnchor","titleTextMetrics","titleTextBounds","mw","fnPos","legendDef","prefSize","paddings","tHeight","tWidth","titleNode","stopNodes","rectNode","tickNodes","targetNode","sequentialLegend","legendSeq","CURVES","curveStep","curveStepAfter","curveStepBefore","basis","curveBasis","curveCardinal","curveCatmullRom","monotonex","curveMonotoneX","monotoney","curveMonotoneY","natural","curveNatural","SETTINGS","coordinates","layerId","layers","createDisplayLayer","generator","createDisplayLayers","missingMinor0","layerStngs","lineObj","layerObj","areaObj","areaGenerator","lineGenerator","secondaryLineGenerator","temp","minor0","firstPoint","layerIds","numLines","lid","metaLayers","layersData","layersResolved","linesResolved","areasResolved","areas","calculateVisibleLayers","visibleLayers","pData","lineMarkerComponent","getLocalPoint","localX","localY","localToChartPoint","doEndBrush","toRect","doAreaBrush","areaCancel","areaBrush","boxComponent","pointComponent","lineComponent","brushAreaComponent","Node","_parent","_children","_ancestors","removeChild","nChildren","equals","ch","toJSON","descendants","GeoRect","testPolygonRect","GeoCircle","minRadius","vector","testCircleCircle","testCirclePolygon","GeoLine","tolerance","vectors","zeroSize","testLinePoint","testPolygonLine","removeDuplicates","v0","GeoPolygon","_bounds","_boundingRect","intersects","pointsAreNotEqual","GeoPolyline","_points","testLine","polyline","GeometryCollection","geometries","geo","geoInstance","containsPoint","intersectsLine","intersectsRect","intersectsCircle","intersectsPolygon","Matrix","_elements","_stack","mt","multiply","elements","radianAngle","determinant","vec","transformRegEx","parseTransform","commands","argsStr","resolveRotateCmd","translate","resolveScaleCmd","resolveTranslateCmd","resolveMatrixCmd","resolveTransform","transforms","SELECTOR_MAPS","attr","universal","FILTERS","objects","operator","token","attribute","attributeValue","tokenize","groups","info","validSelector","selectorMapsIterator","find","groupResults","tokens","gi","glen","levels","hasRemainder","selected","ancestor","ni","nlen","appendDpi","dpi","geometryToDef","geometry","mvm","transformPoints","colliderToShape","modelViewMatrix","isCollection","SceneNode","withTransform","_attrs","_type","_dpi","stage","_collider","_desc","_tag","_element","_key","_node","createSceneNode","_input","appendParentNode","collision","createCollision","appendInputShape","resolveFrontChildCollision","resolveBoundsCollision","transformedInput","createPolygon","resolveGeometryCollision","inverseModelViewMatrix","transformPoint","resolveCollision","intersectionType","findAllCollisions","hasCollision","resolveShape","ratio","_shape","vertex","resolveCollionsOnNode","hasCollisionOnNode","DisplayObject","_stage","geometryCollection","nodeSelector","resolveLocalTransform","attrKeys","dAttrs","dAttrKeys","json","_mvm","_imvm","NodeContainer","indx","addChild","NC","reCalcBoundingRect","child","includeTransform","_xMax","_yMax","Container","addChildren","removeChildren","Stage","_dpiRatio","allowedAttrs","GradientItem","attrKey","Rect","pt","Circle","Line","defaultCollider","hasSize","PI_X2","arcToCenter","rx","ry","endX","endY","startX","startY","sweepAngle","radiusRatio","rad","hdx","hdy","x1d","y1d","rxry","rxy1d","ryx1d","den","frac","cxd","cyd","mx","my","ux","uy","flatness","cp1","cp2","td","toPoints","m0","q0","q1","toCubic","cp","cubicToPoints","arcToPoints","resAngle","deltaAngle","pathToPoints","cubicCurveToPoints","quadCurveToPoints","flatten2d","newAry","isClosed","col","pathToSegments","flatten","Text","gradientitem","contextFactory","whitelist","states","save","restore","styleContext","doEvent","updateState","traverse","siblings","displayNode","isIdentity","scene","LINEBREAK_REGEX","WHITESPACE_REGEX","HYPHEN_REGEX","NO_BREAK","MANDATORY","BREAK_ALLOWED","includesLineBreak","search","includesWhiteSpace","hyphenationAllowed","resolveBreakOpportunity","chunk","chunks","mandatory","noBreakAllowed","cleanEmptyChunks","stringTokenizer","separator","mandatoryBreakIdentifiers","noBreakAllowedIdentifiers","suppressIdentifier","hyphenationIdentifiers","peek","peekAt","textMeasure","opportunity","breakOpportunity","suppress","hyphenation","done","jumpToPosition","DEFAULT_LINE_HEIGHT","HYPHENS_CHAR","ELLIPSIS_CHAR","resolveMaxAllowedLines","measuredLineHeight","calcLineHeight","char","newLine","appendToLine","insertHyphenAndJump","iterator","startIndex","pairToken","breakSequence","charTokenIterator","charToken","breakAll","breakWord","generateLineNodes","_lineBreak","shouldLineBreak","wrappedMeasureText","resolveLineBreakAlgorithm","WORDBREAK","onLineBreak","wordBreakFn","tm","ellipsText","reduceIndex","reduceText","substr","baselineHeuristic","textNode","heightMeasureCache","widthMeasureCache","canvasCache","measureTextWidth","font","measureTextHeight","calcTextBounds","measureFn","calWidth","lineBreakFn","resolvedLineBreaks","nodeCopy","widestLine","createCanvasGradient","gradient","newGradient","theX","theY","createRadialGradient","createLinearGradient","addColorStop","createRendererBox","destory","toLineDash","dpiScale","dpr","devicePixelRatio","backingStorePixelRatio","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","resolveMatrix","setTransform","applyContext","shapeToCanvasMap","computedKeys","shapeCmd","canvasCmd","convertCmd","renderShapes","fillStyle","doFill","doStroke","sceneFn","sceneFactory","hasChangedRect","canvasRenderer","ownerDocument","appendChild","dpiRatio","scaleX","scaleY","sceneContainer","newScene","hasChangedScene","doRender","getItemsFrom","newRect","JSON","stringify","renderFn","rangesOfLChars","rangesOfRChars","rangesOfALChars","rangesOfLRgExp","rangesOfRRgExp","rangesOfALRgExp","isLtrChar","isRtlChar","detectTextDirection","textAnchorRTLMap","flipTextAnchor","dir","bdy","fillText","rendererComponent","updatedNew","updatedOld","fromIds","toIds","idMapper","nodeMapper","isTree","createNodes","destroyNodes","creator","maintainer","destroyer","createTree","oldItems","newItems","svgNs","createElementNS","parentNode","setAttribute","textContent","TreeItemRenderer","treeCreator","nodeCreator","nodeMaintainer","nodeDestroyer","tree","hashObject","hash","chr","gradients","gradientHashMap","checkGradient","url","gradientHash","gradientId","resetGradients","onGradient","location","href","createDefsNode","treeFn","treeFactory","ns","svg","cloneNode","replaceChild","vnode","sel","primitive","tagName","namespaceURI","qualifiedName","createTextNode","createComment","newNode","referenceNode","nextSibling","setTextContent","getTextContent","isElement","nodeType","isText","isComment","htmlDomApi","isUndef","isDef","emptyNode","sameVnode","vnode1","vnode2","isVnode","createKeyToOldIdx","beginIdx","hooks","modules","domApi","cbs","hook","emptyNodeAt","className","createRmCb","childElm","rmCb","parent_1","createElm","insertedVnodeQueue","hashIdx","dotIdx","is","insert","addVnodes","parentElm","vnodes","invokeDestroyHook","removeVnodes","i_1","rm","updateChildren","oldCh","newCh","oldStartIdx","newStartIdx","oldEndIdx","oldStartVnode","oldEndVnode","newEndIdx","newStartVnode","newEndVnode","oldKeyToIdx","idxInOld","elmToMove","patchVnode","oldVnode","prepatch","postpatch","patch","pre","post","exports","xlinkNS","xmlNS","colonChar","xChar","updateAttrs","oldAttrs","cur","removeAttribute","setAttributeNS","attributesModule","updateClass","oldClass","klass","classList","classModule","raf","setTimeout","nextFrame","setNextFrame","updateStyle","oldStyle","oldHasDel","removeProperty","delayed","name2","setProperty","applyDestroyStyle","applyRemoveStyle","compStyle","amount","applied","getComputedStyle","ev","styleModule","invokeHandler","handleEvent","createListener","updateEventListeners","oldOn","oldListener","oldElm","eventListenersModule","addNS","childData","vnode_1","snabbdomAttributes","snabbdomClass","snabbdomStyle","snabbdomEventlisteners","dom","firstChild","LOG_LEVEL","OFF","ERROR","WARN","INFO","DEBUG","loggerFn","level","pipe","currentlevel","LOG_FN","lev","debug","usePlugin","plugin","pic","regis","picassojs","cc","use","about","interactionRegistry","renderers"],"mappings":"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"}